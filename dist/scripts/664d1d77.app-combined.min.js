"use strict";angular.module("com.inthetelling.story",["ngRoute","ngAnimate","ngSanitize"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"templates/root.html"}).when("/episodes",{title:"Available episodes",templateUrl:"templates/producer/episodelist.html"}).when("/episode/:epId",{title:"Telling STORY",controller:"PlayerController",templateUrl:"templates/player.html",reloadOnSearch:!1,resolve:{product:["appState",function(a){a.product="player"}]}}).when("/sxs/:epId",{title:"Telling STORY",controller:"PlayerController",templateUrl:"templates/player.html",reloadOnSearch:!1,resolve:{product:["appState",function(a){a.product="sxs"}]}}).when("/producer/:epId",{title:"Telling STORY",controller:"PlayerController",templateUrl:"templates/player.html",reloadOnSearch:!1,resolve:{product:["appState",function(a){a.product="producer"}]}}).when("/assets/:containerId",{title:"Container Assets test",controller:"ContainerAssetsTestController",template:'<div style="margin:1em" class="admin"><a class="goUp" href="#episodes">Episodes</a><div sxs-container-assets="containerId">{{containerId}}</div></div>'}).otherwise({title:"Telling STORY: Error",controller:"ErrorController",templateUrl:"templates/error-404.html"})}]).run(["$rootScope",function(a){a.$on("$routeChangeSuccess",function(a,b){document.title=b.title?b.title:"Telling STORY"});var b=!1;$(document).on("keydown",function(c){b||"INPUT"===document.activeElement.tagName||"TEXTAREA"===document.activeElement.tagName||(b=!0,27===c.keyCode&&(a.$emit("userKeypress.ESC"),c.preventDefault()),32===c.which&&(a.$emit("userKeypress.SPACE"),c.preventDefault()))}),$(document).on("keyup",function(){b=!1})}]).config(["$sceDelegateProvider",function(a){a.resourceUrlWhitelist(["self",/.*/,/^http(s)?:\/\/platformuniv-p.edgesuite.net/,/^http(s)?:\/\/themes.googleusercontent.com/])}]).config(["$httpProvider",function(a){a.defaults.useXDomain=!0,a.defaults.withCredentials=!0,delete a.defaults.headers.common["X-Requested-With"],a.interceptors.push(["$q","errorSvc",function(a,b){return{responseError:function(c){return b.error(c),a.reject(c)}}}])}]),angular.module("com.inthetelling.story").run(["$templateCache",function(a){a.put("templates/containerepisodes.html",'<li ng-if=!container.episodes.length ng-bind-html=container.display_name></li><li ng-if=container.episodes.length><span ng-if="container.episodes[0] == episodeId"><b ng-bind-html=containers[container._id].display_name></b></span> <span ng-if="container.episodes[0] != episodeId"><a ng-href=/#/{{crossEpisodePath}}/{{container.episodes[0]}} ng-bind-html=containers[container._id].display_name></a></span></li><ul class=crossEpisodeNav><li ng-repeat="child in container.children" itt-container-episodes=containers[child._id]></li></ul>'),a.put("templates/copyright.html","TELLING STORY player &#169; {{now | date:'yyyy'}} <a href=https://inthetelling.com>IN THE TELLING</a>. All rights reserved. <a href=/privacy.html target=_new>Privacy Policy</a>"),a.put("templates/episode/columbia.html",'<div class="episode episode-columbia" ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><a class="itt logo" href=http://inthetelling.com><img src=images/itt.svg alt="In The Telling logo"></a> <span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/columbia.svg alt="Columbia University"></div></div>'),a.put("templates/episode/columbiabusiness.html",'<div class="episode episode-columbiabusiness" ng-class=episode.styleCss><div class="fill trident"></div><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><a class="itt logo" href=http://inthetelling.com><img src=images/itt.svg alt="In The Telling logo"></a> <span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/cbs-logo.svg alt="Columbia Business School"></div></div>'),a.put("templates/episode/components/discovermode.html",'<div class=discoverMode ng-show="appState.viewMode == \'discover\'"><div class="fill windowBg bgLayer"><div ng-class="item.styleCss + \' \' + item.state" itt-item=item class="item animate" ng-repeat="item in scene.items | isCurrent | itemLayout:\'windowBg\'"></div></div><div itt-scene=scene episode=episode></div></div>'),a.put("templates/episode/components/reviewmode.html",'<div class=reviewMode ng-show="appState.viewMode == \'review\'"><div itt-magnet="" id=reviewModeVideoMagnet class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div><div class=scene ng-class="{navigable: scene.display_title}" ng-repeat="scene in episode.scenes" ng-if=!scene._internal><div class="pane mainPane"><div class="content allowHighlights" ng-class="{isNarrow: isNarrow}" itt-width-watch=""><h1 class=sceneTitle ng-if=scene.display_title ng-bind-html=scene.display_title></h1><div ng-if="appState.windowWidth < 480" class="item animate" ng-repeat="item in scene.items| reviewMode | orderBy:\'start_time\'" ng-class="item.state + \' \' + item.uscReviewModeHack" itt-item=item forcetemplate=review-all></div><div ng-if="appState.windowWidth >= 480" class="item animate" ng-repeat="item in scene.items | reviewMode | annotation | orderBy:\'start_time\'" ng-class=item.state itt-item=item forcetemplate=review-annotation></div></div></div><div ng-if="appState.windowWidth >= 480" class="pane altPane"><div class="content allowHighlights" ng-class="{isNarrow: isNarrow}" itt-width-watch=""><img ng-if="$index==1" src=images/aspectratiopreserver-16x9.gif class=videoPadding> <div class="item animate" ng-repeat="item in scene.items | reviewMode | transmedia" ng-class="item.state + \' \' + item.uscReviewModeHack" itt-item=item forcetemplate=review-transmedia></div></div></div></div></div>'),a.put("templates/episode/components/video.html",'<div itt-magnetized="" class="pane videoContainer"><div class="video contentLayer" itt-video=episode.masterAsset></div><div class="pane fill overlay fgLayer"><div ng-class="item.styleCss + \' \' + item.state" itt-item=item class="item animate" ng-repeat="item in episode.items | itemLayout:\'videoOverlay\' | isCurrent"></div></div></div>'),a.put("templates/episode/components/watchmode.html",'<div ng-if="appState.viewMode == \'watch\'" style="padding-bottom: 100%"><div class=watchMode><div itt-magnet="" id=watchModeVideoMagnet class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div></div><span class=watchModeCaptions ng-class="{padForBottomToolbar: appState.videoControlsActive}"><div class="item watchModeCaption" ng-if="item.isCurrent && !appState.hideCaptions" ng-repeat="item in episode.items | transcript" ng-class=item.state itt-item=item forcetemplate=caption></div></span></div>'),a.put("templates/episode/components/windowfg.html",'<div ng-if="(episode.items | isCurrent | itemLayout:\'windowFg\').length > 0" class="overlay windowFg fgLayer animate transitionFade"><div class=content><div ng-class="item.styleCss + \' \' + item.state" itt-item=item class="item animate" ng-repeat="item in episode.items | isCurrent | itemLayout:\'windowFg\'"></div><a ng-if="!appState.editEvent && appState.timelineState == \'paused\'" class=button-continue ng-click=play()><span>Continue</span></a></div></div>'),a.put("templates/episode/eliterate.html",'<div class="episode episode-eliterate" ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><a class="eliterate logo" href=http://www.mindwires.com><img src=images/customer/eliterate-mindwires.svg alt="Mindwires logo"></a> <a class="itt logo" href=http://inthetelling.com><img src=images/itt.svg alt="In The Telling logo"></a> <span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/eliterate-logo.svg alt=E-Literate></div></div>'),a.put("templates/episode/episode.html",'<div class=episode ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><a class="itt logo" href=http://inthetelling.com><img src=images/itt.svg alt="In The Telling logo"></a> <span class=copyright ng-include="\'templates/copyright.html\'"></span></div></div>'),a.put("templates/episode/ewb.html",'<div class="episode episode-ewb" ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><a class="itt logo" href=http://inthetelling.com><img src=images/itt.svg alt="In The Telling logo"></a> <span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/ewb-logo.svg alt="Engineers Without Borders"></div></div>'),a.put("templates/episode/gw.html",'<div class="episode episode-gw" ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/gw-logo.svg alt="George Washington"></div></div>'),a.put("templates/episode/gwlaw.html",'<div class="episode episode-gw" ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/gw-law.jpg alt="GW Law"></div></div>'),a.put("templates/episode/purdue.html",'<div class="episode episode-purdue" ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><a class="itt logo" href=http://inthetelling.com><img src=images/itt.svg alt="In The Telling logo"></a> <span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/purdue-logo.svg alt=Purdue></div></div>'),a.put("templates/episode/schoolclimatesolutions.html",'<div class="episode episode-schoolclimatesolutions" ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><a class="itt logo" href=http://inthetelling.com><img src=images/itt.svg alt="In The Telling logo"></a> <span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/schoolclimatesolutions.svg alt="SCS: School Climate Solutions"></div></div>'),a.put("templates/episode/story.html",'<div class="episode episode-story" ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><a class="itt logo" href=http://inthetelling.com><img src=images/itt.svg alt="In The Telling logo"></a> <span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/tellingstory-logo.svg alt="Telling STORY"></div></div>'),a.put("templates/episode/usc.html",'<div class="episode episode-usc" ng-class=episode.styleCss><span ng-include="\'templates/episode/components/reviewmode.html\'"></span> <span ng-include="\'templates/episode/components/watchmode.html\'"></span> <span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span> <span ng-include="\'templates/episode/components/video.html\'"></span> <span ng-include="\'templates/episode/components/windowfg.html\'"></span><div ng-if="appState.viewMode != \'watch\'" class="branding footer"><a class="itt logo" href=http://inthetelling.com><img src=images/itt.svg alt="In The Telling logo"></a> <span class=copyright ng-include="\'templates/copyright.html\'"></span></div><div class=banner-logo><img src=images/customer/usc-logo.svg alt=USC></div></div>'),a.put("templates/error-404.html","<div class=errors><div class=error><h3>Error: no such route</h3><p><i>404. File not found. Sorry!</i></p></div></div>"),a.put("templates/error.html",'<span ng-if="errorSvc.errors.length || errorSvc.notifications.length" class=errors><div class=error ng-repeat="error in errorSvc.errors" ng-click=dismiss(error)><h3>Error: {{error.cause || error.exception.data || \'(unknown reason)\'}}</h3><p ng-if=error.exception.config.url><i>(While trying to load {{error.exception.config.url}})</i></p><p ng-if="error.exception.status == 401">Please <span ng-if=user.login_url><a ng-if=user.login_via_top_window_only ng-click=resetAuth(); ng-href={{user.login_url}} target=_top>click here</a> <a ng-if=!user.login_via_top_window_only ng-click=resetAuth(); ng-href={{user.login_url}}>click here</a> to log back in.</span> <span ng-if=!user.login_url><a ng-click="resetAuth(); reload();">reset your session</a> and start over.</span></p></div><div class=notification ng-repeat="notification in errorSvc.notifications"><a style="float: right" ng-click=dismiss(notification)>[x]</a><p>{{notification.text}}</p></div></span>'),a.put("templates/item/caption.html",'<div class="itemTemplate itemCaption"><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=authorName ng-bind-html=item.display_annotator></div></div><div class=text ng-bind-html=item.display_annotation></div><div class=clear></div></div>'),a.put("templates/item/debug.html","<div class=itemTemplate><pre ng-if=itemDebug>{{item | pretty}}</pre></div>"),a.put("templates/item/file-withimage.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><div class=title><a ng-if="item.noEmbed && !item.targetTop" class=escapelink ng-click=outgoingLink(item.url) ng-bind-html="item.title ||\'(Untitled)\'"></a> <a ng-if="item.noEmbed && item.targetTop" target=_top ng-click=outgoingLink(item.url) ng-bind-html="item.title ||\'(Untitled)\'"></a> <a ng-if=!item.noEmbed ng-click=toggleDetailView() ng-bind-html="item.title ||\'(Untitled)\'"></a></div><img ng-if=item.asset.url ng-click=toggleDetailView() ng-src={{item.asset.url}} style="cursor:pointer;cursor:hand; margin: 0.25em 0"><div ng-bind-html=item.description></div></div><div class=itemDetail ng-if=item.showInlineDetail><a ng-if=!item.noExternalLink ng-click=outgoingLink(item.url) class=escapelink>(new window)</a><div class=iframeContainer><div ng-include="\'templates/loading.html\'"></div><iframe ng-src={{item.url}}></iframe></div></div><div class=clear></div></div>'),a.put("templates/item/file.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><div class=title><a ng-if="item.noEmbed && !item.targetTop" class=escapelink ng-click=outgoingLink(item.url) ng-bind-html="item.title ||\'(Untitled)\'"></a> <a ng-if="item.noEmbed && item.targetTop" target=_top ng-click=outgoingLink(item.url) ng-bind-html="item.title ||\'(Untitled)\'"></a> <a ng-if=!item.noEmbed ng-click=toggleDetailView() ng-bind-html="item.title ||\'(Untitled)\'"></a></div><div ng-bind-html=item.description></div></div><div class=itemDetail ng-if=item.showInlineDetail><a ng-if=!item.noExternalLink ng-click=outgoingLink(item.url) class=escapelink>(new window)</a><div class=iframeContainer><div ng-include="\'templates/loading.html\'"></div><iframe ng-src={{item.url}}></iframe></div></div><div class=clear></div></div>'),a.put("templates/item/image-caption-sliding.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class="captionContainer touchable"><img x-ng-click=forceModal() ng-src={{item.asset.url}}><div class=touchableIndicator></div><div class="caption slidingcaption"><div class=title ng-bind-html=item.display_title></div><div class=text ng-bind-html=item.display_description></div></div></div><div class=clear></div></div>'),a.put("templates/item/image-caption.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class="captionContainer touchable"><img x-ng-click=forceModal() ng-src={{item.asset.url}}><div class=touchableIndicator></div><div class=caption><div class=title ng-bind-html=item.display_title></div><div class=text ng-bind-html=item.display_description></div></div></div><div class=clear></div></div>'),a.put("templates/item/image-fill.html",'<div class="itemTemplate imageFill" style={{item.backgroundImageStyle}} ng-style="{\'backgroundImage\':item.asset.cssUrl}"><img class=fillImg ng-src={{item.asset.url}}></div>'),a.put("templates/item/image-inline-withtext.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><div class=title ng-if=item.display_title ng-bind-html=item.display_title></div><div class=touchable><img x-ng-click=forceModal() ng-src={{item.asset.url}}><div class=touchableIndicator></div></div><div ng-bind-html=item.display_description></div><div class=clear></div></div></div>'),a.put("templates/item/image-inline.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=touchable><img x-ng-click=forceModal() ng-src={{item.asset.url}}><div class=touchableIndicator></div></div><div class=clear></div></div>'),a.put("templates/item/image-linkonly.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><div class=title><a ng-click=outgoingLink(item.asset.url) ng-bind-html="item.display_title || \'(Untitled)\'"></a></div><div class=text ng-bind-html=item.display_description></div></div><div class=clear></div></div>'),a.put("templates/item/image-plain.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate imagePlain"><div class=touchable><img x-ng-click=forceModal() ng-src={{item.asset.url}}><div class=touchableIndicator></div></div></div>'),a.put("templates/item/image-thumbnail.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class="thumbnail touchable" x-ng-class="{fullsize: item.showInlineDetail || item.isActive}" x-ng-click=toggleDetailView()><img ng-src={{item.asset.url}}><div class=touchableIndicator></div></div><div class=text><div class=title ng-bind-html=item.display_title></div><div class=text ng-bind-html=item.display_description></div></div><div class=clear></div></div>'),a.put("templates/item/image.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><div class=title><a ng-click=toggleDetailView() ng-bind-html="item.display_title || \'(Untitled)\'"></a></div><div ng-bind-html=item.display_description></div></div><div class=itemDetail x-ng-if=item.showInlineDetail><div class=touchable style=position:relative><img x-ng-click=forceModal() ng-src={{item.asset.url}}><div class=touchableIndicator></div></div></div><div class=clear></div></div>'),a.put("templates/item/link-descriptionfirst.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><div ng-bind-html=item.display_description></div><div class=title><a ng-if="item.noEmbed && !item.targetTop" class=escapelink ng-click=outgoingLink(item.url) ng-bind-html="item.display_title || \'(Untitled)\'"></a> <a ng-if="item.noEmbed && item.targetTop" target=_top ng-click=outgoingLink(item.url) ng-bind-html="item.display_title || \'(Untitled)\'"></a> <a ng-if=!item.noEmbed ng-click=toggleDetailView() ng-bind-html="item.display_title || \'(Untitled)\'"></a></div></div><div class=itemDetail ng-if=item.showInlineDetail><a ng-if=!item.noExternalLink ng-click=outgoingLink(item.url) class=escapelink>(new window)</a><div class=iframeContainer><div ng-include="\'templates/loading.html\'"></div><iframe ng-src={{item.url}}></iframe></div></div><div class=clear></div></div>'),a.put("templates/item/link-embed.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><div class=title ng-bind-html=item.display_title></div><div ng-bind-html=item.display_description></div></div><div class=iframeContainer><div ng-include="\'templates/loading.html\'"></div><iframe ng-src={{item.url}}></iframe></div><div class=clear></div></div>'),a.put("templates/item/link-withimage.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><span ng-if=item.noEmbed><span ng-if=item.targetTop><div class=title><a target=_top ng-click=outgoingLink(item.url) ng-bind-html="item.display_title || \'(Untitled)\'"></a></div><a target=_top ng-click=outgoingLink(item.url)><img ng-src={{item.asset.url}}></a></span> <span ng-if=!item.targetTop><div class=title><a class=escapelink ng-click=outgoingLink(item.url) ng-bind-html="item.display_title || \'(Untitled)\'"></a></div><a ng-if=item.asset.url ng-click=outgoingLink(item.url)><img ng-src={{item.asset.url}}></a></span></span> <span ng-if=!item.noEmbed><div class=title><a ng-click=toggleDetailView() ng-bind-html="item.display_title || \'(Untitled)\'"></a></div><img ng-click=toggleDetailView() ng-src={{item.asset.url}}></span></div><div ng-bind-html=item.display_description></div></div><div class=itemDetail ng-if=item.showInlineDetail><a ng-if=!item.noExternalLink ng-click=outgoingLink(item.url) class=escapelink>(new window)</a><div class=iframeContainer><div ng-include="\'templates/loading.html\'"></div><iframe ng-src={{item.url}}></iframe></div></div><div class=clear></div>'),a.put("templates/item/link.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><div class=title><a ng-if="item.noEmbed && !item.targetTop" class=escapelink ng-click=outgoingLink(item.url) ng-bind-html="item.display_title || \'(Untitled)\'"></a> <a ng-if="item.noEmbed && item.targetTop" target=_top ng-click=outgoingLink(item.url) ng-bind-html="item.display_title || \'(Untitled)\'"></a> <a ng-if=!item.noEmbed ng-click=toggleDetailView() ng-bind-html="item.display_title || \'(Untitled)\'"></a></div><div ng-bind-html=item.display_description></div></div><div class=itemDetail ng-if=item.showInlineDetail><a ng-if=!item.noExternalLink ng-click=outgoingLink(item.url) class=escapelink>(new window)</a><div class=iframeContainer><div ng-include="\'templates/loading.html\'"></div><iframe ng-src={{item.url}}></iframe></div></div><div class=clear></div></div>'),a.put("templates/item/modal.html","<div class=modal ng-click=dismiss();><div ng-if=\"item._type == 'Link'\" class=modalmenu><a href={{item.url}} target=_blank class=escapelink>(new window)</a></div><div ng-if=\"item._type == 'Link'\" class=iframeContainer><div ng-include=\"'templates/loading.html'\"></div><iframe ng-src={{item.url}}></iframe></div><div class=modalimage ng-if=\"item._type == 'Upload'\"><img ng-src={{item.asset.url}}></div></div>"),a.put("templates/item/pullquote-noattrib.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate headerItem"><div class=pullquote ng-bind-html=item.display_annotation></div></div>'),a.put("templates/item/pullquote.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate headerItem"><div class=pullquote ng-bind-html=item.display_annotation></div><div class=pullquoteSpeaker ng-bind-html=item.display_annotator></div></div>'),a.put("templates/item/question-mc-formative.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate multipleChoiceQuestion"><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=authorName ng-bind-html=item.display_annotator></div></div><div class=question><p ng-bind-html=plugin.questiontext></p><div ng-repeat="distractor in plugin.distractors"><label ng-class="{\n				correct: plugin.hasBeenAnswered && distractor.correct,\n				incorrect: plugin.hasBeenAnswered && !distractor.correct\n			}"><input ng-change=scoreQuiz($index) type=radio name=fnord ng-disabled=plugin.hasBeenAnswered ng-model=$parent.plugin.selectedDistractor value={{$index}}><span ng-bind-html=distractor.text></span></label></div><div ng-if=plugin.hasBeenAnswered><div ng-if=plugin.distractors[plugin.selectedDistractor].correct ng-bind-html=plugin.correctfeedback></div><div ng-if=!plugin.distractors[plugin.selectedDistractor].correct ng-bind-html=plugin.incorrectfeedback></div></div></div></div>'),a.put("templates/item/question-mc-poll.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate pollQuestion"><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=authorName ng-bind-html=item.display_annotator></div></div><div class=question><p ng-bind-html=plugin.questiontext></p><div ng-if=!plugin.hasBeenAnswered ng-repeat="distractor in plugin.distractors"><label><input ng-change=scorePoll() type=radio name=fnord ng-disabled=plugin.hasBeenAnswered ng-model=$parent.plugin.selectedDistractor value={{$index}}><span ng-bind-html=distractor.text></span></label></div><br><div ng-if=plugin.hasBeenAnswered><p>Here\'s how others answered this question: (your choice was <b ng-bind-html=plugin.distractors[plugin.selectedDistractor].text></b>)</p><p>TODO: insert beautiful chart of user responses</p></div></div></div>'),a.put("templates/item/review-all.html","<span><div ng-if=\"item._type == 'Annotation'\" ng-include=\"'templates/item/review-annotation.html'\"></div><div ng-if=\"item._type != 'Annotation'\" ng-include=\"'templates/item/review-transmedia.html'\"></div></span>"),a.put("templates/item/review-annotation.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div><div ng-if=item.isTranscript class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=authorName ng-bind-html=item.display_annotator></div></div><div class=text ng-bind-html=item.display_annotation></div></div><div ng-if=!item.isTranscript ng-include=item.templateUrl></div><div class=clear></div></div>'),a.put("templates/item/review-transmedia.html",'<div ng-if=item.sxs ng-include=item.templateUrl></div><div ng-if=!item.sxs><a class=edit-event ng-click=editItem()><span>Edit item</span></a><div ng-if="item.data._pluginType == \'credlyBadge\'" ng-include="\'templates/item/usc-badges.html\'"></div><div ng-if="item.data._pluginType != \'credlyBadge\'" class=itemTemplate><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=category><span ng-if=item.required>(Required viewing)</span></div></div><div class=text><div class=title><a ng-if=item.noEmbed class=escapelink ng-click=outgoingLink(item.url) ng-bind-html="item.display_title || \'(Untitled)\'"></a> <a ng-if=!item.noEmbed ng-click=toggleDetailView() ng-bind-html="item.display_title || \'(Untitled)\'"></a></div><div ng-bind-html=item.display_description></div></div><div class=itemDetail ng-if="item.showInlineDetail && item._type == \'Link\'"><a ng-if=!item.noExternalLink ng-click=outgoingLink(item.url) class=escapelink>(new window)</a><div class=iframeContainer><div ng-include="\'templates/loading.html\'"></div><iframe ng-src={{item.url}}></iframe></div></div><div class=itemDetail ng-if="item.showInlineDetail && item._type != \'Link\'"><div class=touchable style=position:relative><img ng-click=forceModal() ng-src={{item.asset.url}}><div class=touchableIndicator></div></div></div><div class=clear></div></div></div>'),a.put("templates/item/searchresults.html",'<div ng-class="{isSxS: item.sxs}"><span class=displayTime><a ng-click="seek(item.start_time, item._id)">{{item.displayStartTime}}</a></span> <span class=type ng-bind-html="(item.display_title || item.annotator) | highlightSubstring: searchText"></span><div class=description ng-bind-html="(item.display_description || item.display_annotation) | highlightSubstring: searchText"></div></div>'),a.put("templates/item/sxs-comment.html",'<div class="itemTemplate sxs-item"><a class=edit-event ng-click=editItem() ng-if="item._id != \'internal:editing\'">[Edit]</a> <img class=sxs-profile src=/images/customer/tmp-userprofile.png><div class=itemHead><div class=authorName ng-bind-html=item.display_annotator></div></div><div class=text ng-bind-html=item.annotation.en></div><div class=clear></div></div>'),a.put("templates/item/sxs-file.html",'<div class="itemTemplate sxs-item"><a class=edit-event ng-click=editItem() ng-if="item._id != \'internal:editing\'">[Edit]</a> <img class=sxs-profile src=/images/customer/tmp-userprofile.png><div class=itemHead><div class=authorName ng-bind-html=item.display_annotator></div></div><a ng-click=outgoingLink(item.asset.url) ng-bind-html="item.title.en ||\'(Untitled)\'"></a><div class=text ng-bind-html=item.description.en></div><div class=clear></div></div>'),a.put("templates/item/sxs-image.html",'<div class="itemTemplate sxs-item"><a class=edit-event ng-click=editItem() ng-if="item._id != \'internal:editing\'">[Edit]</a> <img class=sxs-profile src=/images/customer/tmp-userprofile.png><div class=itemHead><div class=authorName ng-bind-html=item.annotator.en></div></div><div><b ng-bind-html=item.title.en></b><p style=text-align:center><img ng-if=item.asset.url ng-src={{item.asset.url}}></p></div><div class=text ng-bind-html=item.description.en></div><div class=clear></div></div>'),a.put("templates/item/sxs-link.html",'<div class="itemTemplate sxs-item"><a class=edit-event ng-click=editItem() ng-if="item._id != \'internal:editing\'">[Edit]</a> <img class=sxs-profile src=/images/customer/tmp-userprofile.png><div class=itemHead><div class=authorName ng-bind-html=item.display_annotator></div></div><a ng-if=item.noEmbed class=escapelink ng-click=outgoingLink(item.url) ng-bind-html="item.title.en ||\'(Untitled)\'"></a> <a ng-if=!item.noEmbed ng-click=toggleDetailView() ng-bind-html="item.title.en ||\'(Untitled)\'"></a><div class=text ng-bind-html=item.description.en></div><div class=itemDetail ng-if=item.showInlineDetail><a ng-if=!item.noExternalLink ng-click=outgoingLink(item.url) class=escapelink>(new window)</a><div class=iframeContainer><div ng-include="\'templates/loading.html\'"></div><iframe ng-src={{item.url}}></iframe></div></div><div class=clear></div></div>'),a.put("templates/item/sxs-question.html",'<div class="itemTemplate sxs-item"><a class=edit-event ng-click=editItem() ng-if="item._id != \'internal:editing\'">[Edit]</a> <img class=sxs-profile src=/images/customer/tmp-userprofile.png><div class=itemHead><div class=authorName ng-bind-html=item.display_annotator></div></div><div class=question><p ng-bind-html=item.data._plugin.questiontext></p><p ng-if=item.asset.url style="text-align:center; margin: 0.5em"><img ng-src={{item.asset.url}}></p><div ng-repeat="distractor in item.data._plugin.distractors"><label ng-if=distractor.text ng-class="{\n				correct: item.data._plugin.hasBeenAnswered && distractor.correct,\n				incorrect: item.data._plugin.hasBeenAnswered && !distractor.correct\n			}"><input ng-change=scoreQuiz($index) type=radio name=fnord ng-disabled=item.data._plugin.hasBeenAnswered ng-model=$parent.item.data._plugin.selectedDistractor value={{$index}}><span ng-bind-html=distractor.text></span></label></div><div ng-if=item.data._plugin.hasBeenAnswered><div ng-if=item.data._plugin.distractors[item.data._plugin.selectedDistractor].correct ng-bind-html=item.data._plugin.correctfeedback></div><div ng-if=!item.data._plugin.distractors[item.data._plugin.selectedDistractor].correct ng-bind-html=item.data._plugin.incorrectfeedback></div></div><div class=clear></div></div></div>'),a.put("templates/item/sxs-video.html",'<div class="itemTemplate sxs-item"><a class=edit-event ng-click=editItem() ng-if="item._id != \'internal:editing\'">[Edit]</a> <img class=sxs-profile src=/images/customer/tmp-userprofile.png><div class=itemHead><div class=authorName ng-bind-html=item.display_annotator></div></div><p>(Video items are not working yet, sorry!)</p><div class=clear></div></div>'),a.put("templates/item/text-h1.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate headerItem"><h1 ng-bind-html=item.display_annotation></h1></div>'),a.put("templates/item/text-h2.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate headerItem"><h2 ng-bind-html=item.display_annotation></h2></div>'),a.put("templates/item/transcript-withthumbnail-alt.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate transcriptWithThumbnail"><div class=icon style="float:right; margin-right: 0.5em"><img ng-src={{item.asset.url}}></div><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div></div><div class=authorName ng-bind-html=item.display_annotator></div><div class=text ng-bind-html=item.display_annotation></div><div class=clear></div></div>'),a.put("templates/item/transcript-withthumbnail.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate transcriptWithThumbnail"><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div></div><div class=icon style="float:left; margin-right: 0.5em"><img ng-src={{item.asset.url}}><div class=clear></div></div><div class=authorName ng-bind-html=item.display_annotator></div><div class=text ng-bind-html=item.display_annotation></div><div class=clear></div></div>'),a.put("templates/item/transcript.html",'<a class=edit-event ng-click=editItem()><span>Edit item</span></a><div class="itemTemplate transcript"><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div><div class=authorName ng-bind-html=item.display_annotator></div></div><div class=text ng-bind-html=item.display_annotation></div><div class=clear></div></div>'),a.put("templates/item/usc-badges.html",'<div class="itemTemplate uscBadges"><div class=itemHead><div class="startTime displayTime" x-ng-click=seek(item.start_time)>{{item.displayStartTime}}</div></div><img style="max-width: 5em; float:left; margin-right: 0.5em" ng-src={{plugin.credlyImageUrl}}> <b>{{plugin.achievement}}</b> <span ng-if=plugin.eligibleForBadges><p>Complete the following requirements to earn a <a ng-href=https://credly.com/recipients/{{plugin.credlyBadgeId}} target=_new>USC Scholar\'s Badge</a>:</p><div style="clear:both; margin: 1em 1.2em; font-size:90%"><div ng-repeat="req in plugin.requirements"><img ng-if=req.achieved style="width: 1em; height: 1em; margin-left: -1.2em" src=/images/checkmark.png> <img ng-if=!req.achieved style="width: 1em; height: 1em; margin-left: -1.2em" src=/images/checkmark-empty.png> <span>{{req.name}}</span></div></div><p ng-if="plugin.totalAchieved != plugin.requirements.length">You have completed {{plugin.totalAchieved}} of {{plugin.requirements.length}} parts of this achievement.</p><div ng-if="plugin.totalAchieved == plugin.requirements.length && !plugin.gotBadge"><p>Congratulations! You are eligible for a USC Scholarâ€™s Badge. Enter your email address to claim it:</p><input ng-model=plugin.userEmail><input type=button value=Go ng-click=badger()><span ng-if=plugin.gettingBadge><small>Getting your badge...</small></span><div ng-if=plugin.error><small>We\'re sorry, there was an error retrieving your badge. Please try again later.</small></div></div><div ng-if=plugin.gotBadge>Your badge is in the mail. <span ng-if=plugin.alreadyHadBadge>(It looks like you\'ve already acquired this badge; you might want to check your spam folder for an email from credly.com.)</span></div></span> <span ng-if=!plugin.eligibleForBadges><p>We\'re sorry, guest users are not eligibile for USC Scholar\'s Badges.</p></span><br><br></div>'),a.put("templates/loading.html",'<div class=loading><div class=spinner><div class="rotating pie"></div><div class="filler pie"></div><div class=mask></div></div>Loading</div>'),a.put("templates/player.html","<div class=player ng-class=\"{\n	isFramed: appState.isFramed,\n	guestUser: appState.user.isGuestUser,\n	isProducer: (appState.product == 'producer'),\n	isSxS: (appState.product == 'sxs'),\n	canEditContent: (!appState.editEvent && !appState.editEpisode) && (appState.product == 'producer' || appState.product == 'sxs')\n"+'	}"><div class=toolbar><div class="modegroup buttongroup"><a class="button button-watch" ng-class="{cur: appState.viewMode == \'watch\'}" ng-click="viewMode(\'watch\')"><span>Watch</span></a> <a class="button button-discover" ng-class="{cur: appState.viewMode == \'discover\'}" ng-click="viewMode(\'discover\')"><span>Discover</span></a> <a class="button button-review" ng-class="{cur: appState.viewMode == \'review\'}" ng-click="viewMode(\'review\')"><span>Review</span></a></div><div ng-if=appState.isFramed class="escapegroup buttongroup"><a class="button button-mainframeescape" ng-click=pause() ng-href="/v1/new_window/{{appState.episodeId}}?t={{appState.time}}" target=_new><span>New window</span></a></div><div class="searchgroup buttongroup" ng-class="{cur: show.searchPanel}"><a class="button button-search" ng-click=toggleSearchPanel()><span>Search</span></a><input id=searchtext ng-model=searchText></div><div class="profilegroup buttongroup" ng-if="appState.product == \'sxs\'"><a class="button button-profile" ng-click="appState.show.profilePanel = true"><span>Profile</span></a></div></div><div ng-if=loading ng-include="\'templates/loading.html\'"></div><div itt-episode="" ng-class="{padForEditing: appState.editEvent || appState.editEpisode}"></div><div class=toolbar-bottom ng-mouseenter=showControls(); ng-click=showControls(); ng-mouseleave=allowControlsExit() ng-show=appState.videoControlsActive><div class=toolbar-bottom-fill><div ng-show=show.navPanel class=navPanel ng-class=episode.styleCss><div class=parent ng-repeat="parent in episode.parents" ng-bind-html=parent.display_name></div><h2 ng-bind-html=episode.display_title></h2><div class=scene x-ng-if=scene.display_title x-ng-repeat="scene in episode.scenes" x-ng-class="{currentScene: scene.isCurrent}" x-ng-click=seek(scene.start_time)><span class=displayTime>{{scene.displayStartTime}}</span><p><a ng-bind-html=scene.display_title></a><br><span ng-bind-html=scene.display_description></span></p></div><div class=crossEpisode><a class=prevEpisode ng-if=episode.previousEpisodeContainer ng-href=/#/{{appState.crossEpisodePath}}/{{episode.previousEpisodeContainer.episodes[0]}} title={{episode.previousEpisodeContainer.display_name}}>Previous episode</a> <a class=nextEpisode ng-if=episode.nextEpisodeContainer ng-href=/#/{{appState.crossEpisodePath}}/{{episode.nextEpisodeContainer.episodes[0]}} title={{episode.nextEpisodeContainer.display_name}}>Next Episode</a></div></div><div ng-show="appState.editEvent || appState.editEpisode" class=navPanel ng-class=episode.styleCss><div ng-if=appState.editEvent itt-item-editor=appState.editEvent></div><div ng-if=appState.editEpisode itt-episode-editor=appState.editEpisode></div></div><div itt-timeline=""></div></div></div><div class=toolbar-bottom-controltrigger ng-mouseenter=showControls(); ng-click=showControls();></div></div><div class="animate transitionFade" ng-if="appState.videoControlsActive && (appState.product == \'sxs\' || appState.product == \'producer\')" sxs-add-content=""></div><div ng-controller=ErrorController ng-include="\'templates/error.html\'"></div><div class=autoscroll ng-if="appState.autoscroll && appState.autoscrollBlocked" ng-click=enableAutoscroll()><img src=/images/autoscroll.svg width=32 height=32></div><div ng-show="show.navPanel || show.searchPanel || show.helpPanel || show.profilePanel" class=modal-backdrop ng-click=hidePanels()></div><div ng-show=appState.itemDetail class=modal-backdrop ng-click="appState.itemDetail=false"></div><div ng-if=appState.itemDetail itt-item-detail-modal=appState.itemDetail></div><div ng-show=show.searchPanel class=searchPanel><div ng-if=show.searchPanel itt-search-panel="">This will be the search panel</div></div><div ng-if=show.helpPanel class=helpPanel><div class=arrow-up></div><p>Welcome to TELLING STORY! You can switch at any time between these views &#8212; don\'t worry, you won\'t lose your place:</p><ul><li class=video><h3>Watch</h3><p>Just the video, no frills.</p></li><li class=directed><h3>Discover</h3><p>The guided, synchronized view of the video and related content.</p></li><li class=explore><h3>Review</h3><p>Read the full transcript and all the related transmedia in one convenient list.</p></li></ul><a class=goAway x-ng-click=noMoreHelp() href="javascript:void 1;">Don\'t show this again</a></div><div ng-if=show.profilePanel class=profilePanel><div class=arrow-up></div><div ng-if="userHasRole(\'admin\')"><img src=/images/customer/tmp-userprofile.png style="float:left; border: 5px solid #FFF"><div class=authoringForm><div class=field><div class=label>Name</div><div class=input><input value="Professor Smith"></div></div><div class=field><div class=label>Email</div><div class=input><input value=example@this-is-todo.com></div></div><br><br><div class=field><div style=text-align:right><a ng-click=logout()>Log out</a></div></div></div><div ng-if="!(userHasRole(\'admin\'))"><a ng-href="/pages/launch_oauth2?episode={{appState.episodeId}}" target=_new>Log in</a></div></div></div>'),a.put("templates/producer/addcontent.html",'<div ng-show="!appState.editEvent && !appState.editEpisode" class=controlPanel ng-class="{\n	isProducer: appState.product == \'producer\',\n	isSxS: appState.product == \'sxs\'\n}"><div ng-if="appState.product == \'producer\'" class=editPanel><a class="button button-episode" ng-click=editEpisode()>Edit episode</a> <a class="button button-scene" ng-if="appState.time > 0  && appState.viewMode == \'discover\'" ng-click=editCurrentScene()>Edit scene</a></div><div class="producer addPanel" ng-show="!item && appState.time > 0"><span ng-if=expanded style="padding: 0 1em" class="animate transitionExpandW"><span ng-if="appState.product == \'sxs\'"><a class="button button-comment" ng-click="addEvent(\'comment\')">Comment</a> <a class="button button-link" ng-click="addEvent(\'link\')">Link</a> <a class="button button-question" ng-click="addEvent(\'question\')">Question</a> <a class="button button-image" ng-click="addEvent(\'image\')">Image</a> <a class="button button-file" ng-click="addEvent(\'file\')">File</a> <a class="button button-video" ng-click="addEvent(\'video\')">Video</a></span> <span ng-if="appState.product == \'producer\'"><a class="button button-scene" ng-click="addEvent(\'scene\')">Add Scene</a> <a class="button button-comment" ng-click="addEvent(\'transcript\')">Transcript</a> <a class="button button-comment" ng-click="addEvent(\'annotation\')">Annotation</a> <a class="button button-link" ng-click="addEvent(\'link\')">Link</a> <a class="button button-image" ng-click="addEvent(\'image\')">Image</a> <a class="button button-file" ng-click="addEvent(\'file\')">Upload</a> </span></span> <span ng-if=!expanded><a class="button button-add" ng-click=expand()>Add</a></span></div></div>'),a.put("templates/producer/annotator-autocomplete.html",'<div style=position:relative><button ng-if="!allowAddNew && annotator.imageUrl" class=annotatorSubButton ng-click=uploadAnnotatorImage()>Replace image</button> <button ng-if=!annotator.imageUrl class=annotatorSubButton ng-click=uploadAnnotatorImage()>Upload image</button> <span class="fakelink annotatorEmptyCue" ng-if="!searchText && !autoCompleting">Choose one...</span><input class="annotatorChooser fakelink" ng-model=searchText ng-focus=showAutocomplete() ng-blur=hideAutocomplete() ng-change=handleAutocomplete()><div class="autocompleteList animate transitionFade" ng-if=autoCompleting><div class=autocompleteItem ng-repeat="annotator in filteredAnnotators | orderBy:\'name\'" ng-click=select(annotator) ng-class="{selected: ($index == preselectedItem)}" style="white-space: nowrap"><img ng-src={{annotator.imageUrl}}> <span ng-bind-html="(annotator.key | highlightSubstring: searchText) || \'(New speaker)\'"></span></div></div></div>'),a.put("templates/producer/container-assets.html",'<div><div ng-if=showParent><div sxs-container-assets=container.parent_id></div></div><div ng-if="container.parent_id && !showParent"><a class=goUp ng-click=up()>Parent container</a></div><h2>{{container.display_name}}</h2><div><small><a ng-click="onlyImages=!onlyImages"><span ng-if=onlyImages>Images only</span> <span ng-if=!onlyImages>All assets</span></a>| <a ng-click="gridView=!gridView"><span ng-if=gridView>Grid view</span> <span ng-if=!gridView>Table view</span></a></small></div><div ng-if=gridView><div class=grid ng-repeat="asset in assets" ng-if="asset.container_id == containerId && !(onlyImages && asset._type != \'Asset::Image\')"><div ng-if="asset._type == \'Asset::Image\'"><img class=thumbnail ng-src={{asset.url}}></div><div ng-if="asset._type != \'Asset::Image\'"><div class=thumbnail>(video)</div></div>{{asset.name}}</div></div><table ng-if=!gridView><tr ng-repeat="asset in assets" ng-if="asset.container_id == containerId && !(onlyImages && asset._type != \'Asset::Image\')"><td><div ng-if="asset._type == \'Asset::Image\'"><img class=thumbnail ng-src={{asset.url}}></div><td>{{asset.size |asBytes}}<td>{{asset.content_type}}<td>{{asset.name}}</table></div>'),a.put("templates/producer/episode.html",'<div class="itemEdit authoringForm"><div class=authoringFormScrollContainer><span class="eventIcon icon-episode"></span><div class=field><div class=input><select size=1 ng-model=appState.lang ng-change=forcePreview() style="float:right; width: 100px" ng-options="language.code as (\'[\'+language.code.toUpperCase()+\']\') for language in episode.languages"></select></div></div><div class=field><div class=label>Title [{{appState.lang}}]</div><div class=input ng-model-options="{ debounce: 500 }" sxs-input-i18n=episode.title x-inputtype="\'input\'" autofocus></div></div><div class=field><div class=label>Description [{{appState.lang}}]</div><div class=input ng-model-options="{ debounce: 50 }" sxs-input-i18n=episode.description x-inputtype="\'textarea\'"></div></div><div class=field><div class=label>Inter-episode navigation</div><div class=input><select ng-model=episode.navigation_depth><option value=0>None<option value=1>1 level (sibling episodes only)<option value=2>2 levels (course and session)</select></div></div><div class=field><div class=label>Languages</div><div class=input><label><input type=checkbox ng-model=langForm.en>English</label><label><input type=checkbox ng-model=langForm.fr>French</label><label><input type=checkbox ng-model=langForm.es>Spanish</label><label><input type=checkbox ng-model=langForm.pt>Portuguese</label><label><input type=checkbox ng-model=langForm.de>German</label><label><input type=checkbox ng-model=langForm.it>Italian</label></div></div><div class=field ng-if="languageCount>1"><div class=label>Default language</div><div class=input><select size=1 ng-model=episode.defaultLanguage><option ng-disabled=!langForm.en value=en>English<option ng-disabled=!langForm.fr value=fr>French<option ng-disabled=!langForm.es value=es>Spanish<option ng-disabled=!langForm.pt value=pt>Portuguese<option ng-disabled=!langForm.de value=pt>German<option ng-disabled=!langForm.it value=it>Italian</select></div></div><div class=field><div class=label>Template</div><div class=input><select ng-model=episode.templateUrl><option value=templates/episode/story.html>(Default)<option value=templates/episode/episode.html>(Unbranded)<option value=templates/episode/columbia.html>Columbia University<option value=templates/episode/columbiabusiness.html>Columbia Business School<option value=templates/episode/eliterate.html>e-Literate TV<option value=templates/episode/ewb.html>Engineers Without Borders<option value=templates/episode/gw.html>George Washington<option value=templates/episode/gwlaw.html>George Washington Law<option value=templates/episode/purdue.html>Purdue<option value=templates/episode/schoolclimatesolutions.html>School Climate Solutions<option value=templates/episode/usc.html>University of Southern California</select></div></div></div><div style="clear:both; width: 100%; text-align:right; padding-right: 24px"><small><a ng-click=cancelEdit()>Cancel</a></small> &nbsp; &nbsp;<input type=button value=Save ng-click=saveEpisode()></div></div>'),a.put("templates/producer/episodelist.html",'<div ng-controller=EpisodeListController style=margin:1em class=admin><div ng-if=loading ng-include="\'templates/loading.html\'"></div><div ng-repeat="customer in containers" class=customer><h2><a ng-click="customer.hidden = !customer.hidden">{{customer.name.en}}</a></h2><div ng-if=!customer.hidden><ul><li ng-repeat="course in customer.children" class=course ng-class="{isOpen: course.visible, isClosed: !course.visible}"><a ng-click="course.visible =!course.visible">{{course.name.en}}</a> <small><a ng-href=#/assets/{{course._id}}>[Assets]</a></small><div ng-if=course.visible style=margin-left:2em><ul><li ng-repeat="session in course.children" class=session ng-class="{isOpen: session.visible, isClosed: !session.visible}"><b><a ng-click="session.visible =!session.visible">{{session.name.en}}</a></b> <small><a ng-href=#/assets/{{session._id}}>[Assets]</a></small><ul ng-if=session.visible><li ng-repeat="episodecontainer in session.children" class=noChildren><a href=#/episode/{{episodecontainer.episodes[0]}}>[Player]</a> <a href=#/sxs/{{episodecontainer.episodes[0]}}>[SxS]</a> <a href=#/producer/{{episodecontainer.episodes[0]}}>[Producer]</a> {{episodecontainer.name.en}} <small><a ng-href=#/assets/{{episodecontainer._id}}>[Assets]</a></small></li></ul></li></ul></div></li></ul></div></div></div><div x-ng-controller=ErrorController x-ng-include="\'templates/error.html\'"></div>'),a.put("templates/producer/inputi18n.html","<input ng-if=\"inputtype=='input'\" ng-model=field[appState.lang]><textarea rows=4 ng-if=\"inputtype=='textarea'\" ng-model=field[appState.lang]></textarea>"),a.put("templates/producer/item.html",'<div class="itemEdit authoringForm"><div class=authoringFormScrollContainer><div class=field><div class=label>Time</div><div class=input><a ng-class="{invisible: appState.time == 0}" class=button-prev ng-click=prevScene()><span class=control-text>Beginning of scene</span></a><input ng-model=item.start_time sxs-input-time="" style=max-width:100px ng-model-options="{ updateOn: \'blur\' }"><span ng-if="appState.product == \'producer\'"><span class=label>End</span><input ng-if=customEndTime ng-change=setItemEndTime() ng-model=item.end_time sxs-input-time="" style=max-width:100px ng-model-options="{ updateOn: \'blur\' }"><a class=fakelink ng-click="customEndTime = !customEndTime; item.end_time=100000"><span ng-if=customEndTime>(x)</span> <span ng-if=!customEndTime>(auto)</span></a><select size=1 ng-model=appState.lang ng-change=forcePreview() style="float:right; width: 100px" ng-options="language.code as (\'[\'+language.code.toUpperCase()+\']\') for language in episode.languages"></select></span></div></div><div class=field ng-if="appState.product == \'producer\' && item.producerItemType != \'scene\'"><div class=label>Flags</div><div class=input><label><input type=checkbox ng-model=item.required>Required</label><label><input type=checkbox ng-model=item.stop>Stop item</label><label><input type=checkbox ng-model=item.cosmetic>Cosmetic</label></div></div><div ng-include=itemEditor></div><div ng-if="appState.product == \'producer\'"><div class=field><div class=label>Template</div><div class=input><span ng-if="item.producerItemType == \'scene\'"><select ng-model=item.templateUrl><option value=templates/scene/centered.html>Centered video<option value=templates/scene/1col.html>One column<option value=templates/scene/2colL.html>Two columns<option value=templates/scene/2colR.html>Two columns (mirrored)<option value=templates/scene/cornerH.html>Corner video, horizontal<option value=templates/scene/cornerV.html>Corner video, vertical<option value=templates/scene/pip.html>Picture-in-picture</select><select ng-model=item.layouts[0] ng-if="item.templateUrl !=\'templates/scene/centered.html\'"><option value="" ng-if="item.templateUrl != \'templates/scene/cornerH.html\' && item.templateUrl != \'templates/scene/cornerV.html\' && item.templateUrl != \'templates/scene/pip.html\'">Centered<option value=videoLeft>Video on left<option value=videoRight>Video on right</select></span><select ng-if="item.producerItemType == \'transcript\'" ng-model=item.templateUrl><option value=templates/item/transcript.html>Transcript<option value=templates/item/transcript-withthumbnail.html>Transcript with thumbnail<option value=templates/item/transcript-withthumbnail-alt.html>Transcript with thumbnail B</select><select ng-if="item.producerItemType == \'annotation\'" ng-model=item.templateUrl><option value=templates/item/pullquote.html>Pullquote with attribution<option value=templates/item/pullquote-noattrib.html>Pullquote<option value=templates/item/text-h1.html>Header 1<option value=templates/item/text-h2.html>Header 2</select><select ng-if="item.producerItemType == \'link\'" ng-model=item.templateUrl><option value=templates/item/link.html>Link<option value=templates/item/link-withimage.html>Link with image<option value=templates/item/link-descriptionfirst.html>Link: description first<option value=templates/item/link-embed.html>Embedded link</select><select ng-if="item.producerItemType == \'image\'" ng-model=item.templateUrl><option value=templates/item/image.html>Linked image<option value=templates/item/image-inline.html>Inline image<option value=templates/item/image-inline-withtext.html>Inline image with text<option value=templates/item/image-caption.html>Image with caption<option value=templates/item/image-caption-sliding.html>Image with sliding caption<option value=templates/item/image-thumbnail.html>Image thumbnail<option value=templates/item/image-plain.html>Plain image</select><span ng-if="item.producerItemType == \'image\'">(also TODO: overlay/underlay images)</span><select ng-if="item.producerItemType == \'file\'" ng-model=item.templateUrl><option value=templates/item/file.html>Linked file (TODO: force noembed?)<option value=templates/item/file-withimage.html>Linked file with image</select><select ng-if="item.producerItemType == \'question\'" ng-model=item.templateUrl><option value=templates/item/question-mc-formative.html>Formative question<option value=templates/item/question-mc-poll.html>Poll question</select></div></div><div class=field ng-if="item._type !== \'Scene\'"><div class=label>Layout</div><div class=input><span ng-if="item._type === \'Scene\'"></span> <span ng-if="item._type !== \'Scene\'"><select size=1 ng-model=item.layouts[0]><option value=inline>Inline<option value=sidebarL>Sidebar: left<option value=sidebarR>Sidebar: right<option value=burstL>Burst left margin<option value=burstR>Burst right margin<option value=burst>Burst both margins</select></span></div></div><div class=field><div class=label>Styles</div><div class=input><label class=fakelink ng-click="useCustomStyles = !useCustomStyles"><span ng-if=useCustomStyles>Custom styles</span> <span ng-if=!useCustomStyles>Default styles</span></label></div></div><div ng-if=useCustomStyles><div class=field><div class=label>Typography</div><div class=input><select size=1 ng-model=itemForm.typography><option value="">(Default)<option value=Sans>Sans<option value=Serif>Serif<option value=Book>Book<option value=Swiss>Swiss</select></div></div><div class=field><div class=label>Color</div><div class=input><select size=1 ng-model=itemForm.color><option value="">(Default)<option value=Invert>Invert<option value=Sepia>Sepia<option value=Solarized>Solarized<option value=Vivid>Vivid</select></div></div><div class=field><div class=label>Timestamp</div><div class=input><select size=1 ng-model=itemForm.timestamp><option value="">(Default)<option value=None>No timestamp<option value=Inline>Inline timestamp</select></div></div><div class=field><div class=label>Highlight</div><div class=input><select size=1 ng-model=itemForm.highlight><option value="">(Default)<option value=Solid>Solid<option value=Border>Border<option value=Side>Side<option value=Bloom>Bloom<option value=Highlighter>Highlighter<option value=Tilt>Tilt</select></div></div><div class=field><div class=label>Transition</div><div class=input><select size=1 ng-model=itemForm.transition><option value="">(Default)<option value=None>No transition<option value=Fade>Fade<option value=SlideL>Slide left<option value=SlideR>Slide right<option value=ExpandW>Expand<option value=Pop>Pop</select></div></div></div></div></div><div style="clear:both; width: 100%; text-align:right;  padding-right: 24px"><small><a ng-click=cancelEdit()>Cancel</a></small> &nbsp; &nbsp;<input type=button value=Delete ng-if="item._id != \'internal:editing\'" ng-click=deleteEvent(item._id)><input type=button value=Save ng-click=saveEvent()></div></div>'),a.put("templates/producer/item/producer-annotation.html",'<span class="eventIcon icon-comment"></span><div class=field><div class=label>Speaker</div><div class=input sxs-annotator-autocomplete=annotators item=item ng-model=item.annotator></div></div><div class=field><div class=label>Speaker [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.annotator x-inputtype="\'input\'"></div></div><div class=field><div class=label>Annotation [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.annotation x-inputtype="\'textarea\'" autofocus></div></div>'),a.put("templates/producer/item/producer-file.html",'<span class="eventIcon icon-file"></span><div class=field><div class=label>Title [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.title x-inputtype="\'input\'" autofocus></div></div><div class=field><div class=label>File</div><div class=input ng-include="\'templates/producer/upload-single.html\'"></div></div><div class=field><div class=label>Description [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.description x-inputtype="\'textarea\'"></div></div>'),a.put("templates/producer/item/producer-image.html",'<span class="eventIcon icon-image"></span><div class=field>TODO separate content images from overlay/background images</div><div class=field><div class=label>Title [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.title x-inputtype="\'input\'" autofocus></div></div><div class=field><div class=label>Image</div><div class=input ng-include="\'templates/producer/upload-single.html\'"></div></div><div class=field><div class=label>Description [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.description x-inputtype="\'textarea\'"></div></div>'),a.put("templates/producer/item/producer-link.html",'<span class="eventIcon icon-link"></span><div class=field><div class=label>Title [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.title x-inputtype="\'input\'" autofocus></div></div><div class=field><div class=label>URL</div><div class=input><input ng-model=item.url></div></div><div class=field><div class=label>Image</div><div class=input ng-include="\'templates/producer/upload-single.html\'"></div></div><div class=field><div class=label>Description [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.description x-inputtype="\'textarea\'"></div></div>'),a.put("templates/producer/item/producer-question.html",'<span class="eventIcon icon-question"></span><div class=field><div class=label>Question type</div><div class=input><select ng-model=item.data._plugin.questiontype><option value=mc-poll>Poll<option value=mc-formative>Formative</select></div></div><div class=field><div class=label>Question text</div><div class=input><textarea ng-model=item.data._plugin.questiontext rows=4 autofocus></textarea></div></div><div class=field><div class=label>Image (optional)</div><div class=input ng-include="\'templates/producer/upload-single.html\'"></div></div><div class=field ng-repeat="distractor in item.data._plugin.distractors"><div class=label>{{$index | alpha}} &nbsp;<input type=checkbox ng-model=distractor.correct ng-if="item.data._plugin.questiontype == \'mc-formative\'"></div><div class=input><textarea ng-model=distractor.text rows=4></textarea></div></div><div class=field ng-if="item.data._plugin.questiontype == \'mc-formative\'"><div class=label>Feedback when correct</div><div class=input><textarea rows=4 ng-model=item.data._plugin.correctfeedback></textarea></div></div><div class=field ng-if="item.data._plugin.questiontype == \'mc-formative\'"><div class=label>Feedback when incorrect</div><div class=input><textarea rows=4 ng-model=item.data._plugin.incorrectfeedback></textarea></div></div>'),a.put("templates/producer/item/producer-scene.html",'<span class="eventIcon icon-scene"></span><div class=field><div class=label>Scene Title [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.title x-inputtype="\'input\'" autofocus></div></div><div class=field><div class=label>Description [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.description x-inputtype="\'textarea\'"></div></div>'),a.put("templates/producer/item/producer-transcript.html",'<span class="eventIcon icon-comment"></span><div class=field><div class=label>Speaker</div><div class=input sxs-annotator-autocomplete=annotators item=item ng-model=item.annotator></div></div><div class=field><div class=label>Speaker [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.annotator x-inputtype="\'input\'"></div></div><div class=field><div class=label>Transcript [{{appState.lang}}]</div><div class=input sxs-input-i18n=item.annotation x-inputtype="\'textarea\'" autofocus></div></div>'),a.put("templates/producer/item/sxs-comment.html",'<span class="eventIcon icon-comment"></span><div class=field><div class=label>Comment</div><div class=input><textarea ng-model=item.annotation.en rows=4 autofocus></textarea></div></div>'),a.put("templates/producer/item/sxs-file.html",'<span class="eventIcon icon-file"></span><div class=field><div class=label>Title</div><div class=input><input ng-model=item.title.en autofocus></div></div><div class=field><div class=label>File</div><div class=input ng-include="\'templates/producer/upload-single.html\'"></div></div><div class=field><div class=label>Description</div><div class=input><textarea ng-model=item.description.en rows=4></textarea></div></div>'),a.put("templates/producer/item/sxs-image.html",'<span class="eventIcon icon-image"></span><div class=field><div class=label>Title</div><div class=input><input ng-model=item.title.en autofocus></div></div><div class=field><div class=label>Image</div><div class=input ng-include="\'templates/producer/upload-single.html\'"></div></div><div class=field><div class=label>Description</div><div class=input><textarea ng-model=item.description.en rows=4></textarea></div></div>'),a.put("templates/producer/item/sxs-link.html",'<span class="eventIcon icon-link"></span><div class=field><div class=label>Title</div><div class=input><input ng-model=item.title.en autofocus></div></div><div class=field><div class=label>URL</div><div class=input><input ng-model=item.url></div></div><div class=field><div class=label>Description</div><div class=input><textarea ng-model=item.description.en rows=4></textarea></div></div>'),a.put("templates/producer/item/sxs-question.html",'<span class="eventIcon icon-question"></span><div class=field><div class=label>Question type</div><div class=input><select ng-model=item.data._plugin.questiontype><option value=mc-poll>Poll<option value=mc-formative>Formative</select></div></div><div class=field><div class=label>Question text</div><div class=input><textarea ng-model=item.data._plugin.questiontext rows=4 autofocus></textarea></div></div><div class=field><div class=label>Image (optional)</div><div class=input ng-include="\'templates/producer/upload-single.html\'"></div></div><div class=field ng-repeat="distractor in item.data._plugin.distractors"><div class=label>{{$index | alpha}} &nbsp;<input type=checkbox ng-model=distractor.correct ng-if="item.data._plugin.questiontype == \'mc-formative\'"></div><div class=input><textarea ng-model=distractor.text rows=4></textarea></div></div><div class=field ng-if="item.data._plugin.questiontype == \'mc-formative\'"><div class=label>Feedback when correct</div><div class=input><textarea rows=4 ng-model=item.data._plugin.correctfeedback></textarea></div></div><div class=field ng-if="item.data._plugin.questiontype == \'mc-formative\'"><div class=label>Feedback when incorrect</div><div class=input><textarea rows=4 ng-model=item.data._plugin.incorrectfeedback></textarea></div></div>'),a.put("templates/producer/item/sxs-video.html",'<span class="eventIcon icon-video"></span><div class=field><small><div style="width:20%; display:inline-block"></div><div style="width:48%; display:inline-block">Link to a video on YouTube...</div><div style="width:32%; display:inline-block">...or make your own</div></small></div><div class=field><div class=label>Video</div><div class=input><div style="width:60%; display:inline-block; padding-right: 5%"><input ng-model=""></div><div style="width:40%; display:inline-block"><input type=button value=Upload style="width: 48%; margin-right: 4%"><input type=button value=Record style="width: 48%"></div></div></div><div class=field><div class=label>Title</div><div class=input><input ng-model=item.title.en autofocus></div></div><div class=field><div class=label>Description</div><div class=input><textarea ng-model=item.description.en rows=4></textarea></div></div>'),a.put("templates/producer/questionauthoring.html",'<div style=margin:1em><p>This is a standalone editor for question items. Fill in the fields below, then copy the JSON data below into the existing authoring tool. To edit an existing question paste its JSON into the json field and the editor will separate it out into editable fields.</p><table class=authoringForm><tr><td class=label>Question type<td><select ng-model=question.questiontype><option value=mc-poll>Poll<option value=mc-formative>Formative</select><tr><td class=label>Question text<td><textarea rows=4 ng-model=question.questiontext>\n				</textarea><tr><td colspan=2>Answer choices. <span ng-if="question.questiontype == \'mc-formative\'">Check the correct answer (if more than one is selected, either will count as correct).</span>To remove an answer choice, just leave it blank.<tr ng-repeat="distractor in question.distractors"><td class=label><input type=checkbox ng-model=distractor.correct ng-if="question.questiontype == \'mc-formative\'"><td><input ng-model=distractor.text><tr><td class=label><a ng-click=addDistractor()>add another</a><td><tr ng-if="question.questiontype == \'mc-formative\'"><td class=label>Feedback for correct answer<td><input ng-model=question.correctfeedback><tr ng-if="question.questiontype == \'mc-formative\'"><td class=label>Feedback for incorrect answer<td><input ng-model=question.incorrectfeedback><tr><td colspan=2><br><hr><br><tr><td class=label>JSON data: <span ng-if=editwarning>Invalid JSON!</span><td><textarea rows=10 ng-model=pluginjson></textarea></table><br><hr><br><p class=label>Question preview:</p><div class=item><div ng-if=preview itt-item=questionpreview></div></div></div>'),a.put("templates/producer/upload-single.html",'<div><span ng-if="appState.product == \'producer\'">TODO allow selecting asset from episode container here instead</span> <span ng-if=uploads><div ng-repeat="upload in uploads"><progress ng-attr-max={{uploadStatus[$index].bytesTotal}} ng-attr-value={{uploadStatus[$index].bytesSent}}></progress></div></span> <span ng-if="!uploads && item.asset"><span ng-if="item.asset._type == \'Asset::Image\'"><img ng-src={{item.asset.url}} style="max-width: 60px; max-height: 60px"></span> {{item.asset.original_filename}} <button ng-if="appState.product == \'sxs\'" ng-click=deleteAsset(item.asset._id)>Delete</button> <button ng-if="appState.product == \'producer\'" ng-click=detachAsset(item.asset._id)>Detach</button></span> <span ng-if="!uploads && !item.asset"><input type=file onchange=angular.element(this).scope().uploadAsset(this.files)></span></div>'),a.put("templates/producer/upload.html",'<div ng-controller=UploadController style=margin:1em><div ng-if=loading class=loading><div class=spinner><div class="rotating pie"></div><div class="filler pie"></div><div class=mask></div></div>Loading</div><h2>Bucket Listing</h2><div ng-repeat="bucket_object in bucket_objects">{{bucket_object.Key}} <button ng-click=deleteObject(bucket_object)>Delete</button><br></div><h2>Uploads in progress</h2><ul><div ng-repeat="upload_in_progress in uploads_in_progress.Uploads"><li>{{upload_in_progress.Key}} <button ng-click=cancelMultipartUpload(upload_in_progress)>Cancel</button><ul><div ng-repeat="part in upload_parts[$index].Parts"><li>{{part}}</li></div></ul></li></div></ul><input type=file id=file name=file multiple><button ng-click=uploadFiles()>Upload</button><div ng-repeat="upload in uploads"><div><progress ng-attr-max={{upload_status[$index].bytesTotal}} ng-attr-value={{upload_status[$index].bytesSent}}></div><button ng-click=pauseUpload()>Pause</button> <button ng-click=resumeUpload()>Resume</button> <button ng-click=cancelUpload()>Cancel</button> <button ng-click=networkError()>Network Error</button></div></div><div x-ng-controller=ErrorController x-ng-include="\'templates/error.html\'"></div>'),a.put("templates/root.html",'<div style="background-color: #333; position:fixed; top:0;left:0;right:0;bottom:0; padding: 4em"><div style="width:100%; height:100%;background: url(\'images/itt.svg\') 50% 50% no-repeat; background-size:contain"></div></div>'),a.put("templates/scene/1col.html",'<div class="scene onecol" ng-class="scene.styleCss + \' \'+ scene.state"><div itt-magnet="" class=videoMagnet ng-class="{hasLeftSidebar: mainContentHasLeftSidebar, hasRightSidebar: mainContentHasRightSidebar}"><img src=images/aspectratiopreserver-16x9.gif></div><div class=col><div class="pane mainPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in mainBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{\n				singleitem: showCurrent\n					? (mainContentItems | isCurrent).length == 1\n					: (mainContentItems).length == 1, \n				allowHighlights: !showCurrent,\n				hasLeftSidebar: mainContentHasLeftSidebar, \n				hasRightSidebar: mainContentHasRightSidebar,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><div class="item animate" ng-repeat="item in showCurrent ? (contentItems | isCurrent) : contentItems" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div></div></div>'),a.put("templates/scene/2colL.html",'<div class="scene twocol" ng-class="scene.styleCss + \' \'+ scene.state"><div class=videoPositioner><div itt-magnet="" class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div></div><div class="col col1"><div class="pane mainPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in (mainBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{\n				singleitem: showCurrent\n					? (mainContentItems | isCurrent).length == 1\n					: (mainContentItems).length == 1, \n				allowHighlights: !showCurrent,\n				hasLeftSidebar: mainContentHasLeftSidebar, \n				hasRightSidebar: mainContentHasRightSidebar,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><img src=images/aspectratiopreserver-16x9.gif class=matchVideoHeight><div class=clear></div><div class="item animate" ng-repeat="item in showCurrent ? (mainContentItems | isCurrent) : mainContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div><div class="col col2"><div class="pane altPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in (altBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{\n				singleitem: showCurrent\n					? (altContentItems | isCurrent).length == 1\n					: (altContentItems).length == 1, \n				allowHighlights: !showCurrent,\n				hasLeftSidebar: altContentHasLeftSidebar, \n				hasRightSidebar: altContentHasRightSidebar,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><img src=images/aspectratiopreserver-16x9.gif class=matchVideoHeight><div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in (altFgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div></div></div>'),a.put("templates/scene/2colR.html",'<div class="scene twocol" ng-class="scene.styleCss + \' \'+ scene.state"><div class=videoPositioner><div itt-magnet="" class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div></div><div class="col col1"><div class="pane altPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in (altBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{\n				singleitem: showCurrent\n					? (altContentItems | isCurrent).length == 1\n					: (altContentItems).length == 1, \n				allowHighlights: !showCurrent,\n				hasLeftSidebar: altContentHasLeftSidebar, \n				hasRightSidebar: altContentHasRightSidebar,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><img src=images/aspectratiopreserver-16x9.gif class=matchVideoHeight><div class=clear></div><div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in (altFgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div></div><div class="col col2"><div class="pane mainPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in (mainBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{\n				singleitem: showCurrent\n					? (mainContentItems | isCurrent).length == 1\n					: (mainContentItems).length == 1, \n				allowHighlights: !showCurrent,\n				hasLeftSidebar: mainContentHasLeftSidebar, \n				hasRightSidebar: mainContentHasRightSidebar,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><img src=images/aspectratiopreserver-16x9.gif class=matchVideoHeight><div class="item animate" ng-repeat="item in showCurrent ? (mainContentItems | isCurrent) : mainContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div></div></div>'),a.put("templates/scene/centered.html",'<div class="scene centered" ng-class="scene.styleCss + \' \'+ scene.state"><div class=col><div itt-magnet="" class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div><div class="pane mainPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in mainBgItems| isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{\n				singleitem: (contentItems | isCurrent).length == 1,\n				allowHighlights: !showCurrent,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><div class="item animate" ng-repeat="item in (contentItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div></div></div>'),a.put("templates/scene/cornerH.html",'<div class="scene cornerH" ng-class="scene.styleCss + \' \'+ scene.state"><div class=row><div itt-magnet="" class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div><div class="pane mainPane matchVideoHeight"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in mainBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{singleitem: mainItems.length==1, isNarrow: isNarrow}" itt-width-watch=""><div class="item animate" ng-repeat="item in mainItems = (mainContentItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div></div><div class=row><div class="pane altPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in altBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{\n				singleitem: showCurrent\n					? (altContentItems | isCurrent).length == 1\n					: (altContentItems).length == 1, \n				allowHighlights: !showCurrent,\n				hasLeftSidebar: altContentHasLeftSidebar, \n				hasRightSidebar: altContentHasRightSidebar,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in altFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div></div></div>'),a.put("templates/scene/cornerV.html",'<div class="scene cornerV" ng-class="scene.styleCss + \' \'+ scene.state"><div class=col><div itt-magnet="" class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div><div class="pane mainPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in mainBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{singleitem: mainItems.length==1, isNarrow: isNarrow}" itt-width-watch=""><div class="item animate" ng-repeat="item in mainItems = (mainContentItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div></div><div class=col><div class="pane altPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in altBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{\n				singleitem: showCurrent\n					? (altContentItems | isCurrent).length == 1\n					: (altContentItems).length == 1, \n				allowHighlights: !showCurrent,\n				hasLeftSidebar: altContentHasLeftSidebar, \n				hasRightSidebar: altContentHasRightSidebar,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in altFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div></div></div>'),a.put("templates/scene/debug.html","<pre>{{scene | pretty}}</pre>"),a.put("templates/scene/endingscreen.html",'<div class="endingscreen stretchToViewport"><div class="pane introtext"><p>Thanks for watching <span ng-bind-html=episode.display_title></span>.</p><p ng-if=episode.nextEpisodeContainer>The next episode is <a class=nextEpisode ng-href=/#/{{crossEpisodePath}}/{{episode.nextEpisodeContainer.episodes[0]}} ng-bind-html=episode.nextEpisodeContainer.display_name></a>.</p><br><div itt-magnet="" class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div><br><div ng-if="episode.navigation_depth > 0">Other episodes:<ul class=crossEpisodeNav itt-container-episodes=episode.parents[0]></ul></div></div></div>'),a.put("templates/scene/landingscreen.html",'<div class="landingscreen stretchToViewportShort"><div class="pane introtext"><h1 ng-bind-html=episode.display_title></h1><p ng-bind-html=episode.display_description></p><br><div ng-if="episode.navigation_depth >0">Other episodes:<ul class=crossEpisodeNav itt-container-episodes=episode.parents[0]></ul></div></div><div itt-magnet="" class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div><div class=clear></div></div>'),a.put("templates/scene/pip.html",'<div class="scene pip" ng-class="scene.styleCss + \' \'+ scene.state"><div class="pane altPane stretchToViewport"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in (altBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer" ng-class="{\n				singleitem: showCurrent\n					? (altContentItems | isCurrent).length == 1\n					: (altContentItems).length == 1, \n				allowHighlights: !showCurrent,\n				hasLeftSidebar: altContentHasLeftSidebar, \n				hasRightSidebar: altContentHasRightSidebar,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div><div class=clear></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in (altFgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div><div ng-class="{padForBottomToolbar: appState.videoControlsActive}"><div class=videoPositioner><div itt-magnet="" class=videoMagnet><img src=images/aspectratiopreserver-16x9.gif></div></div><div class="pane mainPane"><div class="fill bgLayer"><div class="item animate" ng-repeat="item in (mainBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class="content contentLayer showCurrent" ng-class="{\n				hasLeftSidebar: mainContentHasLeftSidebar, \n				hasRightSidebar: mainContentHasRightSidebar,\n				isNarrow: isNarrow\n			}" itt-width-watch=""><div class="item animate" ng-repeat="item in mainContentItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div><div class=clear></div></div></div><div class="fill fgLayer overlay"><div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item=item></div></div></div>'),a.put("templates/searchpanel.html","<div ng-class=episode.styleCss><div class=searchfilters><label ng-show=\"sortBy!=='startTime'\"><input type=radio name=searchsort id=searchsort ng-model=sortBy value=startTime>Sorted by <span class=fakelink>type</span></label><label ng-show=\"sortBy==='startTime'\"><input type=radio name=searchsort id=searchsort ng-model=sortBy value=type>Sorted by <span class=fakelink>time</span></label></div><div class=scrollContainer><div class=searchResults><div ng-if=\"sortBy == 'startTime'\"><div ng-repeat=\"scene in episode.scenes\"><h3 ng-if=\"sceneItems.length > 0 && scene.display_title\" ng-bind-html=scene.display_title></h3><div class=item ng-repeat=\"item in sceneItems=\n						(scene.items \n						| orderBy:'startTime' \n						| filter:{'searchableText': searchText, 'cosmetic': false}\n						)\" ng-include=\"'templates/item/searchresults.html'\"></div></div></div><div ng-if=\"sortBy == 'type'\"><div ng-repeat=\"(typeID,showType) in searchTypes\" ng-if=showType><h3 ng-if=\"typeItems.length > 0\">{{searchTypeNames[typeID]}}</h3><div class=item ng-repeat=\"item in typeItems=\n						(episode.items \n						| orderBy:'startTime' \n						| filter:{'type': typeID, 'searchableText': searchText, 'cosmetic': false}\n						)\" ng-include=\"'templates/item/searchresults.html'\"></div></div></div><div ng-if=\"(episode.items | filter:{'searchableText': searchText, 'cosmetic': false}).length == 0\">(Nothing matched your search.)</div></div></div></div>"),a.put("templates/timeline.html",'<div class=timeline><div class=progressbarBox><div class=pbarTop><span ng-if="appState.product == \'producer\'"><a class="button button-zoomout" ng-if="zoomLevel != 1" ng-click=zoomOut()><span class=control-text>Zoom out</span></a> <small ng-if="zoomLevel != 1">Zoom: {{zoomLevel*100}}%</small> <a class="button button-zoomin" ng-click=zoomIn()><span class=control-text>Zoom in</span></a></span></div><div class=pbarMain><div class=progressbar><div class=mask style=overflow:hidden><div class=progressbarContainer style="width: {{zoomLevel}}00%"><div class=buffered ng-style="{width: appState.bufferedPercent+\'%\'}"></div><div class=played ng-style="{width: markerPercent(appState.time)+\'%\'}"></div></div></div><div class=progressbarContainer style="width: {{zoomLevel}}00%"><div class=handle ng-show="isSeeking && !appState.editEvent" ng-style="{left: markerPercent(willSeekTo)+\'%\'}"><div class=tip ng-show=seekHandleVisible>{{willSeekTo | asTime}}</div></div><div class="handle sxsHandle playhead" ng-show=appState.editEvent ng-style="{left: markerPercent(willSeekTo)+\'%\'}"><div class=tip>{{willSeekTo | asTime}}</div></div><div class=tooltip ng-if=event.showTooltip ng-repeat="event in timeline.markedEvents" ng-style="{left: markerPercent(event.start_time)+\'%\'}"><span class=content ng-bind-html="event.display_title || \'(&quot;Hidden&quot; scene)\'"></span></div><div ng-if=appState.editEvent class=editingItem ng-style="{left: markerPercent(appState.editEvent.start_time)+\'%\', right: markerPercent(appState.duration - appState.editEvent.end_time)+\'%\'}"></div></div><div class="playhead mask"><div class=progressbarContainer ng-style="{width: zoomLevel+\'00%\'}"><div class=marker ng-mouseover=showTooltip(event); ng-mouseout=hideTooltip(event) ng-repeat="event in timeline.markedEvents" ng-style="{left: markerPercent(event.start_time)+\'%\'}" ng-if="event.display_title || appState.product == \'producer\'" ng-class="{mini: (!event.display_title)}"></div></div></div></div><a ng-class="{invisible: appState.time == 0}" class="button button-prev" ng-click=prevScene()><span class=control-text>Previous</span></a><div class="tooltip sceneMenuTooltip" ng-if=sceneMenuToolTip><span class=content>Scene-by-scene navigation</span></div><a class=button-scenemenu ng-click=showSceneMenuTooltip(false);toggleNavPanel(); ng-mouseover=showSceneMenuTooltip(true) ng-mouseout=showSceneMenuTooltip(false)><span class=control-text>Scenes</span></a> <a ng-class="{invisible: appState.time >= appState.duration-0.1}" class="button button-next" ng-click=nextScene()><span class=control-text>Next</span></a></div><div class=pbarBottom><span class=timedisplay>{{appState.time | asTime}} / {{appState.duration | asTime}} <span class=speedcontrol ng-if="appState.videoType == \'video\' && !(appState.isTouchDevice)"><a class=button-speedcontrol ng-click=changeSpeed(-0.25)><div ng-class="{arrowLeft: appState.timeMultiplier > 0.5}"></div></a> <span class=speeddisplay ng-click=resetSpeed()>{{appState.timeMultiplier}}x</span> <a class=button-speedcontrol ng-click=changeSpeed(0.25)><div ng-class="{arrowRight: appState.timeMultiplier < 2}"></div></a></span></span> <span style=display:inline-block;height:1em;position:relative ng-if="episode.languages.length > 1"><select size=1 ng-model=appState.lang class=languageSelector ng-change=setNewLanguage() ng-options="language.code as (\'[\'+language.code.toUpperCase()+\']\') for language in episode.languages"></select></span> <a ng-if="appState.viewMode == \'watch\'" class="button button-captions" ng-click="appState.hideCaptions=!appState.hideCaptions" ng-class="{active: !appState.hideCaptions}"><span class=control-text>Captions</span></a>  <span ng-if=!appState.isTouchDevice><a class="button button-mute {{audioIcon()}}" ng-click=toggleMute()><span class=control-text>Mute</span></a><div class=volumebar ng-mousedown=userChangingVolume($event)><div class=volume ng-style="{width: currentVolume()+\'%\'}"></div></div></span></div></div><a class="button button-play" ng-if="appState.timelineState == \'paused\'" ng-click=play()><span class=control-text>Play</span></a> <a class="button button-pause" ng-if="appState.timelineState != \'paused\'" ng-click=pause()><span class=control-text>Pause</span></a></div>'),a.put("templates/video.html","<div class=video><iframe id=ytplayer{{uid}} ng-if=video.urls.youtube ng-src=\"{{video.urls.youtube + '?enablejsapi=1&controls=0&modestbranding=1&showinfo=0&wmode=opaque&rel=0'}}\"></iframe><video ng-if=!video.urls.youtube><source class=mpeg4 ng-if=video.urls.mpeg4 ng-src={{video.urls.mpeg4}} type=video/mp4><source class=webm ng-if=video.urls.webm ng-src={{video.urls.webm}} type=video/webm><p>Oh no! Your browser does not support the HTML5 Video element.</p></video><div ng-click=videoClick() class=videoMask ng-class=\"{\n		play: appState.timelineState == 'paused',\n		buffering: appState.timelineState == 'buffering',\n		firstplay: !appState.hasBeenPlayed,\n		rewind: (appState.time > 0 && appState.time >= video.duration - 0.3)\n	}\"></div></div>")
}]),angular.module("com.inthetelling.story").factory("config",function(){var a=window.config;return a.apiDataBaseUrl||(a.apiDataBaseUrl="//"+window.location.host),a}),angular.module("com.inthetelling.story").factory("appState",["$interval","config",function(a,b){var c={};return c.init=function(){c.user=c.user||{},c.episodeId=!1,c.isFramed=window.parent!=window,c.isTouchDevice=navigator.platform.match(/iPad|iPod|iPhone/)||navigator.userAgent.match(/Android/),c.windowWidth=0,c.windowHeight=0,c.viewMode=$(window).width()>480?"discover":"review",c.time=0,c.bufferedPercent=0,c.timeMultiplier=1,c.duration=0,c.timelineState="paused",c.hasBeenPlayed=!1,c.volume=100,c.muted=!1,c.hideCaptions=!1,c.show={searchPanel:!1,helpPanel:!1,navPanel:!1},c.videoControlsActive=!1,c.videoControlsLocked=!1,c.itemDetail=!1,c.autoscroll=!1,c.autoscrollBlocked=!1,c.product=c.product,c.crossEpisodePath="sxs"===c.product||"producer"===c.product?c.product:"episode",c.editEvent=!1,c.editEpisode=!1,c.lang=!1},c.init(),a(function(){c.windowHeight=angular.element(window).height(),c.windowWidth=angular.element(window).width()},50,0,!1),c.isTouchDevice&&(document.getElementById("CONTAINER").className="touchDevice"),b.debugInBrowser,c}]),angular.module("com.inthetelling.story").factory("authSvc",["config","$routeParams","$http","$q","$location","appState",function(a,b,c,d,e,f){var g={};g.userHasRole=function(a){if(f.user&&f.user.roles)for(var b=0;b<f.user.roles.length;b++)if(f.user.roles[b]===a)return!0;return!1},g.logout=function(){f.user={},delete c.defaults.headers.common.Authorization};var h,i=d.defer();return g.authenticate=function(){if(h)return i.promise;if(h=!0,b.key){var a=b.key;e.search("key",null),g.getAccessToken(a).then(function(){i.resolve()})}else if(c.defaults.headers.common.Authorization)f.user==={}&&(f.user=g.getStoredUserData()),i.resolve();else{var d=g.getStoredUserData();d?(f.user=d,c.defaults.headers.common.Authorization='Token token="'+d.access_token+'"',i.resolve()):g.getNonce().then(function(a){g.getAccessToken(a).then(function(){i.resolve()})})}return i.promise},g.getStoredUserData=function(){var b;if(localStorage&&localStorage.getItem(a.localStorageKey)){var c=angular.fromJson(localStorage.getItem(a.localStorageKey)),d=a.apiDataBaseUrl.match(/\/\/([^\.]*)./)[1];c.customer===d?(b=c,c.roles&&1===c.roles.length&&"guest"===c.roles[0]&&(b.isGuestUser=!0)):(localStorage.removeItem(a.localStorageKey),b=!1)}return b},g.getNonce=function(){var b=d.defer();return c.get(a.apiDataBaseUrl+"/v1/get_nonce").success(function(a){a.nonce?b.resolve(a.nonce):a.login_url?a.login_via_top_window_only?window.top.location.href=a.login_url:window.location.href=a.login_url:b.reject()}).error(function(){b.reject()}),b.promise},g.getAccessToken=function(b){var e=d.defer();return c.get(a.apiDataBaseUrl+"/v1/get_access_token/"+b).success(function(b){b.customer=a.apiDataBaseUrl.match(/\/\/([^\.]*)./)[1],f.user=b;try{localStorage.setItem(a.localStorageKey,JSON.stringify(b))}catch(d){}c.defaults.headers.common.Authorization='Token token="'+b.access_token+'"',e.resolve(b)}).error(function(){e.reject()}),e.promise},g}]),angular.module("com.inthetelling.story").factory("awsSvc",["config","$routeParams","$http","$q","appState","modelSvc",function(a,b,c,d,e,f){var g,h,i,j,k=1e3,l=3,m="public-read",n="pending",o="uploading",p="complete",q={},r={s3:{}},s=5242880,t=0,u=0,v=0,w=[],x=0,y=[],z=0,A=0,B=[],C=!1;q.awsCache=function(){return r},q.getBucketListing=function(){var a=d.defer();return D().then(function(){r.s3.listObjects(function(b,c){b?a.reject():a.resolve(c)})}),a.promise},q.uploadFiles=function(a){for(var b=[],c=0;c<a.length;c++){y.push(a.item(c));var e=d.defer();B.push(e),b.push(e.promise)}return E(),b},q.pauseUpload=function(){if(g&&!C){if(C=!0,Q(),H())A=0;else{var a=0;for(A=0;u>a;){var b=w[a];b.status===p&&(A+=b.uploaded),a++}}i.notify({bytesSent:A,bytesTotal:g.size})}},q.resumeUpload=function(){if(g&&C)if(C=!1,H())J();else for(var a=0;l>a;a++)N()},q.cancelUpload=function(){g&&(C=!1,A=0,Q(),H()||(q.cancelMultipartUpload(h),h=null),g=null,i.notify({bytesSent:0,bytesTotal:0}),i.reject("Canceled by user"))},q.networkError=function(){g&&Q()},q.deleteObject=function(a){var b=d.defer();return D().then(function(){var c={Bucket:a.bucket,Key:a.Key};r.s3.deleteObject(c,function(a,c){a?b.reject():b.resolve(c)})}),b.promise},q.getMultipartUploads=function(){var a=d.defer();return D().then(function(){r.s3.listMultipartUploads(function(b,c){b?a.reject():a.resolve(c)})}),a.promise},q.getMultipartUploadParts=function(a,b){var c=d.defer();return D().then(function(){var d={Bucket:b.bucket,Key:b.Key,UploadId:b.UploadId};r.s3.listParts(d,function(b,d){b?c.reject():c.resolve({i:a,parts:d})})}),c.promise},q.cancelMultipartUpload=function(a){var b=d.defer();return D().then(function(){var c={Bucket:a.bucket,Key:a.Key,UploadId:a.UploadId};r.s3.abortMultipartUpload(c,function(a,c){a?b.reject():b.resolve(c)})}),b.promise};var D=function(){return r.hasOwnProperty("sessionDeferred")?r.sessionDeferred.promise:(r.sessionDeferred=d.defer(),c.get(a.apiDataBaseUrl+"/v1/aws/s3/upload_session").success(function(b){if(b.access_key_id){AWS.config.update({accessKeyId:b.access_key_id,secretAccessKey:b.secret_access_key,sessionToken:b.session_token,region:a.awsRegion});var c={params:{Bucket:b.bucket,Prefix:b.key_base}};r.s3=new AWS.S3(c),r.sessionDeferred.resolve(b)}else r.sessionDeferred.reject()}).error(function(){r.sessionDeferred.reject()}),r.sessionDeferred.promise)},E=function(){if(y.length>z&&!g){if(g=y[z],""===g.type)return B[z].resolve("Could not determine file type for file '"+g.name+"'"),g=null,z++,void E();F().then(function(){var a;a=H()?I():K(),a.then(R,function(a){B[z].reject(a)},function(a){B[z].notify(a)})})}},F=function(a){return a=a||d.defer(),g.uniqueName=G(),D().then(function(){var b={Key:r.s3.config.params.Prefix+g.uniqueName};r.s3.headObject(b,function(b){b?404!==b.statusCode?a.reject(b):(H()||q.getMultipartUploads().then(function(a){for(var b=!0;b;)for(var c=r.s3.config.params.Prefix+g.uniqueName,d=0;d<a.Uploads.length;d++){if(a.Uploads[d].Key===c){g.uniqueName=G();break}d===a.Uploads.length-1&&(b=!1)}}),a.resolve()):(g.uniqueName=G(),F(a))})}),a.promise},G=function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===b?c:7&c|8).toString(16)});return b},H=function(){return g.size<=s?!0:!1},I=function(){return i=d.defer(),J().then(function(){},function(){},function(){}),i.promise},J=function(){var a=d.defer();return D().then(function(){var a={Key:r.s3.config.params.Prefix+g.uniqueName,ContentType:g.type,Body:g,ACL:m};j=r.s3.putObject(a,function(a,b){a?i.reject():i.resolve(b)}),j.on("httpUploadProgress",function(a){i.notify({bytesSent:a.loaded,bytesTotal:a.total})}).on("error",function(a){i.reject(a)})},function(){},function(){}),a.promise},K=function(){return i=d.defer(),L().then(M).then(function(){for(var a=0;l>a;a++)N()}),i.promise},L=function(){var a=d.defer();return D().then(function(){var b={Key:r.s3.config.params.Prefix+g.uniqueName};r.s3.createMultipartUpload(b,function(b,c){b?a.reject():a.resolve(c)})}),a.promise},M=function(a){var b=d.defer();h=a,w=[],u=0,v=0,x=0,t=s,A=0,g.size>t*k&&(t=Math.ceil(g.size/k)),u=Math.ceil(g.size/t);for(var c=0;u>c;c++){var e={};e.start=c*t,e.end=e.start+t,e.uploaded=0,e.end>g.size&&(e.end=g.size),e.status=n,w.push(e)}return b.resolve(),b.promise},N=function(){var a=d.defer(),b=x,c=!1;if(C)a.reject("Upload paused");else{for(;!c&&u>b;){var e=w[b];if(e.status===n){c=!0,e.status=o;var f=g.slice(e.start,e.end);e.cancel=function(){e.request.abort(),e.status=n,e.uploaded=0},d.all({partNumber:d.when(b+1),eTag:O(b+1,f)}).then(P).then(function(b){a.resolve(b)},function(b){a.reject(b)},function(b){a.update(b)})}else e.status===p&&b===x&&x++;b++}c||a.reject("All chunks uploaded")}return a.promise},O=function(a,b){var c=d.defer();return D().then(function(){var d={Bucket:h.Bucket,Key:h.Key,UploadId:h.UploadId,PartNumber:a,Body:b};w[a-1].request=r.s3.uploadPart(d,function(a,b){a?c.reject():c.resolve(b.ETag)}),w[a-1].request.on("httpUploadProgress",function(b){A+=b.loaded-w[a-1].uploaded,w[a-1].uploaded=b.loaded,i.notify({bytesSent:A,bytesTotal:g.size})}).on("error",function(a){i.reject(a)})}),c.promise},P=function(a){var b=d.defer();if(w[a.partNumber-1].status=p,w[a.partNumber-1].part={ETag:a.eTag,PartNumber:a.partNumber},v++,v===u){for(var c=[],e=0;u>e;e++)c.push(w[e].part);var f={Bucket:h.Bucket,Key:h.Key,UploadId:h.UploadId,MultipartUpload:{Parts:c}};r.s3.completeMultipartUpload(f,function(a,c){a?(i.reject(a),b.reject(a)):(f={Bucket:h.Bucket,Key:h.Key,ACL:m},r.s3.putObjectAcl(f,function(a){a&&(i.reject(a),b.reject(a))}),i.resolve(c),b.resolve(c))})}else N();return b.promise},Q=function(){if(H())j.abort();else for(var a=x,b=!1;!b&&u>a;){var c=w[a];c.status===o?c.cancel():c.status===n&&(b=!0),a++}},R=function(){var b=d.defer(),h={url:"https://s3.amazonaws.com/"+r.s3.config.params.Bucket+"/"+r.s3.config.params.Prefix+g.uniqueName,type:g.type,size:g.size,original_filename:g.name},i=f.episodes[e.episodeId].container_id;return c.post(a.apiDataBaseUrl+"/v1/containers/"+i+"/assets",h).success(function(a){B[z].resolve(a),g=null,z++,E()}).error(function(){B[z].reject()}),b.promise};return q}]),angular.module("com.inthetelling.story").factory("dataSvc",["$q","$http","$routeParams","$timeout","config","authSvc","modelSvc","errorSvc","mockSvc",function(a,b,c,d,e,f,g,h,i){var j={};j.getEpisode=function(a){if(!a)throw"no episode ID supplied to dataSvc.getEpisode";g.episodes[a]||(g.cache("episode",{_id:a}),c.local?i.mockEpisode(a):f.authenticate().then(function(){return n()}).then(function(){return o(a)}))};var k={template:{},layout:{},style:{}},l=!1,m=a.defer(),n=function(){return l?m.promise:(l=!0,a.all([b.get(e.apiDataBaseUrl+"/v1/templates"),b.get(e.apiDataBaseUrl+"/v1/layouts"),b.get(e.apiDataBaseUrl+"/v1/styles")]).then(function(a){j.cache("templates",a[0].data),j.cache("layouts",a[1].data),j.cache("styles",a[2].data),l=!0,m.resolve()},function(){l=!1,m.reject()}),m.promise)};j.cache=function(a,b){angular.forEach(b,function(b){"templates"===a?k.template[b._id]={id:b._id,url:b.url,type:b.applies_to_episodes?"Episode":b.event_types?b.event_types[0]:void 0,displayName:b.name}:"layouts"===a?k.layout[b._id]={id:b._id,css_name:b.css_name,displayName:b.display_name}:"styles"===a&&(k.style[b._id]={id:b._id,css_name:b.css_name,displayName:b.display_name})})},j.resolveIDs=function(a){if(a.template_id&&(k.template[a.template_id]?(a.templateUrl=k.template[a.template_id].url,delete a.template_id):h.error({data:"Couldn't get templateUrl for id "+a.template_id})),a.layout_id){var b=[];angular.forEach(a.layout_id,function(a){k.layout[a]?b.push(k.layout[a].css_name):h.error({data:"Couldn't get layout for id "+a})}),b.length>0&&(a.layouts=b)}if(a.style_id){var c=[];angular.forEach(a.style_id,function(a){k.style[a]?c.push(k.style[a].css_name):h.error({data:"Couldn't get style for id "+a})}),c.length>0&&(a.styles=c)}return a};var o=function(a){b.get(e.apiDataBaseUrl+"/v3/episodes/"+a).success(function(b){"Published"===b.status||f.userHasRole("admin")?(g.cache("episode",j.resolveIDs(b)),p(a),j.getContainer(b.container_id,a)):h.error({data:"This episode has not yet been published."})}).error(function(){h.error({data:"API call to /v3/episodes/"+a+" failed (bad episode ID?)"})})},p=function(a){b.get(e.apiDataBaseUrl+"/v3/episodes/"+a+"/events").success(function(b){angular.forEach(b,function(a){g.cache("event",j.resolveIDs(a))}),g.resolveEpisodeEvents(a)})};j.getContainer=function(a,c){g.containers[a]||g.cache("container",{_id:a}),b.get(e.apiDataBaseUrl+"/v3/containers/"+a).success(function(a){g.cache("container",a[0]),a[0].parent_id?j.getContainer(a[0].parent_id,c):c&&g.resolveEpisodeContainers(c)}),j.getContainerAssets(a,c)},j.getContainerAssets=function(a,c){b.get(e.apiDataBaseUrl+"/v1/containers/"+a+"/assets").success(function(b){g.containers[a].assetsHaveLoaded=!0,angular.forEach(b.files,function(a){g.cache("asset",a)}),c&&g.resolveEpisodeAssets(c)})};var q={},r=function(c,d){var g=a.defer();return q[c]&&g.resolve(q[c]),f.authenticate().then(function(){return b.get(e.apiDataBaseUrl+c)}).then(function(a){var b=a.data;return d&&(b=d(b)),q[c]=b,g.resolve(b)}),g.promise},s=function(c,d){var f=a.defer();return b({method:"PUT",url:e.apiDataBaseUrl+c,data:d}).success(function(a){return f.resolve(a)}),f.promise},t=function(c,d){var f=a.defer();return b({method:"POST",url:e.apiDataBaseUrl+c,data:d}).success(function(a){return f.resolve(a)}),f.promise},u=function(c){var d=a.defer();return b({method:"DELETE",url:e.apiDataBaseUrl+c}).success(function(a){return d.resolve(a)}),d.promise};j.getAllContainers=function(){return r("/v3/containers",function(a){return angular.forEach(a,function(a){g.cache("container",{_id:a._id,name:angular.copy(a.name)}),angular.forEach(a.children,function(a){g.cache("container",{_id:a._id,parent_id:a.parent_id,name:angular.copy(a.name)}),angular.forEach(a.children,function(a){g.cache("container",{_id:a._id,parent_id:a.parent_id,name:angular.copy(a.name)}),angular.forEach(a.children,function(a){g.cache("container",{_id:a._id,parent_id:a.parent_id,name:angular.copy(a.name)})})})})}),a})},j.deleteItem=function(a){return u("/v3/events/"+a)},j.deleteAsset=function(a){return u("/v1/assets/"+a)},j.storeItem=function(a){return a=v(a),a?a&&a._id&&!a._id.match(/internal/)?s("/v3/events/"+a._id,{event:a}):t("/v3/episodes/"+a.episode_id+"/events",{event:a}):!1};var v=function(a){var b={};a._id&&a._id.match(/internal/)&&delete a._id;var c=["_id","producerItemType","start_time","end_time","episode_id","template_id","templateUrl","stop","sxs","title","url","annotator","annotation","description","data","asset_id","link_image_id","annotation_image_id"];b.type=a._type;for(var d=0;d<c.length;d++)(a[c[d]]||0===a[c[d]])&&(b[c[d]]=angular.copy(a[c[d]]));b.style_id=[],b.layout_id=[],b.style_id=y("style",a.styles),b.layout_id=y("layout",a.layouts);var e=j.readCache("template","url",a.templateUrl);return b.template_id=e?e.id:x(a.templateUrl),b.template_id?b:(h.error({data:"Tried to store a template with no ID: "+a.templateUrl}),!1)};j.prepItemForStorage=v,j.storeEpisode=function(a){var b=w(a);return b?s("/v3/episodes/"+b._id,b):!1};var w=function(a){var b={};a._id&&a._id.match(/internal/)&&delete a._id;for(var c=["_id","title","description","container_id","customer_id","master_asset_id","status","languages","navigation_depth"],d=0;d<c.length;d++)(a[c[d]]||0===a[c[d]])&&(b[c[d]]=angular.copy(a[c[d]]));b.style_id=y("style",a.styles);var e=j.readCache("template","url",a.templateUrl);return b.template_id=e?e.id:x(a.templateUrl),b.template_id?b:(h.error({data:"Tried to store a template with no ID: "+a.templateUrl}),!1)},x=function(a){var b={"templates/episode/episode.html":"templates/episode-default.html","templates/episode/eliterate.html":"templates/episode-eliterate.html","templates/episode/ewb.html":"templates/episode-ewb.html","templates/episode/gw.html":"templates/episode-gw.html","templates/episode/purdue.html":"templates/episode-purdue.html","templates/episode/story.html":"templates/episode-tellingstory.html","templates/item/transcript.html":"templates/transcript-default.html","templates/item/transcript-withthumbnail.html":"templates/transcript-withthumbnail.html","templates/item/transcript-withthumbnail-alt.html":"templates/transcript-withthumbnail-alt.html","templates/item/text-h1.html":"templates/text-h1.html","templates/item/text-h2.html":"templates/text-h2.html","templates/item/pullquote-noattrib.html":"templates/text-pullquote-noattrib.html","templates/item/pullquote.html":"templates/text-pullquote.html","templates/item/image.html":"templates/transmedia-image-default.html","templates/item/image-caption.html":"templates/transmedia-caption.html","templates/item/image-caption-sliding.html":"templates/transmedia-slidingcaption.html","templates/item/image-fill.html":"templates/transmedia-image-fill.html","templates/item/image-plain.html":"templates/transmedia-image-plain.html","templates/item/image-linkonly.html":"templates/transmedia-linkonly.html","templates/item/image-thumbnail.html":"templates/transmedia-thumbnail.html","templates/item/link.html":"templates/transmedia-link-default.html","templates/item/link-embed.html":"templates/transmedia-link-embed.html","templates/scene/1col.html":"templates/scene-1col.html","templates/scene/2colL.html":"templates/scene-2colL.html","templates/scene/2colR.html":"templates/scene-2colR.html","templates/scene/centered.html":"templates/scene-centered.html","templates/scene/cornerH.html":"templates/scene-cornerH.html","templates/scene/cornerV.html":"templates/scene-cornerV.html"};if(b[a]){var c=j.readCache("template","url",b[a]);return c.id}return!1};j.readCache=function(a,b,c){var d=!1;return angular.forEach(k[a],function(a){a[b]===c&&(d=a)}),d?d:!1},e.debugInBrowser;var y=function(a,b){var c=[];return angular.forEach(b,function(b){if(b){var d=j.readCache(a,"css_name",b);if(!d)return h.error({data:"Tried to store a "+a+" with no ID: "+b}),!1;c.push(d.id)}}),c};return j}]),angular.module("com.inthetelling.story").factory("errorSvc",function(){var a={};return a.init=function(){a.errors=[],a.notifications=[]},a.init(),a.error=function(b){b&&401===b.status,b&&b.data&&a.errors.push({exception:b,cause:b.data.error})},a.notify=function(b){a.notifications.push({text:b})},a}),angular.module("com.inthetelling.story").factory("modelSvc",["$interval","$filter","config","appState","errorSvc",function(a,b,c,d,e){var f={};f.episodes={},f.assets={},f.events={},f.containers={},f.cache=function(a,b){"episode"===a?f.episodes[b._id]?angular.extend(f.episodes[b._id],f.deriveEpisode(angular.copy(b))):f.episodes[b._id]=f.deriveEpisode(angular.copy(b)):"event"===a?f.events[b._id]?angular.extend(f.events[b._id],f.deriveEvent(angular.copy(b))):f.events[b._id]=f.deriveEvent(angular.copy(b)):"asset"===a?f.assets[b._id]?angular.extend(f.assets[b._id],f.deriveAsset(angular.copy(b))):f.assets[b._id]=f.deriveAsset(angular.copy(b)):"container"===a&&(f.containers[b._id]?angular.extend(f.containers[b._id],f.deriveContainer(angular.copy(b))):f.containers[b._id]=f.deriveContainer(angular.copy(b)),b.children&&angular.forEach(b.children,function(a){f.cache("container",f.deriveContainer(angular.copy(a)))}))};var g={"templates/episode-default.html":"templates/episode/episode.html","templates/episode-eliterate.html":"templates/episode/eliterate.html","templates/episode-ewb.html":"templates/episode/ewb.html","templates/episode-gw.html":"templates/episode/gw.html","templates/episode-purdue.html":"templates/episode/purdue.html","templates/episode-tellingstory.html":"templates/episode/story.html","templates/scene-1col.html":"templates/scene/1col.html","templates/scene-2colL.html":"templates/scene/2colL.html","templates/scene-2colR.html":"templates/scene/2colR.html","templates/scene-centered.html":"templates/scene/centered.html","templates/scene-cornerH.html":"templates/scene/cornerH.html","templates/scene-cornerV.html":"templates/scene/cornerV.html","templates/transcript-default.html":"templates/item/transcript.html","templates/transcript-withthumbnail.html":"templates/item/transcript-withthumbnail.html","templates/transcript-withthumbnail-alt.html":"templates/item/transcript-withthumbnail-alt.html","templates/text-h1.html":"templates/item/text-h1.html","templates/text-h2.html":"templates/item/text-h2.html","templates/text-pullquote-noattrib.html":"templates/item/pullquote-noattrib.html","templates/text-pullquote.html":"templates/item/pullquote.html","templates/transmedia-caption.html":"templates/item/image-caption.html","templates/transmedia-image-default.html":"templates/item/image.html","templates/transmedia-slidingcaption.html":"templates/item/image-caption-sliding.html","templates/transmedia-image-fill.html":"templates/item/image-fill.html","templates/transmedia-image-plain.html":"templates/item/image-plain.html","templates/transmedia-linkonly.html":"templates/item/image-linkonly.html","templates/transmedia-thumbnail.html":"templates/item/image-thumbnail.html","templates/transmedia-link-default.html":"templates/item/link.html","templates/transmedia-link-frameicide.html":"templates/item/link.html","templates/transmedia-link-noembed.html":"templates/item/link.html","templates/transmedia-link-embed.html":"templates/item/link-embed.html","templates/transmedia-link-youtube.html":"templates/item/link.html","templates/transmedia-embed-youtube.html":"templates/item/link-embed.html","templates/transmedia-link-icon.html":"templates/item/link.html","templates/upload-demo-inline.html":"templates/item/debug.html","templates/upload-demo.html":"templates/item/debug.html"};f.deriveEpisode=function(a){return g[a.templateUrl]&&(a.origTemplateUrl=a.templateUrl,a.templateUrl=g[a.templateUrl]),angular.forEach(a.languages,function(b){b.default&&(a.defaultLanguage=b.code,d.lang||(d.lang=b.code,f.setLanguageStrings()))}),a.styles||(a.styles=[]),angular.forEach(["eliterate","gw","purdue","usc","columbia","columbiabusiness"],function(b){a.templateUrl==="templates/episode/"+b+".html"&&angular.forEach(["color","typography"],function(c){var d=!1;angular.forEach(a.styles,function(a){a.match(c)&&(d=!0)}),d||a.styles.push(c+b[0].toUpperCase()+b.substring(1))})}),a=h(a)},f.deriveAsset=function(a){return"Asset::Video"===a._type&&(a=k(a)),a},f.deriveContainer=function(a){return a.children&&a.children.length>1&&(a.children=a.children.sort(function(a,b){return a.name.en>b.name.en?1:-1}),a.children=a.children.sort(function(a,b){return a.sort_order-b.sort_order})),h(a)},f.deriveEvent=function(a){return a=h(a),"Scene"!==a._type&&(f.episodes[a.episode_id]&&"templates/episode/usc.html"===f.episodes[a.episode_id].templateUrl&&"Link"===a._type&&("templates/transmedia-link-default.html"===a.templateUrl&&(a.templateUrl="templates/transmedia-link-noembed.html"),a.display_title.match(/ACTIVITY/)&&(a.display_description=a.display_description+'<div class="uscWindowFgOnly">Remember! You need to complete this activity to earn a Friends of USC Scholars badge. (When youâ€™re finished - Come back to this page and click <b>Continue</b>).<br><br>If youâ€™d rather <b>not</b> do the activity, clicking Continue will take you back to the micro-lesson and you can decide where you want to go from there.</div>'),a.display_title.match(/Haven't Registered/)&&(a.styles=a.styles?a.styles:[],a.styles.push("uscHackOnlyGuests"),a.uscReviewModeHack="uscHackOnlyGuests"),a.display_title.match(/Connect with/)&&(a.styles=a.styles?a.styles:[],a.styles.push("uscHackOnlyBadge"),a.uscReviewModeHack="uscHackOnlyBadge")),a.isContent=!1,a.showInReviewMode=!1,a.isTranscript=!1,a.noEmbed=!1,a.noExternalLink=!1,a.targetTop=!1,a.layouts?(a.layoutCss=a.layouts[0],("inline"===a.layouts[0]||a.layouts[0].match(/sidebar/)||a.layouts[0].match(/burst/))&&(a.isContent=!0)):a.isContent=!0,!a.cosmetic&&(a.isContent||a.layouts.indexOf("windowFg")>-1)&&(a.showInReviewMode=!0),"Annotation"===a._type&&a.templateUrl.match(/transcript/)&&(a.isTranscript=!0),a.templateUrl.match(/noembed/)&&(a.noEmbed=!0),"Link"===a._type&&a.url.match(/^http:\/\//)&&(a.noEmbed=!0),(a.templateUrl.match(/link-youtube/)||a.templateUrl.match(/-embed/))&&(a.noExternalLink=!0),a.templateUrl.match(/frameicide/)&&(a.targetTop=!0,a.noEmbed=!0)),g[a.templateUrl]?(a.origTemplateUrl=a.templateUrl,a.templateUrl=g[a.templateUrl],a.isContent||"templates/item/image-plain.html"!==a.templateUrl||(a.templateUrl="templates/item/image-fill.html"),"templates/item/image-plain.html"===a.templateUrl&&(a.styles?a.styles.push("timestampNone"):a.styles=["timestampNone"])):a.origTemplateUrl=a.templateUrl,a.producerItemType||(a.templateUrl.match(/file/)?a.producerItemType="file":a.templateUrl.match(/image/)?a.producerItemType="image":a.templateUrl.match(/link/)?a.producerItemType="link":a.templateUrl.match(/question/)?a.producerItemType="question":a.templateUrl.match(/transcript/)?a.producerItemType="transcript":a.templateUrl.match(/text/)?a.producerItemType="annotation":a.templateUrl.match(/pullquote/)?a.producerItemType="annotation":a.templateUrl.match(/scene/)?a.producerItemType="scene":a.templateUrl.match(/comment/)&&(a.producerItemType="comment")),a.displayStartTime=b("asTime")(a.start_time),a};var h=function(a){var b=d.lang?d.lang:"en";return angular.forEach(["title","annotator","annotation","description","name"],function(c){a[c]&&(a["display_"+c]="string"==typeof a[c]?a[c]:a[c][b]?a[c][b]:a[c].en)}),a};f.setLanguageStrings=function(){angular.forEach(f.events,function(a){a=h(a)}),angular.forEach(f.episodes,function(a){a=h(a)}),angular.forEach(f.containers,function(a){a=h(a)})},f.resolveEpisodeEvents=function(a){var b=[],c=[],d=f.episodes[a];angular.forEach(f.events,function(d){d.episode_id===a&&("Scene"===d._type?b.push(d):c.push(d))});var e={};angular.forEach(c,function(a){if("Annotation"===a._type&&a.annotator){for(var b=Object.keys(a.annotator).sort(),c=a.annotator.en,d=0;d<b.length;d++)"en"!==b[d]&&(e[c],c=c+" / "+a.annotator[b[d]]);e[c]={key:c,name:a.annotator,annotation_image_id:a.annotation_image_id}}}),d.annotators=e,d.scenes=b.sort(function(a,b){return a.start_time-b.start_time}),d.items=c.sort(function(a,b){return a.start_time-b.start_time});for(var g=1;g<d.scenes.length-2;g++)d.scenes[g].end_time=d.scenes[g+1].start_time;angular.forEach(b,function(a){var b=[];angular.forEach(c,function(c){c.start_time>=a.start_time&&c.start_time<a.end_time&&(c.end_time<=a.end_time?(f.events[c._id].scene_id=a._id,b.push(c)):a.end_time-.25<c.start_time?c.start_time=a.end_time:(c.end_time=a.end_time,b.push(c)))}),f.events[a._id].items=b.sort(function(a,b){return a.start_time-b.start_time})}),d.styleCss=j(d),angular.forEach(f.events,function(b){b.episode_id===a&&(b.styleCss=j(b),b.layouts&&(b.styleCss=b.styleCss+" "+b.layouts.join(" ")))})},f.resolveEpisodeContainers=function(a){var b=f.episodes[a];b.parents=[],delete b.previousEpisodeContainer,delete b.nextEpisodeContainer,b.navigation_depth>0?i(+b.navigation_depth+1,a,b.container_id):b.navigation_depth=0};var i=function(a,b,c){var d=f.episodes[b];if(a<=d.navigation_depth&&(d.parents[a-1]=f.containers[c]),a===d.navigation_depth)for(var e=0;e<f.containers[c].children.length;e++){var g=f.containers[c].children[e];g.episodes[0]===b&&(e>0&&(d.previousEpisodeContainer=f.containers[f.containers[c].children[e-1]._id]),e<f.containers[c].children.length-1&&(d.nextEpisodeContainer=f.containers[f.containers[c].children[e+1]._id]))}a>1&&i(a-1,b,f.containers[c].parent_id)};f.episode=function(a){return!f.episodes[a],f.episodes[a]},f.episodeEvents=function(a){var b=[];return angular.forEach(f.events,function(c){c.episode_id===a&&b.push(c)}),b},f.scene=function(a){return!f.events[a],f.events[a]};var j=function(a){var b={typography:!1,color:!1,highlight:!1,timestamp:!1,transition:!1},c=[];if(angular.forEach(a.styles,function(a){c.push(a),angular.forEach(b,function(c,d){0===a.indexOf(d)&&(b[d]=a)})}),a.scene_id){var d=f.events[a.scene_id].styles;angular.forEach(d,function(a){angular.forEach(b,function(d,e){b[e]||0!==a.indexOf(e)||(c.push(a),b[e]=a)})})}if(a.episode_id){var e=f.episodes[a.episode_id].styles;angular.forEach(e,function(a){angular.forEach(b,function(d,e){b[e]||0!==a.indexOf(e)||c.push(a)})})}if("Scene"!==a._type&&!a.isContent&&a.layouts&&a.layouts[0].match(/Bg/))for(var g=0;g<c.length;g++)c[g].match(/transition/)&&"transitionNone"!==c[g]&&(c[g]="transitionFade");return c.join(" ")};f.resolveEpisodeAssets=function(a){angular.forEach(f.events,function(b){if(b.episode_id===a){var c=b.asset_id||b.link_image_id||b.annotation_image_id;c&&f.assets[c]&&(f.events[b._id].asset=f.assets[c])}}),f.episodes[a]&&(f.episodes[a].master_asset_id?f.episodes[a].masterAsset=f.assets[f.episodes[a].master_asset_id]:e.error({data:"This episode has no master_asset_id (authoring error?)"}))},f.addLandingScreen=function(a){f.events["internal:landingscreen:"+a]={_id:"internal:landingscreen:"+a,_type:"Scene",_internal:!0,templateUrl:"templates/scene/landingscreen.html",episode_id:a,start_time:0,end_time:.001}},f.addEndingScreen=function(a){if(f.episodes[a].masterAsset){var b=parseFloat(f.episodes[a].masterAsset.duration),c=f.episodes[a].scenes[f.episodes[a].scenes.length-1];c.end_time=b,angular.forEach(c.items,function(a){a.end_time>b&&(a.end_time=b)}),f.events["internal:endingscreen:"+a]={_id:"internal:endingscreen:"+a,_type:"Scene",_internal:!0,templateUrl:"templates/scene/endingscreen.html",episode_id:a,start_time:b,end_time:b+.1},f.resolveEpisodeEvents(d.episodeId)}};var k=function(a){var b={};if(a.alternate_urls){for(var e=/\.(\w+)$/,f=0;f<a.alternate_urls.length;f++)if(a.alternate_urls[f].match(/youtube/))b.youtube=l(a.alternate_urls[f]);else switch(a.alternate_urls[f].match(e)[1]){case"mp4":b.mpeg4=m(b.mpeg4,a.alternate_urls[f]);break;case"m3u8":b.m3u8=m(b.m3u8,a.alternate_urls[f]);break;case"webm":b.webm=m(b.webm,a.alternate_urls[f])}a.you_tube_url&&(b.youtube=l(a.you_tube_url))}else b={mpeg4:a.url.replace(".mp4",".m3u8"),webm:a.url.replace(".mp4",".webm"),youtube:l(a.you_tube_url)};var g=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),h=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);if((d.isTouchDevice||g)&&(b.youtube=void 0),c.disableYoutube&&(b.youtube=void 0),h){var i,j="t="+(new Date).getTime();b.mpeg4&&(i=b.mpeg4.match(/\?/)?"&":"?",b.mpeg4=b.mpeg4+i+j),b.webm&&(i=b.webm.match(/\?/)?"&":"?",b.webm=b.webm+i+j)}return a.urls=b,a},l=function(a){if(!a)return void 0;var b=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i,c=a.match(b)[1];return"//www.youtube.com/embed/"+c},m=function(a,b){if(!a&&b)return b;if(!b)return a;if(!a&&!b)return"";var c=/(\d+)x(\d+)\.\w+$/,e=a.match(c)||[0,0],f=b.match(c)||[0,0];return d.isTouchDevice?Math.floor(e[1])>Math.floor(f[1])?b:a:Math.floor(e[1])<Math.floor(f[1])?b:a};return c.debugInBrowser,f}]),angular.module("com.inthetelling.story").factory("timelineSvc",["$timeout","$interval","$rootScope","$filter","config","modelSvc","appState","analyticsSvc",function(a,b,c,d,e,f,g,h){var i={};i.timelineEvents=[],i.markedEvents=[];var j,k,l,m;i.registerVideo=function(b){void 0!==l&&a(function(){i.seek(g.time)}),l=b},i.setSpeed=function(a){m=a,g.timeMultiplier=m,l.setSpeed(a),s()},i.play=function(a){if(!g.hasBeenPlayed)return g.hasBeenPlayed=!0,void c.$emit("video.firstPlay");if(g.time>g.duration-.1&&(i.seek(.1),i.play()),void 0!==l)g.videoControlsActive=!0,g.show.navPanel=!1,g.timelineState="buffering",l.play().then(function(){g.timelineState="playing",u(),b.cancel(j),j=b(u,20),q(),a||h.captureEpisodeActivity("play")});else var d=c.$watch(function(){return void 0!==l},function(a){a&&(d(),i.play())})},i.pause=function(a){g.videoControlsActive=!0,b.cancel(j),r(),j=void 0,p=void 0,g.timelineState="paused",l.pause(),a||h.captureEpisodeActivity("pause")},i.stall=function(){b.cancel(j),r(),j=void 0,p=void 0,i.wasPlaying="playing"===g.timelineState,g.timelineState="buffering"},i.unstall=function(){i.wasPlaying?i.play():g.timelineState="paused",i.wasPlaying=void 0},i.seek=function(b,c,d){if(!l||0===g.duration)return void a(function(){i.seek(b)},300);r();var e=g.time;if(b=v(b),0>b&&(b=0),b>g.duration&&(b=g.duration),g.time=b,l.seek(b),i.updateEventStates(),s(),c){var f={method:c,seekStart:e};d&&(f.event_id=d),h.captureEpisodeActivity("seek",f)}},i.prevScene=function(){for(var a=i.markedEvents.length-1;a>=0;a--){var b=g.time;if("playing"===g.timelineState&&(b-=3),i.markedEvents[a].start_time<b){i.seek(i.markedEvents[a].start_time,"prevScene");break}}},i.nextScene=function(){for(var a=!1,b=0;b<i.markedEvents.length;b++)if(i.markedEvents[b].start_time>g.time){i.seek(i.markedEvents[b].start_time,"nextScene"),a=!0;break}a||(i.pause(),i.seek(g.duration-.01,"nextScene"))},i.toggleMute=function(){g.muted=!g.muted,l.toggleMute()},i.setVolume=function(a){g.volume=a,l.setVolume(a)
};var n,o=function(){n={lastTimelineTime:0,lastVideoTime:0}};o();var p,q=function(){n.lastTimelineTime=g.time,n.lastVideoTime=g.time,s()},r=function(){a.cancel(k),o()},s=function(){if(a.cancel(k),"playing"===g.timelineState){for(var b=l.currentTime(),c=g.time,d=0;d<i.timelineEvents.length;d++){var e=i.timelineEvents[d];if(e.t>=n.lastTimelineTime){if(e.t>c)break;if("pause"===e.action&&e.t===n.lastTimelineTime);else if(t(e),"pause"===e.action){d++;break}}}var f=i.timelineEvents[d];if(n.lastVideoTime=b,n.lastTimelineTime=c,f&&"playing"===g.timelineState){var h=1e3*(i.timelineEvents[d].t-c)/m;k=a(s,h+10)}}},t=function(a){"pause"===a.action?(g.time=a.t,i.pause()):"play"===a.action?i.play():"enter"===a.action?(f.events[a.id].state="isCurrent",f.events[a.id].isCurrent=!0):"exit"===a.action&&(f.events[a.id].state="isPast",f.events[a.id].isCurrent=!1)},u=function(){var a=new Date,b=isNaN(a-p)?0:a-p,c=parseFloat(g.time)+b/1e3*m;0>c&&(c=0,i.pause()),c>g.duration&&(c=g.duration,i.pause()),g.time=c,p=a};i.init=function(a){i.timelineEvents=[],i.markedEvents=[],m=1,g.duration=0,g.timelineState="paused",i.injectEvents(f.episodeEvents(a),0),b.cancel(j),r()},i.injectEvents=function(a,b){0!==a.length&&(b||(b=0),angular.forEach(a,function(a){a.start_time=+a.start_time,a.end_time=+a.end_time,"Scene"===a._type&&i.markedEvents.push(a),0!==a.start_time||a._id.match("internal")||(a.start_time=.01,f.events[a._id].start_time=.01),a.stop?(i.timelineEvents.push({t:a.start_time+b,id:a._id,action:"pause"}),i.timelineEvents.push({t:a.start_time+b,id:a._id,action:"enter"}),i.timelineEvents.push({t:a.start_time+b+.01,id:a._id,action:"exit"})):(i.timelineEvents.push({t:a.start_time+b,id:a._id,action:"enter"}),(a.end_time||0===a.end_time)&&i.timelineEvents.push({t:a.end_time+b,id:a._id,action:"exit"}))}),i.sortTimeline())},i.removeEvent=function(a){i.timelineEvents=d("filter")(i.timelineEvents,{id:"!"+a}),i.markedEvents=d("filter")(i.markedEvents,{_id:"!"+a}),i.updateEventStates()},i.updateEventTimes=function(a){i.timelineEvents=d("filter")(i.timelineEvents,{id:"!"+a._id}),i.injectEvents([a],0)},i.sortTimeline=function(){i.timelineEvents=i.timelineEvents.sort(function(a,b){return a.t===b.t?a.action===b.action?0:"enter"===a.action&&"pause"===b.action?-1:"enter"===a.action&&"exit"===b.action?1:"exit"===a.action&&"enter"===b.action?-1:"exit"===a.action&&"pause"===b.action?-1:"pause"===a.action&&"enter"===b.action?1:"pause"===a.action&&"exit"===b.action?1:0:a.t-b.t}),i.markedEvents=i.markedEvents.sort(function(a,b){return a.start_time-b.start_time}),i.timelineEvents.length>0&&(g.duration=i.timelineEvents[i.timelineEvents.length-1].t),i.updateEventStates()},i.updateEventStates=function(){var a=g.time;angular.forEach(i.timelineEvents,function(a){if("timeline"!==a.id){var b=f.events[a.id];b.state="isFuture",b.isCurrent=!1}}),angular.forEach(i.timelineEvents,function(b){if(b.t<=a){var c=f.events[b.id];"enter"===b.action?(c.state="isCurrent",c.isCurrent=!0):"exit"===b.action&&(c.state="isPast",c.isCurrent=!1)}}),s()};var v=function(a){if(!isNaN(parseFloat(a))&&isFinite(a))return a;var b=a.match(/^(\d+)[m:]([\d\.]+)s?$/);return b?parseFloat(60*b[1])+parseFloat(b[2]):(b=a.match(/^([\d\.]+)s$/))?parseFloat(b[1]):(b=a.match(/^([\d\.]+)m$/),b?parseFloat(60*b[1]):void 0)};return e.debugInBrowser,i}]),angular.module("com.inthetelling.story").factory("analyticsSvc",["$q","$http","$routeParams","$interval","config","appState",function(a,b,c,d,e,f){var g={};g.activityQueue=[];var h=d(function(){g.flushActivityQueue()},1e4);(c.local||e.disableAnalytics)&&d.cancel(h),g.captureEpisodeActivity=function(a,b){if(!e.disableAnalytics&&f.user.track_episode_metrics){var c={name:a,walltime:new Date,timestamp:f.time};b&&(c.data=b),g.activityQueue.push(c)}},g.captureEventActivity=function(a,b,c){!e.disableAnalytics&&f.user.track_event_actions&&g.activityQueue.push({name:a,event_id:b,walltime:new Date,data:c})},g.readEpisodeActivity=function(c){var d=a.defer();return b({method:"GET",url:e.apiDataBaseUrl+"/v2/episodes/"+c+"/episode_user_metrics"}).success(function(a){d.resolve(a)}).error(function(){d.reject()}),d.promise},g.readEventActivity=function(c,d){var f=a.defer();return b({method:"GET",url:e.apiDataBaseUrl+"/v2/events/"+c+"/event_user_actions"}).success(function(a){if(d){for(var b=!1,c=0;c<a.length;c++){var e=a[c];e.name===d&&(b=!0)}f.resolve(b)}else f.resolve(a)}).error(function(){f.reject()}),f.promise},g.flushActivityQueue=function(){if(0!==g.activityQueue.length){var a=angular.copy(g.activityQueue);g.activityQueue=[];var b=new Date,c=[],d=[];angular.forEach(a,function(a){a.age=(b-a.walltime)/1e3,delete a.walltime,a.event_id?d.push(a):c.push(a)}),c=g.dejitter(c),d.length>0&&i("event_user_actions",{event_user_actions:d}),c.length>0&&i("episode_user_metrics",{episode_user_metrics:c})}},g.dejitter=function(a){if(0===a.length)return[];for(var b=[],c=0;c<a.length-1;c++){var d=a[c],e=a[c+1];"seek"===d.name&&"seek"===e.name&&d.timestamp===e.data.seekStart?e.data.seekStart=d.data.seekStart:b.push(a[c])}return b.push(a[a.length-1]),b};var i=function(a,c){b({method:"POST",url:e.apiDataBaseUrl+"/v2/episodes/"+f.episodeId+"/"+a,data:c})};return g}]),angular.module("com.inthetelling.story").factory("recursionHelper",["$compile",function(a){return{compile:function(b,c){angular.isFunction(c)&&(c={post:c});var d,e=b.contents().remove();return{pre:c&&c.pre?c.pre:null,post:function(b,f){d||(d=a(e)),d(b,function(a){f.append(a)}),c&&c.post&&c.post.apply(null,arguments)}}}}}]),angular.module("com.inthetelling.story").factory("mockSvc",["modelSvc",function(a){var b={};return b.mockEpisode=function(b){a.cache("episode",{_id:b,created_at:"2014-04-10T02:02:15Z",description:"The Business Case for Sustainability",master_asset_id:"masterasset",title:"Test Episode",status:"Published",templateUrl:"templates/episode/episode.html",styles:["typographySwiss","",""]}),a.cache("asset",{_id:"masterasset",_type:"Asset::Video",alternate_urls:["https://www.youtube.com/watch?v=dTAAsCNK7RA&list=RDHCffYp01sXKH8","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg.m3u8","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg_416x234.webm","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg_960x540.webm","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg_416x234.mp4","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg_960x540.mp4"],attachment:"Sustainability_Pays_for_Demo_1.mp4",base_path:"development/Test Customer/SLIC/The Business Case/Sustainability Pays sXs",content_type:"video/mp4",duration:"443.199313",extension:"mp4",file_size:338886327,filename:"Sustainability_Pays_for_Demo_1.mp4",frame_rate:"10000000/417083",frame_rate_d:417083,frame_rate_n:1e7,height:720,name:"Sustainability Pays for Demo 1",original_filename:"Sustainability_Pays_for_Demo_1.mp4",start_time:"0.000000",status:"complete",url:"https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/Sustainability_Pays_for_Demo_1.mp4",width:1280});for(var c={_id:"-",_type:"Scene",description:"Scene <b>description</b> Description",keywords:[],start_time:0,end_time:200,type:"Scene",episode_id:b,layouts:["",""],styles:["transitionSlideL"]},d=["templates/scene/cornerH.html","templates/scene/cornerV.html","templates/scene/2colL.html","templates/scene/2colR.html","templates/scene/centered.html","templates/scene/1col.html"],e=0;10>e;e++){var f=angular.copy(c);f._id="scene-"+e,f.title=e/2===Math.floor(e/2)?"Scene "+(e+1)+" Title":"",f.title="Scene "+(e+1)+" Title <b>html<sup>included</sup></b>",f.start_time=20*e,f.end_time=20*e+20,f.templateUrl=d[e%d.length],a.cache("event",f)}var g={_id:"",_type:"Annotation",annotation:"Transcript text: <b>html</b> included!",annotation_image_id:"asset3",annotator:"Speaker Name",cosmetic:!1,episode_id:b,required:!1,stop:!1,type:"Annotation",templateUrl:"templates/item/transcript-withthumbnail.html",styles:["colorInvert"]},h=["sidebarL","sidebarR","inline"],i=["templates/item/text-h1.html","templates/item/pullquote.html","templates/item/text-h2.html"];for(e=0;30>e;e++){var j=angular.copy(g);j._id="transcript-"+e,j.annotation="Transcript block number "+(e+1),j.start_time=5*e,j.end_time=5*e+5,j.layouts=[h[e%h.length]],a.cache("event",j)}for(e=0;10>e;e++){var k=angular.copy(g);k._id="annotation-"+e,k.start_time=6*e,k.end_time=6*e+3,k.templateUrl=i[e%i.length],a.cache("event",k)}a.cache("asset",{_id:"asset1",_type:"Asset::Image",url:"https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays/Sustainability_Scorecard_1.jpg",extension:"jpg",name:"Sustainability Scorecard 1"}),a.cache("asset",{_id:"asset2",_type:"Asset::Image",url:"http://placehold.it/350x350",extension:"jpg",name:"350x350 placeholder"}),a.cache("asset",{_id:"asset3",_type:"Asset::Image",url:"http://placehold.it/64x64",extension:"jpg",name:"64x64 placeholder"}),a.cache("asset",{_id:"asset4",_type:"Asset::Image",url:"http://placehold.it/900x900",extension:"jpg",name:"900x900 placeholder"});var l={_type:"Upload",description:"Description of an upload item",required:!1,cosmetic:!1,stop:!1,type:"Upload",episode_id:b,templateUrl:"templates/item/image-caption.html",styles:["transitionFade","tl"],layouts:["inline"]};for(e=0;30>e;e++){var m=angular.copy(l);m._id="upload-"+e,m.asset_id="asset2",m.title="Upload number "+(e%3+1),m.start_time=4*e,m.end_time=4*e+4,m.layouts=[h[e%h.length]],a.cache("event",m)}var n=["mainFg","altFg","videoOverlay"];for(e=0;8>e;e++){var o=angular.copy(l);o.layouts=[n[e%n.length]],o._id="filltest-"+e,o.asset_id="asset2",o.start_time=2*e,o.end_time=2*e+2,o.templateUrl="templates/item/image-fill.html",o.styles.push("cover"),a.cache("event",o)}a.resolveEpisodeEvents(b),a.resolveEpisodeAssets(b)},b}]),angular.module("com.inthetelling.story").filter("itemLayout",function(){return function(a,b){var c=[];return angular.forEach(a,function(a){a.layouts&&a.layouts[0]===b&&c.push(a)}),c}}).filter("annotation",function(){return function(a){var b=[];return angular.forEach(a,function(a){"Annotation"===a._type&&b.push(a)}),b}}).filter("transmedia",function(){return function(a){var b=[];return angular.forEach(a,function(a){"Annotation"!==a._type&&b.push(a)}),b}}).filter("transcript",function(){return function(a){var b=[];return angular.forEach(a,function(a){a.isTranscript&&b.push(a)}),b}}).filter("isCurrent",function(){return function(a){var b=[];return angular.forEach(a,function(a){a.isCurrent&&b.push(a)}),b}}).filter("isContent",function(){return function(a){var b=[];return angular.forEach(a,function(a){a.isContent&&b.push(a)}),b}}).filter("reviewMode",function(){return function(a){var b=[];return angular.forEach(a,function(a){a.showInReviewMode&&b.push(a)}),b}}).filter("transcriptandrequired",function(){return function(a){var b=[];return angular.forEach(a,function(a){(a.isTranscript||a.required)&&b.push(a)}),b}}).filter("transcriptandoptional",function(){return function(a){var b=[];return angular.forEach(a,function(a){(a.isTranscript||!a.isTranscript&&!a.required)&&b.push(a)}),b}}).filter("required",function(){return function(a){var b=[];return angular.forEach(a,function(a){!a.isTranscript&&a.required&&b.push(a)}),b}}).filter("optional",function(){return function(a){var b=[];return angular.forEach(a,function(a){a.isTranscript||a.required||b.push(a)}),b}}).filter("highlightSubstring",function(){return function(a,b){return a?b||angular.isNumber(b)?(""+a).replace(RegExp(""+b,"gi"),'<span class="ui-match">$&</span>'):a:void 0}}).filter("pretty",function(){return function(a){return JSON.stringify(a,void 0,2)}}).filter("asBytes",function(){return function(a){var b=Math.floor(a/1024);if(1024>b)return b+"Kb";var c=Math.floor(b/10.24)/100;return c+"Mb"}}).filter("asPercent",function(){return function(a){return isNaN(a)?Math.floor(100*a)+"%":"0%"}}).filter("asTime",function(){return function(a){return isNaN(a)?"0:00":Math.floor(a/60)+":"+("0"+Math.floor(a)%60).slice(-2)}}).filter("alpha",function(){return function(a){return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("")[a%26]}}),angular.module("com.inthetelling.story").controller("ErrorController",["$scope","$http","config","errorSvc","appState",function(a,b,c,d,e){a.errorSvc=d,a.user=e.user,a.dismiss=function(a){for(var b=0;b<d.errors.length;b++)d.errors[b]===a&&(d.errors.splice(b,1),b=d.errors.length);for(b=0;b<d.notifications.length;b++)d.notifications[b]===a&&(d.notifications.splice(b,1),b=d.notifications.length)},a.resetAuth=function(){b.defaults.headers.common.Authorization=void 0,localStorage.removeItem(c.localStorageKey),e.user={}},a.reload=function(){window.location.reload(!0)}}]),angular.module("com.inthetelling.story").controller("TimelineController",["$scope","timelineSvc","modelSvc","appState",function(a,b,c,d){a.play=b.play,a.pause=b.pause,a.changeSpeed=function(a){var c=d.timeMultiplier+a;.5>c&&(c=.5),c>2&&(c=2),b.setSpeed(c)},a.resetSpeed=function(){b.setSpeed(1)},a.markerPercent=function(a){return a/d.duration*100},a.toggleMute=function(){b.toggleMute()},a.setVolume=function(a){b.setVolume(a)},a.toggleFullscreen=function(){e()?g():h()};var e=function(){return document.fullScreenElement&&null!==document.fullScreenElement||document.mozFullScreen||document.webkitIsFullScreen},f=a.$watch(function(){return e()},function(a){d.isInFullscreenMode=a});a.$on("$destroy",function(){f()});var g=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},h=function(){var a=document.getElementById("CONTAINER");a.requestFullScreen?a.requestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&a.webkitRequestFullScreen()};a.$on("$destroy",function(){b.pause()})}]),angular.module("com.inthetelling.story").controller("PlayerController",["$scope","$location","$rootScope","$routeParams","$timeout","$interval","appState","dataSvc","modelSvc","timelineSvc","analyticsSvc","errorSvc","authSvc",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.viewMode=function(a){g.viewMode=a,k.captureEpisodeActivity("modeChange",{mode:a}),"review"===a?(g.autoscroll=!0,g.autoscrollBlocked=!1,e(y)):g.autoscroll=!1,e(function(){$(window).trigger("resize")})},d.viewMode&&e(function(){a.viewMode(d.viewMode)}),d.t&&j.seek(d.t,"URLParameter"),g.init(),l.init(),g.episodeId=d.epId,i.addLandingScreen(g.episodeId),h.getEpisode(g.episodeId);var n=a.$watch(function(){return i.episodes[g.episodeId].display_title},function(a){a&&(document.title="STORY: "+a,n())});a.loading=!0;var o=a.$watch(function(){return i.episodes[g.episodeId].items},function(b){b&&(i.addEndingScreen(g.episodeId),j.init(g.episodeId),a.loading=!1,o())});a.episode=i.episode(g.episodeId),a.appState=g,a.show=g.show,a.now=new Date,a.currentdate=new Date,g.videoControlsActive=!1;var p,q=a.$watch(function(){return g.videoControlsActive},function(a){a&&(p=e(function(){g.videoControlsLocked||(g.videoControlsActive=!1)},5e3))});a.$on("$destroy",function(){q()}),a.showControls=function(){e.cancel(p),g.videoControlsActive=!0,g.isTouchDevice&&a.allowControlsExit()},a.allowControlsExit=function(){e.cancel(p),p=e(function(){g.videoControlsLocked||(g.videoControlsActive=!1)},5e3)},a.toggleSearchPanel=function(){g.show.searchPanel=!g.show.searchPanel},a.toggleNavPanel=function(){j.pause(),g.show.navPanel=!g.show.navPanel},a.seek=function(b){a.enableAutoscroll(),j.seek(b,"sceneMenu"),g.show.navPanel=!1},a.pause=function(){j.pause()};var r=!0;try{localStorage.setItem("iCanHazStorage",1)}catch(s){r=!1}r&&localStorage.removeItem("iCanHazStorage"),c.$on("video.firstPlay",function(){r&&!localStorage.getItem("noMoreHelp")?g.show.helpPanel=!0:j.play()}),a.hidePanels=function(){g.show.searchPanel=!1,g.show.helpPanel=!1,g.show.navPanel=!1,g.show.profilePanel=!1,g.itemDetail=!1,c.$emit("player.dismissAllPanels")},a.noMoreHelp=function(){g.show.helpPanel=!1,localStorage.setItem("noMoreHelp","1"),j.play()},a.play=function(){j.play()},a.userHasRole=function(a){return m.userHasRole(a)},a.logout=function(){return m.logout()};var t,u=$(window),v=$("html,body"),w=function(){t=f(y,400),u.bind("scroll",function(){v.stop(),x(),g.autoscrollBlocked=!0})},x=function(){u.unbind("scroll"),f.cancel(t)};a.enableAutoscroll=function(){g.autoscrollBlocked&&(g.autoscrollBlocked=!1,w())};var y=function(){if(!g.autoscrollBlocked&&g.autoscroll){var a=1/0,b=u.scrollTop();if(angular.forEach($(".content .item.isCurrent:visible"),function(c){var d=c.getBoundingClientRect().top+b;a>d&&(a=d)}),1/0!==a){var c=$(window).height()/5;a>b+c&&b+c+c+c>a||c>a&&c>b||(x(),v.animate({scrollTop:a-c},1500),e(function(){w()},1750))}}};w(),c.$on("userKeypress.ESC",a.hidePanels)}]),angular.module("com.inthetelling.story").controller("EpisodeController",["$scope","$routeParams","modelSvc","appState",function(a,b,c,d){a.episode=c.episode(d.episodeId),a.appState=d}]),angular.module("com.inthetelling.story").controller("SceneController",["$scope","$filter",function(a,b){a.precalculateSceneValues=function(){delete a.mainContentHasLeftSidebar,delete a.mainContentHasRightSidebar,delete a.mainContentHasBothSidebars,delete a.altContentHasLeftSidebar,delete a.altContentHasRightSidebar,delete a.altContentHasBothSidebars,a.showCurrent=$.inArray("showCurrent",a.scene.layouts)>-1,a.contentItems=b("isContent")(a.scene.items),a.mainFgItems=b("itemLayout")(a.scene.items,"mainFg"),a.mainBgItems=b("itemLayout")(a.scene.items,"mainBg"),a.altFgItems=b("itemLayout")(a.scene.items,"altFg"),a.altBgItems=b("itemLayout")(a.scene.items,"altBg"),a.mainContentItems=$.inArray("splitRequired",a.scene.layouts)>-1?b("transcriptandoptional")(a.contentItems):$.inArray("splitOptional",a.scene.layouts)>-1?b("transcriptandrequired")(a.contentItems):b("annotation")(a.contentItems),a.altContentItems=$.inArray("splitRequired",a.scene.layouts)>-1?b("required")(a.contentItems):$.inArray("splitOptional",a.scene.layouts)>-1?b("optional")(a.contentItems):b("transmedia")(a.contentItems);for(var c=0;c<a.mainContentItems.length;c++)($.inArray("burstL",a.mainContentItems[c].layouts)>-1||$.inArray("sidebarL",a.mainContentItems[c].layouts)>-1||$.inArray("burst",a.mainContentItems[c].layouts)>-1)&&(a.mainContentHasLeftSidebar=!0),($.inArray("burstR",a.mainContentItems[c].layouts)>-1||$.inArray("sidebarR",a.mainContentItems[c].layouts)>-1||$.inArray("burst",a.mainContentItems[c].layouts)>-1)&&(a.mainContentHasRightSidebar=!0),a.mainContentHasLeftSidebar&&a.mainContentHasRightSidebar&&(a.mainContentHasBothSidebars=!0,c=a.mainContentItems.length);for(c=0;c<a.altContentItems.length;c++)($.inArray("burstL",a.altContentItems[c].layouts)>-1||$.inArray("sidebarL",a.altContentItems[c].layouts)>-1||$.inArray("burst",a.altContentItems[c].layouts)>-1)&&(a.altContentHasLeftSidebar=!0),($.inArray("burstR",a.altContentItems[c].layouts)>-1||$.inArray("sidebarR",a.altContentItems[c].layouts)>-1||$.inArray("burst",a.altContentItems[c].layouts)>-1)&&(a.altContentHasRightSidebar=!0),a.altContentHasLeftSidebar&&a.altContentHasRightSidebar&&(a.altContentHasBothSidebars=!0,c=a.altContentItems.length)}}]),angular.module("com.inthetelling.story").controller("ItemController",["$scope","timelineSvc",function(a,b){a.seek=function(c){b.seek(c,"clickedOnItem",a.item._id)}}]),angular.module("com.inthetelling.story").controller("VideoController",["$q","$scope","$timeout","$window","$document","appState","timelineSvc",function(a,b,c,d,e,f,g){var h=document.createElement("script");h.src="//www.youtube.com/iframe_api",angular.element(e[0].head).append(h),d.onYouTubeIframeAPIReady=function(){f.youtubeIsReady=!0},b.initVideo=function(a){if(b.video.urls.youtube)if(b.videoType="youtube",f.videoType=b.videoType,b.videoNode=a.find("iframe")[0],f.youtubeIsReady)b.initYoutube(b.videoNode.id);else var c=b.$watch(function(){return f.youtubeIsReady},function(a){a&&(b.initYoutube(b.videoNode.id),c())});else b.videoType="video",f.videoType=b.videoType,b.videoNode=a.find("video")[0],b.initHTML5Video()},b.initYoutube=function(){var a=["ended","playing","paused","buffering","","cued"];b.YTPlayer=new window.YT.Player(b.videoNode.id,{events:{onStateChange:function(c){b.playerState=a[c.data],"buffering"===b.playerState&&b.stall()}}});var c=b.$watch(function(){return void 0!==b.YTPlayer.playVideo},function(a){a&&(c(),b.getBufferPercent=function(){return f.bufferedPercent=100*b.YTPlayer.getVideoLoadedFraction(),f.bufferedPercent},g.registerVideo(b))})},b.initHTML5Video=function(){b.videoNode.addEventListener("playing",function(){b.playerState="playing"},!1),b.videoNode.addEventListener("waiting",function(){b.playerState="waiting",b.stall()},!1),b.videoNode.addEventListener("stalled",function(){b.playerState="stalled"},!1),b.videoNode.addEventListener("pause",function(){b.playerState="pause"},!1),b.getBufferPercent=function(){if(b.videoNode.buffered.length>0){var a=b.videoNode.buffered.start(b.videoNode.buffered.length-1),c=b.videoNode.buffered.end(b.videoNode.buffered.length-1);return 0>c&&(c-=a,a=0),f.bufferedPercent=c/f.duration*100,f.bufferedPercent}return 0},g.registerVideo(b)},b.stall=function(){if("playing"===f.timelineState){g.stall();var a=b.$watch(function(){return b.playerState},function(b){"buffering"!==b&&"waiting"!==b&&(a(),g.unstall())})}},b.play=function(){var c=a.defer();"youtube"===b.videoType?b.YTPlayer.playVideo():b.videoNode.play();var d=b.$watch(function(){return b.playerState},function(a){"playing"===a&&(d(),c.resolve())});return c.promise},b.pause=function(){"youtube"===b.videoType?(b.YTPlayer.seekTo(f.time,!0),b.YTPlayer.pauseVideo()):b.videoNode.pause();try{b.videoNode.currentTime=f.time}catch(a){}},b.seek=function(a){try{if("youtube"===b.videoType){var d="playing"===f.timelineState;b.YTPlayer.seekTo(a,!0),d||b.YTPlayer.pauseVideo()}else b.videoNode.currentTime=a}catch(e){c(function(){b.seek(a)},100)}},b.setSpeed=function(a){0>=a||"youtube"===b.videoType||(b.videoNode.playbackRate=a)},b.currentTime=function(){return"youtube"===b.videoType?b.YTPlayer.getCurrentTime():b.videoNode.currentTime},b.toggleMute=function(){"youtube"===b.videoType?b.YTPlayer.isMuted()?b.YTPlayer.unMute():b.YTPlayer.mute():b.videoNode.muted=!b.videoNode.muted},b.setVolume=function(a){"youtube"===b.videoType?b.YTPlayer.setVolume(a):b.videoNode.volume=a/100}}]),angular.module("com.inthetelling.story").controller("SearchPanelController",["$scope","timelineSvc",function(a,b){a.searchTypes={Annotation:!0,Link:!0,Upload:!0},a.searchTypeNames={Annotation:"Transcript",Link:"Link",Upload:"Image"},a.sortBy="startTime",a.seek=function(c,d){a.enableAutoscroll(),b.seek(c,"clickedOnEventInSearch",d)},a.indexEvents=function(){angular.forEach(a.episode.items,function(a){a.searchableText=(a.display_annotation||a.display_description)+" "+(a.display_title||a.display_annotator),a.sxs&&(a.cosmetic=!1)})}}]),angular.module("com.inthetelling.story").controller("EditController",["$scope","$rootScope","appState","dataSvc","modelSvc","timelineSvc",function(a,b,c,d,e,f){a.addEvent=function(a){var b=g(a);e.cache("event",b),c.editEvent=e.events["internal:editing"],c.videoControlsActive=!0,c.videoControlsLocked=!0,e.resolveEpisodeEvents(c.episodeId),f.injectEvents([e.events["internal:editing"]])},a.saveEvent=function(){var a=angular.copy(c.editEvent);d.storeItem(a).then(function(a){"internal:editing"===c.editEvent._id&&(f.removeEvent("internal:editing"),delete e.events["internal:editing"],e.cache("event",d.resolveIDs(a)),e.resolveEpisodeEvents(c.episodeId),f.injectEvents([e.events[a._id]])),c.editEvent=!1},function(){})},a.saveEpisode=function(){var a=angular.copy(c.editEpisode);d.storeEpisode(a).then(function(){c.editEpisode=!1,c.videoControlsLocked=!1},function(){})},a.editCurrentScene=function(){var a=e.episodes[c.episodeId];angular.forEach(a.scenes,function(a){a.isCurrent&&(c.editEvent=e.events[a._id],c.editEvent.producerItemType="scene",c.videoControlsActive=!0,c.videoControlsLocked=!0)})},a.editEpisode=function(){c.editEpisode=e.episodes[c.episodeId],c.videoControlsActive=!0,c.videoControlsLocked=!0},a.deleteEvent=function(a){window.confirm("Are you sure you wish to delete this item?")&&d.deleteItem(a).then(function(){"sxs"===c.product&&e.events[a].asset&&d.deleteAsset(e.events[a].asset._id),f.removeEvent(a),delete e.events[a],e.resolveEpisodeEvents(c.episodeId),c.editEvent=!1,c.videoControlsLocked=!1},function(){})},a.cancelEventEdit=function(a){"internal:editing"===c.editEvent._id?(delete e.events["internal:editing"],f.removeEvent("internal:editing")):(e.events[c.editEvent._id]=a,f.updateEventTimes(a)),e.resolveEpisodeEvents(c.episodeId),c.editEvent=!1,c.videoControlsLocked=!1},a.cancelEpisodeEdit=function(a){e.episodes[c.episodeId]=angular.copy(a),e.deriveEpisode(e.episodes[c.episodeId]),c.editEpisode=!1,c.videoControlsLocked=!1};var g=function(a){var b={_id:"internal:editing",start_time:c.time,episode_id:c.episodeId,type:a,isCurrent:!0,producerItemType:a,layouts:["inline"],styles:[]},d={};if("scene"===a&&(d={_type:"Scene",title:{en:""},description:{en:""}}),("comment"===a||"transcript"===a||"annotation"===a)&&(d={_type:"Annotation",annotation:{en:""},annotator:{en:""},annotation_image_id:""}),("file"===a||"image"===a)&&(d={_type:"Upload",asset_id:"",title:{en:""},description:{en:""}}),"link"===a&&(d={_type:"Link",link_image_id:"",url:"https://",title:{en:""},description:{en:""}}),"question"===a&&(d={_type:"Plugin",data:{_pluginType:"question",_version:1,_plugin:{questiontext:"",questiontype:"mc-formative",distractors:[{text:""},{text:""},{text:""},{text:""}],correctfeedback:"",incorrectfeedback:""}}},d.plugin=d.data._plugin),"sxs"===c.product)d.sxs=!0,d.annotator={en:"Professor Smith"},d.layouts=["windowFg"],d.end_time=c.time,d.stop=!0,d.templateUrl="templates/item/sxs-"+a+".html";else{var e={scene:"templates/scene/1col.html",transcript:"templates/item/transcript.html",annotation:"templates/item/pullquote.html",link:"templates/item/link.html",image:"templates/item/image.html",file:"templates/item/link.html",question:"templates/item/question-mc-formative.html",video:"TODO:VIDEO"};d.templateUrl=e[a]}return angular.extend(b,d),b}}]),angular.module("com.inthetelling.story").controller("QuestionAuthoringController",["$scope","$timeout",function(a,b){a.addDistractor=function(){a.question.distractors.push({text:""})},a.init=function(){a.question={questiontext:"",questiontype:"mc-formative",distractors:[]},a.addDistractor(),a.addDistractor(),a.addDistractor(),a.addDistractor(),a.sampleitem={_id:"sample",type:"Plugin",start_time:0,templateUrl:"templates/item/question-"+a.question.questiontype+".html",data:a.pluginjson}},a.init(),a.$watch(function(){return a.question},function(){if(!a.selfediting){a.fieldediting=!0,a.editwarning=!1;for(var c={questiontext:a.question.questiontext,questiontype:a.question.questiontype,distractors:[]},d=0;d<a.question.distractors.length;d++){var e=a.question.distractors[d];e.text&&c.distractors.push("mc-formative"===a.question.questiontype&&e.correct?{text:e.text,correct:!0}:{text:e.text})}"mc-formative"===a.question.questiontype&&(c.correctfeedback=a.question.correctfeedback,c.incorrectfeedback=a.question.incorrectfeedback),a.sampleitem={_id:"sample",type:"Plugin",start_time:0,templateUrl:"templates/item/question-"+a.question.questiontype+".html",data:{_pluginType:"question",_version:1,_plugin:c}},a.pluginjson=angular.toJson(a.sampleitem.data),b(function(){a.updatePreview(),a.fieldediting=!1})}},!0),a.$watch(function(){return a.pluginjson},function(){if(!a.fieldediting){a.selfediting=!0;var c;a.editwarning=!1;try{c=angular.fromJson(a.pluginjson),a.question=c._plugin}catch(d){a.editwarning=!0}b(function(){a.sampleitem.data._plugin=angular.fromJson(a.pluginjson),a.updatePreview(),a.selfediting=!1})}}),a.updatePreview=function(){a.preview=!1,b(function(){a.questionpreview=a.sampleitem,a.preview=!0})}}]),angular.module("com.inthetelling.story").directive("autofocus",["$timeout",function(a){return{link:function(b,c){a(function(){"TEXTAREA"===c[0].tagName||"INPUT"===c[0].tagName?c[0].focus():c.find("input,textarea")[0].focus()})}}}]),angular.module("com.inthetelling.story").directive("ittTimeline",["$timeout","appState","timelineSvc","modelSvc",function(a,b,c,d){return{restrict:"A",replace:!0,scope:!0,templateUrl:"templates/timeline.html",controller:"TimelineController",link:function(e,f){e.appState=b,e.timeline=c,e.handlePosition=0,e.zoomLevel=1,e.zoomOffset=0;var g=f.find(".progressbarContainer"),h=f.find(".progressbar");e.setNewLanguage=function(){d.setLanguageStrings()},e.showSceneMenuTooltip=function(a){e.sceneMenuToolTip=a&&!b.isTouchDevice?!0:!1},e.prevScene=function(){c.prevScene()},e.nextScene=function(){c.nextScene()},e.userChangingVolume=function(a){b.muted&&e.toggleMute();var c=angular.element(a.currentTarget),d=function(a,b){var d=(a.clientX-c.offset().left)/c.width()*100;d>98&&(d=100),3>d&&(d=0),b?e.setVolume(d):e.$apply(e.setVolume(d))};d(a,!0),c.bind("mousemove.volume",d),angular.element(document).bind("mouseup.volume",function(){angular.element(document).unbind("mouseup.volume"),c.unbind("mousemove.volume")})},e.currentVolume=function(){return b.muted?0:b.volume},e.audioIcon=function(){return b.muted?"muted":"vol"+Math.floor(b.volume/34)},e.showTooltip=function(a){a.showTooltip=!0},e.hideTooltip=function(a){a.showTooltip=!1},e.zoomIn=function(){e.stopWatching=!0,e.zoomLevel=e.zoomLevel+1,i()},e.zoomOut=function(){e.stopWatching=!0,e.zoomLevel=e.zoomLevel<=2?1:e.zoomLevel<=3?1.5:e.zoomLevel/2,i()};var i=function(){e.zoomOffset=-((e.zoomLevel-1)*(b.time/b.duration)),g.stop().animate({left:100*e.zoomOffset+"%",width:100*e.zoomLevel+"%"},1e3,function(){e.stopWatching=!1})};e.$watch(function(){return{t:b.time,d:b.duration}},function(){e.stopWatching||(e.zoomOffset=-((e.zoomLevel-1)*(b.time/b.duration)),g.css({left:100*e.zoomOffset+"%"}))},!0);var j=function(c){a(function(){e.seekHandleVisible=!0},250),e.isSeeking=!0;var d=b.isTouchDevice?"touchend.timeline":"mouseup.timeline";h.bind(d,function(){l()}),angular.element(document).bind(d,function(){m()}),k(c)};e.$watch(function(){return b.time},function(){b.editEvent&&(e.willSeekTo=b.time)});var k=function(a){e.isSeeking&&(e.willSeekTo=(a.clientX-g.offset().left)/g.width()*b.duration,e.willSeekTo<0&&(e.willSeekTo=0),e.willSeekTo>b.duration&&(e.willSeekTo=b.duration))},l=function(){e.stopWatching=!0,e.enableAutoscroll(),c.seek(e.willSeekTo,"scrubTimeline"),i()},m=function(){angular.element(document).off("mouseup.timeline"),angular.element(document).off("touchend.timeline"),h.off("mouseup.timeline"),h.off("touchend.timeline"),e.$apply(function(){e.isSeeking=!1,e.seekHandleVisible=!1})},n=function(){var a=$(f.find(".playhead"));b.isTouchDevice?(a.on("touchstart.timeline",function(a){j(a.originalEvent.targetTouches[0]),a.preventDefault()}),a.on("touchmove.timeline",function(a){k(a.originalEvent.targetTouches[0]),a.preventDefault()})):(a.on("mousedown.timeline",function(a){j(a),a.preventDefault()}),a.on("mousemove.timeline",function(a){k(a),a.preventDefault()}))};n(),e.$on("$destroy",function(){m()})}}}]),angular.module("com.inthetelling.story").directive("ittEpisode",["analyticsSvc",function(a){return{restrict:"A",replace:!0,template:'<span ng-include="episode.templateUrl"></span>',controller:"EpisodeController",link:function(){a.captureEpisodeActivity("episodeLoad")}}}]),angular.module("com.inthetelling.story").directive("ittScene",["$timeout","$interval","appState","modelSvc",function(a,b,c,d){return{restrict:"A",replace:!1,scope:{scene:"=ittScene",episode:"=episode"},template:'<span ng-include="scene.templateUrl"></span>',controller:"SceneController",link:function(a,e){a.precalculateSceneValues(),a.appState=c,a.scene._id.match(/internal/)&&(a.containers=d.containers,a.crossEpisodePath=c.crossEpisodePath);
var f=function(){var b=e.find(".videoMagnet img");if(null===b.height())var c=a.$watch(function(){return e.find(".videoMagnet img").height()},function(a){a>0&&(c(),f())});else{e.find(".matchVideoHeight:visible").each(function(){$(this).css("height",e.find(".videoMagnet img").height())});var d=angular.element(window).height()-$("#CONTAINER").scrollTop();e.find(".stretchToViewport:visible").each(function(){$(this).css("min-height",d-$(this).offset().top)}),e.find(".stretchToViewportShort:visible").each(function(){$(this).css("min-height",d-$(this).offset().top-210)})}e.find(".content").each(function(){var a=$(this);a.outerWidth()>550?a.addClass("allowSidebars"):a.removeClass("allowSidebars")})};a.unwatch=a.$watch(function(){return{winWidth:c.windowWidth,winHeight:c.windowHeight,newMode:c.viewMode}},function(b){"discover"===b.newMode&&a.scene.isCurrent&&f()},!0),a.unwatchEdits=a.$watch(function(){return c.editEvent},a.precalculateSceneValues,!0),a.safetyBelt=b(f,1321),a.$on("$destroy",function(){a.unwatch(),a.unwatchEdits(),b.cancel(a.safetyBelt)})}}}]),angular.module("com.inthetelling.story").directive("ittWidthWatch",function(){return{restrict:"A",replace:!1,link:function(a,b){var c=a.$watch(function(){return b.width()},function(b){a.isNarrow=400>b});a.$on("$destroy",c)}}}),angular.module("com.inthetelling.story").directive("ittItem",["$http","$timeout","config","appState","analyticsSvc","timelineSvc","modelSvc",function(a,b,c,d,e,f,g){return{restrict:"A",replace:!1,scope:{item:"=ittItem"},template:function(a,b){return b.forcetemplate?"<div ng-include=\"'templates/item/"+b.forcetemplate+".html'\"></div>":'<div ng-include="item.templateUrl"></div>'},controller:"ItemController",link:function(h,i){h.toggleDetailView=function(){h.item.showInlineDetail?h.item.showInlineDetail=!1:(f.pause(),h.captureInteraction(),i.width()>400?h.item.showInlineDetail=!0:d.itemDetail=h.item)},h.forceModal=function(){f.pause(),d.itemDetail=h.item},h.outgoingLink=function(a){f.pause(),h.captureInteraction(),h.item.targetTop?b(function(){window.location.href=a}):window.open(a)},h.editItem=function(){d.editEvent=h.item,d.videoControlsActive=!0,d.videoControlsLocked=!0},h.captureInteraction=function(){e.captureEventActivity("clicked",h.item._id)},"templates/item/link-embed.html"===h.item.templateUrl&&h.captureInteraction(),h.item.asset_id&&!h.item.asset&&(h.item.asset=g.assets[h.item.asset_id]),h.item.styleCss&&h.item.styleCss.match(/fill|contain|cover/)&&(h.item.asset.cssUrl="url('"+h.item.asset.url+"');",h.item.backgroundImageStyle="background-image: url('"+h.item.asset.url+"');"),h.item.data&&(h.plugin=h.item.data._plugin,h.plugin._type=h.item.data._pluginType,"question"===h.plugin._type&&(h.scoreQuiz=function(){h.plugin.distractors[h.plugin.selectedDistractor].selected=!0,h.plugin.hasBeenAnswered=!0,e.captureEventActivity("question-answered",h.item._id,{answer:h.plugin.distractors[h.plugin.selectedDistractor].text,correct:!!h.plugin.distractors[h.plugin.selectedDistractor].correct})},h.scorePoll=function(){h.plugin.distractors[h.plugin.selectedDistractor].selected=!0,h.plugin.hasBeenAnswered=!0,e.captureEventActivity("question-answered",h.item._id,{answer:h.plugin.distractors[h.plugin.selectedDistractor].text,correct:!!h.plugin.distractors[h.plugin.selectedDistractor].correct})},h.resetQuestion=function(){h.plugin.selectedDistractor=void 0,h.plugin.hasBeenAnswered=!1;for(var a=0;a<h.plugin.distractors.length;a++)h.plugin.distractors[a].selected=!1}),"credlyBadge"===h.plugin._type&&(e.captureEventActivity("viewed",h.item._id),d.user.roles&&1===d.user.roles.length&&"guest"===d.user.roles[0]?h.plugin.eligibleForBadges=!1:(h.plugin.eligibleForBadges=!0,h.plugin.userEmail=d.user.emails?d.user.emails[0]:"",h.plugin.totalAchieved=0),h.checkBadgeEligibility=function(){h.plugin.eligibleForBadges&&angular.forEach(h.plugin.requirements,function(a){a.achieved||e.readEventActivity(a.eventId,a.activity).then(function(b){a.achieved=b,h.countAchievements()}),h.countAchievements()})},h.$watch(function(){return h.item.isCurrent||"review"===d.viewMode},function(a,b){a&&!b&&h.checkBadgeEligibility()}),h.countAchievements=function(){var a=0;angular.forEach(h.plugin.requirements,function(b){b.achieved&&(a+=1)}),h.plugin.totalAchieved=a,h.plugin.totalAchieved===h.plugin.requirements.length&&(h.$parent.episode.styleCss=h.$parent.episode.styleCss+" uscHackUserHasBadge")},h.badger=function(){h.plugin.gettingBadge=!0,a({method:"GET",url:c.apiDataBaseUrl+"/v1/send_credly_badge?badge_id="+h.plugin.credlyBadgeId+"&email="+h.plugin.userEmail}).success(function(a){h.checkBadgeEligibility(),"Badge previously sent."===a.status&&(h.plugin.alreadyHadBadge=!0),h.plugin.gotBadge=!0}).error(function(){h.plugin.gettingBadge=!1,h.plugin.error=!0})}))}}}]),angular.module("com.inthetelling.story").directive("ittItemDetailModal",["appState",function(a){return{restrict:"A",replace:!0,scope:{item:"=ittItemDetailModal"},templateUrl:"templates/item/modal.html",link:function(b){b.dismiss=function(){a.itemDetail=!1}}}}]),angular.module("com.inthetelling.story").directive("ittEpisodeEditor",["$rootScope","appState","modelSvc",function(a,b,c){return{restrict:"A",replace:!0,scope:{episode:"=ittEpisodeEditor"},templateUrl:"templates/producer/episode.html",controller:"EditController",link:function(d){if(d.uploadStatus=[],d.uneditedEpisode=angular.copy(d.episode),d.episodeForm={transition:"",highlight:"",color:"",typography:"",timestamp:""},d.episode.styles)for(var e in d.episodeForm)for(var f=0;f<d.episode.styles.length;f++)d.episode.styles[f].substr(0,e.length)===e&&(d.episodeForm[e]=d.episode.styles[f].substr(e.length));d.langForm={};for(var g=0;g<d.episode.languages.length;g++)d.langForm[d.episode.languages[g].code]=!0;d.langForm[d.episode.defaultLanguage]=!0,d.languageWatcher=d.$watch(function(){return[d.langForm,d.episode.defaultLanguage]},function(){var a=0,b="",c=[];for(var e in d.langForm)d.langForm[e]?(a++,b=e,c.push({code:e})):d.episode.defaultLanguage===e&&(d.episode.defaultLanguage=!1);d.languageCount=a,d.episode.defaultLanguage===!1&&(d.episode.defaultLanguage=b),angular.forEach(c,function(a){a.code===d.episode.defaultLanguage&&(a.default=!0)}),d.episode.languages=angular.copy(c)},!0),d.appState=b,d.watchEdits=d.$watchGroup(["episode.templateUrl","episode.title[appState.lang]","episode.description[appState.lang]","episode.navigation_depth"],function(a,b){if(a[0]!==b[0]){var e=[],f=b[0].match("templates/episode/(.*).html")[1],g=a[0].match("templates/episode/(.*).html")[1];angular.forEach(d.episode.styles,function(a){a.toLowerCase()!=="color"+f&&a.toLowerCase()!=="typography"+f&&e.push(a)}),angular.forEach(["eliterate","gw","purdue","usc","columbia","columbiabusiness"],function(a){g===a&&(e.push("color"+a[0].toUpperCase()+a.substring(1)),e.push("typography"+a[0].toUpperCase()+a.substring(1)))}),d.episode.styles=angular.copy(e)}c.deriveEpisode(d.episode),c.resolveEpisodeContainers(d.episode._id),c.resolveEpisodeEvents(d.episode._id)}),d.dismissalWatcher=a.$on("player.dismissAllPanels",d.cancelEdit),d.cancelEdit=function(){d.cancelEpisodeEdit(d.uneditedEpisode)},d.$on("$destroy",function(){d.watchEdits(),d.dismissalWatcher(),d.languageWatcher()})}}}]),angular.module("com.inthetelling.story").directive("ittItemEditor",["$rootScope","appState","modelSvc","timelineSvc","awsSvc","dataSvc",function(a,b,c,d,e,f){return{restrict:"A",replace:!0,scope:{item:"=ittItemEditor"},templateUrl:"templates/producer/item.html",controller:"EditController",link:function(g){if(g.uploadStatus=[],g.uneditedItem=angular.copy(g.item),g.annotators=c.episodes[b.episodeId].annotators,g.itemForm={transition:"",highlight:"",color:"",typography:"",timestamp:""},g.prevScene=d.prevScene,g.item.layouts||(g.item.layouts=["inline"]),g.item.styles)for(var h in g.itemForm)for(var i=0;i<g.item.styles.length;i++)g.item.styles[i].substr(0,h.length)===h&&(g.itemForm[h]=g.item.styles[i].substr(h.length));g.itemEditor="templates/producer/item/"+b.product+"-"+g.item.producerItemType+".html",g.appState=b,g.watchEdits=g.$watch(function(){return g.item},function(){c.resolveEpisodeEvents(b.episodeId),c.cache("event",g.item)},!0),g.watchStyleEdits=g.$watch(function(){return g.itemForm},function(){var a=[];for(var b in g.itemForm)g.itemForm[b]&&a.push(b+g.itemForm[b]);g.item.styles=a},!0),g.forcePreview=function(){b.editEvent.fnord=b.editEvent.fnord?"":"fnord"},g.setItemTime=function(){g.item&&(g.item.start_time=b.time,g.item.stop?g.item.end_time=g.item.start_time:(c.resolveEpisodeEvents(b.episodeId),(g.item.end_time<=g.item.start_time||g.item.end_time>c.events[g.item.scene_id].end_time)&&(g.item.end_time=c.events[g.item.scene_id].end_time))),d.updateEventTimes(g.item),d.seek(b.time)},g.setItemEndTime=function(){(g.item.end_time<=g.item.start_time||g.item.end_time>c.events[g.item.scene_id].end_time)&&(g.item.end_time=c.events[g.item.scene_id].end_time),d.updateEventTimes(g.item)},g.watchSeek=g.$watch(function(){return b.time},function(a,b){a!==b&&g.item&&g.setItemTime()}),g.dismissalWatcher=a.$on("player.dismissAllPanels",g.cancelEdit),g.cancelEdit=function(){g.cancelEventEdit(g.uneditedItem)},g.uploadAsset=function(a){g.uploads=e.uploadFiles(a),g.uploads[0].then(function(a){c.cache("asset",a.file),g.item.asset=c.assets[a.file._id],"Upload"===g.item._type?g.item.asset_id=a.file._id:"Link"===g.item._type?g.item.link_image_id=a.file._id:"Annotation"===g.item._type&&(g.item.annotation_image_id=a.file._id),delete g.uploads},function(){},function(a){g.uploadStatus[0]=a})},g.deleteAsset=function(a){window.confirm("Are you sure you wish to delete this asset?")&&(delete c.events[g.item._id].asset,delete g.item.asset_id,delete c.events[g.item._id].asset_id,delete g.item.link_image_id,delete c.events[g.item._id].link_image_id,delete g.item.annotation_image_id,delete c.events[g.item._id].annotation_image_id,delete g.item.asset,f.deleteAsset(a))},g.detachAsset=function(a){a&&(delete c.events[g.item._id].asset,delete g.item.asset,delete g.item.asset_id,delete g.item.link_image_id,delete g.item.annotation_image_id)},g.$on("$destroy",function(){g.watchEdits(),g.watchSeek(),g.dismissalWatcher(),g.watchStyleEdits()})}}}]),angular.module("com.inthetelling.story").directive("ittVideo",["$timeout","$interval","$rootScope","appState","timelineSvc",function(a,b,c,d,e){var f=0;return{restrict:"A",replace:!0,templateUrl:"templates/video.html",controller:"VideoController",scope:{video:"=ittVideo"},link:function(g,h){g.appState=d,g.uid=++f,a(function(){if(g.video)g.initVideo(h);else var a=g.$watch(function(){return g.video},function(b){b&&(a(),g.initVideo(h))})}),g.videoClick=function(){"paused"===d.timelineState?e.play():e.pause()},g.spaceWatcher=c.$on("userKeypress.SPACE",g.videoClick),g.bufferInterval=b(function(){if(g.getBufferPercent){var a=g.getBufferPercent();a>98&&(b.cancel(g.bufferInterval),d.bufferedPercent=100)}},200),g.$on("$destroy",function(){g.spaceWatcher(),b.cancel(g.bufferInterval)})}}}]),angular.module("com.inthetelling.story").directive("ittMagnetized",["$rootScope","$timeout","appState",function(a,b,c){return{restrict:"A",replace:!0,scope:!0,link:function(d,e){var f=16/9,g=function(a){d.unwatch&&d.unwatch(),d.magnet=$(a),d.unwatch=d.$watch(function(){return{top:d.magnet.offset().top-e.offset().top,left:d.magnet.offset().left-e.offset().left,width:d.magnet.width()-e.width(),winWidth:c.windowWidth,winHeight:c.windowHeight}},h,!0)},h=function(){b(function(){e.css("position","fixed"===d.magnet.css("position")?"fixed":"absolute");var a=d.magnet.offset().top-e.offset().top,b=d.magnet.offset().left-e.offset().left,c=d.magnet.width()-e.width();e.offset(Math.abs(a)>1||Math.abs(b)>1?{top:e.offset().top+a/4,left:e.offset().left+b/4}:d.magnet.offset()),e.width(Math.ceil(Math.abs(c)>4?e.width()+c/4:d.magnet.width())),e.height(Math.ceil(d.magnet.width()/f))})};a.$on("magnet.changeMagnet",function(a,b){g(b)}),d.$on("$destroy",function(){d.unwatch()})}}}]),angular.module("com.inthetelling.story").directive("ittMagnet",["$rootScope",function(a){return{restrict:"A",replace:!0,scope:!0,link:function(b,c){b.unwatchVisibility=b.$watch(function(){return c.is(":visible")},function(b){b&&a.$emit("magnet.changeMagnet",c)}),"watchModeVideoMagnet"===c.attr("id")&&(b.unwatchSize=b.$watch(function(){return{w:angular.element(window).width(),h:angular.element(window).height(),v:c.is(":visible")}},function(){var b=angular.element(window),d=b.height()-46;c.width(b.width()/d>16/9?16/9*d:b.width()),a.$emit("magnet.changeMagnet",c)},!0)),b.$on("$destroy",function(){b.unwatchVisibility(),b.unwatchSize&&b.unwatchSize()})}}}]),angular.module("com.inthetelling.story").directive("ittSearchPanel",function(){return{restrict:"A",replace:!0,scope:!0,templateUrl:"templates/searchpanel.html",controller:"SearchPanelController",link:function(a){a.indexEvents()}}}),angular.module("com.inthetelling.story").directive("ittContainerEpisodes",["modelSvc","recursionHelper","appState",function(a,b,c){return{restrict:"A",replace:!1,scope:{container:"=ittContainerEpisodes"},templateUrl:"templates/containerepisodes.html",compile:function(d){return b.compile(d,function(b){b.containers=a.containers,b.crossEpisodePath=c.crossEpisodePath,b.episodeId=c.episodeId})}}}]),angular.module("com.inthetelling.story").controller("EpisodeListController",["$scope","config","dataSvc",function(a,b,c){a.loading=!0,c.getAllContainers().then(function(b){a.containers=b,a.loading=!1})}]),angular.module("com.inthetelling.story").controller("UploadController",["$scope","config","awsSvc",function(a,b,c){a.loading=!0,c.getBucketListing().then(function(b){a.bucket_objects=b.Contents,a.loading=!1}),a.loading=!0,c.getMultipartUploads().then(function(b){a.uploads_in_progress=b,a.upload_parts=[];for(var d=0;d<b.Uploads.length;d++)c.getMultipartUploadParts(d,b.Uploads[d]).then(function(b){a.upload_parts[b.i]=b.parts,a.loading=!1})}),a.uploadFiles=function(){a.upload_status=[],a.uploads=c.uploadFiles(document.getElementById("file").files);for(var b in a.uploads)!function(b){var c=a.uploads[b];c.then(function(b){a.upload_result=b},function(){},function(c){a.upload_status[b]=c})}(b)},a.pauseUpload=function(){c.pauseUpload()},a.resumeUpload=function(){c.resumeUpload()},a.cancelUpload=function(){c.cancelUpload()},a.networkError=function(){c.networkError()},a.deleteObject=function(a){c.deleteObject(a)},a.cancelMultipartUpload=function(a){c.cancelMultipartUpload(a)}}]),angular.module("com.inthetelling.story").directive("sxsAddContent",["appState",function(a){return{restrict:"A",replace:!0,scope:{},templateUrl:"templates/producer/addcontent.html",controller:"EditController",link:function(b){b.appState=a,b.expand=function(){b.expanded=!0,angular.element(document).one("mouseup.addcontent",function(){b.collapse()})},b.collapse=function(){b.expanded=!1}}}}]),angular.module("com.inthetelling.story").directive("sxsInputTime",["appState",function(a){return{require:"ngModel",link:function(b,c,d,e){e.$parsers.push(function(b){var c;if(void 0===b||""===b)c=a.time;else if(isNaN(b)){var d=b.split(":");2===d.length?(isNaN(d[0])&&(d[0]=0),isNaN(d[1])&&(d[1]=0),c=60*+d[0]+ +d[1]):c=a.time}else c=b;return.01>c&&(c=.01),c}),e.$formatters.push(function(a){var b=Math.floor(a/60)+":"+("0"+Math.floor(a)%60).slice(-2),c=(a+"").slice(4,6);return""!==c&&(b=b+"."+c),b})}}}]),angular.module("com.inthetelling.story").directive("sxsAnnotatorAutocomplete",["modelSvc","$timeout","appState",function(a,b,c){return{require:"ngModel",templateUrl:"templates/producer/annotator-autocomplete.html",scope:{annotators:"=sxsAnnotatorAutocomplete",item:"=item"},link:function(d,e,f,g){d.appState=c,angular.forEach(d.annotators,function(b){b.annotation_image_id&&(b.imageUrl=a.assets[b.annotation_image_id].url)}),d.annotator={name:d.item.annotator},d.annotators[d.item.annotator]&&d.annotators[d.item.annotator].annotation_image_id&&(d.annotator.imageUrl=a.assets[d.annotators[d.item.annotator].annotation_image_id].url),d.searchText=d.item.annotator[c.lang],d.filteredAnnotators=angular.copy(d.annotators),d.preselectedItem=-1,e.find(".annotatorChooser").bind("keydown",function(a){switch(a.which){case 40:d.preselectedItem=(d.preselectedItem+1)%Object.keys(d.filteredAnnotators).length;break;case 38:d.preselectedItem=(d.preselectedItem-1)%Object.keys(d.filteredAnnotators).length;break;case 13:a.preventDefault(),d.preselectedItem>-1&&d.selectByIndex(d.preselectedItem)}}),d.handleAutocomplete=function(){if(d.annotator.name="",d.searchText){d.preselectedItem=-1;var a={};angular.forEach(d.annotators,function(b){b.key.toLowerCase().indexOf(d.searchText.toLowerCase())>-1&&(a[b.key]=b)}),d.filteredAnnotators=a,1===Object.keys(d.filteredAnnotators).length&&(d.preselectedItem=0),d.allowAddNew=0===Object.keys(d.filteredAnnotators).length}else d.filteredAnnotators=angular.copy(d.annotators),d.allowAddNew=!1,d.preselectedItem=-1},d.selectByIndex=function(a){if(!(0>a)){var b=Object.keys(d.filteredAnnotators).sort();d.select(d.filteredAnnotators[b[a]])}},d.select=function(b){d.preselectedItem=-1,b.annotation_image_id?(d.item.annotation_image_id=b.annotation_image_id,d.item.asset=a.assets[b.annotation_image_id],d.annotator.imageUrl=d.item.asset.url):(delete d.annotator.imageUrl,delete d.item.asset),g.$setViewValue(b.name),d.searchText=b.key},d.autoCompleting=!1,d.showAutocomplete=function(){var a=e.find(".annotatorChooser")[0];a.setSelectionRange(0,a.value.length),d.autoCompleting=!0},d.hideAutocomplete=function(){b(function(){d.preselectedItem>-1&&d.selectByIndex(d.preselectedItem),d.autoCompleting=!1},300)},d.addNewAnnotator=function(){var a=d.searchText,b={name:{en:a},imageUrl:"",annotation_image_id:!1};"en"!==c.lang&&(b.name[c.lang]=a),d.annotators[a]=angular.copy(b),d.annotator=angular.copy(b),delete d.annotator.imageUrl,g.$setViewValue(a[c.lang]),d.handleAutocomplete()},d.uploadAnnotatorImage=function(){window.alert("TODO")}}}}]),angular.module("com.inthetelling.story").directive("sxsInputI18n",["appState",function(a){return{templateUrl:"templates/producer/inputi18n.html",scope:{field:"=sxsInputI18n",inputtype:"=inputtype"},link:function(b){b.appState=a}}}]),angular.module("com.inthetelling.story").controller("ContainerAssetsTestController",["$scope","$routeParams",function(a,b){a.containerId=b.containerId}]).directive("sxsContainerAssets",["$routeParams","recursionHelper","dataSvc","modelSvc",function(a,b,c,d){return{restrict:"A",replace:!1,scope:{containerId:"=sxsContainerAssets"},templateUrl:"templates/producer/container-assets.html",compile:function(a){return b.compile(a,function(a){d.containers[a.containerId]?d.containers[a.containerId].assetsHaveLoaded||c.getContainerAssets(a.containerId):c.getContainer(a.containerId),a.container=d.containers[a.containerId],a.assets=d.assets,a.up=function(){a.showParent=!0}})}}}]);