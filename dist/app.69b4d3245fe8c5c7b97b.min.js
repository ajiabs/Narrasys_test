webpackJsonp([0],{"+ViR":function(t,e){var n="templates/producer/item/producer-file.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- <span class="eventIcon icon-file"></span> --\x3e\n\n\x3c!--DEPRECATED WITH PRODUCER V1 --\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Title [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.title" x-inputtype="\'input\'" autofocus></div>--\x3e\n\x3c!--</div>--\x3e\n\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">File--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input" ng-include="\'templates/producer/upload-producer.html\'">--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Description [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.description" x-inputtype="\'textarea\'"></div>--\x3e\n\x3c!--</div>--\x3e\n')}]),t.exports=n},"+o/S":function(t,e){var n="templates/item/modal.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="modal" ng-style="modalStyle" ng-click="dismiss();">\n  <span ng-if="item._type == \'Link\'" ng-click="$event.stopPropagation()">\n    <div class="modalmenu">\n      <a href="{{item.url}}" target="_blank" class="escapelink">(new window)</a>\n    </div>\n\t<itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n\t<itt-video\n\t\tng-if="item.isVideoUrl"\n\t\tmedia-src-arr="[item.url]"\n\t\tplayer-id="item._id"\n\t\tmain-player="false">\n\t</itt-video>\n  </span>\n  <span ng-if="item._type == \'Upload\'">\n    <span ng-switch="item.asset.content_type.indexOf(\'image/\')">\n      <span ng-switch-when="-1">\n        <div class="modalmenu">\n          <a href="{{item.asset.url}}" target="_blank" class="escapelink">(new window)</a>\n        </div>\n        <itt-iframe x-src="{{item.asset.url}}" item="item" x-contenttype="{{item.asset.content_type}}"></itt-iframe>\n      </span>\n      <span ng-switch-default>\n        <div class="modalimage" ng-if="item._type == \'Upload\'">\n          <img ng-src="{{item.asset.url}}">\n        </div>\n      </span>\n    </span>\n  </span>\n</div>\n')}]),t.exports=n},"/EO3":function(t,e,n){t.exports=n.p+"images/eliterate-logo.5a6d4df662628d18f39bd41cec77fbc0.svg"},0:function(t,e){t.exports=angular},"0ePo":function(t,e){var n="templates/item/question-mc-inner.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="question item__text">\n\n\t<p ng-bind-html="plugin.questiontext | i18n"></p>\n\t<div ng-if="!showChart">\n\n\t\t<div ng-repeat="distractor in choices">\n\t\t\t<div ng-if="(distractor.text | i18n) != \'\'">\n\t\t\t\t<label ng-class="{\n\t\t\t\t\tcorrect: plugin.hasBeenAnswered && distractor.correct,\n\t\t\t\t\tincorrect: plugin.hasBeenAnswered && !distractor.correct\n\t\t\t\t}">\n\t\t\t\t\t<input ng-change="scoreQuiz($index)" type="radio" name="fnord" ng-model="index" ng-disabled="plugin.hasBeenAnswered" value="{{$index}}" ng-checked="distractor.selected">\n\t\t\t\t\t<span ng-bind-html="distractor.text | i18n"></span>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="plugin.hasBeenAnswered" ng-bind-html="feedback() | i18n"></div>\n\t</div>\n\n\t<div ng-if="showChart">\n\t\t<div ng-if="!plugin.hasBeenAnswered" ng-repeat="distractor in plugin.distractors">\n\t\t\t<div ng-if="(distractor.text | i18n) != \'\'">\n\t\t\t\t<label>\n\t\t\t\t\t<input ng-change="scorePoll($index)" type="radio" name="fnord" ng-disabled="plugin.hasBeenAnswered" ng-model="$parent.plugin.selectedDistractor" value="{{$index}}">\n\t\t\t\t\t<span ng-bind-html="distractor.text | i18n"></span>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\t\t<br>\n\t\t<div ng-if="plugin.hasBeenAnswered">\n\t\t\t<p ng-if="plugin.selectedDistractor">Here\'s how others answered this question. (Your choice was:\n\t\t\t\t<b ng-repeat="distractor in plugin.distractors | filter:{ index: plugin.selectedDistractor }" ng-bind-html="distractor.text | i18n"></b>)\n\t\t\t</p>\n\n\t\t\t<itt-flotr2-chart type="{{chartType}}" title="" data="{{chartData}}" options="{{chartOptions}}"></itt-flotr2-chart>\n\t\t</div>\n\t</div>\n</div>\n')}]),t.exports=n},"1Wv5":function(t,e,n){var i="templates/toolbar-story.html",a='<div class="toolbar">\n  <div class="buttongroup nav-item scene-nav-btns">\n    <a ng-if="appState.productLoadedAs == \'narrative\' && !narrative.disable_navigation"\n       class="button button-exitEpisode" href="/#/story/{{narrative.path_slug.en}}">\n      <span>Exit</span>\n    </a>\n    <button tabindex="0" class="button button-nav" ng-click="toggleNavPanel();">\n      <span>Chapters</span>\n    </button>\n\n    \x3c!-- \t\t<button ng-click="tmp()">TMP</button>\n --\x3e\n  </div>\n\n  <div class="nav-item toolbar-logos">\n    <img src="'+n("teY+")+'"\n         id="toolbar-logo-big"\n         ng-if="episode.templateUrl === \'templates/episode/narrasys-pro.html\' && appState.windowWidth > 500">\n\n    <img src="'+n("5Tuk")+'"\n         id="toolbar-logo-small"\n         ng-if="episode.templateUrl === \'templates/episode/narrasys-pro.html\' && appState.windowWidth <= 500"/>\n  </div>\n\n  \x3c!--if we are a player, isFramed--\x3e\n  <div class="nav-item new-window-btn">\n    <div ng-if="appState.isFramed && (appState.productLoadedAs == \'player\'\n\t \t\t\t|| (appState.productLoadedAs == \'narrative\'\n\t \t\t\t&& !narrative.disable_new_window ) )" class="escapegroup buttongroup">\n      \x3c!-- this needs to be an <a> or it trips popup blockers --\x3e\n      <a class="button button-mainframeescape" ng-click="pause()"\n         ng-href="{{newWindowUrl}}&t={{playbackService.getMetaProp(\'time\')|| 0}}&access_token={{appState.user.access_token}}"\n         target="_blank">\n        <span>New window</span>\n      </a>\n    </div>\n  </div>\n  <div class="nav-item searchgroup buttongroup" ng-class="{cur: show.searchPanel}">\n    <button tabindex="2" class="button button-search" ng-click="toggleSearchPanel()" aria-label="Search"\n            aria-expanded="{{show.searchPanel}}">\n      <span>Search</span>\n    </button>\n    <label for="searchtext" class="hidden">Search Text</label>\n    <input tabindex="2" name="searchtext" id="searchtext" type="text" ng-show="show.searchPanel"\n           ng-model="appState.searchText" ng-model-options="{ debounce: 200 }"/>\n  </div>\n  <div class="nav-item socialshare social-buttongroup">\n    <itt-social-share\n      ng-if="socialShareInfo"\n      subdomain="{{socialShareInfo.subDomain}}"\n      paths="{narrative: socialShareInfo.narrative, timeline: socialShareInfo.timeline}"\n      share-title="{{socialShareInfo.tlTitle}}"\n      providers="[\'facebook\', \'linkedin\', \'twitter\', \'google\', \'reddit\', \'email\']">\n    </itt-social-share>\n  </div>\n  \x3c!-- for now, hide user panel in regular player. TODO maybe show it for non-guest users here? --\x3e\n  <div class="nav-item profilegroup buttongroup">\n    <a class="button button-preview"\n       ng-if="appState.productLoadedAs==\'producer\' && (userHasRole(\'admin\') || userHasRole(\'customer admin\'))"\n       ng-click="toggleProducerPreview()">\n      <span ng-if="appState.product == \'producer\'">Preview</span>\n      <span ng-if="appState.product == \'player\'">Edit</span>\n    </a>\n    <a class="button button-profile"\n       ng-hide="isTrueGuest()"\n       ng-click="appState.show.profilePanel = !appState.show.profilePanel">\n      <span>Profile</span>\n    </a>\n  </div>\n</div>\n\n<div ng-cloak ng-show="show.navPanel" class="navPanel topDrawer" ng-class="episode.styleCss">\n  <div class="parent" ng-repeat="parent in episode.parents" ng-bind-html="parent.display_name"></div>\n  <h2 ng-bind-html="episode.display_title" class="fakeLink" ng-click="seek(0)"></h2>\n  <div class="scene" x-ng-if="chapter.display_annotation || chapter.display_title"\n       x-ng-repeat="chapter in episode.chapters" x-ng-class="{currentScene: chapter.isCurrent}"\n       x-ng-click="seek(chapter.start_time)">\n    <span class="displayTime">{{chapter.displayStartTime}}</span>\n    <p>\n      <button class="fakeLink" tabindex="0" ng-bind-html="chapter.display_annotation || chapter.display_title"\n              x-ng-class="{sceneLink: !chapter.isCurrent}" ng-focus="showControls()"></button>\n      <br>\n      <span ng-bind-html="chapter.display_description"></span>\n    </p>\n  </div>\n  \x3c!--\n  <div class="crossEpisode">\n    <a class="prevEpisode" ng-if="episode.previousEpisodeContainer" ng-href="/#/{{appState.crossEpisodePath}}/{{episode.previousEpisodeContainer.episodes[0]}}" title="{{episode.previousEpisodeContainer.display_name}}">Previous episode</a>\n    <a class="nextEpisode" ng-if="episode.nextEpisodeContainer" ng-href="/#/{{appState.crossEpisodePath}}/{{episode.nextEpisodeContainer.episodes[0]}}" title="{{episode.nextEpisodeContainer.display_name}}">Next Episode</a>\n  </div>\n --\x3e\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"2+b9":function(t,e){var n="templates/item/sxs-annotation.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemTemplate sxs-item">\n\t<a class="edit-event" ng-click="editItem()" ng-if="item.editableByThisUser">[Edit]</a>\n\t<div class="avatar">\n\t\t<img ng-src="{{item.avatar.url || appState.noAvatar}}">\n\t</div>\n\t<div class="itemHead">\n\t\t<div class="authorName" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div class="text" ng-bind-html="item.annotation.en"></div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},"2/3b":function(t,e){var n="templates/item/caption.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- used in watch mode.  Will have a different style of content editing there, so no editItem button for now --\x3e\n<div class="itemTemplate itemCaption">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="authorName" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div class="text" ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},"2n3E":function(t,e,n){var i="templates/episode/washingtonSBCTC.html",a='<div class="episode episode-wsbctc" ng-class="episode.styleCss">\n\t<div class="fill bigwsbctc"></div>\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent"\n\t\t  ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<div id="branding-wrapper">\n\t\t\t<img src="'+n("AYkA")+'" id="sbctc-logo" alt="Washington SBCTC logo"/>\n\t\t\t<a id="itt-logo" href="//inthetelling.com" target="_blank">\n\t\t\t\t<img src="'+n("wIHC")+'" alt="In The Telling logo">\n\t\t\t</a>\n\t\t</div>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"2qXd":function(t,e,n){var i="templates/scene/2colL.html",a='<div class="scene twocol" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="videoPositioner">\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t</div>\n\t<div class="col col1">\n\t\t<div class="pane mainPane">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in (mainBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (mainContentItems | isCurrent).length == 1\n\t\t\t\t\t: (mainContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: mainContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: mainContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: mainContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<img src="'+n("rXKF")+'" class="matchVideoHeight ">\n\t\t\t\t<div class="clear"></div>\n\t\t\t\t<div class="item animate" ng-repeat="item in showCurrent ? (mainContentItems | isCurrent) : mainContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="clear "></div>\n\t\t</div>\n\t\t<div class="fill fgLayer overlay">\n\t\t\t<div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t</div>\n\t</div>\n\t<div class="col col2">\n\t\t<div class="pane altPane">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in (altBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (altContentItems | isCurrent).length == 1\n\t\t\t\t\t: (altContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: altContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: altContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: altContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<img src="'+n("rXKF")+'" class="matchVideoHeight ">\n\t\t\t\t<div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear "></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in (altFgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"3gcz":function(t,e){var n="templates/item/text-transmedia.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n\n<div>\n\t<div class="itemTemplate">\n\t\t<div class="itemHead">\n\t\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t\t<div class="item__title">\n\t\t\t\t<h2 class="item__title item__title--transmedia" ng-if="item.display_title | highlightSubstring: appState.searchText" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></h2>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="text item__text item__text--transmedia" ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},"3hY0":function(t,e,n){t.exports=n.p+"images/eliterate-mindwires.649b951e65b02bb2031d7a4880368eeb.svg"},"3vSo":function(t,e,n){t.exports=n.p+"images/purdue-logo.bd94d6c891348bb7892e668b4dea0bcc.svg"},"4JKO":function(t,e,n){var i="templates/episode/episode.html",a='<div class="episode professional unbranded" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent"\n\t\t  ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="professional__branding branding footer">\n\t\t<div class="branding--content">\n\t\t\t<nys-copyright class="professional__copyright"></nys-copyright>\n\n\t\t\t<a class="professional__logo" href="//narrasys.com" target="_blank">\n\t\t\t\t<img src="'+n("PtaW")+'" alt="In The Telling logo">\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"4bbU":function(t,e){var n="templates/narrativelist.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="">\n\n\n  <itt-modal wrapper-class="responsive-modal__wrapper" modal-class="narrative__modal" ng-if="$ctrl.narrativeSelect || $ctrl.narrativeToEdit">\n    <h3>{{$ctrl.narrativeSelect ? \'Add\' : \'Edit\'}} Narrative</h3>\n\n    <itt-narrative-editor\n      customers="$ctrl.selectedCustomer"\n      narrative="$ctrl.narrativeToEdit"\n      hide-path-slug="$ctrl.narrativeSelect"\n      on-done="$ctrl.closeAddOrEditModal()"\n      on-update="$ctrl.addOrUpdateNarrative(n)">\n    </itt-narrative-editor>\n\n  </itt-modal>\n\n  <div ng-repeat="customer in $ctrl.customersData"\n       ng-click="$ctrl.customerRowClick(customer, $event)"\n       ng-class="$ctrl.setRowClasses(customer)">\n    \x3c!--drop down arrow--\x3e\n    <span ng-click="$ctrl.toggleRow(customer, $event)" ng-class="customer.showNarratives ? \'isOpen\' : \'isClosed\'">\n    </span>\n\n    <a>{{customer.name}}</a>\n\n    <div ng-if="customer.isActive === true">\n      <div ng-if="$ctrl.canAccess" style="padding-left: 1em;">\n        <itt-tooltip tip-text="Add Narrative">\n          <a class="icon__button button__add-inverted" ng-click="$ctrl.setSelectedNarrative(customer)"></a>\n        </itt-tooltip>\n      </div>\n    </div>\n\n    <div ng-repeat="narrative in customer.narratives"\n         style="padding-left: 2em;"\n         ng-if="customer.showNarratives === true"\n         ng-click="$ctrl.toggleNarrativeRow(narrative, $event)"\n         ng-class="$ctrl.setNarrativeRowClasses(customer, narrative)">\n      <div>\n        <itt-edit-pencil can-access="true" on-edit="$ctrl.setNarrativeToEdit($event, narrative, customer)">\n          <a>{{narrative.name.en}}</a>\n        </itt-edit-pencil>\n        <p ng-if="narrative.description">\n          <small>{{narrative.description.en}}</small>\n        </p>\n\n        <div ng-if="$ctrl.narrativeRow._id === narrative._id">\n          <itt-tooltip tip-text="Go to Narrative">\n            <a ng-click="$ctrl.gotoNarrative(narrative._id, $event)" class="icon__button button__generateNarrative" title="Go to Narrative"></a>\n          </itt-tooltip>\n          <a itt-guest-accessible-url narrative="narrative" clipboard-mode="Click to Copy"></a>\n        </div>\n\n\n\n      </div>\n    </div>\n\n  </div>\n</div>\n')}]),t.exports=n},"55GB":function(t,e){var n="templates/item/searchresults-all.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span ng-class="{\'sxs-item\': item.sxs}">\n  <a ng-if="item.editableByThisUser" class="edit-event" ng-click="editItem()">\n    <span>Edit item</span>\n  </a>\n  <div ng-style="\n    item.sxs?{background:\'url(\'+item.avatar.url+\') no-repeat scroll right top / 40px 40px\',minHeight:\'40px\'}:{}\n    " ng-class="{isCosmetic: item.cosmetic}" class="itemTemplate">\n    <div class="itemHead">\n      <a role="button" aria-label="Seek video to {{item.displayStartTime}}" ng-if="item._type !== \'Chapter\' && !item.chapter_marker" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n      <div class="category item__title">\n        \x3c!--{{item.category}}--\x3e\n        <span ng-if="item.required">(Required viewing)</span>\n      </div>\n      <div ng-if="item.display_annotator && item.producerItemType !== \'annotation\' || item.isPq" class="authorName" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n      <div ng-if="item.producerItemType == \'annotation\' && item.display_title && !item.isHeader && !item.isPq" class="authorName" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n      <span ng-if="item._type != \'Annotation\' && item._type !== \'Chapter\'">\n        <a tabindex="0" ng-if="handleOutgoingLinkDisplay()" class="fakeLink escapelink item__link--escape-link item__link--fake-link" ng-click="outgoingLink(item.url)" ng-bind-html="(item.display_title || \'(Untitled)\') | highlightSubstring: appState.searchText"></a>\n        <a tabindex="0" role="button" class="fakeLink item__link--fake-link" ng-if="!handleOutgoingLinkDisplay()" x-ng-keypress="toggleDetailOnKeyPress($event)" ng-click="item.showInlineDetail=!item.showInlineDetail" ng-bind-html="(item.display_title || \'(Untitled)\') | highlightSubstring: appState.searchText" aria-label="Toggle detail display of {{item.display_title}}"></a>\n      </span>\n\t\t<span ng-if="item._type === \'Chapter\' || item.chapter_marker">\n\t\t\t<h2 class="searchChapter" ng-bind-html="(item.display_annotation || item.display_title) | highlightSubstring: appState.searchText"></h2>\n\t\t</span>\n    </div>\n    <div class="text item__text">\n      \x3c!-- TODO display header/pullquote differently? --\x3e\n      <div ng-class="{showAsHeader: item.showAsHeader}" ng-if="!item.chapter_marker" ng-bind-html="item.display_annotation || item.display_description | highlightSubstring: appState.searchText"></div>\n    </div>\n    <div class="itemDetail" ng-if="item.showInlineDetail">\n      <span ng-switch="item.producerItemType">\n        <span ng-switch-when="file">\n          <a tabindex="0" x-ng-keypress="outgoingLinkOnKeyPress(item.asset.url,$event)" ng-click="outgoingLink(item.asset.url)" class="escapelink item__link--escape-link">(new window)</a>\n          <itt-iframe ng-if="appState.viewMode == \'review\'" x-src="{{item.asset.url}}" x-contenttype="{{item.asset.content_type}}"></itt-iframe>\n        </span>\n        <span ng-switch-when="link">\n          <a tabindex="0" ng-if="!item.noExternalLink" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" class="escapelink item__link--escape-link">(new window)</a>\n\t\t\t<itt-iframe ng-if="!item.isVideoUrl && appState.viewMode == \'review\'" x-src="{{item.url}}" item="item"></itt-iframe>\n            <itt-video\n\t\t\t\tng-if="item.isVideoUrl && appState.viewMode == \'review\'"\n\t\t\t\tmedia-src-arr="[item.url]"\n\t\t\t\tplayer-id="item._id"\n\t\t\t\tmain-player="false">\n            </itt-video>\n        </span>\n        <span ng-switch-when="video">\n          <span ng-switch-when="file">\n\t\t\t  <itt-video\n\t\t\t\t  ng-if="item.isVideoUrl && appState.viewMode == \'review\'"\n\t\t\t\t  media-src-arr="[item.url]"\n\t\t\t\t  player-id="item._id"\n\t\t\t\t  main-player="false">\n            </itt-video>\n            <a tabindex="0" x-ng-keypress="outgoingLinkOnKeyPress(item.asset.url,$event)" ng-click="outgoingLink(item.asset.url)" class="escapelink item__link--escape-link">(new window)</a>\n          </span>\n        </span>\n        <span ng-switch-when="image">\n          <div class="touchable" style="position:relative">\n            <img ng-click="forceModal()" ng-src="{{item.asset.url}}">\n            <div class="touchableIndicator"></div>\n          </div>\n        </span>\n        <span ng-switch-when="question">\n          <div ng-if="item.asset.url" class="touchable">\n            <img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n            <div class="touchableIndicator"></div>\n          </div>\n          <itt-mc-question show-chart="item.data._plugin.questiontype == \'mc-poll\'" choices="item.data._plugin.distractors" on-choice="save" data="item.data._plugin" qid="item._id"></itt-mc-question>\n        </span>\n        <span ng-switch-default>\n          <span ng-if="item.data._pluginType == \'credlyBadge\'" ng-include="\'templates/item/usc-badges-inner.html\'"></span>\n          \x3c!-- no other plugin types at the moment... <pre ng-bind-html="item | pretty"></pre> --\x3e\n        </span>\n      </span>\n    </div>\n  </div>\n</span>\n')}]),t.exports=n},"5Tuk":function(t,e,n){t.exports=n.p+"images/Narrasys-Tree.cc1cd923afd67c6dc362c6aa5c3b5399.png"},"5iOH":function(t,e){var n="templates/producer/episodelist.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="standaloneAncillaryPage">\n\t<itt-nav on-logout="logout()"></itt-nav>\n\n\t<h1>Projects</h1>\n\t<div itt-episode-list>\n\t\t\x3c!-- TODO proper i18n --\x3e\n\t\t<div ng-if="userHasRole(\'admin\') || userHasRole(\'customer admin\')">\n\t\t\t\x3c!--<div class="ancillaryNav">--\x3e\n\t\t\t\t\x3c!--<a class="button" href="/#/stories">Narratives</a>--\x3e\n\t\t\t\t\x3c!--<a class="button" href="/#/account">Account</a>--\x3e\n\t\t\t\t\x3c!--<a class="button" ng-click="logout()">Log out</a>--\x3e\n\t\t\t\x3c!--</div>--\x3e\n\n\t\t\t<itt-loading ng-if="loading"></itt-loading>\n\t\t\t\x3c!--\n\t\t\t<div class="controls">\n\t\t\t\t<label>\n\t\t\t\t\t<input type="checkbox" ng-model="appState.dangerousButtons">&nbsp;Enable danger</label>\n\t\t\t\t<div ng-if="appState.dangerousButtons" STYLE="background-color:#F00; color:#FFF; padding: 1em">DANGER ENABLED. THERE IS NO UNDO.\n\t\t\t\t\t<br>\n\t\t\t\t\t<small> This message brought to you by the letter "B", for "Be careful what you delete!"</small>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t--\x3e\n\n\t\t\t<div ng-repeat="child in root.children"\n\t\t\t\t itt-container="containers[child._id]"\n\t\t\t\t ng-class="{\'container__row--odd\': containers[child._id].evenOdd === false, \'container__row--even\': containers[child._id].evenOdd === true }"\n\t\t\t\t depth="0"\n\t\t\t\t on-container-click="onContainerClick($container)"\n\t\t\t\t on-container-add="onContainerAdd($container)"\n\t\t\t\t add-root-context="onContainerAdd"\n\t\t\t\t click-root-context="onContainerClick">\n\n\t\t\t</div>\n\t\t\t<div ng-if="!(userHasRole(\'admin\') || userHasRole(\'customer admin\')) || (!loading && (failedLogin || root.children.length == 0))">\n\t\t\t\tLooks like you aren\'t logged in as an admin -- <a ng-click="logout();">try again</a>.\n\t\t\t</div>\n\t\t</div>\n\t</div>\n')}]),t.exports=n},"6+VC":function(t,e,n){var i="templates/episode/university-arizona.html",a='<div class="episode professional university-arizona" ng-class="episode.styleCss">\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent"\n\t\t  ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="professional__branding">\n\t\t<div class="branding--content">\n\t\t\t<nys-copyright class="professional__copyright"></nys-copyright>\n\t\t\t<img class="professional__logo" src="'+n("ebgR")+'"/>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"6/Qv":function(t,e,n){t.exports=n.p+"images/checkmark.80564877965f7d5b3ab0fccf3fde46c1.png"},"6fZU":function(t,e){var n="templates/item/question-mc-image-left.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category">\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text item__text--question-mc-image-left">\n\t\t<div class="title item__title item__title--question-mc-image-left" ng-if="item.display_title | highlightSubstring: appState.searchText" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n\t\t<div ng-if="item.asset.url" class="touchable" style="float:left; max-width: 50%; padding-right: 0.5em">\n\t\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t\t<div class="touchableIndicator"></div>\n\t\t</div>\n\t\t<itt-mc-question show-chart="item.data._plugin.questiontype == \'mc-poll\'" choices="item.data._plugin.distractors" on-choice="save" data="item.data._plugin" qid="item._id"></itt-mc-question>\n\t\t\t<div class="clear"></div>\n\t</div>\n</div>')}]),t.exports=n},"6ze8":function(t,e){var n="templates/narrative/default.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="">\n  <div ng-if="!loading">\n    <div class="narrative">\n\n      \x3c!-- begin display --\x3e\n      <div>\n        <itt-edit-pencil can-access="canAccess" on-edit="toggleEditNarrativeModal()">\n          <h2 ng-bind-html="narrative.name.en"></h2>\n        </itt-edit-pencil>\n        <p ng-bind-html="narrative.description.en"></p>\n        <p>Total Duration: {{totalNarrativeDuration | asTime}}</p>\n      </div>\n\n      \x3c!--\n     <div ng-if="narrative.user_id == user._id">You are the owner of this narrative</div>\n --\x3e\n      \x3c!--narrative action buttons row--\x3e\n      <div class="episode__button-row">\n        <div ng-if="canAccess">\n          \x3c!--overlay class is pointer-events: none, to disable clicks while editing.--\x3e\n          <itt-tooltip tip-text="Add Timeline" ng-class="{overlay: timelineUnderEdit || tmpTimeline}">\n            <a class="icon__button button__add-inverted" ng-click="addTmpTimeline(null, narrative.timelines)"></a>\n          </itt-tooltip>\n          <itt-tooltip tip-text="Export links to spreadsheet">\n            <a class="icon__button button__export-spreadsheet"\n               ng-click="exportToSpreadsheet(narrative._id)">\n            </a>\n          </itt-tooltip>\n          <itt-guest-accessible-url narrative="narrative" sub-domain="{{narrative.narrative_subdomain}}" clipboard-mode="Click to copy URL"></itt-guest-accessible-url>\n        </div>\n      </div>\n\n      \x3c!--modals--\x3e\n\n      \x3c!--add narrative modal top level--\x3e\n      <itt-modal ng-if="showEpisodeList">\n        <div itt-episode-list class="admin episodePicker">\n          \x3c!--Choose an episode: <button ng-click="toggleEpisodeList()">cancel</button>--\x3e\n          Choose an episode:\n          <button ng-click="toggleEpisodeList(); doneEditingTimeline()">cancel</button>\n          <ul\n            ng-repeat="child in root.children"\n            x-for-admin="true"\n            itt-container-episodes="containers[child._id]"\n            on-node-click="onEpisodeSelect(node)" root-context="onEpisodeSelect"\n            depth="0"></ul>\n        </div>\n      </itt-modal>\n\n      \x3c!--edit narrative or timeline modal--\x3e\n      <itt-modal wrapper-class="responsive-modal__wrapper" modal-class="narrative__modal"\n                 ng-if="editingNarrative || timelineUnderEdit != null">\n\n        <div ng-if="editingNarrative">\n\n          <itt-narrative-editor\n            narrative="narrative"\n            customers="customers"\n            on-done="toggleEditNarrativeModal()"\n            on-update="updateNarrative(n)">\n          </itt-narrative-editor>\n        </div>\n\n        <div ng-if="timelineUnderEdit != null">\n          <itt-timeline-editor\n            class="tl__editor"\n            timeline="timelineUnderEdit"\n            narrative="narrative"\n            container-id="{{customers[0].root_container_id}}"\n            on-done="doneEditingTimeline()"\n            on-update="editorAction(t, timelineUnderEdit)"\n            on-delete="deleteTimeline(t)">\n          </itt-timeline-editor>\n        </div>\n\n      </itt-modal>\n\n      \x3c!--end modals--\x3e\n\n\n      \x3c!--list of timelines--\x3e\n      <div ui-tree="treeOpts" ng-if="narrative.timelines.length !== 0">\n        <div ui-tree-nodes ng-model="narrative.timelines">\n          \x3c!--begin ng-repeat - note: do not use track by on ng-repeats with ui-tree--\x3e\n          <div class="storyTimeline hoverIndicator"\n               ng-class-even="\'container__row--even\'"\n               ng-class-odd="\'container__row--odd\'"\n               ng-mouseenter="rowHover = true"\n               ng-mouseleave="rowHover = false"\n               ui-tree-node\n               ng-repeat="timeline in narrative.timelines | filter: (canAccess === false || undefined) && {hidden: false}">\n\n            <div ng-class="{\'timeline--hidden\': timeline.hidden}">\n\n\t\t\t\t\t\t\t<span ng-show="canAccess && rowHover" class="tlDrag__handle" ui-tree-handle>\n\t\t\t\t\t\t\t\t<i class="fa fa-arrows"></i>\n\t\t\t\t\t\t\t</span>\n              <div class="tl__wrapper">\n                <itt-edit-pencil can-access="canAccess" force="rowHover && canAccess" on-edit="toggleEditingTimeline(timeline)">\n                  <h3>\n                    <i ng-if="timeline.hidden" class="fa fa-eye-slash"></i>\n                    <a href="/#/story/{{narrative._id}}/{{timeline._id}}">{{timeline.name.en}}</a>\n                  </h3>\n                </itt-edit-pencil>\n                <p>{{timeline.episode_segments[0].end_time | asTime}}</p>\n                <p>{{timeline.description.en}}</p>\n\n\n                <div class="tl__addButton">\n                  <div ng-if="rowHover && canAccess" class="episode__button-row">\n                    <div>\n                      <itt-tooltip tip-text="Insert Timeline">\n                        <a class="icon__button button__add-inverted"\n                           ng-click="addTmpTimeline(timeline, narrative.timelines)"></a>\n                      </itt-tooltip>\n                      <itt-guest-accessible-url\n                        narrative="narrative"\n                        timeline="timeline"\n                        clipboard-mode="Copy to Clipboard">\n                      </itt-guest-accessible-url>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n          </div>\n          \x3c!--end repeat--\x3e\n        </div>\n      </div>\n      \x3c!--end ui-tree--\x3e\n    </div>\n    \x3c!-- end display --\x3e\n  </div>\n</div>\n<a ng-if="narrative.support_url" target="_blank" ng-href="{{narrative.support_url}}">Support</a>\n</div>\n')}]),t.exports=n},"7GUz":function(t,e){var n="templates/item/transcript.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate transcript">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t</div>\n\t<div class="icon" style="float:left; margin-right: 0.5em;">\n\t\t<img ng-if="item.asset.url" ng-src="{{item.asset.url}}">\n\t\t<div class="clear"></div>\n\t</div>\n\t<div class="authorName item__title" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n\t<div class="text item__text item__text--transcript" ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},"7Kem":function(t,e,n){var i="templates/episode/regis.html",a='<div class="episode episode-regis" ng-class="episode.styleCss">\n\t<div class="fill bigregis"></div>\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"7XCA":function(t,e){var n="templates/item/image-thumbnail.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="thumbnail touchable" x-ng-class="{fullsize: item.showInlineDetail || item.isActive}" x-ng-click="toggleDetailView()">\n\t\t<img ng-src="{{item.asset.url}}">\n\t\t<div class="touchableIndicator"></div>\n\t</div>\n\t<div class="text item__text">\n\t\t<div class="title item__title item__title--image-thumbnail" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n\t\t<div class="text item__text item__text--image text--image-thumbnail" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},"81AW":function(t,e,n){var i="templates/episode/gw.html",a='<div class="episode episode-gw" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("BRlR")+'" alt="George Washington">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"84qX":function(t,e){var n="templates/item/pullquote.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate headerItem">\n\t<div class="category"></div>\n\t<div class="pullquote item__text item__text--pullquote" ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></div>\n\t<div class="pullquoteSpeaker" ng-if="item.display_annotator"> — <span ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></span></div>\n</div>\n')}]),t.exports=n},"888c":function(t,e){var n="templates/testbed-event.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<style>\n.testContentPane {\n\tborder: 1px solid #000;\n\tposition: absolute;\n\toverflow: hidden;\n\ttop: 3em;\n\tleft: 2em;\n\tright: 2em;\n\tbottom: 10em;\n}\n.testEditorPane {\n\tposition: absolute;\n\tbottom: 0;\n\tz-index: 2;\n\tleft: 0;\n\tright: 0;\n\theight: 10em;\n\toverflow-y: scroll;\n}\nlabel {\n\tmargin: 0 2em;\n}\n</style>\n\n\n<div class="controls">\n\t<label>\n\t\tContent pane type:\n\t\t<select size="1" ng-model="testbed.contentType" ng-init="testbed.contentType=\'content\'">\n\t\t\t<option value="content">Content</option>\n\t\t\t<option value="fill">Overlay</option>\n\t\t</select>\n\t</label>\n\n\t<label ng-if="testbed.contentType == \'content\'">\n\t\t<input type="checkbox" ng-model="testbed.isNarrow"> Narrow content pane\n\t</label>\n\t<label>\n\t\tItem state:\n\t\t<select size="1" ng-model="item.state" ng-init="item.state=\'isCurrent\'">\n\t\t\t<option value="isCurrent">Current</option>\n\t\t\t<option value="isPast">Past</option>\n\t\t\t<option value="isFuture">Future</option>\n\t\t</select>\n\t</label>\n\t<label>\n\t\t<input type="checkbox" ng-model="testbed.showCurrent" ng-init="testbed.showCurrent = false;"> Hide non-current items\n\t</label>\n\n</div>\n\n<div class="testContentPane allowHighlights allowSidebars hasLeftSidebar hasRightSidebar {{testbed.contentType}}" ng-class="{isNarrow: testbed.isNarrow, showCurrent: testbed.showCurrent}">\n\t<div ng-if="!(testbed.showCurrent && item.state!=\'isCurrent\')" class="item animate" itt-item="item" ng-class="item.styleCss + \' \' + item.state"></div>\n</div>\n\n<div class="testEditorPane" itt-item-editor="item"></div>\n')}]),t.exports=n},"8fXl":function(t,e){var n="templates/item/image-inline.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0"\tclass="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="touchable">\n\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t<div class="touchableIndicator"></div>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},"9ij1":function(t,e){var n="templates/timeline-story.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="timeline" ng-show="!isSuppressed" ng-cloak>\n\n\t<button tabindex="0" ng-focus="showControls()" class="button" ng-class="setBtnClass()" ng-click="timelineBtnClick()">\n\t\t<span class="control-text">{{controlText}}</span>\n\t</button>\n\n\t<div class="progressbarBox">\n\t\t<div class="pbarTop">\n\t\t\t<span ng-if="appState.product == \'producer\'">\n\t\t\t\t<a class="button button-zoomout" ng-if="zoomLevel != 1" ng-click="zoomOut()">\n\t\t\t\t\t<span class="control-text">Zoom out</span>\n\t\t\t\t</a>\n\t\t\t\t<small ng-if="zoomLevel != 1">Zoom: {{zoomLevel*100}}%</small>\n\t\t\t\t<a class="button button-zoomin" ng-click="zoomIn()">\n\t\t\t\t\t<span class="control-text">Zoom in</span>\n\t\t\t\t</a>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="pbarMain">\n\t\t\t<button ng-focus="showControls()" ng-class="{invisible: playbackService.getMetaProp(\'time\') == 0}" class="button button-prev" ng-click="prevScene()">\n\t\t\t\t<span class="control-text">Previous</span>\n\t\t\t</button>\n\t\t\t<button ng-focus="showControls()" tabindex="0" ng-class="{invisible: playbackService.getMetaProp(\'time\')>= playbackService.getMetaProp(\'duration\')- 0.1}" class="button button-next" ng-click="nextScene()">\n\t\t\t\t<span class="control-text">Next</span>\n\t\t\t</button>\n\n      \x3c!--<div ng-repeat="scene in timeline.markedEvents | isCurrent">--\x3e\n\n        \x3c!--<button class="button button-prev" ng-click="handleScene(scene, timeline.displayMarkedEvents, \'prevScene\')">--\x3e\n\n        \x3c!--</button>--\x3e\n\n        \x3c!--<button class="button button-next" ng-click="handleScene(scene, timeline.displayMarkedEvents, \'nextScene\')">--\x3e\n\n        \x3c!--</button>--\x3e\n      \x3c!--</div>--\x3e\n\n\n\n\n\t\t\t<div class="progressbar">\n\t\t\t\t<div class="mask">\n\t\t\t\t\t<div class="progressbarContainer" style="width: {{zoomLevel}}00%;">\n\t\t\t\t\t\t<div class="buffered" ng-style="{width: playbackService.getMetaProp(\'bufferedPercent\')+\'%\'}"></div>\n\t\t\t\t\t\t<div class="played" ng-style="{width: markerPercent(playbackService.getMetaProp(\'time\'))+\'%\'}"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- unmasked parts of timeline --\x3e\n\t\t\t\t<div class="progressbarContainer" style="width: {{zoomLevel}}00%;">\n\t\t\t\t\t<div class="handle" ng-show="isSeeking" ng-style="{left: markerPercent(willSeekTo)+\'%\'}">\n\t\t\t\t\t\t<div class="tip" ng-show="seekHandleVisible">{{willSeekTo | asTime}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="tooltip" ng-if="eventGroup.showTooltip" ng-repeat="eventGroup in timeline.displayMarkedEvents" ng-style="{left: markerPercent(eventGroup.start_time)+\'%\'}">\n\t\t\t\t\t\t<span class="content">{{eventGroup.toolTipText}}</span>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t\x3c!-- draggable handles for start/end time editing. TODO make draggable, move them somewhere\n\t\t\t\t\tthat doesn\'t incidentally trigger setting appState.time --\x3e\n\n\t\t\t\t\t<div class="handle sxsHandle playhead" ng-show="appState.editEvent" ng-style="{left: markerPercent(appState.editEvent.start_time)+\'%\'}">\n\t\t\t\t\t\t<div class="tip" ng-click="">{{appState.editEvent.start_time | asTime}}</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t\x3c!-- TODO make this one visible only when end_time != auto\n\t\t\t\t\t<div class="handle sxsHandle playhead" ng-show="appState.editEvent" ng-style="{left: markerPercent(appState.editEvent.end_time)+\'%\'}">\n\t\t\t\t\t\t<div class="tip">{{appState.editEvent.end_time | asTime}}</div>\n\t\t\t\t\t</div>\n --\x3e\n\t\t\t\t\t\x3c!-- end of draggable handles --\x3e\n\n\t\t\t\t</div>\n\t\t\t\t<div class="playhead mask">\n\t\t\t\t\t\x3c!-- interactive parts of timeline --\x3e\n\t\t\t\t\t<div class="progressbarContainer " ng-style="{width: zoomLevel+\'00%\'}">\n\t\t\t\t\t\t\x3c!-- scene markers --\x3e\n\t\t\t\t\t\t<div class="marker"\n\t\t\t\t\t\t\t ng-mouseover="showTooltip(eventGroup)"\n\t\t\t\t\t\t\t ng-mouseout="hideTooltip(eventGroup)"\n\t\t\t\t\t\t\t ng-repeat="eventGroup in timeline.displayMarkedEvents"\n\t\t\t\t\t\t\t ng-style="{left: markerPercent(eventGroup.start_time)+\'%\'}"\n\t\t\t\t\t\t\t ng-if="eventGroup.stop || eventGroup.toolTipText || appState.product == \'producer\' && eventGroup.toolTipText != null"\n\t\t\t\t\t\t\t ng-class="{stop: eventGroup.stop && !eventGroup.multiStop, mini: eventGroup.layoutChange, multi: eventGroup.multiStop}">\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\x3c!-- highlight item being edited --\x3e\n\t\t\t\t\t\t<div ng-if="appState.editEvent" class="editingItem" ng-style="{left: markerPercent(appState.editEvent.start_time)+\'%\', right: markerPercent(playbackService.getMetaProp(\'duration\') - appState.editEvent.end_time)+\'%\'}"></div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="pbarBottom">\n\t\t\t<span class="timedisplay">\n\t\t\t\t{{playbackService.getMetaProp(\'time\')| asTime}} / {{playbackService.getMetaProp(\'duration\') | asTime}}\n\t\t\t\t\x3c!-- playback rate not currently supported in youtube or on iOS --\x3e\n\t\t\t\t<span class="speedcontrol">\n\t\t\t\t\t<button ng-focus="showControls()" class="button-speedcontrol" ng-click="changeSpeed(-0.25)" aria-label="Slow down video">\n\t\t\t\t\t\t<div ng-class="{arrowLeft: playbackService.getMetaProp(\'timeMultiplier\') > 0.5}"></div>\n\t\t\t\t\t</button>\n\t\t\t\t\t<span class="speeddisplay" ng-click="resetSpeed()">{{playbackService.getMetaProp(\'timeMultiplier\')}}x</span>\n\t\t\t\t\t<button ng-focus="showControls()" class="button-speedcontrol" ng-click="changeSpeed(0.25)" aria-label="Speed up video">\n\t\t\t\t\t\t<div ng-class="{arrowRight: playbackService.getMetaProp(\'timeMultiplier\') < 2}"></div>\n\t\t\t\t\t</button>\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t\t<span style="display:inline-block;height:1em;position:relative" ng-if="episode.languages.length > 1">\n\t\t\t\t<select size="1" ng-model="appState.lang" class="languageSelector" ng-change="setNewLanguage()" ng-options="language.code as (\'[\'+language.code.toUpperCase()+\']\') for language in episode.languages">\n\t\t\t\t</select>\n\t\t\t</span>\n\n\t\t\t<button ng-focus="showControls()" tabindex="0" ng-if="appState.viewMode == \'watch\'" class="button button-captions" ng-click="appState.hideCaptions=!appState.hideCaptions" ng-class="{active: !appState.hideCaptions}">\n\t\t\t\t<span class="control-text">Captions</span>\n\t\t\t</button>\n\n\t\t\t<a ng-if="appState.viewMode==\'watch\'" class="button button-fullscreen active" ng-click="viewMode(\'discover\')">\n\t\t\t\t<span class="control-text">Exit fullscreen</span>\n\t\t\t</a>\n\t\t\t<a ng-if="appState.viewMode!=\'watch\'" class="button button-fullscreen" ng-click="viewMode(\'watch\')">\n\t\t\t\t<span class="control-text">Fullscreen video</span>\n\t\t\t</a>\n\n\t\t\t<span ng-if="!appState.isTouchDevice">\n\t\t\t\t<button ng-focus="showControls()" tabindex="0" class="button button-mute {{audioIcon()}}" ng-click="toggleMute()">\n\t\t\t\t\t<span class="control-text">Mute</span>\n\t\t\t\t</button>\n\n\t\t\t\t<itt-volume-slider></itt-volume-slider>\n\t\t\t</span>\n\t\t</div>\n\t</div>\n</div>\n')}]),t.exports=n},"9vsO":function(t,e,n){var i="templates/episode/columbia.html",a='<div class="episode episode-columbia" ng-class="episode.styleCss">\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("AiMV")+'" alt="Columbia University">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},AYkA:function(t,e,n){t.exports=n.p+"images/WSBCTC_Logo.fe6d0db7ea475d9f84062dbe4db61b9c.svg"},AZay:function(t,e){var n="templates/item/text-definition.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n\n<div>\n\t<div class="itemTemplate definition">\n\t\t<div class="itemHead">\n\t\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t\t<div class="item__title item__title--definition">\n\t\t\t\t<span ng-if="item.display_title | highlightSubstring: appState.searchText" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="text item__text item__text--definition" ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},AeV0:function(t,e){var n="templates/producer/upload-masterasset.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- producer master asset --\x3e\n\n<div ng-if="showAssetPicker" class="floatAssetPicker">\n\t<div class="scrollContainer">\n    <sxs-container-assets container-id="{{episodeContainerId}}"></sxs-container-assets>\n\t</div>\n\t<div class="controlsContainer">\n\t\t<button ng-click="endChooseAsset();">Cancel</button>\n\t</div>\n</div>\n\n<div>\n\t<div ng-if="(masterAsset.original_filename) && !showUploadButtonsMaster">\n\t\t{{masterAsset.display_name}}\n\t\t<button class="button" ng-click="replaceAsset(\'Master\')"> Replace this asset </button>\n\t</div>\n\t<div ng-if="showUploadButtonsMaster || !(masterAsset.original_filename)">\n\t\t<span ng-if="showUploadFieldMaster">\n      <itt-asset-uploader container-id="{{episodeContainerId}}" callback="assetUploaded(data)"></itt-asset-uploader>\n\t\t</span>\n\t\t<span ng-if="!showUploadFieldMaster">\n\t\t\t<button class="button" ng-click="chooseAsset(\'Master\')">Browse uploaded assets</button>\n\t\t\t<button class="button" ng-click="toggleUpload(\'Master\')">Upload new asset</button>\n\t\t</span>\n\t</div>\n</div>\n')}]),t.exports=n},AiEB:function(t,e){var n="templates/producer/questionauthoring.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div style="margin:1em">\n\n\t<p>This is a standalone editor for question items. Fill in the fields below, then copy the JSON data below into the existing authoring tool. To edit an existing question paste its JSON into the json field and the editor will separate it out into editable fields.</p>\n\t<table class="authoringForm">\n\t\t<tr>\n\t\t\t<td class="label">Question type</td>\n\t\t\t<td>\n\t\t\t\t<select ng-model="question.questiontype">\n\t\t\t\t\t<option value="mc-poll">Poll</option>\n\t\t\t\t\t<option value="mc-formative">Formative</option>\n\t\t\t\t</select>\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr>\n\t\t\t<td class="label">Question text</td>\n\t\t\t<td>\n\t\t\t\t<textarea rows="4" ng-model="question.questiontext">\n\t\t\t\t</textarea>\n\t\t\t</td>\n\t\t</tr>\n\t\t\x3c!-- \t\t<tr>\n\t\t\t<td class="label">Image (optional)</td>\n\t\t\t<td>\n\t\t\t\t<input type="file">\n\t\t\t</td>\n\t\t</tr>\n --\x3e\n\t\t<tr>\n\t\t\t<td colspan="2">Answer choices.\n\t\t\t\t<span ng-if="question.questiontype == \'mc-formative\'">Check the correct answer (if more than one is selected, either will count as correct).</span>To remove an answer choice, just leave it blank.\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr ng-repeat="distractor in question.distractors">\n\t\t\t<td class="label">\n\t\t\t\t<input type="checkbox" ng-model="distractor.correct" ng-if="question.questiontype == \'mc-formative\'">\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<input type="text" ng-model="distractor.text">\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td class="label"><a ng-click="addDistractor()">add another</a>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t</td>\n\t\t</tr>\n\n\n\t\t<tr ng-if="question.questiontype == \'mc-formative\'">\n\t\t\t<td class="label">Feedback for correct answer</td>\n\t\t\t<td>\n\t\t\t\t<input type="text" ng-model="question.correctfeedback">\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr ng-if="question.questiontype == \'mc-formative\'">\n\t\t\t<td class="label">Feedback for incorrect answer</td>\n\t\t\t<td>\n\t\t\t\t<input type="text" ng-model="question.incorrectfeedback">\n\t\t\t</td>\n\t\t</tr>\n\n\t\t<tr>\n\t\t\t<td colspan="2">\n\t\t\t\t<br>\n\t\t\t\t<hr>\n\t\t\t\t<br>\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td class="label">JSON data:\n\t\t\t\t<span ng-if="editwarning">Invalid JSON!</span>\n\t\t\t</td>\n\t\t\t<td>\n\n\t\t\t\t<textarea rows="10" ng-model="pluginjson"></textarea>\n\t\t\t</td>\n\t\t</tr>\n\n\t</table>\n\n\t<br>\n\t<hr>\n\t<br>\n\t<p class="label">Question preview:</p>\n\t<div class="item">\n\t\t<div ng-if="preview" itt-item="questionpreview"></div>\n\t</div>\n</div>\n')}]),t.exports=n},AiMV:function(t,e,n){t.exports=n.p+"images/columbia.0fcb4dd40f866aa5065cd6eb377d0dcd.svg"},AjZW:function(t,e,n){var i="templates/episode/eliterate.html",a='<div class="episode episode-eliterate" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="eliterate logo" href="//www.mindwires.com" target="_blank">\n\t\t\t<img src="'+n("3hY0")+'" alt="Mindwires logo">\n\t\t</a>\n\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\n\t</div>\n\t<div class="banner-logo">\n\t\t<img src="'+n("/EO3")+'" alt="E-Literate">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},BRlR:function(t,e,n){t.exports=n.p+"images/gw-logo.1019d2f84e8d475b9a61f2f04c8535e7.svg"},CQGL:function(t,e){var n="templates/root.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="rootLogin standaloneAncillaryPage" itt-login>\n\t<itt-nav on-logout="logout()"></itt-nav>\n\t<div class="inner">\n\t\t<div ng-if="appState.user._id">\n\t\t\t<div itt-user></div>\n\t\t</div>\n\n\t\t<div ng-if="!appState.user._id">\n\n\t\t\t<form ng-submit="adminLogin()">\n\t\t\t\t<h1>Sign in to Narrative Producer</h1>\n\t\t\t\t<label>\n\t\t\t\t\t<span>Username</span>\n\t\t\t\t\t<input type="email" name="auth_key" ng-model="loginForm.auth_key">\n\t\t\t\t</label>\n\n\t\t\t\t<label>\n\t\t\t\t\t<span>Password</span>\n\t\t\t\t\t<input type="password" name="password" ng-model="loginForm.password">\n\t\t\t\t</label>\n\n\t\t\t\t<input class="submit button" type="submit" value="Sign in">\n\t\t\t\t<span class="error" ng-if="badlogin">Sorry, try again?</span>\n\t\t\t</form>\n\n\t\t</div>\n\n\t\t<br style="clear:both">\n\t</div>\n\t<small ng-if="!appState.user._id"><a href="{{apiDataBaseUrl}}/oauth2">OAuth</a></small>\n\n</div>\n')}]),t.exports=n},CVkk:function(t,e){var n="templates/item/image.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text">\n\t\t<div class="title item__title item__title--image">\n\t\t\t<a class="fakeLink item__link--fake-link" role="button" tabindex="0" ng-click="toggleDetailView()" x-ng-keypress="toggleDetailOnKeyPress($event)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t</div>\n\t\t<div class="item__text item__text--image" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div class="itemDetail" x-ng-if="item.showInlineDetail">\n\t\t<div class="touchable" style="position:relative">\n\t\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t\t<div class="touchableIndicator"></div>\n\t\t</div>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},"D/IP":function(t,e,n){var i="templates/scene/landingscreen.html",a='<div class="landingscreen stretchToViewportShort">\n\t<div>\n\t\t<div class="pane introtext">\n\t\t\t<h1 ng-bind-html="episode.display_title"></h1>\n\t\t\t<p id="episode--description" ng-bind-html="episode.display_description"></p>\n\n\t\t\t<br>\n\t\t\t\x3c!-- \t\t\t<div ng-if="episode.navigation_depth >0">\n\t\t\t\tOther episodes:\n\t\t\t\t<ul class="crossEpisodeNav" itt-container-episodes="episode.parents[0]"></ul>\n\t\t\t</div>\n --\x3e\n\t\t</div>\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t\t<div class="landingscreen-end"></div>\n\t\t<div class="clear"></div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},DJEM:function(t,e){var n="templates/producer/item/producer-link.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- <span class="eventIcon icon-link"></span> --\x3e\n\x3c!--DEPRECATED WITH PRODUCER V1 --\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Title [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.title" x-inputtype="\'input\'" autofocus></div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">URL--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<form class="doValidate" name="ittItemForm">--\x3e\n\t\t\t\x3c!--<input type="text"--\x3e\n\t\t\t\t   \x3c!--itt-valid-item-url--\x3e\n\t\t\t\t   \x3c!--item="item"--\x3e\n\t\t\t\t   \x3c!--name="itemUrl"--\x3e\n\t\t\t\t   \x3c!--ng-model-options="{ updateOn: \'blur\' }"--\x3e\n\t\t\t\t   \x3c!--ng-model="item.url"/>--\x3e\n\t\t\x3c!--</form>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Description [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.description" x-inputtype="\'textarea\'"></div>--\x3e\n\x3c!--</div>--\x3e\n')}]),t.exports=n},DJti:function(t,e){},DwK4:function(t,e,n){t.exports=n.p+"images/prolotherapy-text.9eb3da161e4474f99736cdfe5c575fdd.svg"},EDO7:function(t,e){var n="templates/producer/annotator-autocomplete.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div style="position:relative;" ng-show="!hasAnnotator()">\n\n\t<input class="annotatorChooser" type="text" ng-model="searchText" ng-focus="showAutocomplete()" ng-blur="hideAutocomplete()" ng-change="handleAutocomplete()">\n\n\t<div class="autocompleteList animate transitionFade" ng-if="autoCompleting">\n\t\t<div class="autocompleteItem" ng-repeat="annotator in filteredAnnotators" ng-click="select(annotator)" ng-class="{selected: ($index == preselectedItem)}" style="white-space: nowrap">\n\t\t\t<img ng-src="{{annotator.imageUrl}}">\n\t\t\t<span ng-bind-html="(annotator.key | highlightSubstring: searchText) || \'(New speaker)\'"></span>\n\t\t</div>\n\t</div>\n</div>\n<div style="position:relative;" ng-show="hasAnnotator()">\n\t<div sxs-input-i18n="item.annotator" x-inputtype="\'input\'"></div>\n\t<a style="position: absolute; top: 3px; right: 10px" ng-click="item.annotator={}">(x)</a>\n</div>\n')}]),t.exports=n},ElzS:function(t,e){var n="templates/episode/components/discovermode.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="discoverMode" ng-if="appState.viewMode == \'discover\'">\n\t<div class="fill windowBg bgLayer">\n\t\t<div ng-class="item.styleCss + \' \' + item.state" itt-item="item" class="item animate" ng-repeat="item in scene.items | isCurrent | itemLayout:\'windowBg\'">\n\t\t</div>\n\t</div>\n\t<div itt-scene="scene" episode="episode" class="scene__container"></div>\n</div>\n')}]),t.exports=n},F5VT:function(t,e,n){var i="templates/scene/mirrored-twocol.html",a='\x3c!--\nVideo, Main, Alt:\n___________    ___________\n|V   |A   |    |A   |V   |\n|____|    |    |    |____|\n|M   |    |    |    |M   |\n|    |    |    |    |    |\n|____|____|    |____|____|\nshowCurrent is forced in main.\n--\x3e\n\n<div class="scene cornerV" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="col">\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t\t<div class="pane mainPane">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in altBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t\t\x3c!--<div class="item animate" ng-repeat="item in mainBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>--\x3e\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{singleitem: altContentItems.length==1, isNarrow: isNarrow, isEmpty: altContentItems.length == 0}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in altItems = (altContentItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in altFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="col">\n\t\t<div class="pane altPane stretchToViewport">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (mainContentItems | isCurrent).length == 1\n\t\t\t\t\t: (mainContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: mainContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: mainContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: mainContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in showCurrent ? (mainContentItems | isCurrent) : mainContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},FFkw:function(t,e){var n="templates/item/file-withimage.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- I believe this template is not in use (because we don\'t currently suport two assets on the same event...) --\x3e\n<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text item__text--file-with-image">\n\t\t<span ng-if="handleOutgoingLinkDisplay()">\n\t\t\t<span ng-if="!item.targetTop">\n\t\t\t\t<div class="title item__title item__title--file-with-image">\n\n\t\t\t\t\t<a tabindex="0" class="escapelink item__link--escape-link" x-ng-keypress="outgoingLinkOnKeyPress(item.asset.url,$event)" ng-click="outgoingLink(item.asset.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t\t</div>\n\t\t\t\t<a tabindex="0" ng-if="item.asset.url" x-ng-keypress="outgoingLinkOnKeyPress(item.asset.url,$event)" ng-click="outgoingLink(item.asset.url)">\n\t\t\t\t\t<img ng-src="{{item.asset.url}}">\n\t\t\t\t</a>\n\t\t\t</span>\n\t\t\t<span ng-if="item.targetTop">\n\t\t\t\t<div class="title item__title item__title--file-with-image">\n\t\t\t\t\t<a tabindex="0" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t\t</div>\n\t\t\t\t<a tabindex="0" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)">\n\t\t\t\t\t<img ng-src="{{item.asset.url}}">\n\t\t\t\t</a>\n\t\t\t</span>\n\n\t\t</span>\n\t\t<span ng-if="!handleOutgoingLinkDisplay()">\n\t\t\t<div class="title item__title item__title--file-with-image">\n\t\t\t\t<a role="button" x-ng-keypress="toggleDetailOnKeyPress($event)" class="fakeLink item__link--fake-link" tabindex="0" ng-click="toggleDetailView()" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t</div>\n\t\t\t<img ng-click="toggleDetailView()" ng-src="{{item.asset.url}}">\n\t\t</span>\n\n\t</div>\n\t<div class="item__text item__text--file-with-image" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n</div>\n\n<div class="itemDetail" ng-if="item.showInlineDetail">\n\t<a tabindex="0" ng-if="!item.noExternalLink" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" class="escapelink">(new window)</a>\n\t<itt-iframe x-src="{{item.asset.url}}" item="item" x-contenttype="{{item.asset.content_type}}"></itt-iframe>\n</div>\n<div class="clear"></div>\n')}]),t.exports=n},FUk5:function(t,e,n){t.exports=n.p+"images/checkmark-empty.eccafa854fceac6359bac2609d44e2ce.png"},Fttn:function(t,e,n){var i="templates/episode/gwsb.html",a='<div class="episode episode-gwsb" ng-class="episode.styleCss">\n\n\t<div class="fill gwsb-seal">\n\t\t<div class="fill"></div>\n\t</div>\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("BRlR")+'" alt="The George Washington University">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},G4Wk:function(t,e){var n="templates/item/review-annotation.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div ng-class="{isCosmetic: item.cosmetic}">\n\t<div ng-if="item.isTranscript" class="itemTemplate">\n\t\t<div class="itemHead">\n\t\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t\t<div class="category item__title">\n\t\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t\t</div>\n\n\t\t\t<div class="authorName" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n\t\t</div>\n\t\t<div class="text" ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div ng-if="!item.isTranscript" ng-include="item.templateUrl"></div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},GGxq:function(t,e){var n="templates/item/debug.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemTemplate">\n\t<pre ng-if="itemDebug">{{item | pretty}}</pre>\n</div>\n')}]),t.exports=n},GUWn:function(t,e){var n="templates/error.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span ng-if="errorSvc.errors.length || errorSvc.notifications.length" class="errors">\n\t<div class="error" ng-repeat="error in errorSvc.errors" ng-click="dismiss(error)">\n\t\t<h3><i class="fa fa-exclamation-triangle error-red"></i>Error: <span ng-bind-html="error.cause || error.exception.data.error || error.exception.data || \'(unknown reason)\'"></span></h3>\n\t\t<p ng-if="error.exception.config.url">\n\t\t\t<i>(While trying to load {{error.exception.config.url}})</i>\n\t\t</p>\n\n\t\t<p ng-if="error.exception.status == 401">\n\t\t\tPlease\n\t\t\t<span ng-if="user.login_url">\n\t\t\t\t<a ng-if="user.login_via_top_window_only" ng-click="logout();" ng-href="{{user.login_url}}" target="_top">click here</a>\n\t\t\t\t<a ng-if="!user.login_via_top_window_only" ng-click="logout();" ng-href="{{user.login_url}}">click here</a> to log back in.\n\t\t\t</span>\n\t\t\t<span ng-if="!user.login_url">\n\t\t\t\t<a ng-click="logout();">reset your session</a> and start over.\n\t\t\t</span>\n\t\t</p>\n\n\t\t\x3c!-- \t\t<a style="font-size: small" ng-click="showDetails= !showDetails">(show details)</a>\n\t\t<pre ng-if="showDetails" style="font-size: small" ng-bind="error | pretty"></pre>\n --\x3e\n\t</div>\n\t<div class="notification" ng-repeat="notification in errorSvc.notifications">\n\t\t<a style="float: right;" ng-click="dismiss(notification)">[x]</a>\n\t\t<p><i class="fa fa-info-circle info-blue"></i> <strong> Note: </strong> {{notification.text}}</p>\n\t</div>\n</span>\n')}]),t.exports=n},GeQP:function(t,e){var n="templates/producer/upload-producer.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- producer item assets--\x3e\n\n<div ng-if="showAssetPicker" class="floatAssetPicker">\n\t<div class="scrollContainer">\n    <sxs-container-assets container-id="{{episodeContainerId}}" mime-key="{{item.producerItemType}}"></sxs-container-assets>\n\t</div>\n\t<div class="controlsContainer">\n\t\t<button ng-click="endChooseAsset();">Cancel</button>\n\t</div>\n</div>\n\n<div>\n\t\x3c!--ng-model as element here so we can attach itt-valid-image, which requires ng-model--\x3e\n\t<ng-model ng-model="item.asset" name="itemAsset" itt-valid-asset item="item"></ng-model>\n\t<div ng-if="item.asset && !showUploadButtons">\n\t\t{{item.asset.display_name}}\n\t\t<button class="button" ng-click="replaceAsset()">Replace</button>\n\t\t<button class="button" ng-click="detachAsset(); selectService.onSelectChange(item, itemForm)">Remove</button>\n\t</div>\n\t<div ng-if="showUploadButtons || !item.asset">\n\t\t<span ng-if="showUploadField">\n\n\t\t\t<itt-asset-uploader\n        container-id="{{episodeContainerId}}"\n        ng-if="canAccess"\n        callback="assetUploaded(data)"\n        mime-types="{{mimes}}">\n      </itt-asset-uploader>\n\t\t</span>\n\t\t<span ng-if="!showUploadField">\n\t\t\t<button class="button" ng-click="chooseAsset()">Browse uploaded</button>\n\t\t\t<button class="button" ng-click="toggleUpload()">Upload new</button>\n\t\t</span>\n\t</div>\n</div>\n')}]),t.exports=n},GmGj:function(t,e,n){var i="templates/episode/middlebury.html",a='<div class="episode episode-middlebury" ng-class="episode.styleCss">\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span class="colorInvert DiscoverModeOnly" ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("wIHC")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<a class="logo" href="http://middlebury.edu">\n\t\t\t<img src="'+n("nA8d")+'" alt="Middlebury logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("c3xB")+'" alt="Middlebury">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},GoGc:function(t,e,n){var i="templates/scene/cornerH.html",a='\x3c!--\nVideo, Main, Alt:\n___________\n|V/M |M/V |\n|____|____|\n|A        |\n|         |\n|_________|\nshowCurrent is forced in Main.\n--\x3e\n\n<div class="scene cornerH" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="row">\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t\t<div class="pane mainPane matchVideoHeight">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer" ng-class="{singleitem: mainContentItems.length==1, isNarrow: isNarrow, isEmpty: mainContentItems.length == 0}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in mainItems = (mainContentItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="row">\n\t\t<div class="pane altPane ">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in altBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (altContentItems | isCurrent).length == 1\n\t\t\t\t\t: (altContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: altContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: altContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: altContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in altFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},GqFw:function(t,e){var n="templates/producer/item/producer-question.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\n\x3c!-- <span class="eventIcon icon-question"></span> --\x3e\n\x3c!--DEPRECATED WITH PRODUCER V1 --\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Question type--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<select ng-model="item.data._plugin.questiontype">--\x3e\n\t\t\t\x3c!--<option value="mc-poll">Poll</option>--\x3e\n\t\t\t\x3c!--<option value="mc-formative">Formative</option>--\x3e\n\t\t\x3c!--</select>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Title [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.title" x-inputtype="\'input\'" autofocus></div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Question text--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.data._plugin.questiontext" x-inputtype="\'textarea\'"></div>--\x3e\n\x3c!--</div>--\x3e\n\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Image (optional)--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input" ng-include="\'templates/producer/upload-producer.html\'">--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\n\x3c!--<div class="field" ng-repeat="distractor in item.data._plugin.distractors track by $index">--\x3e\n\t\x3c!--<div class="label">--\x3e\n\t\t\x3c!--{{$index | alpha}} &nbsp;--\x3e\n\t\t\x3c!--<input type="checkbox" ng-model="distractor.correct" ng-if="item.data._plugin.questiontype == \'mc-formative\'">--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="distractor.text" x-inputtype="\'textarea\'"></div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<button ng-click="addDistractor($event)">Add distractor</button>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\n\x3c!--<div class="field" ng-if="item.data._plugin.questiontype == \'mc-formative\'">--\x3e\n\t\x3c!--<div class="label">Feedback when correct--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.data._plugin.correctfeedback" x-inputtype="\'textarea\'"></div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field" ng-if="item.data._plugin.questiontype == \'mc-formative\'">--\x3e\n\t\x3c!--<div class="label">Feedback when incorrect--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.data._plugin.incorrectfeedback" x-inputtype="\'textarea\'"></div>--\x3e\n\x3c!--</div>--\x3e\n')}]),t.exports=n},HyaP:function(t,e){var n="templates/copyright.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'TELLING STORY player &#169;\n<span ng-bind-html="now | date:\'yyyy\'"></span>\n<a href="//inthetelling.com" target="_blank">IN THE TELLING</a>. All rights reserved.\n<br>\n<a href="/privacy.html" target="_blank">Privacy</a>\n<span ng-if="narrative.support_url"> -\n\t<a ng-href="{{narrative.support_url}}">Support</a>\n</span>\n')}]),t.exports=n},I0L0:function(t,e){var n="templates/item/link-withimage.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text">\n\t\t<span ng-if="handleOutgoingLinkDisplay()">\n\t\t\t<span ng-if="!item.targetTop">\n\t\t\t\t<div class="title item__title item__title--link title--link-with-image">\n\t\t\t\t\t<a tabindex="0" class="escapelink item__link--escape-link escape-link--link-with-image" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t\t</div>\n\t\t\t\t<a tabindex="0" ng-if="item.asset.url" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)">\n\t\t\t\t\t<img ng-if="item.asset.url" ng-src="{{item.asset.url}}">\n\t\t\t\t</a>\n\t\t\t</span>\n\t\t\t<span ng-if="item.targetTop">\n\t\t\t\t<div class="title item__title item__title--link title--link-with-image">\n\t\t\t\t\t<a tabindex="0" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t\t</div>\n\t\t\t\t<a tabindex="0" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)">\n\t\t\t\t\t<img ng-if="item.asset.url" ng-src="{{item.asset.url}}">\n\t\t\t\t</a>\n\t\t\t</span>\n\n\t\t</span>\n\t\t<span ng-if="!handleOutgoingLinkDisplay()">\n\t\t\t\t<div class="title item__title item__title--link title--link-with-image">\n\t\t\t\t<a role="button" x-ng-keypress="toggleDetailOnKeyPress($event)" class="fakeLink item__link--fake-link" tabindex="0" ng-click="toggleDetailView()" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t</div>\n\t\t\t<img ng-if="item.asset.url" ng-click="toggleDetailView()" ng-src="{{item.asset.url}}">\n\t\t</span>\n\t\t<div class="item__text item__text--link text--link-with-image" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t</div>\n\n</div>\n\n<div class="itemDetail" ng-if="item.showInlineDetail">\n\t<a tabindex="0" ng-if="!item.noExternalLink" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" class="escapelink item__link--escape-link escape-link--link-with-image">(new window)</a>\n\t<itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n\t<itt-video\n\t\tng-if="item.isVideoUrl"\n\t\tmedia-src-arr="[item.url]"\n\t\tplayer-id="item._id"\n\t\tmain-player="false">\n\t</itt-video>\n</div>\n<div class="clear "></div>\n')}]),t.exports=n},IL3w:function(t,e){var n="templates/item/link-descriptionfirst.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text">\n\t\t<div class="item__text--link text--description-first" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t\t<div class="title item__title item__title--link title--description-first">\n\t\t\t<a tabindex="0" ng-if="handleOutgoingLinkDisplay() && !item.targetTop" class="escapelink item__escape-link item__link--escape-link escape-link--description-first" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t<a tabindex="0" ng-if="handleOutgoingLinkDisplay() && item.targetTop" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t<a tabindex="0" ng-if="!handleOutgoingLinkDisplay()" ng-click="toggleDetailView()" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t</div>\n\t</div>\n\t<div class="itemDetail" ng-if="item.showInlineDetail">\n\t\t<a tabindex="0" ng-if="!item.noExternalLink" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" class="escapelink item__link--escape-link escape-link--description-first">(new window)</a>\n\t\t<itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n\t\t<itt-video\n\t\t\tng-if="item.isVideoUrl"\n\t\t\tmedia-src-arr="[item.url]"\n\t\t\tplayer-id="item._id"\n\t\t\tmain-player="false">\n\t\t</itt-video>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},IiAB:function(t,e,n){t.exports=n.p+"images/no-avatar.a012e2f1c64d5ed04112b126c8c347ba.gif"},IsZR:function(t,e,n){var i="templates/episode/usc.html",a='<div class="episode episode-usc" ng-class="episode.styleCss">\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t\x3c!-- <img class="logo" src="images/customer/usc-footer.svg" alt="USC logo" style="margin-top:1em"> --\x3e\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("JqTC")+'" alt="USC">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},JTcP:function(t,e,n){var i="templates/scene/cornerV.html",a='\x3c!--\nVideo, Main, Alt:\n___________    ___________\n|V   |A   |    |A   |V   |\n|____|    |    |    |____|\n|M   |    |    |    |M   |\n|    |    |    |    |    |\n|____|____|    |____|____|\nshowCurrent is forced in main.\n--\x3e\n\n<div class="scene cornerV" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="col">\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t\t<div class="pane mainPane">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{singleitem: mainContentItems.length==1, isNarrow: isNarrow, isEmpty: mainContentItems.length == 0}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in mainItems = (mainContentItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="col">\n\t\t<div class="pane altPane stretchToViewport">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in altBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (altContentItems | isCurrent).length == 1\n\t\t\t\t\t: (altContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: altContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: altContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: altContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in altFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},Jetm:function(t,e){var n="templates/item/link-embed.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text">\n\t\t<div class="title item__title item__title--link title--link-embed" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n\t\t<div class="item__text--link text--link-embed" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<a tabindex="0" class="escapelink item__link--escape-link escape-link--link-embed" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)">(new window)</a>\n\n\t<itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n\n\t<itt-video\n\t\tng-if="item.isVideoUrl"\n\t\tmedia-src-arr="[item.url]"\n\t\tplayer-id="item._id"\n\t\tmain-player="false">\n\t</itt-video>\n\n\t<div class="clear"></div>\n</div>\n\n\n')}]),t.exports=n},JkHQ:function(t,e){var n="templates/item/searchresults.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div ng-class="{\nsearchitem:true,\nisSxS: item.sxs,\nisCurrent: ((item.start_time <= playbackService.getMetaProp(\'time\')) && (item.end_time > playbackService.getMetaProp(\'time\'))),\nisCosmetic: item.cosmetic\n}" ng-style="item.sxs?{backgroundImage:\'url(\'+item.avatar.url+\')\'}:{}">\n\t<a class="edit-event" ng-click="editItem(item._id)">\n\t\t<span>Edit item</span>\n\t</a>\n\t<span class="displayTime">\n\t\t<button class="fakeLink" tabindex="2" ng-click="seek(item.start_time, item._id)">{{item.displayStartTime}}</button>\n\t</span>\n\t<span class="type" ng-bind-html="(item.display_title || item.display_annotator) | highlightSubstring: appState.searchText"></span>\n\t<div class="description" ng-bind-html="(item.display_description || item.display_annotation) | highlightSubstring: appState.searchText"></div>\n</div>\n')}]),t.exports=n},JnVu:function(t,e){var n="templates/item/link-modal-thumb.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime"\n\t\t   x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text">\n\t\t<span ng-if="handleOutgoingLinkDisplay()">\n\t\t\t<span ng-if="!item.targetTop">\n\t\t\t\t<div class="title item__title item__title--link title--link-modal">\n\t\t\t\t\t<a tabindex="0" class="escapelink item__link--escape-link escape-link--link-modal"\n\t\t\t\t\t   x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)"\n\t\t\t\t\t   ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t\t</div>\n\t\t\t\t<a tabindex="0" ng-if="item.asset.url" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)"\n\t\t\t\t   ng-click="outgoingLink(item.url)">\n\t\t\t\t\t<img ng-if="item.asset.url" ng-src="{{item.asset.url}}">\n\t\t\t\t</a>\n\t\t\t</span>\n\t\t\t<span ng-if="item.targetTop">\n\t\t\t\t<div class="title item__title item__title--link title--link-modal">\n\t\t\t\t\t<a tabindex="0" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)"\n\t\t\t\t\t   ng-click="outgoingLink(item.url)"\n\t\t\t\t\t   ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t\t</div>\n\t\t\t\t<a tabindex="0" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)"\n\t\t\t\t   ng-click="outgoingLink(item.url)">\n\t\t\t\t\t<img ng-if="item.asset.url" ng-src="{{item.asset.url}}">\n\t\t\t\t</a>\n\t\t\t</span>\n\n\t\t</span>\n\t\t<span ng-if="!handleOutgoingLinkDisplay()">\n\t\t\t\t<div class="title item__title item__title--link title--link-modal">\n\t\t\t\t<a role="button" x-ng-keypress="toggleDetailOnKeyPress($event)" class="fakeLink item__link--fake-link" tabindex="0"\n\t\t\t\t   ng-click="forceModal(false)"\n\t\t\t\t   ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t</div>\n\t\t\t<img ng-if="item.asset.url" ng-click="forceModal(false)" ng-src="{{item.asset.url}}">\n\t\t</span>\n\n\t\t<div class="item__text item__text--link text--link-modal"\n\t\t\t ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t</div>\n\n</div>\n\n<div class="itemDetail" ng-if="item.showInlineDetail && appState.viewMode === \'review\'">\n\t<a tabindex="0" ng-if="!item.noExternalLink" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)"\n\t   ng-click="outgoingLink(item.url)" class="escapelink item__link--escape-link escape-link--link-modal">(new\n\t\twindow)</a>\n\t<itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n\t<itt-video\n\t\tng-if="item.isVideoUrl"\n\t\tmedia-src-arr="[item.url]"\n\t\tplayer-id="item._id"\n\t\tmain-player="false">\n\t</itt-video>\n</div>\n<div class="clear "></div>\n')}]),t.exports=n},JoBD:function(t,e){var n="scripts/directives/socialshare/social-share.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span class="itt-socialshare">\n\n  <span ng-if="!$ctrl.expanded">\n    <a class="button button-facebook" ng-click="$ctrl.onShare(\'facebook\')"></a>\n    <a class="button button-linkedin" ng-click="$ctrl.onShare(\'linkedin\')"></a>\n    <a class="button button-share" ng-click="$ctrl.toggleExpanded()"></a>\n  </span>\n\n  <div class="socialshare__row" ng-if="$ctrl.expanded">\n    <button class="socialshare__exit"\n            ng-click="$ctrl.toggleExpanded()">\n    </button>\n    <div class="socialshare__row--expanded">\n      <div>\n        \x3c!--share button row--\x3e\n        <p>Share episode</p>\n        <a ng-repeat="provider in $ctrl.providers"\n           class="button"\n           ng-click="$ctrl.onShare(provider)"\n           ng-class="\'button-\' + provider">\n        </a>\n      </div>\n    \x3c!--end share button row--\x3e\n    \x3c!--copy link row--\x3e\n      <div>\n        <p>Copy link</p>\n        <div class="socialshare__clipboard">\n          <itt-clipboard\n            light="true"\n            custom-notice="true"\n            on-copy="$ctrl.ontextCopied($event)"\n            source-text="{{$ctrl.stubUrl}}">\n          </itt-clipboard>\n          <div ng-if="$ctrl.textCopied">\n            <span class="button button-text-copied"></span>\n            <span class="text--notice">(Link copied to clipboard)</span>\n          </div>\n        </div>\n      </div>\n    \x3c!--end copy link row--\x3e\n    \x3c!--email options--\x3e\n    <itt-modal\n      wrapper-class="email-modal__wrapper"\n      modal-class="email-modal__content"\n      ng-if="$ctrl.emailshareExpanded">\n      <form name="emailshareForm">\n        <div class="socialshare__email-row">\n          <div class="socialshare__email-from">\n            <span>\n              <label for="ssFromName">From name</label>\n              <input type="text" id="ssFromName" ng-model="email.from_name" required/>\n            </span>\n            <span>\n              <label for="ssFromEmail">From email</label>\n              <input type="email" id="ssFromEmail" ng-model="email.from_email_address" required/>\n            </span>\n          </div>\n          <div class="socialshare__email-to">\n            <span>\n              <label for="ssToName">To name</label>\n              <input id="ssToName" type="text" ng-model="email.to_name" required/>\n            </span>\n            <span>\n              <label for="ssToEmail">To email</label>\n              <input type="email" id="ssToEmail" ng-model="email.to_email_address" required/>\n            </span>\n          </div>\n          <div class="socialshare__email-subject">\n            <span>\n              <label for="ssSubject">Subject</label>\n              <input type="text" id="ssSubject" ng-init="email.subject = $ctrl.shareTitle"\n                     ng-model="email.subject" required/>\n            </span>\n          </div>\n          <div class="socialshare__email-message">\n            <label for="ssMessage">Message</label>\n            <textarea id="ssMessage" ng-model="email.message" required></textarea>\n          </div>\n          <div class="socialshare__email-sender-copy">\n            <span>\n              <input type="checkbox" id="ssSenderCopy" ng-init="email.sender_copy = true" ng-model="email.sender_copy"/>\n              <label for="ssSenderCopy">Send me a copy</label>\n            </span>\n          </div>\n          <div class="socialshare__email-buttons">\n            <button ng-click="$ctrl.handleEmailShare(email, emailshareForm)" type="submit">Send email</button>\n            <button ng-click="$ctrl.toggleEmailshare()">Close</button>\n          </div>\n        </div>\n      </form>\n    </itt-modal>\n\n    \x3c!--end email options--\x3e\n\n    </div>\n  </div>\n\n</span>\n')}]),t.exports=n},JqTC:function(t,e,n){t.exports=n.p+"images/usc-logo.3965f7aa659c7a577ae0321f1fdeb6f2.svg"},JtGx:function(t,e){var n="templates/auth.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div itt-login style="margin:2em">\n\t\x3c!-- keep this UI as minimal as possible, as it\'ll briefly flash during LTI login --\x3e\n\t<a style="animation: delayedFadeIn 5s;" href="/#/">Home</a>\n</div>\n')}]),t.exports=n},K8cx:function(t,e){var n="templates/producer/item/producer-image.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!--DEPRECATED WITH PRODUCER V1 --\x3e\n\x3c!-- <span class="eventIcon icon-image"></span> --\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Title [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.title" x-inputtype="\'input\'" autofocus></div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Image--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input" ng-include="\'templates/producer/upload-producer.html\'">--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Description [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.description" x-inputtype="\'textarea\'"></div>--\x3e\n\x3c!--</div>--\x3e\n')}]),t.exports=n},K96E:function(t,e){var n="templates/producer/item/sxs-video.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span class="eventIcon icon-video"></span>\n<itt-url-field data="item" label="Video url" context="editor-video" itt-item-form="ittItemForm"></itt-url-field>\n<itt-title-field do-validate="false" data="item" itt-item-form="ittItemForm"></itt-title-field>\n<itt-description-field data="item"></itt-description-field>\n')}]),t.exports=n},"KP/u":function(t,e){var n="templates/item/sxs-link.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemTemplate sxs-item">\n  <a class="edit-event" ng-click="editItem()" ng-if="item.editableByThisUser">[Edit]</a>\n  <div class="avatar">\n    <img ng-src="{{item.avatar.url || appState.noAvatar }}">\n  </div>\n  <div class="itemHead">\n    <div class="authorName" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n  </div>\n\n  <a ng-if="handleOutgoingLinkDisplay()" class="escapelink" ng-click="outgoingLink(item.url)" ng-bind-html="item.title.en ||\'(Untitled)\'"></a>\n  <h3 ng-if="!handleOutgoingLinkDisplay()" ng-bind-html="item.title.en ||\'(Untitled)\'"></h3>\n  <div class="text" ng-bind-html="item.description.en"></div>\n  <div class="itemDetail" ng-if="item.url && !handleOutgoingLinkDisplay() && item.url != \'https://\'">\n    <div class="modalmenu" ng-if="!item.noExternalLink">\n      <a ng-click="outgoingLink(item.url)" class="escapelink">(new window)</a>\n    </div>\n    <itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n    <itt-video\n      ng-if="item.isVideoUrl"\n      media-src-arr="[item.url]"\n      player-id="item._id"\n      main-player="false">\n    </itt-video>\n  </div>\n  <div class="clear"></div>\n</div>\n')}]),t.exports=n},L3Dy:function(t,e){var n="templates/item/question-mc-image-right.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category">\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text item__text--question-mc-image-right">\n\t\t<div class="title item__title item__title--question-mc-image-right" ng-if="item.display_title | highlightSubstring: appState.searchText" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n\t\t<div ng-if="item.asset.url" class="touchable" style="float:right; max-width: 50%; padding-right: 0.5em">\n\t\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t\t<div class="touchableIndicator"></div>\n\t\t</div>\n\t\t<itt-mc-question show-chart="item.data._plugin.questiontype == \'mc-poll\'" choices="item.data._plugin.distractors" on-choice="save" data="item.data._plugin" qid="item._id"></itt-mc-question>\n\t\t\t<div class="clear"></div>\n\t</div>\n</div>')}]),t.exports=n},LSM6:function(t,e){var n="templates/producer/inputi18n.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<input ng-if="inputtype==\'input\'" ng-model="field[appState.lang]" name="{{textangularname}}" ng-required="doValidate">\n<text-angular ng-if="inputtype==\'textarea\'" name="{{textangularname}}" ng-required="doValidate" ng-model="field[appState.lang]" ta-paste="sanitizePastedHtml($html)" ta-default-wrap="span" ng-blur="trim()"></text-angular>\n')}]),t.exports=n},MvqX:function(t,e,n){t.exports=n.p+"images/gw-law.1e102049617459a1219f011e95fe9de0.jpg"},"N29+":function(t,e){var n="templates/producer/item/sxs-annotation.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- annotation --\x3e\n<span class="eventIcon icon-comment"></span>\n<div class="field">\n\t<div class="label">Comment\n\t</div>\n\t<div class="input" sxs-input-i18n="item.annotation" autofocus x-inputtype="\'textarea\'"></div>\n</div>\n')}]),t.exports=n},NnMI:function(t,e){var n="templates/producer/item/sxs-question.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span class="eventIcon icon-question"></span>\n<div class="field">\n\t<div class="label">Question type\n\t</div>\n\t<div class="input">\n\t\t<select ng-model="item.data._plugin.questiontype">\n\t\t\t<option value="mc-poll">Poll</option>\n\t\t\t<option value="mc-formative">Formative</option>\n\t\t</select>\n\t</div>\n</div>\n<div class="field">\n\t<div class="label">Question text\n\t</div>\n\t<div class="input" autofocus sxs-input-i18n="item.data._plugin.questiontext" x-inputtype="\'textarea\'"></div>\n\n</div>\n<div class="field">\n\t<div class="label">Question Title\n\t</div>\n\t<div class="input">\n\t\t<input type="text" ng-model="item.title.en" autofocus>\n\t</div>\n</div>\n<div class="field">\n\t<div class="label">Image (optional)\n\t</div>\n\t<div class="input" ng-include="\'templates/producer/upload-sxs.html\'">\n\t</div>\n</div>\n\n<div class="field" ng-repeat="distractor in item.data._plugin.distractors track by $index">\n\t<div class="label">\n\t\t{{$index | alpha}} &nbsp;\n\t\t<input type="checkbox" ng-model="distractor.correct" ng-if="item.data._plugin.questiontype == \'mc-formative\'">\n\t</div>\n\t<div class="input" sxs-input-i18n="distractor.text" x-inputtype="\'textarea\'"></div>\n</div>\n<div class="field">\n\t<div class="input">\n\t\t<button ng-click="addDistractor($event)">Add distractor</button>\n\t</div>\n</div>\n<div class="field" ng-if="item.data._plugin.questiontype == \'mc-formative\'">\n\t<div class="label">Feedback when correct\n\t</div>\n\t<div class="input" sxs-input-i18n="item.data._plugin.correctfeedback" x-inputtype="\'textarea\'"></div>\n</div>\n<div class="field" ng-if="item.data._plugin.questiontype == \'mc-formative\'">\n\t<div class="label">Feedback when incorrect\n\t</div>\n\t<div class="input" sxs-input-i18n="item.data._plugin.incorrectfeedback" x-inputtype="\'textarea\'"></div>\n</div>\n')}]),t.exports=n},O4Bc:function(t,e){var n="templates/item/image-fill.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- one or the other of .item background-image and fillImg will be made invisible, depending on fill type.   see ittItem for explanation of the redundant backgroundImageStyle and item.asset.cssUrl is for browser --\x3e\n<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate imageFill" style="{{item.backgroundImageStyle}}" ng-style="{\'backgroundImage\':item.asset.cssUrl}">\n\t<img class="fillImg" ng-src="{{item.asset.url}}">\n</div>\n')}]),t.exports=n},OCYu:function(t,e){var n="templates/item/image-caption-sliding.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="captionContainer touchable">\n\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t<div class="touchableIndicator"></div>\n\t\t<div class="caption slidingcaption">\n\t\t\t<div class="title item__title item__title--image title--image-caption-sliding" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n\t\t\t<div class="text item__text item__text--image text--image-caption-sliding" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t\t</div>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},Of5n:function(t,e){var n="templates/navpanel.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span class="navPanel">\n\t<div class="parent" ng-repeat="parent in episode.parents" ng-bind-html="parent.display_name"></div>\n\t\x3c!-- <h2 ng-bind-html="episode.display_title"></h2> --\x3e\n\t<div class="scene" x-ng-if="scene.display_title" x-ng-repeat="scene in episode.scenes" x-ng-class="{currentScene: scene.isCurrent}" x-ng-click="seek(scene.start_time)">\n\t\t<span class="displayTime">{{scene.displayStartTime}}</span>\n\t\t<p>\n\t\t\t<button class="fakeLink" tabindex="0" ng-bind-html="scene.display_title" x-ng-class="{sceneLink: !scene.isCurrent}" ng-focus="showControls()"></button>\n\t\t\t<br>\n\t\t\t<span ng-bind-html="scene.display_description"></span>\n\t\t</p>\n\t</div>\n\t<div class="crossEpisode">\n\t\t<a class="prevEpisode" ng-if="episode.previousEpisodeContainer" ng-href="/#/{{appState.crossEpisodePath}}/{{episode.previousEpisodeContainer.episodes[0]}}" title="{{episode.previousEpisodeContainer.display_name}}">Previous episode</a>\n\t\t<a class="nextEpisode" ng-if="episode.nextEpisodeContainer" ng-href="/#/{{appState.crossEpisodePath}}/{{episode.nextEpisodeContainer.episodes[0]}}" title="{{episode.nextEpisodeContainer.display_name}}">Next Episode</a>\n\t</div>\n</span>\n')}]),t.exports=n},"Ogf/":function(t,e,n){function webpackContext(t){return n(webpackContextResolve(t))}function webpackContextResolve(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var i={"./socialshare/social-share.html":"JoBD"};webpackContext.keys=function(){return Object.keys(i)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id="Ogf/"},Opc2:function(t,e){var n="templates/episode/components/windowfg.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div ng-if="(episode.items | isCurrent | itemLayout:\'windowFg\').length > 0" class="overlay windowFg fgLayer animate transitionFade">\n\t<div class="content w-modal">\n    \x3c!--state: {{playbackService.getTimelineState()}} time: {{playbackService.getMetaProp(\'time\')}}--\x3e\n\t\t<div ng-class="item.styleCss + \' \' + item.state" itt-item="item" class="item animate  timestampNone" ng-repeat="item in episode.items | isCurrent | itemLayout:\'windowFg\'">\n\t\t</div>\n\n\n\t\t<a ng-if="!appState.editEvent" class="button-continue" ng-click="continue()">\n\t\t\t<span>Continue</span>\n\t\t</a>\n\t</div>\n</div>\n')}]),t.exports=n},PtaW:function(t,e,n){t.exports=n.p+"images/Narrasys_Banner_white.faf00553a8acd1f5bcdee8118173dd45.svg"},QIbj:function(t,e){var n="templates/producer/item/producer-scene.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- <span class="eventIcon icon-scene"></span> --\x3e\n\x3c!--DEPRECATED WITH PRODUCER V1 --\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Layout Title [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.title" x-inputtype="\'input\'" autofocus></div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Description [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.description" x-inputtype="\'textarea\'"></div>--\x3e\n\x3c!--</div>--\x3e\n')}]),t.exports=n},QJZl:function(t,e,n){t.exports=n.p+"images/CPB_Logo-01-2.5381d1e6233221a10084e04bd78694c8.svg"},QfUj:function(t,e,n){var i="templates/episode/prolotherapy.html",a='<div class="episode episode-prolotherapy" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\t<div class="banner-logo">\n\t\t<img src="'+n("DwK4")+'" alt="American Association of Musculoskeletal Medicine">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},QgsF:function(t,e){var n="templates/producer/item/producer-video.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!--DEPRECATED WITH PRODUCER V1 --\x3e\n\x3c!--<span class="eventIcon icon-video"></span>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<small>--\x3e\n\t\t\x3c!--<div style="width:20%; display:inline-block"></div>--\x3e\n\t\t\x3c!--<div style="width:48%; display:inline-block">Link to a video on YouTube...</div>--\x3e\n\t\t\x3c!--<div style="width:32%; display:inline-block">...or record your own</div>--\x3e\n\t\x3c!--</small>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div ng-show="isRecordingVideo" class="ytRecordWidgetFloater">--\x3e\n\t\x3c!--<div id="recordWidgetContainer"></div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Video</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<div style="width:60%; display:inline-block; padding-right: 5%">--\x3e\n\t\t\t\x3c!--<input type="text" ng-model="item.yturl">--\x3e\n\t\t\x3c!--</div>--\x3e\n\t\t\x3c!--<div style="width:40%; display:inline-block">--\x3e\n\t\t\t\x3c!--<button class="button" ng-click="startRecordVideo()" style="width: 48%; margin-right: 4%">--\x3e\n\t\t\t\t\x3c!--<span ng-if="isRecordingVideo">Cancel</span>--\x3e\n\t\t\t\t\x3c!--<span ng-if="!isRecordingVideo">Record</span>--\x3e\n\t\t\t\x3c!--</button>--\x3e\n\t\t\x3c!--</div>--\x3e\n\t\t\x3c!--<small ng-if="isRecordingVideo">Click the "Record from webcam" button above (requires Adobe Flash)</small>--\x3e\n\t\t\x3c!--<small ng-if="isProcessingVideo">Your video is being processed by YouTube and will appear automatically in this episode when it is ready. (This may take a few minutes; you can safely continue editing or close this window.)</small>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field" ng-if="(item.url || item.yturl) && !(isRecordingVideo || isProcessingVideo)">--\x3e\n\t\x3c!--<div class="label">YouTube url</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<small ng-if="item.url">{{item.url | stripParams}}</small>--\x3e\n\t\t\x3c!--<small ng-if="item.yturl && !item.url">(No valid YouTube video found)</small>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Title--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<input type="text" ng-model="item.title.en" autofocus>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Description--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<textarea ng-model="item.description.en" rows="4"></textarea>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n')}]),t.exports=n},QnA9:function(t,e,n){var i="templates/episode/wiley1.html",a='<div class="episode episode-wiley wiley-endscreentext" ng-class="episode.styleCss">\n\t\x3c!-- HACK identical to wiley2, but with endscreen text (triggered by the wiley-endscreentext class) --\x3e\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\t<div class="ghost"></div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},R1VI:function(t,e,n){var i="templates/episode/components/reviewmode.html",a='<div ng-show="appState.viewMode == \'review\'" class="searchMode">\n\t<div itt-magnet id="searchVideoMagnet" class="videoMagnet">\n\t\t<img src="'+n("rXKF")+'">\n\t</div>\n\t<div itt-search-panel></div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},RMtA:function(t,e){var n="templates/producer/item/sxs-image.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span class="eventIcon icon-image"></span>\n<div class="field">\n\t<div class="label">Title\n\t</div>\n\t<div class="input">\n\t\t<input type="text" ng-model="item.title.en" autofocus>\n\t</div>\n</div>\n<div class="field">\n\t<div class="label">Image\n\t</div>\n\t<div class="input" ng-include="\'templates/producer/upload-sxs.html\'">\n\t</div>\n</div>\n<div class="field">\n\t<div class="label">Description\n\t</div>\n\t<div class="input" sxs-input-i18n="item.description" x-inputtype="\'textarea\'"></div>\n</div>\n')}]),t.exports=n},RRIM:function(t,e,n){t.exports=n.p+"images/ewb-logo.909f4a2be8056cffe0b466c116283b75.svg"},RSWg:function(t,e,n){t.exports=n.p+"images/Logo_ColorBars-01.86cc3678e8255b294082e43f21560bc6.svg"},SO4R:function(t,e,n){var i="templates/episode/schoolclimatesolutions.html",a='<div class="episode episode-schoolclimatesolutions" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("jgfq")+'" alt="SCS: School Climate Solutions">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},SwK8:function(t,e){var n="templates/item/file.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n  <span>Edit item</span>\n</a>\n<div class="itemTemplate">\n  <div class="itemHead">\n    <a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n    <div class="category item__title">\n      \x3c!--{{item.category}}--\x3e\n      <span ng-if="item.required">(Required viewing)</span>\n    </div>\n  </div>\n  <div class="text item__text item__text--file">\n    <div class="title item__title item__title--file">\n      <a role="button" tabindex="0" x-ng-keypress="toggleDetailOnKeyPress($event)" ng-click="toggleDetailView()" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n    </div>\n    <div class="item__text item__text--file" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n  </div>\n  <div class="itemDetail" ng-if="item.showInlineDetail">\n    <span ng-switch="item.asset.content_type.indexOf(\'image/\')">\n      <span ng-switch-when="-1">\n        <a tabindex="0" ng-if="!item.noExternalLink" x-ng-keypress="outgoingLinkOnKeyPress(item.asset.url,$event)" ng-click="outgoingLink(item.asset.url)" class="escapelink item__link--escape-link">(new window)</a>\n        <itt-iframe x-src="{{item.asset.url}}" item="item" x-contenttype="{{item.asset.content_type}}"></itt-iframe>\n      </span>\n      <span ng-switch-default>\n        <img ng-src="{{item.asset.url}}">\n      </span>\n    </span>\n  </div>\n  <div class="clear "></div>\n</div>\n')}]),t.exports=n},TEP0:function(t,e){var n="templates/item/sxs-file.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemTemplate sxs-item">\n\t<a class="edit-event" ng-click="editItem()" ng-if="item.editableByThisUser">[Edit]</a>\n\t<div class="avatar">\n\t\t<img ng-src="{{item.avatar.url || appState.noAvatar}}">\n\t</div>\n\t<div class="itemHead">\n\t\t<div class="authorName" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<a ng-click="outgoingLink(item.asset.url)" ng-bind-html="item.title.en ||\'(Untitled)\'"></a>\n\t<div class="text" ng-bind-html="item.description.en"></div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},UJLu:function(t,e){var n="templates/containerepisodes.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- consider breaking these into separate templates altogether, since they have different purposes --\x3e\n<span>\n\t\x3c!-- used in narrative creation --\x3e\n\t<li ng-if="!container.episodes.length" class="container" ng-class="{isOpen: container.wasClicked, isClosed: !container.wasClicked}" ng-click="toggle();loadChildren()" ng-bind-html="container.display_name"></li>\n\t<li ng-if="container.episodes.length">\n\t\t<span class="hoverIndicator">\n\t\t\t<a ng-click="onNodeClick({node: container.episodes[0]})" ng-bind-html="containers[container._id].display_name"></a> ({{container.status}})\n\t\t</span>\n\t</li>\n\t<ul class="crossEpisodeNav" ng-class="{isOpen: container.wasClicked, isClosed: !container.wasClicked}" ng-if="container.wasClicked">\n\n\t\t<li ng-repeat="child in container.children" on-node-click="rootContext(node)" root-context="rootContext" itt-container-episodes="containers[child._id]" x-for-admin="true"></li>\n\t</ul>\n</span>\n')}]),t.exports=n},UNjH:function(t,e,n){var i="templates/episode/career-playbook.html",a='<div class="episode professional career-playbook" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent"\n\t\t  ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="professional__branding">\n\t\t<div class="branding--content">\n\t\t\t<nys-copyright class="professional__copyright"></nys-copyright>\n\t\t\t<img class="professional__logo" src="'+n("QJZl")+'"/>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"UW+C":function(t,e){var n="templates/item/transcript-withthumbnail.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate transcript">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t</div>\n\t<div class="icon" style="float:left; margin-right: 0.5em;">\n\t\t<img ng-if="item.asset.url" ng-src="{{item.asset.url}}">\n\t\t<div class="clear"></div>\n\t</div>\n\t<div class="authorName item__title" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n\t<div class="text item__text" ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},V8p6:function(t,e){var n="templates/producer/addcontent.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div ng-show="!appState.editEvent && !appState.editEpisode" class="controlPanel" ng-class="{\n\tisProducer: appState.product == \'producer\',\n\tisSxS: appState.product == \'sxs\'\n}">\n\n\t<div ng-if="appState.product == \'producer\'" class="editButtonPanel">\n\t\t<a class="button button-episode" ng-click="editEpisode()">Edit episode</a>\n\t\t<a class="button button-scene" ng-if="playbackService.getMetaProp(\'time\') > 0  && playbackService.getMetaProp(\'time\') < (playbackService.getMetaProp(\'duration\') - 0.1) && appState.viewMode == \'discover\'" ng-click="editCurrentScene()">Edit Layout</a>\n\t</div>\n\n\t<div class="producer addButtonPanel" ng-show="!item && playbackService.getMetaProp(\'time\') > 0 && playbackService.getMetaProp(\'time\') < (playbackService.getMetaProp(\'duration\') - 0.1) ">\n\t\t<span ng-if="expanded" style="padding: 0 1em" class="animate transitionExpandW">\n\t\t\t<span ng-if="appState.product == \'sxs\'">\n\t\t\t\t<a class="button button-comment" ng-click="addEvent(\'annotation\')">Comment</a>\n\t\t\t\t<a class="button button-link" ng-click="addEvent(\'link\')">Link</a>\n\t\t\t\t<a class="button button-question" ng-click="addEvent(\'question\')">Question</a>\n\t\t\t\t<a class="button button-image" ng-click="addEvent(\'image\')">Image</a>\n\t\t\t\t<a class="button button-file" ng-click="addEvent(\'file\')">File</a>\n\t\t\t\t<a class="button button-video" ng-click="addEvent(\'video\')">Video</a>\n\t\t\t</span>\n\t\t\t<span ng-if="appState.product == \'producer\'">\n\t\t\t\t<a class="button button-scene" ng-click="addEvent(\'scene\')">Layout</a>\n\t\t\t\t<a class="button button-comment" ng-click="addEvent(\'transcript\')">Transcript</a>\n\t\t\t\t<a class="button button-comment" ng-click="addEvent(\'annotation\')">Annotation</a>\n\t\t\t\t<a class="button button-link" ng-click="addEvent(\'link\')">Link</a>\n\t\t\t\t<a class="button button-image" ng-click="addEvent(\'image\')">Image</a>\n\t\t\t\t<a class="button button-file" ng-click="addEvent(\'file\')" ng-if="userHasRole(\'admin\') || userHasRole(\'customer admin\')">File</a>\n\t\t\t\t<a class="button button-question" ng-click="addEvent(\'question\')">Question</a>\n\t\t\t\t<a class="button button-chapter" ng-click="addEvent(\'chapter\')">Chapter</a>\n\t\t\t</span>\n\t\t</span>\n\t\t<span ng-if="!expanded">\n\t\t\t<a class="button button-add" ng-click="expand()">Add</a>\n\t\t</span>\n\t</div>\n\n</div>\n')}]),t.exports=n},VUBB:function(t,e){var n="templates/user.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="userHome">\n\n\t<div class="user__info">\n\t\t<div class="user__item">\n\t\t\t<div class="user__label">Role</div>\n\t\t\t<h4>{{user.role_description}}</h4>\n\t\t\t<hr>\n\t\t</div>\n\n\t\t<div clas="user__item">\n\t\t\t<div class="user__label">Name</div>\n\t\t\t<itt-edit-pencil\n\t\t\t\tcan-access="true"\n\t\t\t\ton-edit="toggleEditing()"\n\t\t\t\tng-if="!isEditing">\n\t\t\t\t<p>{{user.name}}</p>\n\t\t\t</itt-edit-pencil>\n\n\t\t\t<div ng-if="isEditing">\n\t\t\t\t<input class="userEditable" ng-model="user.name">\n\t\t\t\t<button class="button" ng-click="updateUser(); toggleEditing()">save</button>\n\t\t\t\t<button class="button" ng-click="toggleEditing()">cancel</button>\n\t\t\t</div>\n\t\t\t<hr>\n\t\t</div>\n\n\t\t<div class="user__item" ng-if="!isTrueGuest()">\n\t\t\t<div class="user__label">Email</div>\n\t\t\t<div>{{user.email}}</div>\n\t\t\t<hr>\n\t\t</div>\n\n\t\t<div class="user__item" ng-if="!isTrueGuest()">\n\t\t\t<div class="user__avatar">\n\t\t\t\t<div class="user__label">Avatar</div>\n\t\t\t\t<div>\n\t\t\t\t\t<img ng-src="{{appState.user.avatar || appState.noAvatar }}">\n\t\t\t\t</div>\n\n\t\t\t\t<div ng-if="showUploadField && !uploads">\n\t\t\t\t\t<input type="file" accept="image/*" itt-files-handler on-selected="uploadAvatar(files)">\n\t\t\t\t</div>\n\n\t\t\t\t<button class="button" ng-click="toggleUploadAvatar()">{{showUploadField ? \'cancel\' : \'replace\'}}</button>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n</div>\n')}]),t.exports=n},WeeJ:function(t,e,n){t.exports=n.p+"images/autoscroll.417c83d1f0b2eb6bceb7e048e66ede9d.svg"},X9vo:function(t,e){var n="templates/producer/inputtime.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span class="floaterContainer">\n\t<input class="inputfield" ng-model="model" name="time" ng-focus="showTools(true)" ng-blur="showTools(false)" ng-model-options="{ updateOn: \'blur\' }" style="max-width: 150px" ng-class="{invalid: (fieldname == \'end_time\' && item.invalid_end_time)}">\n\t<div class="floater" ng-if="tooltip">\n\n\t\t<ul style="list-style:none; white-space:nowrap">\n\t\t\t<li style="text-align:center; font-size: 150%">\n\t\t\t\t<a ng-click="nudge(-5)">«</a>\n\t\t\t\t<a ng-click="nudge(-1)">‹</a>\n\t\t\t\t<span> &nbsp;&nbsp; </span>\n\t\t\t\t<a ng-click="nudge(1)">›</a>\n\t\t\t\t<a ng-click="nudge(5)">»</a>\n\t\t\t</li>\n\t\t\t<li ng-click="setTime(playbackService.getMetaProp(\'time\'))">\n\t\t\t\t<a>Set to current time ({{::format(playbackService.getMetaProp(\'time\'))}})</a>\n\t\t\t</li>\n\t\t\t<span ng-if="item._type != \'Scene\' && scene().start_time > 0">\n\t\t\t\t<li ng-if="fieldname==\'start_time\'" ng-click="setTime(scene().start_time)">\n\t\t\t\t\t<a>Beginning of layout ({{format(scene().start_time)}})</a>\n\t\t\t\t</li>\n\t\t\t\t<li ng-if="fieldname==\'end_time\'" ng-click="setTime(scene().end_time)">\n\t\t\t\t\t<a>End of layout ({{format(scene().end_time)}})</a>\n\t\t\t\t</li>\n\t\t\t\t<li ng-if="fieldname==\'end_time\' && isTranscript()" ng-click="TODO">\n\t\t\t\t\t<a>Auto (TODO)</a>\n\t\t\t\t</li>\n\t\t\t</span>\n\t\t</ul>\n\t</div>\n</span>\n')}]),t.exports=n},XOLC:function(t,e){var n="templates/item/review-all.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,"\x3c!-- hack, to be removed when we move away from review mode --\x3e\n<span ng-switch=\"(item._type == 'Annotation' && item.templateUrl != 'templates/item/text-transmedia.html' && item.templateUrl != 'templates/item/text-definition.html')\">\n\t<span ng-switch-when=\"true\">\n\t\t<div ng-include=\"'templates/item/review-annotation.html'\"></div>\n\t</span>\n\t<span ng-switch-default>\n\t\t<div ng-include=\"'templates/item/review-transmedia.html'\"></div>\n\t</span>\n</span>\n")}]),t.exports=n},XP8H:function(t,e){var n="templates/video.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!--temp debug code--\x3e\n\n\x3c!--<h6 style="background-color: white; color:black;">--\x3e\n\x3c!--autoplay: {{$ctrl.playbackService.getMetaProp(\'autoplay\', $ctrl.playerId)}} |--\x3e\n\x3c!--timeline State: {{$ctrl.playbackService.getTimelineState()}} |--\x3e\n\x3c!--time: {{$ctrl.playbackService.getMetaProp(\'time\', $ctrl.playerId)}} |--\x3e\n\x3c!--first play: {{$ctrl.playbackService.getMetaProp(\'hasBeenPlayed\', $ctrl.playerId)}} |--\x3e\n\x3c!--has resumed from startAt: {{$ctrl.playbackService.getMetaProp(\'hasResumedFromStartAt\', $ctrl.playerId)}} |--\x3e\n\x3c!--player state: {{$ctrl.playbackService.getMetaProp(\'playerState\', $ctrl.playerId)}} |--\x3e\n\x3c!--start at: {{$ctrl.playbackService.getMetaProp(\'startAtTime\', $ctrl.playerId)}} |--\x3e\n\x3c!--ready: {{$ctrl.playbackService.getMetaProp(\'ready\', $ctrl.playerId)}} |--\x3e\n\x3c!--playerId: {{$ctrl.playerId}}--\x3e\n\x3c!--duration:  {{$ctrl.playbackService.getMetaProp(\'duration\', $ctrl.playerId)}}|--\x3e\n\x3c!--time: {{$ctrl.playbackService.getMetaProp(\'time\', $ctrl.playerId)}} |--\x3e\n\x3c!--player time: {{$ctrl.playbackService.getCurrentTime()}} |--\x3e\n\x3c!--ios stuff: {{$ctrl.showMask()}} iosVersion: {{$ctrl.appState.iOSVersion[0]}} unstarted: {{$ctrl.showUnstartedOverlay()}} | mainplayer {{$ctrl.mainPlayer}}--\x3e\n\x3c!--poster: {{$ctrl.poster}}--\x3e\n\x3c!--<button ng-click="$ctrl.resetKaltura()">reset kaltura</button>--\x3e\n\x3c!--</h6>--\x3e\n\n\x3c!--end temp debug code--\x3e\n<div class="np-video"\n     ng-if="$ctrl.mediaSrcArr.length > 0"\n     ng-class="{\'np--embed\': $ctrl.mainPlayer === false}">\n\n  <div class="np-video__overlay-ui"\n       ng-if="$ctrl.showMask()"\n       ng-class="$ctrl.setCssClass()"\n       ng-click="$ctrl.videoClick()">\n  </div>\n\n  <div class="np-video__wrapper">\n    <div class="np-video__element" ng-bind-html="::$ctrl.playerElement"></div>\n  </div>\n\n  <div class="poster overlay fill"\n       ng-if="$ctrl.poster && $ctrl.playbackService.getMetaProp(\'time\') === 0"\n       ng-style="{backgroundImage:\'url(\'+$ctrl.poster.url+\')\'}">\n  </div>\n</div>\n\n<div ng-if="$ctrl.mediaSrcArr.length < 1" class="np-video__empty">\n\n  <div ng-if="$ctrl.isTranscoded === false">\n    <h3>Video is currently transcoding.</h3>\n    <p>The page will refresh when the transcode is complete!</p>\n  </div>\n\n  <h1 ng-if="$ctrl.isTranscoded === true">\n    No video source available...\n  </h1>\n\n</div>\n')}]),t.exports=n},XWPa:function(t,e,n){t.exports=n.p+"images/cbs-logo.385e00440a2848c132576810aa039b68.svg"},"Y+RF":function(t,e){var n="templates/item/text-h1.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate headerItem">\n\t<div class="category"></div>\n\t<div class="item__text item__text--h1">\n\t\t<h1 ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></h1>\n\t</div>\n\n</div>\n')}]),t.exports=n},YALA:function(t,e){var n="templates/item/question-mc.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text item__text--question-mc">\n\t\t<div class="title item__title item__title--question-mc" ng-if="item.display_title | highlightSubstring: appState.searchText" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n\t\t<div ng-if="item.asset.url" class="touchable" style="float:right; max-width: 50%; padding-right: 0.5em">\n\t\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t\t<div class="touchableIndicator"></div>\n\t\t</div>\n\t\t<itt-mc-question show-chart="item.data._plugin.questiontype == \'mc-poll\'" choices="item.data._plugin.distractors" on-choice="save" data="item.data._plugin" qid="item._id"></itt-mc-question>\n\t\t\t<div class="clear"></div>\n\t</div>\n</div>\n')}]),t.exports=n},Youv:function(t,e){var n="templates/item/image-plain.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0"\tclass="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="touchable">\n\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t<div class="touchableIndicator"></div>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},Ypjs:function(t,e,n){var i="templates/scene/centerVV-mondrial.backup.html",a='\x3c!--\nVideo, Main, Alt:\n___________    ___________\n|V   |A   |    |A   |V   |\n|____|    |    |    |____|\n|M   |    |    |    |M   |\n|    |    |    |    |    |\n|____|____|    |____|____|\nshowCurrent is forced in main.\n--\x3e\n\n<div class="scene centerVV-mondrian" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="col">\n\t\t<div class="pane altPane stretchToViewport">\n\t\t\t<div class="fill bgLayer bg-alt">\n\t\t\t\t<div class="item animate" ng-repeat="item in altBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (altContentItems | isCurrent).length == 1\n\t\t\t\t\t: (altContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: altContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: altContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: altContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate mondrian" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in altFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="col">\n\t\t<div class="fill bgLayer bg-main">\n\t\t\t<div ng-if="currentMainBgItems.length > 0" class="item animate" ng-repeat="item in currentMainBgItems = (mainBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\n\t\t\t<div ng-if="currentMainBgItems.length === 0">\n\t\t\t\t<div class="static-bg__main--mondrian"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t\t<div class="pane mainPane">\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{isNarrow: isNarrow, isEmpty: mainContentItems.length == 0}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in mainItems = (mainContentItems | isCurrent | filter:byPullquoteOrH2 )" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},YxFl:function(t,e,n){var i="templates/scene/centerVV-Mondrian.html",a='\x3c!--\nVideo, Main, Alt:\n___________    ___________\n|V   |A   |    |A   |V   |\n|____|    |    |    |____|\n|M   |    |    |    |M   |\n|    |    |    |    |    |\n|____|____|    |____|____|\nshowCurrent is forced in main.\n--\x3e\n\n<div class="scene centerVV-mondrian" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="col">\n\t\t\x3c!--this div is stand alone so we can apply opacity to it and not effect the content items in the col--\x3e\n\t\t<div class="static-bg__alt" ng-style="setBgImgUrl(scene.items, \'mainCol\')"></div>\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t\t<div class="pane altPane stretchToViewport">\n\t\t\t<div class="content contentLayer stretchToViewport"\n\t\t\t\t ng-class="{singleitem: mainContentItems.length==1, isNarrow: isNarrow, isEmpty: mainContentItems.length == 0}"\n\t\t\t\t itt-width-watch>\n\t\t\t\t<div class="item animate centerVV-h2"\n\t\t\t\t\t ng-repeat="item in mainItems = (mainContentItems | isCurrent | filter:byPullquoteOrH2)"\n\t\t\t\t\t ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="col">\n\t\t\x3c!--this div is stand alone so we can apply opacity to it and not effect the content items in the col--\x3e\n\t\t<div class="static-bg__main" ng-style="setBgImgUrl(scene.items, \'altCol\')"></div>\n\t\t<div class="pane mainPane">\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (altContentItems | isCurrent).length == 1\n\t\t\t\t\t: (altContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: altContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: altContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: altContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate"\n\t\t\t\t\t ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems"\n\t\t\t\t\t ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},ZcPu:function(t,e,n){function webpackContext(t){return n(webpackContextResolve(t))}function webpackContextResolve(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var i={"./auth.html":"JtGx","./container.html":"w5Vi","./containerepisodes.html":"UJLu","./copyright.html":"HyaP","./episode/career-playbook.html":"UNjH","./episode/columbia.html":"9vsO","./episode/columbiabusiness.html":"wAkt","./episode/components/discovermode.html":"ElzS","./episode/components/reviewmode-scenes.html":"ms3E","./episode/components/reviewmode.html":"R1VI","./episode/components/video.html":"crAB","./episode/components/watchmode.html":"tOyj","./episode/components/windowfg.html":"Opc2","./episode/eliterate.html":"AjZW","./episode/episode.html":"4JKO","./episode/ewb.html":"vhlq","./episode/fieldpros.html":"yRIp","./episode/george-washington.html":"wM7k","./episode/gw.html":"81AW","./episode/gwlaw.html":"uaSq","./episode/gwsb.html":"Fttn","./episode/kellogg.html":"px/Z","./episode/middlebury.html":"GmGj","./episode/narrasys-pro.html":"pMX5","./episode/prolotherapy.html":"QfUj","./episode/purdue.html":"g7L3","./episode/regis.html":"7Kem","./episode/schoolclimatesolutions.html":"SO4R","./episode/story.html":"xs09","./episode/university-arizona.html":"6+VC","./episode/usc.html":"IsZR","./episode/washingtonSBCTC.html":"2n3E","./episode/wiley1.html":"QnA9","./episode/wiley2.html":"f0pS","./episode/wiley3.html":"yulP","./error-404.html":"eSLu","./error.html":"GUWn","./iframe.html":"iEyP","./item/caption.html":"2/3b","./item/debug.html":"GGxq","./item/file-withimage.html":"FFkw","./item/file.html":"SwK8","./item/image-caption-sliding.html":"OCYu","./item/image-caption.html":"rdiM","./item/image-fill.html":"O4Bc","./item/image-inline-withtext.html":"asq8","./item/image-inline.html":"8fXl","./item/image-linkonly.html":"qpRi","./item/image-plain.html":"Youv","./item/image-thumbnail.html":"7XCA","./item/image.html":"CVkk","./item/link-descriptionfirst.html":"IL3w","./item/link-embed.html":"Jetm","./item/link-modal-thumb.html":"JnVu","./item/link-withimage-notitle.html":"un+J","./item/link-withimage.html":"I0L0","./item/link.html":"zuiT","./item/modal.html":"+o/S","./item/pullquote-noattrib.html":"wXer","./item/pullquote.html":"84qX","./item/question-mc-image-left.html":"6fZU","./item/question-mc-image-right.html":"L3Dy","./item/question-mc-inner.html":"0ePo","./item/question-mc.html":"YALA","./item/review-all.html":"XOLC","./item/review-annotation.html":"G4Wk","./item/review-transmedia.html":"phYv","./item/review-windowfg.html":"eQIm","./item/searchresults-all.html":"55GB","./item/searchresults.html":"JkHQ","./item/sxs-annotation.html":"2+b9","./item/sxs-file.html":"TEP0","./item/sxs-image.html":"vxq4","./item/sxs-link.html":"KP/u","./item/sxs-question.html":"gr72","./item/sxs-video.html":"q06B","./item/text-definition.html":"AZay","./item/text-h1.html":"Y+RF","./item/text-h2.html":"kvzn","./item/text-transmedia.html":"3gcz","./item/transcript-withthumbnail.html":"UW+C","./item/transcript.html":"7GUz","./item/usc-badges-inner.html":"nd4G","./item/usc-badges.html":"dt7p","./loading.html":"m47d","./narrative/default.html":"6ze8","./narrativelist.html":"4bbU","./navpanel.html":"Of5n","./player-timeline.html":"x+pf","./player.html":"p3P+","./producer/addcontent.html":"V8p6","./producer/annotator-autocomplete.html":"EDO7","./producer/asset-uploader.html":"emMF","./producer/container-assets.html":"rLXe","./producer/episode.html":"cBzx","./producer/episodelist.html":"5iOH","./producer/inputi18n.html":"LSM6","./producer/inputtime.html":"X9vo","./producer/item.html":"p2SB","./producer/item/producer-annotation.html":"rSRG","./producer/item/producer-chapter.html":"enrJ","./producer/item/producer-file.html":"+ViR","./producer/item/producer-image.html":"K8cx","./producer/item/producer-link.html":"DJEM","./producer/item/producer-question.html":"GqFw","./producer/item/producer-scene.html":"QIbj","./producer/item/producer-transcript.html":"dw4R","./producer/item/producer-video.html":"QgsF","./producer/item/sxs-annotation.html":"N29+","./producer/item/sxs-file.html":"cWz7","./producer/item/sxs-image.html":"RMtA","./producer/item/sxs-link.html":"rGHM","./producer/item/sxs-question.html":"NnMI","./producer/item/sxs-video.html":"K96E","./producer/questionauthoring.html":"AiEB","./producer/upload-masterasset.html":"AeV0","./producer/upload-poster.html":"gJY5","./producer/upload-producer.html":"GeQP","./producer/upload-sxs.html":"fJsy","./root.html":"CQGL","./scene/1col.html":"rfeV","./scene/2colL.html":"2qXd","./scene/2colR.html":"iutC","./scene/centerVV-Mondrian.html":"YxFl","./scene/centerVV-mondrial.backup.html":"Ypjs","./scene/centerVV.html":"cm1R","./scene/centered.html":"mbIM","./scene/centeredPro.html":"qZRx","./scene/cornerH.html":"GoGc","./scene/cornerV.html":"JTcP","./scene/debug.html":"mNIM","./scene/endingscreen.html":"liE5","./scene/landingscreen.html":"D/IP","./scene/mirrored-twocol.html":"F5VT","./scene/pip.html":"uFtN","./searchpanel.html":"sGzq","./testbed-event.html":"888c","./timeline-story.html":"9ij1","./toolbar-story.html":"1Wv5","./user.html":"VUBB","./video.html":"XP8H"};webpackContext.keys=function(){return Object.keys(i)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id="ZcPu"},asq8:function(t,e){var n="templates/item/image-inline-withtext.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text">\n\t\t<div class="title item__title item__title--image-inline-with-text" ng-if="item.display_title | highlightSubstring: appState.searchText" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n\n\t\t<div class="touchable">\n\t\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t\t<div class="touchableIndicator"></div>\n\t\t</div>\n\t\t<div class="item__text item__text--image text--inline-with-text" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t\t<div class="clear"></div>\n\t</div>\n</div>\n')}]),t.exports=n},c3xB:function(t,e,n){t.exports=n.p+"images/middlebury-logo.cd5e3ca64d7cd59e09ac496fe143682f.svg"},cBzx:function(t,e){var n="templates/producer/episode.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemEdit authoringForm">\n  <form name="ittEpisodeForm" class="doValidate">\n    <div ng-if="appState.product == \'producer\'">\n      \x3c!-- <span class="eventIcon icon-episode"></span> --\x3e\n\n      <div class="ittTabs" itt-tabs>\n\n        \x3c!-- begin tabset --\x3e\n        <div class="ittTab" itt-tab title="Episode">\n          \x3c!-- begin episode content tab --\x3e\n\n          <div class="field" ng-hide="!userHasRole(\'admin\')">\n            <div class="label">Master asset type</div>\n            <div class="input">\n              <select size="1" ng-model="masterAssetType">\n                <option value="Video">Native Video</option>\n                <option value="WebUrl">Youtube / Kaltura / Wistia</option>\n              </select>\n            </div>\n          </div>\n          <div class="field" ng-if="masterAssetType == \'Video\' && userHasRole(\'admin\')">\n            <div class="label">Video</div>\n            <div class="input" ng-include="\'templates/producer/upload-masterasset.html\'"></div>\n          </div>\n\n          <itt-url-field\n            label="Video URL"\n            ng-if="masterAssetType === \'WebUrl\'"\n            data="::masterAsset.mediaSrcArr[0]"\n            context="episode"\n            on-attach="attachMediaSrc($url)">\n          </itt-url-field>\n\n          <div class="field" ng-if="showmessage">\n            <div class="input" ng-bind-html="showmessage"></div>\n          </div>\n          <itt-title-field data="episode" model-opts="{ debounce: 500 }" do-validate="true" itt-item-form="ittEpisodeForm"></itt-title-field>\n          <itt-description-field data="episode" model-opts="{debounce: 50}"></itt-description-field>\n\n\n          <div class="field" ng-if="userHasRole(\'admin\')">\n            <div class="label">Poster image\n            </div>\n            <div class="input" ng-include="\'templates/producer/upload-poster.html\'">\n            </div>\n          </div>\n\n          <div class="field">\n            <div class="label">Status</div>\n            <div class="input">\n              <select size="1" ng-model="episode.status">\n                <option value="Published">Published</option>\n                <option value="Unpublished">Unpublished</option>\n              </select>\n            </div>\n          </div>\n\n          <itt-language-flags></itt-language-flags>\n          <itt-language-select\n            ng-if="languageCount > 1"\n            data="episode"\n            lang-form="langForm">\n          </itt-language-select>\n          <div class="field" ng-if="episode.languages.length > 1">\n            <div class="label">Current Language</div>\n            <div class="input">\n              <select size="1" ng-model="appState.lang" ng-change="forcePreview()"\n                      ng-options="language.code as (\'[\'+language.code.toUpperCase()+\']\') for language in episode.languages">\n              </select>\n            </div>\n          </div>\n\n          <div class="field" ng-if="userHasRole(\'admin\') && episode.languages.length > 1">\n            <div class="label">Translations</div>\n            <div class="input" ng-if="doCheckForTranslations == null">\n              {{translationMessage(episode.languages)}}\n              <button ng-click="beginBackgroundTranslations(episode._id)">Begin translation</button>\n            </div>\n            <div ng-if="doCheckForTranslations === true">\n              {{afterTranslationAttempt}}\n            </div>\n          </div>\n\n          <itt-upload-transcripts\n            ng-if="episode.master_asset_id && !episode._master_asset_was_changed  && (userHasRole(\'admin\') || userHasRole(\'customer admin\'))"\n            episode-id="{{episode._id}}">\n          </itt-upload-transcripts>\n\n          \x3c!-- end episode content tab --\x3e\n        </div>\n        <div class="ittTab" itt-tab title="Style">\n          \x3c!-- begin styles tab --\x3e\n          <itt-template-select data="episode"></itt-template-select>\n          \x3c!--<itt-typography-select></itt-typography-select>--\x3e\n          \x3c!--<itt-color-select></itt-color-select>--\x3e\n          <itt-timestamp-select></itt-timestamp-select>\n          <itt-highlight-select></itt-highlight-select>\n          <itt-transition-select></itt-transition-select>\n          \x3c!-- end styles tab --\x3e\n        </div>\n        \x3c!-- end of tabset --\x3e\n      </div>\n    </div>\n    <div class="ittTabFoot">\n      <a ng-click="cancelEdit()">Cancel</a> &nbsp; &nbsp;\n\n      <button ng-click="saveEpisode()" ng-disabled="blockDoubleClicks || ittEpisodeForm.$invalid">Save</button>\n    </div>\n  </form>\n</div>\n')}]),t.exports=n},cWz7:function(t,e){var n="templates/producer/item/sxs-file.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span class="eventIcon icon-file"></span>\n<div class="field">\n\t<div class="label">Title\n\t</div>\n\t<div class="input">\n\t\t<input type="text" ng-model="item.title.en" autofocus>\n\t</div>\n</div>\n<div class="field">\n\t<div class="label">File\n\t</div>\n\t<div class="input" ng-include="\'templates/producer/upload-sxs.html\'">\n\t</div>\n</div>\n<div class="field">\n\t<div class="label">Description\n\t</div>\n\t<div class="input" sxs-input-i18n="item.description" x-inputtype="\'textarea\'"></div>\n</div>\n')}]),t.exports=n},cm1R:function(t,e,n){var i="templates/scene/centerVV.html",a='\x3c!--\nVideo, Main, Alt:\n___________    ___________\n|V   |A   |    |A   |V   |\n|____|    |    |    |____|\n|M   |    |    |    |M   |\n|    |    |    |    |    |\n|____|____|    |____|____|\nshowCurrent is forced in main.\n--\x3e\n\n<div class="scene centerVV" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="col">\n\t\t\x3c!--this div is stand alone so we can apply opacity to it and not effect the content items in the col--\x3e\n\t\t<div class="static-bg__main" ng-style="setBgImgUrl(scene.items, \'mainCol\')"></div>\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t\t<div class="pane mainPane">\n\t\t\t<div class="content contentLayer stretchToViewport"\n\t\t\t\t ng-class="{singleitem: mainContentItems.length==1, isNarrow: isNarrow, isEmpty: mainContentItems.length == 0}"\n\t\t\t\t itt-width-watch>\n\t\t\t\t<div class="item animate centerVV-h2"\n\t\t\t\t\t ng-repeat="item in mainItems = (mainContentItems | isCurrent | filter:byPullquoteOrH2)"\n\t\t\t\t\t ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="col">\n\t\t\x3c!--this div is stand alone so we can apply opacity to it and not effect the content items in the col--\x3e\n\t\t<div class="static-bg__alt" ng-style="setBgImgUrl(scene.items, \'altCol\')"></div>\n\t\t<div class="pane altPane stretchToViewport">\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (altContentItems | isCurrent).length == 1\n\t\t\t\t\t: (altContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: altContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: altContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: altContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate"\n\t\t\t\t\t ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems"\n\t\t\t\t\t ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},crAB:function(t,e){var n="templates/episode/components/video.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div itt-magnetized class="pane videoContainer">\n\n\t<span ng-if="episode.swap && episode.replacingMasterAsset" style="visibility: hidden;">\n\t\t<itt-video class="video contentLayer"\n\t\t\t\t   media-src-arr="episode.swap.mediaSrcArr"\n\t\t\t\t   poster="episode.poster"\n\t\t\t\t   player-id="episode.swap._id"\n\t\t\t\t   main-player="true">\n\t\t</itt-video>\n\t</span>\n\t<span ng-if="episode.masterAsset && !episode.replacingMasterAsset">\n\t\t\x3c!--<div class="video contentLayer" itt-video="episode.masterAsset" poster="episode.poster"></div>--\x3e\n\t\t<itt-video class="video contentLayer"\n\t\t\tmedia-src-arr="episode.masterAsset.mediaSrcArr"\n\t\t\tposter="episode.poster"\n\t\t\tplayer-id="episode.masterAsset._id"\n\t\t\tmain-player="true">\n\t\t</itt-video>\n\t</span>\n\n\t<div class="pane fill overlay fgLayer">\n\t\t<div ng-class="item.styleCss + \' \' + item.state" itt-item="item" class="item animate" ng-repeat="item in episode.items | itemLayout:\'videoOverlay\' | isCurrent">\n\t\t</div>\n\t</div>\n</div>\n')}]),t.exports=n},dt7p:function(t,e){var n="templates/item/usc-badges.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemTemplate uscBadges">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t</div>\n\t<span ng-include="\'templates/item/usc-badges-inner.html\'"></span>\n</div>\n')}]),t.exports=n},dw4R:function(t,e){var n="templates/producer/item/producer-transcript.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- <span class="eventIcon icon-comment"></span> --\x3e\n\x3c!--DEPRECATED WITH PRODUCER V1 --\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Speaker [{{appState.lang}}]--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<div sxs-annotator-autocomplete="annotators" item="item" ng-model="item.annotator"></div>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Speaker thumbnail--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input" ng-include="\'templates/producer/upload-producer.html\'">--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Transcript [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.annotation" x-inputtype="\'textarea\'" autofocus></div>--\x3e\n\x3c!--</div>--\x3e\n')}]),t.exports=n},eQIm:function(t,e){var n="templates/item/review-windowfg.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text">\n\t\t<div class="title">\n\t\t\t<a tabindex="0" ng-click="seek(item.start_time)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t</div>\n\t\t<div class="text" ng-if="item.data._plugin._type == \'question\'">\n\t\t\tYou have\n\t\t\t<span ng-if="!item.data._plugin.hasBeenAnswered"> not yet </span>\n\t\t\tanswered this\n\t\t\t<span ng-if="item.data._plugin.questiontype == \'mc-poll\'"> poll </span>\n\t\t\tquestion.\n\t\t</div>\n\t\t<div class="text" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t\t<div class="clear"></div>\n\t</div>\n</div>\n')}]),t.exports=n},eSLu:function(t,e){var n="templates/error-404.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="errors">\n\t<div class="error">\n\t\t<h3>Error: no such route</h3>\n\t\t<p><i>404. File not found. Sorry!</i></p>\n\t</div>\n</div>\n')}]),t.exports=n},ebgR:function(t,e,n){t.exports=n.p+"images/ua_horiz.7037b23792b318a2e528b04188d4af26.svg"},emMF:function(t,e){var n="templates/producer/asset-uploader.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="assetUploader">\n  <div ng-if="$ctrl.uploads.length">\n    <div class="uploadList" ng-repeat="upload in $ctrl.uploads">\n\t\t\t<span class="uploadName">\n\t\t\t\t{{$ctrl.uploadStatus[$index].name}}:\n\t\t\t</span>\n      <span class="uploadProgress">\n\t\t\t\t<span ng-if="$ctrl.uploadStatus[$index].done">Upload complete</span>\n\t\t\t\t<div ng-if="$ctrl.uploadStatus[$index].error">Error</div>\n\t\t\t\t<span ng-if="!$ctrl.uploadStatus[$index].done && !$ctrl.uploadStatus[$index].error">\n\t\t\t\t\t<progress ng-attr-max="{{$ctrl.uploadStatus[$index].bytesTotal}}" ng-attr-value="{{$ctrl.uploadStatus[$index].bytesSent}}">\n\t\t\t\t\t</progress>\n\t\t\t\t\t<span ng-switch="$ctrl.uploadStatus[$index].percent">\n\t\t\t\t\t\t<span ng-switch-when="100">...</span>\n\t\t\t\t\t\t<span ng-switch-default>{{$ctrl.uploadStatus[$index].percent}}%</span>\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</span>\n      <div ng-if="$ctrl.uploadStatus[$index].error">{{$ctrl.uploadStatus[$index].error}}</div>\n    </div>\n    <span ng-if="$ctrl.uploadsinprogress > 0">{{$ctrl.uploadsinprogress}} files remaining\n\t\t\t<button ng-if="!$ctrl.paused" ng-click="$ctrl.pauseUpload()">Pause</button>\n\t\t\t<button ng-if="$ctrl.paused" ng-click="$ctrl.resumeUpload()">Resume</button>\n\t\t\t<button ng-click="$ctrl.cancelUpload()">Cancel</button>\n\t\t</span>\n  </div>\n  <div ng-if="$ctrl.errormessage" class="error-red" ng-bind-html="$ctrl.errormessage"></div>\n\n\n  <div class="uploadDropTarget">\n    <a style="float:right" ng-click="$ctrl.showInstructions = !$ctrl.showInstructions">(?)</a> Drag and drop\n    <span ng-if="$ctrl.multiple">files</span>\n    <span ng-if="!$ctrl.multiple">a file</span> here\n    <br>\n    <small>\n      or choose\n      <span ng-if="$ctrl.multiple">files</span>\n      <span ng-if="!$ctrl.multiple">a file</span> to upload:\n      \x3c!--<input class="uploadFileInput" type="file" multiple onchange="angular.element(this).scope().handleUploads(this.files)">--\x3e\n      <input class="uploadFileInput" type="file" multiple="true" itt-files-handler on-selected="$ctrl.handleUploads(files)">\n    </small>\n    <div ng-if="$ctrl.showInstructions" style="text-align:left">\n      \x3c!--<small>We support uploads of most common file formats, including .doc, .docx, .jpeg, .jpg, .pdf, .png, .ppt, .pptx, .rtf, .txt, and .zip. </small>--\x3e\n      <small>{{$ctrl.manPage}}</small>\n    </div>\n  </div>\n\n</div>\n')}]),t.exports=n},enrJ:function(t,e){var n="templates/producer/item/producer-chapter.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- <span class="eventIcon icon-scene"></span> --\x3e\n\x3c!--DEPRECATED WITH PRODUCER V1 --\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Chapter Title [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.title" x-inputtype="\'input\'" autofocus></div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Description [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.description" x-inputtype="\'textarea\'"></div>--\x3e\n\x3c!--</div>--\x3e\n')}]),t.exports=n},f0pS:function(t,e,n){var i="templates/episode/wiley2.html",a='<div class="episode episode-wiley" ng-class="episode.styleCss">\n\t\x3c!-- HACK identical to wiley1, but without endscreen text (triggered by the wiley-endscreentext class) --\x3e\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\t<div class="ghost"></div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},fJsy:function(t,e){var n="templates/producer/upload-sxs.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- editor: no master assets, no \'browse\', and use userspace instead of container id --\x3e\n\n<div>\n\t<div ng-if="(item.asset) && !showUploadButtons">\n\t\t{{item.asset.display_name}}\n\t\t<button class="button" ng-click="replaceAsset(item.asset._id)"> Replace this asset </button>\n\t</div>\n\t<div ng-if="showUploadButtons || !(item.asset)">\n\t\t<itt-asset-uploader ng-if="item.producerItemType === \'image\'" callback="assetUploaded(data)"></itt-asset-uploader>\n\n\t\t<itt-asset-uploader\n      ng-if="item.producerItemType === \'file\'"\n      callback="assetUploaded(data)" mime-types="application/*, text/*, audio/*, model/*"\n      instructions="We currently accept all non-image or non-video files."\n      error-text="Please make sure you are not trying to upload an image or video file.">\n    </itt-asset-uploader>\n\t</div>\n</div>\n')}]),t.exports=n},g7L3:function(t,e,n){var i="templates/episode/purdue.html",a='<div class="episode episode-purdue" ng-class="episode.styleCss">\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("3vSo")+'" alt="Purdue">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},gJY5:function(t,e){var n="templates/producer/upload-poster.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- producer episode poster asset--\x3e\n\n<div ng-if="showAssetPicker" class="floatAssetPicker">\n\t<div class="scrollContainer">\n    <sxs-container-assets container-id="{{episodeContainerId}}"></sxs-container-assets>\n\t</div>\n\t<div class="controlsContainer">\n\t\t<button ng-click="endChooseAsset();">Cancel</button>\n\t</div>\n</div>\n\n<div>\n\t<div ng-if="episode.poster && !showUploadButtonsPoster">\n\t\t{{episode.poster.display_name}}\n\t\t<button class="button" ng-click="replaceAsset(\'Poster\')">Replace this</button>\n\t</div>\n\t<div ng-if="showUploadButtonsPoster || !episode.poster">\n\t\t<span ng-if="showUploadFieldPoster">\n      <itt-asset-uploader container-id="{{episodeContainerId}}" callback="posterUploaded(data)"></itt-asset-uploader>\n\t\t</span>\n\t\t<span ng-if="!showUploadFieldPoster">\n\t\t\t<button class="button" ng-click="chooseAsset(\'Poster\')">Browse uploaded</button>\n\t\t\t<button class="button" ng-click="toggleUpload(\'Poster\')">Upload new</button>\n\t\t</span>\n\t</div>\n</div>\n')}]),t.exports=n},gr72:function(t,e){var n="templates/item/sxs-question.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemTemplate sxs-item">\n\t<a class="edit-event" ng-click="editItem()" ng-if="item.editableByThisUser">\n\t\t<span>Edit item</span>\n\t</a>\n\t<div class="avatar">\n\t\t<img ng-src="{{item.avatar.url || appState.noAvatar }}">\n\t</div>\n\t<div class="itemHead">\n\t\t<div class="authorName" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div class="text">\n\t\t<div class="title" ng-if="item.display_title | highlightSubstring: appState.searchText" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n\t\t<div ng-if="item.asset.url" class="touchable" style="float:right; max-width: 50%; padding-right: 0.5em">\n\t\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t\t<div class="touchableIndicator"></div>\n\t\t</div>\n\t\t<itt-mc-question show-chart="item.data._plugin.questiontype == \'mc-poll\'" choices="item.data._plugin.distractors" on-choice="save" data="item.data._plugin" qid="item._id"></itt-question>\n\t\t\t<div class="clear"></div>\n\t</div>\n</div>\n')}]),t.exports=n},iEyP:function(t,e){var n="templates/iframe.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="iframeContainer">\n\t\x3c!--temp hide loading spinner until we wire it up correctly--\x3e\n\t<itt-loading ng-if="$ctrl.isLoading"></itt-loading>\n\n\t<iframe\n\t\tng-if="!ctrl.isLoading"\n\t\tng-src="{{$ctrl.src}}"\n\t\tng-attr-scrolling="{{$ctrl.iOSScroll}}"\n\t\tng-style="$ctrl.styles"\n\t\tng-attr-sandbox="{{$ctrl.sandbox}}">\n\t</iframe>\n</div>\n')}]),t.exports=n},iutC:function(t,e,n){var i="templates/scene/2colR.html",a='<div class="scene twocol" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="videoPositioner">\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t</div>\n\t<div class="col col1">\n\t\t<div class="pane altPane">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in (altBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (altContentItems | isCurrent).length == 1\n\t\t\t\t\t: (altContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: altContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: altContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: altContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<img src="'+n("rXKF")+'" class="matchVideoHeight ">\n\t\t\t\t<div class="clear"></div>\n\t\t\t\t<div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear "></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in (altFgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="col col2">\n\t\t<div class="pane mainPane">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in (mainBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (mainContentItems | isCurrent).length == 1\n\t\t\t\t\t: (mainContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: mainContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: mainContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: mainContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<img src="'+n("rXKF")+'" class="matchVideoHeight ">\n\t\t\t\t<div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t\t<div class="clear "></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},jgfq:function(t,e,n){t.exports=n.p+"images/schoolclimatesolutions.07cde7348592f3c82ac1cdafce3aa5b7.svg"},kDpR:function(t,e,n){t.exports=n.p+"images/Narrasys_brand_logo.1219260904deb927b3a14bb995f27a5c.svg"},kRx8:function(t,e,n){t.exports=n.p+"images/kellogg-k.286c07c6bc767760bb9fd57c5803692e.svg"},kvzn:function(t,e){var n="templates/item/text-h2.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate headerItem">\n\t<div class="category"></div>\n\t<div class="item__text item__text--h2">\n\t\t<h2 ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></h2>\n\t</div>\n\n</div>\n')}]),t.exports=n},l1Qu:function(t,e){},liE5:function(t,e,n){var i="templates/scene/endingscreen.html",a='<div class="endingscreen stretchToViewport">\n\t<div class="pane introtext">\n\t\t<p>Thanks for watching:&nbsp;\n\t\t\t<span ng-bind-html="episode.display_title"></span>\n\t\t</p>\n\t\t<br>\n\t</div>\n\t<div itt-magnet class="videoMagnet">\n\t\t<img src="'+n("rXKF")+'">\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},m2IE:function(t,e,n){"use strict";function ContainerAssetsTestController(t,e,n){t.logout=n.logout,t.containerId=e.containerId}function createInstance(t,e){var n;switch(t){case"Link":n=new d;break;case"Annotation":n=new p;break;case"Bookmark":n=new m;break;case"Chapter":n=new u;break;case"Image":n=new g;break;case"Plugin":n=new v;break;case"Scene":n=new h;break;case"Text":n=new f;break;case"Upload":n=new y;break;case"Narrative":n=new r;break;case"Asset":n=new o;break;case"Customer":n=new s;break;case"Timeline":n=new a}return Object.assign(n,e),n}function EditController(t,e,n,i,a,s,r,o,l,c,d,p){function onFormativeChecked(e){angular.forEach(t.item.data._plugin.distractors,function(t){t!==e&&(t.correct=void 0)})}t.uneditedScene=angular.copy(t.item),t.userHasRole=c.userHasRole,t.canAccess=c.userHasRole("admin")||c.userHasRole("customer admin"),t.selectService=a,t.item&&d[t.item.producerItemType]?t.mimes=d[t.item.producerItemType]:t.mimes=d.default,t.chooseAsset=function(n){n=n||"",t.showAssetPicker=!0,t.w1=e.$on("UserSelectedAsset",function(e,i){"Poster"===n?t.attachPosterAsset(i):t.attachChosenAsset(i),t["showUploadButtons"+n]=!1,t.endChooseAsset()}),t.w2=e.$on("userKeypress.ESC",t.endChooseAsset)},t.endChooseAsset=function(){t.w1(),t.w2(),t.showAssetPicker=!1},t.toggleUpload=function(e){e=e||"",t["showUploadField"+e]=!t["showUploadField"+e]},t.addDistractor=function(){t.item.data._plugin.distractors.push({text:"",index:t.item.data._plugin.distractors.length+1})},t.onFormativeChecked=onFormativeChecked,t.addEvent=function(n){if("scene"===n){var i=Math.round(100*p.getMetaProp("time"))/100;if(o.isOnExistingSceneStart(i))return t.editCurrentScene(i)}var r=T(n);r.cur_episode_id=s.episodeId,r.episode_id=s.episodeId,s.user&&s.user.avatar_id&&(r.avatar_id=s.user.avatar_id),o.cache("event",r),s.editEvent=o.events["internal:editing"],s.videoControlsActive=!0,s.videoControlsLocked=!0,o.resolveEpisodeEvents(s.episodeId),l.injectEvents([o.events["internal:editing"]]),"scene"===n&&(a.onSelectChange(s.editEvent),l.updateSceneTimes(s.episodeId)),e.$emit("searchReindexNeeded")};var m=function(t){return!("Annotation"!==t._type||!t.templateUrl.match(/transcript/))},u=function(){var t=o.episodes[s.episodeId];return angular.copy(t.items).filter(m)},g=function(t,e){for(var n=0,i=0,a=t.length;i<a;i++)if(t[i]._id===e._id){n=i;break}return n},v=function(t,e){t=t.sort(k);var n=g(t,e),i=[];return 0===n?i:(n<t.length-1&&n>=1&&(_(t[n-1])||i.push(t[n-1])),i)},h=function(t,e){t=t.sort(k);var n=g(t,e),i=[];return 0===n?n<t.length-1&&(_(t[n+1])||i.push(t[n+1])):n<t.length-1&&(_(t[n+1])||i.push(t[n+1]),n>=1&&(_(t[n-1])||i.push(t[n-1]))),i},f=function(t,e,n){if(m(t)){var i=[],a=u();switch(e){case"create":i=h(a,t);break;case"delete":i=v(a,t);break;case"update":n&&f(n,"delete"),f(t,"create")}angular.forEach(i,function(t){r.storeItem(t).then(function(){},function(t){})})}};t.saveEvent=function(){var n=angular.copy(s.editEvent);if(t.blockDoubleClicks=!0,n.cur_episode_id=s.episodeId,"Scene"===n._type){var i=C(n);angular.forEach(i,function(t){r.storeItem(t).then(function(){},function(t){})})}r.storeItem(n).then(function(t){t.cur_episode_id=s.episodeId;var i="update";if("internal:editing"===s.editEvent._id){l.removeEvent("internal:editing"),delete o.events["internal:editing"];var a=r.resolveIDs(t),c=createInstance(t._type,a);o.cache("event",c),o.resolveEpisodeEvents(s.episodeId),i="create";var d=t.asset_id||t.link_image_id||t.annotation_image_id;d&&n.asset&&n.asset._id===d&&o.assocEventWithAsset(t._id,d)}"Scene"===t._type?(l.timelineEvents=[],l.injectEvents(o.episodeEvents(s.episodeId),0)):(o.resolveEpisodeEvents(s.episodeId),l.updateEventTimes(o.events[t._id])),f(t,i),angular.forEach(n.removedAssets,function(t){r.deleteAsset(t)}),s.editEvent=!1,e.$emit("searchReindexNeeded")},function(t){})};var y=o.getEpisodeScenes,_=function(t){return t._id&&t._id.match(/internal/)};t.getItemsAfter=function(t,e){for(var n=[],i=0,a=t.length;i<a;i++)_(t[i])||(e<t[i].start_time||e<t[i].end_time)&&n.push(t[i]);return n},t.saveEpisode=function(){var e=angular.copy(s.editEpisode);r.storeEpisode(e).then(function(a){if(o.cache("episode",r.resolveIDs(a)),s.editEpisode._master_asset_was_changed){delete o.episodes[a._id]._master_asset_was_changed;var c=o.assets[a.master_asset_id].duration,d=c-.01;o.episodes[s.episodeId].masterAsset=o.assets[t.episode.master_asset_id],o.episodes[s.episodeId].master_asset_id=a.master_asset_id;var m=[],u=[],g=o.episodes[e._id];angular.forEach(g.scenes,function(t){t.start_time>c?u.push(t):t.end_time>c&&(t.end_time=d,m.push(t))}),angular.forEach(g.items,function(t){t.start_time>c&&(t.start_time=d),t.end_time>c&&(t.end_time=d),m.push(t)});var v=o.events["internal:endingscreen:"+e._id];v?(v.start_time=d,v.end_time=d):o.addEndingScreen(e._id),o.resolveEpisodeEvents(s.episodeId),o.resolveEpisodeAssets(s.episodeId),p.setMetaProp("duration",c),s.editEpisode=!1,s.videoControlsLocked=!1,l.init(s.episodeId),angular.forEach(m,function(t){t._id.indexOf("internal")<0&&r.storeItem(t)}),angular.forEach(u,function(t){t._id.indexOf("internal")<0&&r.deleteItem(t._id)}),n(function(){i.location.reload()},500)}else o.resolveEpisodeEvents(s.episodeId),o.resolveEpisodeAssets(s.episodeId),s.editEpisode=!1,s.videoControlsLocked=!1},function(t){})};var b=function(t,e){for(var n=0;n<t.length;n++){if(void 0===t[n]._id||"internal:editing"===t[n]._id){t.splice(n,1);break}if(e&&t[n]._id===e._id){t[n]=e;break}}return t},x=function(t,e){for(var n=1,i=t.length;n<i;n++)n===i-1?t[n].end_time=e:t[n].end_time!==t[n+1].start_time&&(t[n].end_time=t[n+1].start_time)},w=function(t,e){for(var n=!1,i=0,a=t.length;i<a;i++)if(t[i]._id===e._id){n=!0;break}n||t.push(e)},S=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]._id===e){t.splice(n,1);break}},k=function(t,e){return t.start_time-e.start_time},C=function(e,n){var i=p.getMetaProp("duration"),a=angular.copy(y()),s=[];n?w(a,t.uneditedScene):b(a,t.uneditedScene),a=a.sort(k),x(a,i),S(a,e._id),n||a.push(e),a=a.sort(k);for(var r=1,o=a.length;r<o;r++)r===o-1?a[r].end_time!==i&&(a[r].end_time=i,s.push(a[r])):a[r].end_time!==a[r+1].start_time&&(a[r].end_time=a[r+1].start_time,s.push(a[r]));return s};t.editCurrentScene=function(t){var e=o.sceneAtEpisodeTime(s.episodeId,t);s.editEvent=o.events[e._id],s.editEvent.templateOpts=a.getTemplates("scene"),s.editEvent.cur_episode_id=s.episodeId,s.editEvent.episode_id=s.episodeId,s.editEvent.producerItemType="scene",s.videoControlsActive=!0,s.videoControlsLocked=!0,a.onSelectChange(s.editEvent)},t.editEpisode=function(){s.editEpisode=o.episodes[s.episodeId],s.editEpisode.templateOpts=a.getTemplates("episode"),s.videoControlsActive=!0,s.videoControlsLocked=!0},t.deleteEvent=function(t){if(window.confirm("Are you sure you wish to delete this item?")){var e={};e._id=t;var n=o.events[t]._type;if("Scene"===n){var i=C(e,!0);angular.forEach(i,function(t){r.storeItem(t).then(function(){},function(t){})})}r.deleteItem(t).then(function(){"sxs"===s.product&&o.events[t].asset&&r.deleteAsset(o.events[t].asset._id),l.removeEvent(t),delete o.events[t],o.resolveEpisodeEvents(s.episodeId),"Scene"!==n&&"Chapter"!==n||l.updateSceneTimes(s.episodeId),f(e,"delete"),s.editEvent=!1,s.videoControlsLocked=!1},function(t){})}},t.cancelEventEdit=function(t){var e=t.cur_episode_id?t.cur_episode_id:t.episode_id;"internal:editing"===s.editEvent._id?(delete o.events["internal:editing"],l.removeEvent("internal:editing")):o.events[s.editEvent._id]=t,o.resolveEpisodeEvents(e),"Scene"===t._type?l.updateSceneTimes(e):l.updateEventTimes(t),s.editEvent=!1,s.videoControlsLocked=!1},t.cancelEpisodeEdit=function(t){o.episodes[s.episodeId]=t,o.deriveEpisode(o.episodes[t._id]),o.resolveEpisodeContainers(t._id),o.resolveEpisodeEvents(t._id),s.editEpisode=!1,s.videoControlsLocked=!1};var T=function(t){var e={_id:"internal:editing",start_time:p.getMetaProp("time"),episode_id:s.episodeId,isCurrent:!0,producerItemType:t,layouts:["inline"],styles:[]},n={};if("scene"===t&&(n={_type:"Scene",title:{},description:{}}),"chapter"===t&&(n={_type:"Chapter",title:{},description:{}}),"video"===t&&(n={_type:"Link",link_image_id:"",url:"",title:{},description:{}}),"comment"!==t&&"transcript"!==t&&"annotation"!==t||(n={_type:"Annotation",annotation:{},annotator:{},annotation_image_id:""}),"file"!==t&&"image"!==t||(n={_type:"Upload",asset_id:"",title:{},description:{}}),"link"===t&&(n={_type:"Link",link_image_id:"",url:"https://",title:{},target:"_self",description:{},url_status:{}}),"question"===t&&(n={_type:"Plugin",title:{},data:{_pluginType:"question",_version:2,_plugin:{questiontext:"",questiontype:"mc-formative",distractors:[{index:1,text:""},{index:2,text:""},{index:3,text:""},{index:4,text:""}],correctfeedback:"",incorrectfeedback:""}}},n.plugin=n.data._plugin),"sxs"===s.product)n.sxs=!0,n.annotator={en:s.user.name},n.layouts=["windowFg"],n.end_time=s.time,n.stop=!0,n.templateUrl="templates/item/sxs-"+t+".html";else{var i={scene:"templates/scene/centered.html",transcript:"templates/item/transcript.html",annotation:"templates/item/text-h2.html",link:"templates/item/link.html",image:"templates/item/image-plain.html",file:"templates/item/file.html",question:"templates/item/question-mc.html",video:"TODO:VIDEO"};n.templateOpts=a.getTemplates(t),n.templateUrl=i[t]}return angular.extend(e,n),e}}function EpisodeController(){}function ErrorController(t,e,n,i){t.errorSvc=e,t.logout=i.logout,t.user=n.user,t.dismiss=function(t){for(var n=0;n<e.errors.length;n++)e.errors[n]===t&&(e.errors.splice(n,1),n=e.errors.length);for(n=0;n<e.notifications.length;n++)e.notifications[n]===t&&(e.notifications.splice(n,1),n=e.notifications.length)}}function EventTestController(t,e,n,i,a){n.mockEpisode("ep1"),a.episodeId="ep1",a.product="producer",a.lang="en",t.item=i.events[e.eventId]}function ItemController(t,e){t.seek=function(n){e.seek(n,"clickedOnItem",t.item._id)};var n={ENTER:13,SPACE:32};t.seekOnKeyPress=function(e,i){var a=i,s=!0;switch(a.keyCode){case n.ENTER:case n.SPACE:t.seek(e),s=!1;break;default:s=!0}s||(i.stopPropagation(),i.preventDefault())}}function NarrativeCtrl(t,e,n){t.narrativeResolve=e.n,t.customerResolve=e.c,t.logout=n.logout}function NarrativesCtrl(t,e,n){t.customersResolve=n.c,t.logout=e.logout}function PlayerController(t,e,n,i,a,s,r,o,l,c,d,p,m,u,g){t.viewMode=function(e){o.viewMode=e,p.captureEpisodeActivity("modeChange",{mode:e}),o.producerEditLayer=0,"review"===e?(a(function(){n.$emit("magnet.jumpToMagnet")}),o.autoscroll=!0,o.autoscrollBlocked=!1,S(),a(C)):o.autoscroll=!1,"watch"===e&&t.endSearch(),a(function(){$(window).trigger("resize")})},i.viewMode&&a(function(){t.viewMode(i.viewMode)}),t.toggleProducerPreview=function(){o.product="producer"===o.product?"player":"producer"},i.epId?(o.init(),o.episodeId=i.epId):t.narrativeId=i.narrativeId,o.isFramed&&Math.max(document.documentElement.clientHeight,window.innerHeight||0)<151&&window.parent.postMessage(JSON.stringify({subject:"lti.frameResize",height:"650px"}),"*");var v=function(){if(o.isFramed&&-1!==c.episodes[o.episodeId].templateUrl.indexOf("wiley")){var e=!0;try{localStorage.setItem("iCanHazStorage",1)}catch(t){e=!1}if(e&&localStorage.removeItem("iCanHazStorage"),e&&!localStorage.getItem("noWileyNag")){o.show.wileyNag=!0;var n=t.$watch(function(){return g.getMetaProp("time")},function(t){t&&(o.show.wileyNag=!1,n())})}t.noWileyNag=function(){o.show.wileyNag=!1,localStorage.setItem("noWileyNag","1")}}},h=n.$on("dataSvc.getEpisode.done",function(){o.lang=i.lang?i.lang.toLowerCase():c.episodes[o.episodeId].defaultLanguage,c.setLanguageStrings(),v(),document.title=c.episodes[o.episodeId].display_title,l.getContainer(c.episodes[o.episodeId].container_id,o.episodeId).then(function(){if(c.episodes[o.episodeId].master_asset_id)var e=t.$watch(function(){return c.assets[c.episodes[o.episodeId].master_asset_id]},function(n){n&&Object.keys(n).length>1&&(e(),c.addEndingScreen(o.episodeId),d.init(o.episodeId),t.loading=!1)});else t.loading=!1,"producer"===o.product&&(o.editEpisode=c.episodes[o.episodeId],o.editEpisode.templateOpts=u.getTemplates("episode")),o.videoControlsActive=!0,o.videoControlsLocked=!0;"producer"!==o.productLoadedAs||m.userHasRole("admin")||m.userHasRole("customer admin")||(o.product="player",o.productLoadedAs="player")})});c.episodes[o.episodeId]?(o.lang=i.lang?i.lang.toLowerCase():c.episodes[o.episodeId].defaultLanguage,document.title=c.episodes[o.episodeId].display_title,c.episodes[o.episodeId].master_asset_id?d.init(o.episodeId):("producer"===o.product&&(o.editEpisode=c.episodes[o.episodeId]),o.videoControlsActive=!0,o.videoControlsLocked=!0),"producer"!==o.productLoadedAs||m.userHasRole("admin")||m.userHasRole("customer admin")||(o.product="player",o.productLoadedAs="player")):(t.loading=!0,c.addLandingScreen(o.episodeId),l.getEpisode(o.episodeId,o.episodeSegmentId)),t.appState=o,t.playbackService=g,t.show=o.show,t.now=new Date,t.newWindowUrl=r.apiDataBaseUrl+"/v1/new_window",o.narrativeId?t.newWindowUrl=t.newWindowUrl+"?narrative="+o.narrativeId+"&timeline="+o.timelineId:t.newWindowUrl=t.newWindowUrl+"?episode="+o.episodeId,o.videoControlsActive=!1;var f,y=t.$watch(function(){return o.videoControlsActive},function(t){t&&(a.cancel(f),f=a(function(){o.videoControlsActive=!1},5e3))});t.showControls=function(){a.cancel(f),o.videoControlsActive=!0,o.isTouchDevice&&t.allowControlsExit()},t.allowControlsExit=function(){a.cancel(f),f=a(function(){o.videoControlsLocked||(o.videoControlsActive=!1)},5e3)},t.toggleSearchPanel=function(){o.show.searchPanel=!o.show.searchPanel,o.windowWidth<480?t.viewMode("review"):t.viewMode(o.show.searchPanel?"review":"discover"),o.searchText="",o.show.searchPanel&&a(function(){document.getElementById("searchtext").focus()})},t.endSearch=function(){o.searchText="",o.show.searchPanel=!1},t.toggleNavPanel=function(){d.pause(),o.show.navPanel=!o.show.navPanel},t.seek=function(t){d.seek(t,"sceneMenu"),o.show.navPanel=!1},t.pause=function(){d.pause()};var _=n.$on("video.firstPlay",function(){d.play()});t.hidePanel=function(t){o.show[t]=!1},t.hidePanels=function(){o.show.navPanel=!1,o.show.profilePanel=!1,o.itemDetail=!1,n.$emit("player.dismissAllPanels")},t.play=function(){d.play()},t.continue=function(){c.episodes[o.episodeId].masterAsset.duration-g.getMetaProp("time")<.2?(d.pause(),d.seek(c.episodes[o.episodeId].masterAsset.duration-.01)):d.play()},t.userHasRole=m.userHasRole,t.logout=m.logout,t.isTrueGuest=m.isTrueGuest,o.isTouchDevice&&"review"===o.viewMode&&(o.autoscroll=!0);var b=$(window),x=$("html,body"),w=!1,S=function(){w||(w=s(C,400),b.bind("scroll",function(){x.stop(),k(),o.autoscrollBlocked=!0}))},k=function(){b.unbind("scroll"),s.cancel(w),w=!1};t.enableAutoscroll=function(){o.autoscrollBlocked&&(o.autoscrollBlocked=!1,S())};var C=function(){if(!o.autoscrollBlocked&&o.autoscroll){var t=1/0,e=b.scrollTop();if(angular.forEach($(".isCurrent:visible"),function(n){var i=n.getBoundingClientRect().top+e;i<t&&(t=i)}),t!==1/0){t>e+180&&t-e<document.documentElement.clientHeight-180||t<180&&e<180||(k(),x.animate({scrollTop:t-180},1500),a(function(){S()},1750))}}};S();var T=n.$on("userKeypress.ESC",t.hidePanels);t.$on("$destroy",function(){y(),h(),_(),T()})}function SceneController(t,e,n){function precalculateSceneValues(){delete t.mainContentHasLeftSidebar,delete t.mainContentHasRightSidebar,delete t.mainContentHasBothSidebars,delete t.altContentHasLeftSidebar,delete t.altContentHasRightSidebar,delete t.altContentHasBothSidebars,t.showCurrent=$.inArray("showCurrent",t.scene.layouts)>-1,t.contentItems=e("isContent")(t.scene.items),t.mainFgItems=e("itemLayout")(t.scene.items,"mainFg"),t.mainBgItems=e("itemLayout")(t.scene.items,"mainBg"),t.altFgItems=e("itemLayout")(t.scene.items,"altFg"),t.altBgItems=e("itemLayout")(t.scene.items,"altBg"),$.inArray("splitRequired",t.scene.layouts)>-1?t.mainContentItems=e("transcriptandoptional")(t.contentItems):$.inArray("splitOptional",t.scene.layouts)>-1?t.mainContentItems=e("transcriptandrequired")(t.contentItems):t.mainContentItems=e("annotation")(t.contentItems),$.inArray("splitRequired",t.scene.layouts)>-1?t.altContentItems=e("required")(t.contentItems):$.inArray("splitOptional",t.scene.layouts)>-1?t.altContentItems=e("optional")(t.contentItems):t.altContentItems=e("transmedia")(t.contentItems);for(var n=0;n<t.mainContentItems.length;n++)($.inArray("burstL",t.mainContentItems[n].layouts)>-1||$.inArray("sidebarL",t.mainContentItems[n].layouts)>-1||$.inArray("burst",t.mainContentItems[n].layouts)>-1)&&(t.mainContentHasLeftSidebar=!0),($.inArray("burstR",t.mainContentItems[n].layouts)>-1||$.inArray("sidebarR",t.mainContentItems[n].layouts)>-1||$.inArray("burst",t.mainContentItems[n].layouts)>-1)&&(t.mainContentHasRightSidebar=!0),t.mainContentHasLeftSidebar&&t.mainContentHasRightSidebar&&(t.mainContentHasBothSidebars=!0,n=t.mainContentItems.length);for(n=0;n<t.altContentItems.length;n++)($.inArray("burstL",t.altContentItems[n].layouts)>-1||$.inArray("sidebarL",t.altContentItems[n].layouts)>-1||$.inArray("burst",t.altContentItems[n].layouts)>-1)&&(t.altContentHasLeftSidebar=!0),($.inArray("burstR",t.altContentItems[n].layouts)>-1||$.inArray("sidebarR",t.altContentItems[n].layouts)>-1||$.inArray("burst",t.altContentItems[n].layouts)>-1)&&(t.altContentHasRightSidebar=!0),t.altContentHasLeftSidebar&&t.altContentHasRightSidebar&&(t.altContentHasBothSidebars=!0,n=t.altContentItems.length)}function centeredProTransmedia(t){var e="templates/item/pullquote.html"===t.templateUrl,n="templates/item/text-h2.html"===t.templateUrl,i="templates/item/text-transmedia.html"===t.templateUrl,a="templates/item/text-definition.html"===t.templateUrl;return!!(e||n||i||a)&&t}function byPullquoteOrH2(t){var e="templates/item/pullquote.html"===t.templateUrl,n="templates/item/text-h2.html"===t.templateUrl;return!(!e&&!n)&&t}function setBgImgUrl(t,i){var a,s,r,o=e("isCurrent")(t),l=e(i)(o),c=1;if(l.length>0&&n.existy(l[0].asset)){switch(r="url("+l[0].asset.url+")",/Bg/.test(l[0].layoutCss)&&(c=.25),l[0].styles[0]){case"cover":return a="cover",{"background-image":r,"background-size":a,opacity:c};case"contain":return a="contain",s="center",{"background-image":r,"background-size":a,opacity:c,"background-position":s};case"fill":return a="100% 100%",s="50% 50%",{"background-image":r,"background-size":a,opacity:c,"background-position":s};case"tl":return a="auto",s="top left",{"background-image":r,"background-size":a,opacity:c,"background-position":s};case"tr":return a="auto",s="top right",{"background-image":r,"background-size":a,opacity:c,"background-position":s};case"bl":return a="auto",s="bottom left",{"background-image":r,"background-size":a,opacity:c,"background-position":s};case"br":return a="auto",s="bottom right",{"background-image":r,"background-size":a,opacity:c,"background-position":s}}return""}}t.byPullquoteOrH2=byPullquoteOrH2,t.centeredProTransmedia=centeredProTransmedia,t.setBgImgUrl=setBgImgUrl,t.precalculateSceneValues=precalculateSceneValues}function SearchPanelController(t,e,n,i){t.sortBy="startTime",t.toggleSortBy=function(e){t.sortBy=a(e),i.autoscroll="startTime"===t.sortBy},t.getToggledValue=function(t){return a(t)};var a=function(t){return"startTime"===t?"type":"startTime"};t.getFriendlySortText=function(t){return"startTime"===t?"time":"type"},t.indexed=!1,t.indexEvents=function(){if(!t.episode.items)return n(function(){t.indexEvents()},300),!1;t.indexed=!0,t.typeCategories=["transcript","annotation","file","image","link","video","question","other"],t.showTypes={transcript:{name:"Transcript",items:[]},annotation:{name:"Annotations",items:[]},file:{name:"Files",items:[]},image:{name:"Images",items:[]},link:{name:"Links",items:[]},video:{name:"Videos",items:[]},question:{name:"Questions",items:[]},other:{name:"Other",items:[]}},angular.forEach(t.episode.items,function(e){"producer"!==i.product&&e.cosmetic||"Scene"!==e._type&&(e.producerItemType&&t.showTypes[e.producerItemType]?t.showTypes[e.producerItemType].items.push(e):t.showTypes.other.items.push(e),"annotation"===e.producerItemType&&(e.showAsHeader=!e.templateUrl.match(/(transmedia|definition)/)))})},e.$on("searchReindexNeeded",t.indexEvents)}function TimelineController(t,e,n,i){function setBtnClass(){var e=_getTimelineState();return!0===i.allowPlayback(e)?(t.controlText="play","button-play"):(t.controlText="pause","button-pause")}function timelineBtnClick(){i.togglePlayback(null,n.restartEpisode)}function _getTimelineState(){return i.getTimelineState()}t.playbackService=i,t.timelineBtnClick=timelineBtnClick,t.setBtnClass=setBtnClass,e.$on("userKeypress.SPACE",timelineBtnClick),t.changeSpeed=function(t){var e=i.getMetaProp("timeMultiplier")+t;e<.5&&(e=.5),e>2&&(e=2),n.setSpeed(e)},t.resetSpeed=function(){n.setSpeed(1)},t.markerPercent=function(t){return void 0===t?0:t/i.getMetaProp("duration")*100},t.toggleMute=function(){n.toggleMute()},t.setVolume=function(t){n.setVolume(t)},t.$on("$destroy",function(){n.pause()})}function analyticsSvc(t,e,n,i,a,s,r){var o={};o.activityQueue=[];var l=i(function(){o.flushActivityQueue()},1e4);return(n.local||a.disableAnalytics)&&i.cancel(l),o.captureEpisodeActivity=function(t,e){if(!a.disableAnalytics&&(!s.user||!s.user._id||s.user.track_episode_metrics)){var n={name:t,walltime:new Date,timestamp:r.getMetaProp("time")||0};e&&(n.data=e),o.activityQueue.push(n)}},o.captureEventActivity=function(t,e,n,i){!i&&(a.disableAnalytics||s.user._id&&!s.user.track_event_actions)||o.activityQueue.push({name:t,event_id:e,walltime:new Date,data:n})},o.forceCaptureEventActivityWithPromise=function(t,e,n){return o.captureEventActivity(t,e,n,!0),o.flushActivityQueue()},o.captureEventActivityWithPromise=function(t,e,n){return o.captureEventActivity(t,e,n),o.flushActivityQueue()},o.readEpisodeActivity=function(n){var i=t.defer();return e({method:"GET",url:a.apiDataBaseUrl+"/v2/episodes/"+n+"/episode_user_metrics"}).success(function(t){i.resolve(t)}).error(function(){i.reject()}),i.promise},o.readEventActivity=function(n,i){var s=t.defer();return e({method:"GET",url:a.apiDataBaseUrl+"/v2/events/"+n+"/event_user_actions"}).success(function(t){if(i){for(var e=!1,n=0;n<t.length;n++){t[n].name===i&&(e=!0)}s.resolve(e)}else s.resolve(t)}).error(function(){s.reject()}),s.promise},o.flushActivityQueue=function(){var n=t.defer();0===o.activityQueue.length&&n.resolve(""),s.episodeId||n.resolve();var i=angular.copy(o.activityQueue);o.activityQueue=[];var r=new Date,l=[],c=[];angular.forEach(i,function(t){t.age=(r-t.walltime)/1e3,delete t.walltime,t.event_id?c.push(t):l.push(t)}),l=o.dejitter(l);var d=[];return c.length>0&&d.push(e.post(a.apiDataBaseUrl+"/v2/episodes/"+s.episodeId+"/event_user_actions",{event_user_actions:c})),l.length>0&&d.push(e.post(a.apiDataBaseUrl+"/v2/episodes/"+s.episodeId+"/episode_user_metrics",{episode_user_metrics:l})),t.all(d).then(function(){n.resolve()}),n.promise},o.dejitter=function(t){if(0===t.length)return[];for(var e=[],n=0;n<t.length-1;n++){var i=t[n],a=t[n+1];"seek"===i.name&&"seek"===a.name&&i.timestamp===a.data.seekStart?a.data.seekStart=i.data.seekStart:e.push(t[n])}return e.push(t[t.length-1]),e},o}function authSvc_authSvc(t,e,n,i,a,s,r,o,l){function isTrueGuest(){var t=!0;return angular.forEach(r.user.roles,function(e){e.role!==d.GUEST&&(t=!1)}),t}var c={},d={ADMINISTRATOR:"admin",INSTRUCTOR:"instructor",STUDENT:"student",GUEST:"guest",CUSTOMER_ADMINISTRATOR:"customer admin"},p={CUSTOMER:"Customer"};c.isTrueGuest=isTrueGuest,c.userHasRole=function(t){if(r.user&&r.user.roles)for(var e=0;e<r.user.roles.length;e++)if(r.user.roles[e].role===t){if(t!==d.ADMINISTRATOR||!s.existy(r.user.roles[e].resource_id))return!0}else if(t===d.CUSTOMER_ADMINISTRATOR&&r.user.roles[e].role===d.ADMINISTRATOR&&s.existy(r.user.roles[e].resource_id)&&r.user.roles[e].resource_type===p.CUSTOMER)return!0;return!1},c.getCustomerIdsFromRoles=function(){if(r.user&&r.user.roles)return r.user.roles.reduce(function(t,e){return e.role===d.ADMINISTRATOR&&s.existy(e.resource_id)&&e.resource_type===p.CUSTOMER&&t.push(e.resource_id),t},[])},c.getRoleForNarrative=function(t,e){e=void 0!==e?e:r.user.roles;var n="",i=!1;if(e)for(var a=0;a<e.length;a++){switch(e[a].role){case d.ADMINISTRATOR:if(e[a].resource_id&&e[a].resource_id!==t)continue;n="admin",i=!0;break;case d.INSTRUCTOR:if(e[a].resource_id&&e[a].resource_id!==t)continue;n=e[a].role;break;case d.STUDENT:if(e[a].resource_id&&e[a].resource_id!==t)continue;n="instructor"===n?n:e[a].role;break;case d.GUEST:if(e[a].resource_id&&e[a].resource_id!==t)continue;n="instructor"===n||"student"===n?n:e[a].role}if(i)break}return n},c.getDefaultProductForRole=function(t){var e="player";return"narrative"===r.productLoadedAs?t!==d.ADMINISTRATOR&&t!==d.INSTRUCTOR||(e="sxs"):l.error({data:"authSvc.getDefaultProductForRole should only be used within narratives for now"}),e},c.logout=function(){try{localStorage.removeItem(t.localStorageKey),document.cookie="XSRF-TOKEN=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.cookie="_tellit-api_session=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}catch(t){}r.user={},n({method:"GET",url:t.apiDataBaseUrl+"/logout"}).success(function(){delete n.defaults.headers.common.Authorization,a.path("/").search({logout:1})}).error(function(){delete n.defaults.headers.common.Authorization,a.path("/").search({logout:1})})},c.adminLogin=function(e,a){var s=i.defer();return n({method:"POST",url:t.apiDataBaseUrl+"/auth/identity/callback",data:$.param({auth_key:e,password:a}),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(t){n.defaults.headers.common.Authorization='Token token="'+t.access_token+'"',u(t),c.getCurrentUser().then(function(){s.resolve(t)})}).error(function(t){s.reject(t)}),s.promise};var m=i.defer();c.authenticate=function(i){if(n.defaults.headers.common.Authorization)r.user._id?m.resolve():c.getCurrentUser().then(function(){m.resolve()},function(){return c.authenticateViaNonce(i)});else{if(e.key){var s=e.key;return a.search("key",null),c.getAccessToken(s)}var o=c.getStoredToken();if(!o)return c.authenticateViaNonce(i);n.defaults.headers.common.Authorization='Token token="'+o+'"',c.getCurrentUser().then(function(){m.resolve()},function(){try{localStorage.removeItem(t.localStorageKey),document.cookie="XSRF-TOKEN=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.cookie="_tellit-api_session=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}catch(t){}return r.user={},c.authenticateViaNonce(i)})}return m.promise},c.authenticateViaNonce=function(t){var e=i.defer();return c.getNonce(t).then(function(t){c.getAccessToken(t).then(function(){e.resolve()})}),e.promise},c.getStoredToken=function(){var e={};try{if(!localStorage)return!1;localStorage.getItem(t.localStorageKey),e=angular.fromJson(localStorage.getItem(t.localStorageKey));var n=t.apiDataBaseUrl.match(/\/\/([^\.]*)./)[1];return e.customer!==n&&(localStorage.removeItem(t.localStorageKey),e={}),e.token||!1}catch(t){return!1}},c.getCurrentUser=function(){var e=i.defer();return n({method:"GET",url:t.apiDataBaseUrl+"/show_user"}).success(function(t){u(t),e.resolve()}).error(function(){e.reject()}),e.promise},c.updateUser=function(e){var a=i.defer();return n({method:"PUT",url:t.apiDataBaseUrl+"/users/"+e._id,data:e}).success(function(t){u(t),a.resolve()}).error(function(){a.reject()}),a.promise};var u=function(e){if(null!==e.roles&&void 0!==e.roles&&e.roles.length>0&&e.roles[0].constructor===String){for(var i=[],a=0;a<e.roles.length;a++){var s={role:e.roles[a]};i.push(s)}e.roles=i}var l={access_token:e.access_token||e.authentication_token,customer:t.apiDataBaseUrl.match(/\/\/([^\.]*)./)[1],roles:e.roles};angular.forEach(["_id","name","email","track_event_actions","track_episode_metrics","avatar_id"],function(t){e[t]&&(l[t]=e[t])});var d=c.getStoredToken();l.avatar_id&&d&&(n.defaults.headers.common.Authorization='Token token="'+d+'"',n.get(t.apiDataBaseUrl+"/v1/assets/"+l.avatar_id).then(function(t){o.cache("asset",t.data),r.user.avatar=t.data.url})),e["track_episode_metrics:"]&&(l.track_episode_metrics=!0),l.roles&&(l.role_description=g(l.roles[0])),e.emails&&(l.email=e.emails[0]),r.user=l;try{localStorage.setItem(t.localStorageKey,JSON.stringify({token:l.access_token,customer:l.customer}))}catch(t){}},g=function(t){return void 0===t?"User":"admin"===t.role?"Administrator":void 0===t.role?"User":"guest"===t.role?"Guest user":t.role.match(/student/i)?"Student":t.role.match(/instructor/i)?"Instructor":t};return c.getNonce=function(e){var a=i.defer(),s=t.apiDataBaseUrl+"/v1/get_nonce";return e&&(s=s+"?"+e),n.get(s).success(function(t){t.nonce?a.resolve(t.nonce):t.login_url&&null!==t.login_url?(t.login_via_top_window_only?window.top.location.href=t.login_url:window.location.href=t.login_url,a.reject()):("#/"!==window.location.hash&&(window.location.href="/#/"),a.reject())}).error(function(){a.reject()}),a.promise},c.getAccessToken=function(e){var a=i.defer();return n.get(t.apiDataBaseUrl+"/v1/get_access_token/"+e).success(function(t){u(t),n.defaults.headers.common.Authorization='Token token="'+t.access_token+'"',c.getCurrentUser().then(function(){a.resolve(t)})}).error(function(){a.reject()}),a.promise},c}function awsSvc(t,e,n){var i,a,s,r,o={},l={s3:{}},c=0,d=0,p=0,m=[],u=0,g=[],v={},h=0,f=0,y=[],_=!1;o.awsCache=function(){return l},o.getBucketListing=function(){var t=e.defer();return x().then(function(){l.s3.listObjects(function(e,n){e?t.reject():t.resolve(n)})}),t.promise},o.uploadContainerFiles=function(t,e,n){return b("/v1/containers/"+t+"/assets",e,n)},o.uploadUserFiles=function(t,e){return b("/v1/users/"+t+"/assets",e)};var b=function(t,n,i){for(var a=[],s=0;s<n.length;s++){g.push(n[s]),null!=i&&(v[n[s].name]=[i]);var r=e.defer();y.push(r),a.push(r.promise)}return w(t),a};o.pauseUpload=function(){if(i&&!_){if(_=!0,D(),C())f=0;else{var t=0;for(f=0;t<d;){var e=m[t];"complete"===e.status&&(f+=e.uploaded),t++}}s.notify({bytesSent:f,bytesTotal:i.size})}},o.resumeUpload=function(){if(i&&_)if(_=!1,C())E();else for(var t=0;t<3;t++)A()},o.cancelUpload=function(){i&&(_=!1,f=0,D(),C()||(o.cancelMultipartUpload(a),a=null),i=null,y[h].reject("Canceled by user"));for(var t=h+1;t<g.length;t++)y[t].reject("Canceled by user");h=g.length},o.networkError=function(){i&&D()},o.deleteObject=function(t){var n=e.defer();return x().then(function(){var e={Bucket:t.bucket,Key:t.Key};l.s3.deleteObject(e,function(t,e){t?n.reject():n.resolve(e)})}),n.promise},o.getMultipartUploads=function(){var t=e.defer();return x().then(function(){l.s3.listMultipartUploads(function(e,n){e?t.reject():t.resolve(n)})}),t.promise},o.getMultipartUploadParts=function(t,n){var i=e.defer();return x().then(function(){var e={Bucket:n.bucket,Key:n.Key,UploadId:n.UploadId};l.s3.listParts(e,function(e,n){e?i.reject():i.resolve({i:t,parts:n})})}),i.promise},o.cancelMultipartUpload=function(t){var n=e.defer();return x().then(function(){var e={Bucket:t.bucket,Key:t.Key,UploadId:t.UploadId};l.s3.abortMultipartUpload(e,function(t,e){t?n.reject():n.resolve(e)})}),n.promise};var x=function(){return l.hasOwnProperty("sessionDeferred")?l.sessionDeferred.promise:(l.sessionDeferred=e.defer(),t.get(n.apiDataBaseUrl+"/v1/aws/s3/upload_session").success(function(t){if(t.access_key_id){AWS.config.update({accessKeyId:t.access_key_id,secretAccessKey:t.secret_access_key,sessionToken:t.session_token,region:n.awsRegion});var e={maxRetries:0,httpOptions:{timeout:3e4},params:{Bucket:t.bucket,Prefix:t.key_base}};l.s3=new AWS.S3(e),l.sessionDeferred.resolve(t)}else l.sessionDeferred.reject()}).error(function(){l.sessionDeferred.reject()}),l.sessionDeferred.promise)},w=function(t){if(g.length>h&&!i){if(i=g[h],""===i.type)return y[h].reject("Could not determine file type for file '"+i.name+"'"),i=null,h++,void w(t);S().then(function(){var e;e=C()?T():I(),e.then(function(){F(t)},function(t){y[h].reject(t)},function(t){y[h].notify(t)})})}},S=function(t){return t=t||e.defer(),i.uniqueName=k(),x().then(function(){var e={Key:l.s3.config.params.Prefix+i.uniqueName};l.s3.headObject(e,function(e){e?404!==e.statusCode?t.reject(e):C()?t.resolve():o.getMultipartUploads().then(function(e){var n=function(t){for(var i=0;i<e.Uploads.length;i++)if(e.Uploads[i].Key===l.s3.config.params.Prefix+t)return n(k());return t};i.uniqueName=n(i.uniqueName),t.resolve()}):(i.uniqueName=k(),S(t))})}),t.promise},k=function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:7&n|8).toString(16)})},C=function(){return i.size<=5242880},T=function(){return s=e.defer(),E().then(function(t){},function(t){},function(t){}),s.promise},E=function(){var t=e.defer();return x().then(function(){U(i,"base64").then(function(t){var e={Key:l.s3.config.params.Prefix+i.uniqueName,ContentType:i.type,Body:i,ContentMD5:t,ACL:"public-read"};r=l.s3.putObject(e,function(t,e){t?s.reject():s.resolve(e)}),r.on("httpUploadProgress",function(t){s.notify({bytesSent:t.loaded,bytesTotal:t.total})}).on("error",function(t,e){s.reject("An error occured while uploading the file, please try again.")})})},function(t){},function(t){}),t.promise},I=function(){return s=e.defer(),P().then($).then(function(){for(var t=0;t<3;t++)A()}),s.promise},P=function(){var t=e.defer();return x().then(function(){var e={Key:l.s3.config.params.Prefix+i.uniqueName};l.s3.createMultipartUpload(e,function(e,n){e?t.reject():t.resolve(n)})}),t.promise},$=function(t){var n=e.defer();a=t,m=[],d=0,p=0,u=0,c=5242880,f=0,i.size>1e3*c&&(c=Math.ceil(i.size/1e3)),d=Math.ceil(i.size/c);for(var s=0;s<d;s++){var r={};r.start=s*c,r.end=r.start+c,r.uploaded=0,r.end>i.size&&(r.end=i.size),r.status="pending",r.retries=0,m.push(r)}return n.resolve(),n.promise},A=function(){var t=e.defer(),n=u,a=!1;if(_)t.reject("Upload paused");else{for(;!a&&n<d;){var s=m[n];if("pending"===s.status){a=!0,s.status="uploading";var r=i.slice(s.start,s.end);s.cancel=function(){s.request.abort(),s.status="pending",s.uploaded=0},e.all({partNumber:e.when(n+1),eTag:M(n+1,r)}).then(L,O).then(function(e){t.resolve(e)},function(e){t.reject(e)},function(e){t.update(e)})}else"complete"===s.status&&n===u&&u++;n++}a||t.reject("All chunks uploaded")}return t.promise},U=function(t,n){var i=e.defer(),a=new FileReader;return a.onload=function(){var t=a.result;i.resolve(AWS.util.crypto.md5(new Uint8Array(t),n))},a.readAsArrayBuffer(t),i.promise},M=function(t,n,r){return r||(r=e.defer()),x().then(function(){U(n,"base64").then(function(e){var o={Bucket:a.Bucket,Key:a.Key,UploadId:a.UploadId,PartNumber:t,ContentMD5:e,Body:n};m[t-1].request=l.s3.uploadPart(o,function(e,i){e?m[t-1].retries<4?(m[t-1].request.abort(),m[t-1].retries++,M(t,n,r)):(m[t-1].status="failed",r.reject(e)):r.resolve(i.ETag)}),m[t-1].request.on("httpUploadProgress",function(e){f+=e.loaded-m[t-1].uploaded,m[t-1].uploaded=e.loaded,s.notify({bytesSent:f,bytesTotal:i.size})}).on("error",function(t,e){})})}),r.promise},L=function(t){var n=e.defer();if(m[t.partNumber-1].status="complete",m[t.partNumber-1].part={ETag:t.eTag,PartNumber:t.partNumber},++p===d){for(var i=[],r=0;r<d;r++)i.push(m[r].part);var o={Bucket:a.Bucket,Key:a.Key,UploadId:a.UploadId,MultipartUpload:{Parts:i}};l.s3.completeMultipartUpload(o,function(t,e){t?(s.reject(t),n.reject(t)):(o={Bucket:a.Bucket,Key:a.Key,ACL:"public-read"},l.s3.putObjectAcl(o,function(t,e){t&&(s.reject(t),n.reject(t))}),s.resolve(e),n.resolve(e))})}else A();return n.promise},O=function(t){o.cancelMultipartUpload(a),s.reject(t)},D=function(){if(C())r.abort();else for(var t=u,e=!1;!e&&t<d;){var n=m[t];"uploading"===n.status?n.cancel():"pending"===n.status&&(e=!0),t++}},F=function(a){var s=e.defer(),r={url:"https://s3.amazonaws.com/"+l.s3.config.params.Bucket+"/"+l.s3.config.params.Prefix+i.uniqueName,type:i.type,size:i.size,original_filename:i.name};return v[i.name]&&(Object.assign(r,{tags:v[i.name]}),v[i.name]=null),t.post(n.apiDataBaseUrl+a,r).success(function(t){y[h].resolve(t),i=null,h++,w(a)}).error(function(){y[h].reject(),i=null,h++,w(a)}),s.promise};return o}function config_config(){var t=window.config?window.config:{};return t.apiDataBaseUrl||(t.apiDataBaseUrl="//"+window.location.host),t.localStorageKey||(t.localStorageKey="storyToken"),t.youtube||(t.youtube={domain:"//gdata.youtube.com/",timeout:5e3}),t}function dataSvc_dataSvc(t,e,n,i,a,s,r,o,l,c,d,p,m){function sendSocialshareEmail(t,e){return T("/v3/timelines/"+t+"/share_via_email",e)}function beginBackgroundTranslations(t){return C("/v3/episodes/"+t+"/update_translations")}function batchUploadTranscripts(t,e,n){var i={transformRequest:angular.identity,headers:{"Content-type":void 0}};return s.existy(n)&&Object.keys(n).length>0&&Object.assign(i,{params:n}),T("/v3/episodes/"+t+"/events/import_subtitles",e,i)}function generateNewNarrative(t,e){return T("/v3/containers/"+t+"/narratives",e).then(function(t){return t.data}).catch(function(t){})}function getCustomerLinkStatusReportSpreadsheet(t){var e="/v3/customers/"+t+"/link_status.xlsx";window.open(e)}function getAssetsByAssetIds(t){var e=Object.create(null);return e.asset_ids=t,T("/v1/assets",e).then(function(t){return t.data.files})}function fetchAndCacheAssetsByIds(t){return getAssetsByAssetIds(t).then(function(e){return e.forEach(function(t){c.cache("asset",createInstance("Asset",t))}),t.reduce(function(t,e){return t.push(c.assets[e]),t},[])})}var u=Object.create(null);u.sendSocialshareEmail=sendSocialshareEmail,u.beginBackgroundTranslations=beginBackgroundTranslations,u.batchUploadTranscripts=batchUploadTranscripts,u.generateNewNarrative=generateNewNarrative,u.getNarrative=function(n){var i=t.defer(),l=c.narratives[n],d=s.getSubdomain(a.host()),p="";return s.existy(l)&&s.existy(l.narrative_subdomain)&&d!==l.narrative_subdomain&&(p="?customer="+l.narrative_subdomain),o.authenticate("narrative="+n).then(function(){e.get(r.apiDataBaseUrl+"/v3/narratives/"+n+"/resolve"+p).then(function(t){t.data.timelines.sort(function(t,e){return t.sort_order-e.sort_order}),c.cache("narrative",createInstance("Narrative",u.resolveIDs(t.data))),i.resolve(c.narratives[t.data._id])})}),i.promise},u.getNarrativeOverview=function(t){return k("/v3/narratives/"+t)},u.getNarrativeExportAsSpreadsheet=function(t){var e="/v3/narratives/"+t+".xlsx";window.open(e)},u.getCustomerLinkStatusReportSpreadsheet=getCustomerLinkStatusReportSpreadsheet;var g=!1;u.getUserNarratives=function(e){if(g){var n=t.defer();return n.resolve(g),n.promise}return k("/v3/users/"+e+"/narrative_purchases",function(t){return g=t,t})},u.getCustomerList=function(){return k("/v3/customers/",function(t){return angular.forEach(t,function(t){c.cache("customer",createInstance("Customer",t))}),t})},u.getCustomer=function(e,n){return o.userHasRole("admin")||o.userHasRole("customer admin")?c.customers[e]?n?t(function(t){t(c.customers[e])}):void 0:C("/v3/customers/"+e).then(function(t){return c.cache("customer",createInstance("Customer",t)),c.customers[t._id]}).catch(function(t){}):t(function(t){t({})})},u.getEpisode=function(t,e){if(!t)throw"no episode ID supplied to dataSvc.getEpisode";c.cache("episode",{_id:t}),n.local?(p.mockEpisode(t),i.$emit("dataSvc.getEpisode.done")):o.authenticate().then(function(){return y()}).then(function(){return x(t,e)})},u.getEpisodeOverview=function(t){return k("/v3/episodes/"+t)},u.getNarrativeList=function(t){return s.existy(t)?k("/v3/narratives?customer_id="+t._id).then(function(e){c.assocNarrativesWithCustomer(t,e)}):k("/v3/narratives/")},u.createUserGroup=function(t){return P("/v3/groups",{group:{name:t}})},u.createNarrative=function(t){return delete t.templateUrl,T("/v3/narratives",t)},u.updateNarrative=function(t){return delete t.templateUrl,E("/v3/narratives/"+t._id,t)},u.createChildEpisode=function(t){return P("/v3/episodes",{episode:t})},u.createEpisodeSegment=function(t,e){return P("/v3/timelines/"+t+"/episode_segments",e)},u.storeTimeline=function(t,e){var n=["sort_order","path_slug","name","description","hidden","timeline_image_ids","narrative_id","_id"],i=s.pick(e,n);return i._id?I("/v3/timelines/"+i._id,i,function(t){return"string"==typeof t.name&&(t.name={en:t.name}),"string"==typeof t.description&&(t.description={en:t.description}),t}):P("/v3/narratives/"+t+"/timelines",i,function(t){return"string"==typeof t.name&&(t.name={en:t.name}),"string"==typeof t.description&&(t.description={en:t.description}),t})},u.deleteTimeline=function(t){return A("/v3/timelines/"+t).then(function(t){return t})},u.getSingleAsset=function(e){return e?k("/v1/assets/"+e):t(function(t){t(void 0)})};var v={template:{},layout:{},style:{}},h=!1,f=t.defer(),y=function(){return h?f.promise:(h=!0,t.all([e.get(r.apiDataBaseUrl+"/v1/templates"),e.get(r.apiDataBaseUrl+"/v1/layouts"),e.get(r.apiDataBaseUrl+"/v1/styles")]).then(function(t){u.cache("templates",t[0].data),u.cache("layouts",t[1].data),u.cache("styles",t[2].data),h=!0,f.resolve()},function(){h=!1,f.reject()}),f.promise)};u.getCommon=y,u.cache=function(t,e){angular.forEach(e,function(e){"templates"===t?v.template[e._id]={id:e._id,url:e.url,type:e.applies_to_episodes?"Episode":e.event_types?e.event_types[0]:void 0,displayName:e.name,customerIds:e.customer_ids}:"layouts"===t?v.layout[e._id]={id:e._id,css_name:e.css_name,displayName:e.display_name}:"styles"===t&&(v.style[e._id]={id:e._id,css_name:e.css_name,displayName:e.display_name})})},u.createTemplate=function(t){return P("/v1/templates",t)},u.resolveIDs=function(t){if(t.everyone_group&&!t.template_id&&(t.templateUrl="templates/narrative/default.html"),t.template_id&&(v.template[t.template_id]?(t.templateUrl=v.template[t.template_id].url,delete t.template_id):d.error({data:"Couldn't get templateUrl for id "+t.template_id})),t.layout_id){var e=[];"Scene"===t.type&&(e=["",""]),angular.forEach(t.layout_id,function(n){v.layout[n]?"Scene"===t.type?"showCurrent"===v.layout[n].css_name?e[1]=v.layout[n].css_name:"splitRequired"===v.layout[n].css_name?e[2]=v.layout[n].css_name:e[0]=v.layout[n].css_name:e.push(v.layout[n].css_name):d.error({data:"Couldn't get layout for id "+n})}),e.length>0&&(t.layouts=e)}if(t.style_id){var n=[];angular.forEach(t.style_id,function(t){v.style[t]?n.push(v.style[t].css_name):d.error({data:"Couldn't get style for id "+t})}),n.length>0&&(t.styles=n)}return t};var _=function(t){return t.hasOwnProperty("asset_id")&&t.asset_id?t.asset_id:t.hasOwnProperty("annotation_image_id")&&t.annotation_image_id?t.annotation_image_id:t.hasOwnProperty("link_image_id")&&t.link_image_id?t.link_image_id:t.hasOwnProperty("avatar_id")&&t.avatar_id?t.avatar_id:void 0},b=function(t){for(var e={},n=0,i=t.length;n<i;n++){var a=_(t[n]);a&&(a in e||(e[a]=0))}return Object.keys(e)};u.getAssetsByAssetIds=getAssetsByAssetIds,u.fetchAndCacheAssetsByIds=fetchAndCacheAssetsByIds;var x=function(t,n){var a=n?"/v3/episode_segments/"+n+"/resolve":"/v3/episodes/"+t;e.get(r.apiDataBaseUrl+a).success(function(e){var a={};e&&(a=e.episode?e.episode:e),"Published"===a.status||o.userHasRole("admin")||o.userHasRole("customer admin")?(c.cache("episode",u.resolveIDs(a)),w(t,n).success(function(e){e=e||[],S(e,"Plugin",t),angular.forEach(e,function(e){e.cur_episode_id=t;var n=u.resolveIDs(e),i=createInstance(e.type,n);c.cache("event",i)}),c.resolveEpisodeEvents(t);var n=b(e);n=void 0!==n&&n.length>0?n:[],n.push(a.master_asset_id),a.poster_frame_id&&n.push(a.poster_frame_id),getAssetsByAssetIds(n).then(function(e){e.forEach(function(t){c.cache("asset",createInstance("Asset",t))}),c.resolveEpisodeAssets(t),i.$emit("dataSvc.getEpisode.done")})}).error(function(){d.error({data:"API call to get events failed."})})):d.error({data:"This episode has not yet been published."})}).error(function(){d.error({data:"API call to /v3/episodes/"+t+" failed (bad episode ID?)"})})};u.getContainerAncestry=function(e,n,i){return i=i||t.defer(),u.getContainer(e,n).then(function(t){var e=c.containers[t];e.parent_id?u.getContainerAncestry(e.parent_id,n,i):i.resolve(t)}),i.promise};var w=function(t,n){var i=n?"/v3/episode_segments/"+n+"/events":"/v3/episodes/"+t+"/events";return e.get(r.apiDataBaseUrl+i)},S=function(t,e,n){angular.forEach(t,function(t){"Plugin"===t.type&&function(t){m.getUserAnswer(t._id,l.user._id).then(function(e){if(e.data){t.data._plugin.hasBeenAnswered=!0;var n=0,i=!0;angular.forEach(t.data._plugin.distractors,function(a){i&&(a.index===e.data.index&&(a.selected=!0,t.data._plugin.selectedDistractor=a.index,i=!1),n++)}),c.cache("event",u.resolveIDs(t))}})}(t)}),c.resolveEpisodeEvents(n)},k=function(n,i){var a=t.defer();return o.authenticate().then(function(){e.get(r.apiDataBaseUrl+n).then(function(t){var e=t.data;return i&&(e=i(e)),a.resolve(e)})}),a.promise},C=function(t){return o.authenticate().then(function(){return e.get(r.apiDataBaseUrl+t).then(function(t){return t.data})})},T=function(t,n,i){return i?e.post(t,n,i):e.post(t,n)},E=function(t,n){return e.put(r.apiDataBaseUrl+t,n)},I=function(n,i,a){var s=t.defer();return e({method:"PUT",url:r.apiDataBaseUrl+n,data:i}).success(function(t){var e=t;a&&(e=a(e)),s.resolve(e)}),s.promise},P=function(n,i,a){var s=t.defer();return e({method:"POST",url:r.apiDataBaseUrl+n,data:i}).success(function(t){var e=t;a&&(e=a(e)),s.resolve(e)}),s.promise},$=function(n){var i=t.defer();return e({method:"DELETE",url:r.apiDataBaseUrl+n}).success(function(t){return i.resolve(t)}),i.promise},A=function(t){return e({method:"DELETE",url:r.apiDataBaseUrl+t}).then(function(t){return t})};u.getContainerRoot=function(){return k("/v3/containers",function(t){var e=[];return angular.forEach(t,function(t){c.cache("container",t),e.push(t._id)}),e})},u.getContainer=function(t,e){return k("/v3/containers/"+t,function(n){c.cache("container",n[0]);var i=c.containers[n[0]._id];if(u.getContainerAssets(t,e),i.children){for(var a=0;a<i.children.length;a++)i.children[a]=c.containers[i.children[a]._id];var s=!1;e||(s=!0),s&&angular.forEach(i.children,function(t){t.episodes[0]&&u.getEpisodeOverview(t.episodes[0]).then(function(e){e&&(t.status=e.status,t.title=e.title,c.cache("container",t))})})}return n[0]._id})},u.getContainerAssets=function(t,n){return e.get(r.apiDataBaseUrl+"/v1/containers/"+t+"/assets").success(function(e){c.containers[t].assetsHaveLoaded=!0,angular.forEach(e.files,function(t){c.cache("asset",createInstance("Asset",t))}),c.resolveEpisodeAssets(n)})},u.createContainer=function(e){var n=t.defer(),i={container:{customer_id:e.customer_id,name:e.name,parent_id:e.parent_id}};return P("/v3/containers",i).then(function(t){c.cache("container",t);var e=t.parent_id;c.containers[e].children.push(c.containers[t._id]),n.resolve(t)}),n.promise},u.updateContainer=function(e){var n=t.defer();return e._id||n.reject(),I("/v3/containers/"+e._id,e,function(t){c.cache("container",t),n.resolve(t)}),n.promise},u.deleteContainer=function(t){return delete c.containers[t],$("/v3/containers/"+t)},u.createEpisode=function(e){e.status="Unpublished";var n=t.defer();return P("/v3/episodes",e).then(function(t){c.containers[t.container_id].episodes=[t._id],c.containers[t.container_id].status=t.status,n.resolve(t)}),n.promise},u.storeEpisode=function(t){var e=M(t);return!!e&&I("/v3/episodes/"+e._id,e)},u.deleteEpisode=function(e){var n=t.defer();return k("/v2/episodes/"+e+"/episode_user_metrics").then(function(i){if(i.length){for(var a=[],s=0;s<i.length;s++)a.push($("/v2/episode_user_metrics/"+i[s]._id));t.all(a).then(function(){$("/v3/episodes/"+e),n.resolve()})}else $("/v3/episodes/"+e),n.resolve()}),n.promise},u.deleteItem=function(t){return $("/v3/events/"+t)},u.createAsset=function(e,n){var i=t.defer();return n.container_id=e,n._id&&n._id.match(/internal/)&&delete n._id,n=c.deriveAsset(n),P("/v1/containers/"+e+"/assets",n).then(function(t){c.containers[t.file.container_id].episodes=[t.file._id],c.cache("asset",t.file),i.resolve(t.file)}),i.promise},u.deleteAsset=function(t){return $("/v1/assets/"+t)},u.storeItem=function(e){return e=U(e),e?e&&e._id&&!e._id.match(/internal/)?I("/v3/events/"+e._id,{event:e}):P("/v3/episodes/"+e.episode_id+"/events",{event:e}):t.reject(!1)};var U=function(t){var e={};t._id&&t._id.match(/internal/)&&delete t._id;var n=["_id","start_time","end_time","episode_id","chapter_marker","template_id","templateUrl","stop","required","cosmetic","sxs","title","url","target","url_status","annotator","annotation","description","data","asset_id","link_image_id","annotation_image_id","avatar_id"];e.type=t._type;for(var i=0;i<n.length;i++)void 0!==t[n[i]]&&(e[n[i]]=angular.copy(t[n[i]]));if(e.start_time&&e.end_time){var a=parseFloat(e.start_time),s=parseFloat(e.end_time);if(isNaN(a)||isNaN(s))return d.error({data:"Tried to store an invalid start_time or end_time."}),!1;if(a>s)return d.error({data:"Tried to store a start_time that is after the end_time."}),!1}if(e.data&&(delete e.data._plugin.selectedDistractor,delete e.data._plugin.hasBeenAnswered,delete e.data._plugin._type,e.data._plugin.distractors.length))for(i=0;i<e.data._plugin.distractors.length;i++)delete e.data._plugin.distractors[i].selected;if(e.style_id=[],e.layout_id=[],e.style_id=O("style",t.styles),e.layout_id=O("layout",t.layouts),"Chapter"===t._type)return e;var r=u.readCache("template","url",t.templateUrl);return e.template_id=r?r.id:L(t.templateUrl),e.template_id?e:(d.error({data:"Tried to store a template with no ID: "+t.templateUrl}),!1)};u.prepItemForStorage=U,u.detachEventAsset=function(t,e){return!!(t=U(t))&&(t.asset_id===e&&(t.asset_id=null),t.link_image_id===e&&(t.link_image_id=null),t.annotation_image_id===e&&(t.annotation_image_id=null),t&&t._id&&!t._id.match(/internal/)?I("/v3/events/"+t._id,{event:t}):P("/v3/episodes/"+t.episode_id+"/events",{event:t}))};var M=function(t){var e={};t._id&&t._id.match(/internal/)&&delete t._id;for(var n=["_id","title","description","container_id","customer_id","master_asset_id","poster_frame_id","status","languages"],i=0;i<n.length;i++)(t[n[i]]||0===t[n[i]])&&(e[n[i]]=angular.copy(t[n[i]]));e.style_id=O("style",t.styles);var a=u.readCache("template","url",t.templateUrl);return e.template_id=a?a.id:L(t.templateUrl),e.template_id?e:(d.error({data:"Tried to store a template with no ID: "+t.templateUrl}),!1)},L=function(t){var e={"templates/episode/episode.html":"templates/episode-default.html","templates/episode/eliterate.html":"templates/episode-eliterate.html","templates/episode/ewb.html":"templates/episode-ewb.html","templates/episode/gw.html":"templates/episode-gw.html","templates/episode/purdue.html":"templates/episode-purdue.html","templates/episode/story.html":"templates/episode-tellingstory.html","templates/item/transcript.html":"templates/transcript-default.html","templates/item/transcript-withthumbnail.html":"templates/transcript-withthumbnail.html","templates/item/transcript-withthumbnail-alt.html":"templates/transcript-withthumbnail-alt.html","templates/item/text-h1.html":"templates/text-h1.html","templates/item/text-h2.html":"templates/text-h2.html","templates/item/pullquote-noattrib.html":"templates/text-pullquote-noattrib.html","templates/item/pullquote.html":"templates/text-pullquote.html","templates/item/image.html":"templates/transmedia-image-default.html","templates/item/image-caption.html":"templates/transmedia-caption.html","templates/item/image-caption-sliding.html":"templates/transmedia-slidingcaption.html","templates/item/image-fill.html":"templates/transmedia-image-fill.html","templates/item/image-plain.html":"templates/transmedia-image-plain.html","templates/item/image-linkonly.html":"templates/transmedia-linkonly.html","templates/item/image-thumbnail.html":"templates/transmedia-thumbnail.html","templates/item/link.html":"templates/transmedia-link-default.html","templates/item/link-embed.html":"templates/transmedia-link-embed.html","templates/scene/1col.html":"templates/scene-1col.html","templates/scene/2colL.html":"templates/scene-2colL.html","templates/scene/2colR.html":"templates/scene-2colR.html","templates/scene/centered.html":"templates/scene-centered.html","templates/scene/cornerH.html":"templates/scene-cornerH.html","templates/scene/cornerV.html":"templates/scene-cornerV.html","templates/item/question-mc-formative.html":"templates/question-mc-formative.html","templates/item/question-mc-poll.html":"templates/question-mc-poll.html","templates/item/question-mc.html":"templates/question-mc.html","templates/item/question-mc-image-left.html":"templates/question-mc-image-left.html","templates/item/question-mc-image-right.html":"templates/question-mc-image-right.html","templates/item/sxs-question.html":"templates/sxs-question.html","templates/item/sxs-link.html":"templates/sxs-link.html"};if(e[t]){return u.readCache("template","url",e[t]).id}return!1};u.readCache=function(t,e,n){var i=!1;return angular.forEach(v[t],function(t){t[e]===n&&(i=t)}),i||!1},r.debugInBrowser,u.getTemplates=function(){return Object.keys(v.template).map(function(t){return v.template[t]})};var O=function(t,e){var n=["colorEliterate","colorGw","colorGwsb","colorPurdue","colorUsc","colorColumbia","colorColumbiabusiness","typographyEliterate","typographyGw","typographyGwsb","typographyPurdue","typographyUsc","typographyColumbia","typographyColumbiabusiness"],i=[];return angular.forEach(e,function(e){if(e){var a=u.readCache(t,"css_name",e);if(a)i.push(a.id);else if(-1===n.indexOf(e))return d.error({data:"Tried to store a "+t+" with no ID: "+e}),!1}}),i};return u}function errorSvc_errorSvc(t){var e={};return e.init=function(){e.errors=[],e.notifications=[]},e.init(),e.error=function(n,i){!n||401!==n.status&&403!==n.status||"/"===t.path()&&(n=void 0),n&&n.data&&("string"==typeof n.data?(n.data=n.data.replace(/\n/g,"").replace(/==/g,"").replace(/-----.*/g,""),e.errors.push({exception:n})):e.errors.push({exception:n}))},e.notify=function(t){e.notifications.push({text:t})},e}function imageResize(t){function createFileFromDataURL(t,e){var n=_dataURLToBlob(t);return n.name="resized"+e,n.lastModifiedDate=new Date,n}function readFileToImg(e){var n=new Image;return readFileToDataURI(e).then(function(e){return n.src=e,t(function(t,e){n.onload=function(){t(n)},n.onerror=function(){e("Error Loading Image")}}).then(function(t){return t})})}function readFileToDataURI(e){var n=new FileReader;return t(function(t,i){n.onloadend=function(){t(n.result)},n.onerror=function(){i(n.error)},n.readAsDataURL(e)}).then(function(t){return t})}function resizeImg(e,n,i,a){return t(function(t){var s=document.createElement("canvas"),r=_getContext(s),o=0,l=0,c=e.width,d=e.height;for(_setCanvasWH(s,c,d),r.drawImage(e,0,0,c,d);(c>n||d>i)&&!(.5*c<n||.5*d<i);)e.width=.5*e.width,e.height=.5*e.height,c=e.width,d=e.height,s=_resizeImgWithCanvas(s,c,d);var p=_calculateNewDimensions(s.width,s.height,n,i);a&&(p.height<i&&(l=(i-p.height)/2),p.width<n&&(o=(n-p.width)/2)),s=_resizeImgWithCanvas(s,p.width,p.height,n,i,o,l),t(s.toDataURL("image/png",1))})}function calcAspectRatio(t,e){return t/e}function getImageTagType(t,e){return calcAspectRatio(t,e)>1.25?x:b}function _setCanvasWH(t,e,n){t.width=e,t.height=n}function _resizeImgWithCanvas(t,e,n,i,a,s,r){void 0===i&&(i=e),void 0===a&&(a=n),void 0===s&&(s=0),void 0===r&&(r=0);var o=document.createElement("canvas"),l=_getContext(o);return o.width=i,o.height=a,l.drawImage(t,s,r,e,n),o}function _getContext(t){var e=t.getContext("2d");return e.imageSmoothingEnabled=!0,e.mozImageSmoothingEnabled=!0,e.oImageSmoothingEnabled=!0,e.webkitImageSmoothingEnabled=!0,e}function _dataURLToBlob(t){if(-1==t.indexOf(";base64,")){var e=t.split(","),n=e[0].split(":")[1],i=decodeURIComponent(e[1]);return new Blob([i],{type:n})}for(var a=t.split(";base64,"),s=a[0].split(":")[1],r=window.atob(a[1]),o=r.length,l=new Uint8Array(o),c=0;c<o;++c)l[c]=r.charCodeAt(c);return new Blob([l],{type:s})}function _calculateNewDimensions(t,e,n,i){var a=Math.min(n/t,i/e);return{width:Math.floor(t*a),height:Math.floor(e*a)}}return{calcAspectRatio:calcAspectRatio,createFileFromDataURL:createFileFromDataURL,readFileToDataURI:readFileToDataURI,readFileToImg:readFileToImg,resizeImg:resizeImg,getImageTagType:getImageTagType}}function ittUtils_ittUtils(t){function ngTimeout(e,n){return t(e,n||0)}function cancelNgTimeout(e){t.cancel(e)}return{getSubdomain:getSubdomain,existy:ittUtils_existy,truthy:truthy,generateUUID:generateUUID,isValidURL:isValidURL,stripHtmlTags:stripHtmlTags,pick:pick,bitwiseCeil:bitwiseCeil,setNgOpts:setNgOpts,intersection:intersection,parseTime:parseTime,renameKey:renameKey,ngTimeout:ngTimeout,cancelNgTimeout:cancelNgTimeout,capitalize:capitalize,slugify:slugify}}function capitalize(t){if(ittUtils_existy(t))return t.slice(0,1).toUpperCase()+t.slice(1)}function bitwiseCeil(t){return t+(t<0?0:1)>>0}function pick(t,e){return e.reduce(function(e,n){return ittUtils_existy(t[n])&&(e[n]=angular.copy(t[n])),e},{})}function stripHtmlTags(t){return String(t).replace(/<\/?[^>]*>/gm,"")}function getSubdomain(t){return t.indexOf(".")<0?null:t.split(".")[0]}function ittUtils_existy(t){return null!=t}function truthy(t){return 0!=t&&ittUtils_existy(t)}function generateUUID(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:7&n|8).toString(16)})}function isValidURL(t){return/^(((?:http)s?:\/\/)|(?:\/\/))(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\.)+(?:[A-Z]{2,6}\.?|[A-Z0-9-]{2,}\.?)|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::\d+)?(?:\/?|[\/?]\S+)$/i.test(t)}function setNgOpts(t){return"option.value as option.name for option in $ctrl.getSelectOpts('"+t+"')"}function intersection(t,e){for(var n=[],i=0;i<t.length;i++)for(var a=0;a<e.length;a++)if(t[i]==e[a]){n.push(i);break}return n}function parseTime(t){if(!isNaN(parseFloat(t))&&isFinite(t))return t;var e=t.match(/^(\d+)[m:]([\d\.]+)s?$/);return e?parseFloat(60*e[1])+parseFloat(e[2]):(e=t.match(/^([\d\.]+)s$/))?parseFloat(e[1]):(e=t.match(/^([\d\.]+)m$/),e?parseFloat(60*e[1]):void 0)}function renameKey(t,e,n){n.hasOwnProperty(t)&&!n.hasOwnProperty(e)&&t!==e&&(n[e]=n[t],delete n[t])}function slugify(t){return t.toLowerCase().replace(/ /g,"-").replace(/[^\w-]/g,"")}function mockSvc_mockSvc(t){var e={};return e.keepJsLintHappy=function(){t.episodes.noop},e.mockEpisode=function(e){t.cache("episode",{_id:e,created_at:"2014-04-10T02:02:15Z",description:{en:"The Business Case for Sustainability"},master_asset_id:"masterasset",title:{en:"Test Episode"},languages:[{code:"en",default:!0}],status:"Published",templateUrl:"templates/episode/gwsb.html",styles:["","",""]}),t.cache("asset",{_id:"masterasset",_type:"Asset::Video",alternate_urls:["https://www.youtube.com/watch?v=dTAAsCNK7RA&list=RDHCffYp01sXKH8","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg.m3u8","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg_416x234.webm","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg_960x540.webm","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg_416x234.mp4","https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/9aPKP5AJNJdH-UEQ2EB9jg_960x540.mp4"],attachment:"Sustainability_Pays_for_Demo_1.mp4",base_path:"development/Test Customer/SLIC/The Business Case/Sustainability Pays sXs",content_type:"video/mp4",duration:"443.199313",extension:"mp4",file_size:338886327,filename:"Sustainability_Pays_for_Demo_1.mp4",frame_rate:"10000000/417083",frame_rate_d:417083,frame_rate_n:1e7,height:720,name:"Sustainability Pays for Demo 1",original_filename:"Sustainability_Pays_for_Demo_1.mp4",start_time:"0.000000",status:"complete",url:"https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays%20sXs/Sustainability_Pays_for_Demo_1.mp4",width:1280});for(var n={_id:"-",_type:"Scene",description:{en:"Scene <b>description</b> Description"},keywords:[],start_time:0,end_time:200,type:"Scene",episode_id:e,cur_episode_id:e,layouts:["",""],styles:["transitionSlideL"]},i=["templates/scene/cornerH.html","templates/scene/cornerV.html","templates/scene/2colL.html","templates/scene/2colR.html","templates/scene/centered.html","templates/scene/1col.html"],a=0;a<10;a++){var s=angular.copy(n);s._id="scene-"+a,s.title=a/2===Math.floor(a/2)?{en:"Scene "+(a+1)+" Title"}:{en:""},s.start_time=20*a,s.end_time=20*a+20,s.templateUrl=i[a%i.length],t.cache("event",s)}var r={_id:"",_type:"Annotation",annotation:{en:"Transcript text: <b>html</b> included!"},annotation_image_id:"asset3",annotator:{en:"Speaker Name"},cosmetic:!1,episode_id:e,cur_episode_id:e,required:!1,stop:!1,type:"Annotation",templateUrl:"templates/item/transcript-withthumbnail.html",styles:["colorInvert"]},o=["sidebarL","sidebarR","inline"],l=["templates/item/text-h1.html","templates/item/pullquote.html","templates/item/text-h2.html"];for(a=0;a<30;a++){var c=angular.copy(r);c._id="transcript-"+a,c.annotation={en:"Transcript block number "+(a+1)},c.start_time=5*a,c.end_time=5*a+5,c.layouts=[o[a%o.length]]}for(a=0;a<10;a++){var d=angular.copy(r);d._id="annotation-"+a,d.start_time=6*a,d.end_time=6*a+3,d.templateUrl=l[a%l.length],t.cache("event",d)}for(a=0;a<10;a++){var p=angular.copy(r);p._id="longtext-"+a,p.start_time=7*a,p.end_time=7*a+7,p.styles=["timestampNone"],p.annotation={en:"A way a long a last a loved along the riverrun, past Eve and Adam's, from swerve of shore to bend of bay, brings us by a commodius vicus of recirculation back to Howth Castle and Environs. Sir Tristram, <i>violer d'amores</i>, fr'over the short sea, had passencore rearrived from North Armorica on this side the scraggy isthmus of Europe Minor to wielderfight his penisolate war"},p.templateUrl="templates/item/text-transmedia.html",t.cache("event",p)}t.cache("asset",{_id:"asset1",_type:"Asset::Image",url:"https://s3.amazonaws.com/itt.uploads/development/Test%20Customer/SLIC/The%20Business%20Case/Sustainability%20Pays/Sustainability_Scorecard_1.jpg",extension:"jpg",name:"Sustainability Scorecard 1"}),t.cache("asset",{_id:"asset2",_type:"Asset::Image",url:"http://placehold.it/350x350",extension:"jpg",name:"350x350 placeholder"}),t.cache("asset",{_id:"asset3",_type:"Asset::Image",url:"http://placehold.it/64x64",extension:"jpg",name:"64x64 placeholder"}),t.cache("asset",{_id:"asset4",_type:"Asset::Image",url:"http://placehold.it/900x900",extension:"jpg",name:"900x900 placeholder"});var m={_id:"",_type:"Link",link_image_id:"asset1",url:"https://luminarydigitalmedia.com",title:{en:"Link Title"},description:{en:"Link Description <i>lorem</i> ipsum dolor frog a frog oh lord it's amet lorem ipsum buddy lorem ipsum dolor frog a frog oh lord it's amet lorem ipsum buddy lorem ipsum dolor frog a frog oh lord it's amet lorem ipsum buddy"},cosmetic:!1,stop:!1,type:"Link",episode_id:e,cur_episode_id:e,templateUrl:"templates/item/link-withimage.html",layouts:["inline"],styles:["timestampNone"],isContent:!0};for(a=0;a<30;a++){var u=angular.copy(m);u._id="link-"+a,u.required=Math.random()>.5,u.start_time=3*a,u.end_time=3*a+3,u.layouts=[o[a%o.length]],t.cache("event",u)}var g={_id:"",_type:"Plugin",producerItemType:"question",episode_id:e,cur_episode_id:e,templateUrl:"templates/item/question-mc.html",style_id:[],layout_id:[],title:{},data:{_id:"",_pluginType:"question",_version:2,_plugin:{questiontext:"Some question text?",questiontype:"mc-formative",distractors:[{text:"a",index:1},{text:"b",index:2},{text:"c",correct:!0,index:3},{text:"",index:4}],correctfeedback:"Great!",incorrectfeedback:"Doh!",_type:"question"}}};for(a=0;a<10;a++){var v=angular.copy(g);v._id="question-"+a,v.required=Math.random()>.5,v.start_time=5*a,v.end_time=5*a+5,v.layouts=[o[a%o.length]],t.cache("event",v)}var h={_id:"",_type:"Plugin",type:"Plugin",producerItemType:"question",episode_id:e,cur_episode_id:e,templateUrl:"templates/item/question-mc.html",style_id:[],layout_id:[],data:{_id:"",_pluginType:"question",_version:2,_plugin:{questiontext:"Some question text?",questiontype:"mc-poll",distractors:[{text:"a",index:1},{text:"b",index:2},{text:"c",index:3},{text:"",index:4}],_type:"question"}}};for(a=0;a<10;a++){var f=angular.copy(h);f._id="question-"+a,f.required=Math.random()>.5,f.start_time=6*a,f.end_time=6*a+6,f.layouts=[o[a%o.length]],t.cache("event",f)}var y={_type:"Upload",description:{en:"Description of an upload item"},required:!1,cosmetic:!0,stop:!1,type:"Upload",episode_id:e,cur_episode_id:e,templateUrl:"templates/item/image-caption.html",styles:["transitionFade","tl"],layouts:["inline"]};for(a=0;a<30;a++){var _=angular.copy(y);_._id="upload-"+a,_.asset_id="asset2",_.title={en:"Upload number "+(a%3+1)},_.start_time=4*a,_.end_time=4*a+4,_.layouts=[o[a%o.length]],t.cache("event",_)}var b=["mainFg","altFg","videoOverlay"];for(a=0;a<8;a++){var x=angular.copy(y);x.layouts=[b[a%b.length]],x._id="filltest-"+a,x.asset_id="asset2",x.start_time=2*a,x.end_time=2*a+2,x.templateUrl="templates/item/image-fill.html",x.styles.push("cover"),t.cache("event",x)}t.resolveEpisodeEvents(e),t.resolveEpisodeAssets(e)},e}function modelSvc_modelSvc(t,e,n,i,a,s,r){function assocNarrativesWithCustomer(t,e){return e.forEach(function(t){o.cache("narrative",t)}),t.narratives=cachedNarrativesByCustomer(t),o.cache("customer",t),t}function cachedNarrativesByCustomer(t){return Object.keys(o.narratives).reduce(function(e,n){return o.narratives[n].customer_id===t._id&&e.push(o.narratives[n]),e},[])}function getCustomersAsArray(){return Object.keys(o.customers).map(function(t){return o.customers[t]})}function getNarrativesAsArray(){return Object.keys(o.narratives).map(function(t){return o.narratives[t]})}function _sortItems(t){return t.sort(function(t,e){return t.start_time===e.start_time?"chapter"===t.producerItemType?-1:"chapter"===e.producerItemType?1:!0===t.chapter_marker?-1:!0===e.chapter_marker?1:"templates/item/text-h1.html"===t.templateUrl?-1:"templates/item/text-h1.html"===e.templateUrl?1:"templates/item/text-h2.html"===t.templateUrl?-1:"templates/item/text-h2.html"===e.templateUrl?1:t.isTranscript?-1:e.isTranscript?1:"Link"===t._type?-1:"Link"===e._type?1:"Upload"===t._type?"file"===t.producerItemType||"Annotation"===e._type?-1:1:"Upload"===e._type?1:-1:t.start_time-e.start_time})}function isOnExistingSceneStart(t){return getEpisodeScenes().some(function(e){return e.start_time===n.parseTime(t)})}function getEpisodeScenes(){return Object.keys(o.events).reduce(function(t,e){return"Scene"===o.events[e]._type&&o.events[e].episode_id===a.episodeId&&t.push(o.events[e]),t},[])}function assocEventWithAsset(t,e){o.events[t]&&o.assets[e]&&(o.events[t].asset=o.assets[e])}var o=Object.create(null);o.episodes={},o.assets={},o.events={},o.containers={},o.narratives={},o.customers={},o.getNarrativeByPathOrId=function(t){if(/^[0-9a-fA-F]{24}$/.test(t))return o.narratives[t];var e;for(e in o.narratives)if(o.narratives.hasOwnProperty(e)&&t===o.narratives[e].path_slug.en)return o.narratives[e]},o.assocNarrativesWithCustomer=assocNarrativesWithCustomer,o.cachedNarrativesByCustomer=cachedNarrativesByCustomer,o.getCustomersAsArray=getCustomersAsArray,o.getNarrativesAsArray=getNarrativesAsArray,o.cache=function(t,e){"narrative"===t&&(o.narratives[e._id]?angular.extend(o.narratives[e._id],e):o.narratives[e._id]=angular.copy(e)),"customer"===t&&(o.customers[e._id]?angular.extend(o.customers[e._id],e):o.customers[e._id]=angular.copy(e)),"episode"===t?o.episodes[e._id]?angular.extend(o.episodes[e._id],o.deriveEpisode(angular.copy(e))):o.episodes[e._id]=o.deriveEpisode(angular.copy(e)):"event"===t?(e.title||(e.title={}),o.events[e._id]?angular.extend(o.events[e._id],o.deriveEvent(angular.copy(e))):o.events[e._id]=o.deriveEvent(angular.copy(e))):"asset"===t?o.assets[e._id]?angular.extend(o.assets[e._id],o.deriveAsset(angular.copy(e))):o.assets[e._id]=o.deriveAsset(angular.copy(e)):"container"===t&&(o.containers[e._id]?angular.extend(o.containers[e._id],o.deriveContainer(angular.copy(e))):o.containers[e._id]=o.deriveContainer(angular.copy(e)))};var l={"templates/episode-default.html":"templates/episode/episode.html","templates/episode-eliterate.html":"templates/episode/eliterate.html","templates/episode-ewb.html":"templates/episode/ewb.html","templates/episode-gw.html":"templates/episode/gw.html","templates/episode-purdue.html":"templates/episode/purdue.html","templates/episode-tellingstory.html":"templates/episode/story.html","templates/scene-1col.html":"templates/scene/1col.html","templates/scene-2colL.html":"templates/scene/2colL.html","templates/scene-2colR.html":"templates/scene/2colR.html","templates/scene-centered.html":"templates/scene/centered.html","templates/scene-cornerH.html":"templates/scene/cornerH.html","templates/scene-cornerV.html":"templates/scene/cornerV.html","templates/transcript-default.html":"templates/item/transcript.html","templates/transcript-withthumbnail.html":"templates/item/transcript-withthumbnail.html","templates/transcript-withthumbnail-alt.html":"templates/item/transcript-withthumbnail-alt.html","templates/text-h1.html":"templates/item/text-h1.html","templates/text-h2.html":"templates/item/text-h2.html","templates/text-pullquote-noattrib.html":"templates/item/pullquote-noattrib.html","templates/text-pullquote.html":"templates/item/pullquote.html","templates/transmedia-caption.html":"templates/item/image-caption.html","templates/transmedia-image-default.html":"templates/item/image.html","templates/transmedia-slidingcaption.html":"templates/item/image-caption-sliding.html","templates/transmedia-image-fill.html":"templates/item/image-fill.html","templates/transmedia-image-plain.html":"templates/item/image-plain.html","templates/transmedia-linkonly.html":"templates/item/image-linkonly.html","templates/transmedia-thumbnail.html":"templates/item/image-thumbnail.html","templates/transmedia-link-default.html":"templates/item/link.html","templates/transmedia-link-frameicide.html":"templates/item/link.html","templates/transmedia-link-noembed.html":"templates/item/link.html","templates/transmedia-link-embed.html":"templates/item/link-embed.html","templates/transmedia-link-youtube.html":"templates/item/link.html","templates/transmedia-embed-youtube.html":"templates/item/link-embed.html","templates/transmedia-link-icon.html":"templates/item/link.html","templates/question-mc-formative.html":"templates/item/question-mc-formative.html","templates/question-mc-poll.html":"templates/item/question-mc-poll.html","templates/question-mc.html":"templates/item/question-mc.html","templates/question-mc-image-left.html":"templates/item/question-mc-image-left.html","templates/question-mc-image-right.html":"templates/item/question-mc-image-right.html","templates/sxs-question.html":"templates/item/sxs-question.html"};o.deriveEpisode=function(t){return t.templateUrl||(t.templateUrl="templates/episode/episode.html"),l[t.templateUrl]&&(t.origTemplateUrl=t.templateUrl,t.templateUrl=l[t.templateUrl]),angular.forEach(t.languages,function(e){e.default&&(t.defaultLanguage=e.code)}),!1===t.defaultLanguage&&(t.defaultLanguage="en"),o.setLanguageStrings(),t.styles||(t.styles=[]),angular.forEach(["eliterate","gw","gwsb","purdue","usc","columbia","columbiabusiness"],function(e){t.templateUrl==="templates/episode/"+e+".html"&&angular.forEach(["color","typography"],function(n){var i=!1;angular.forEach(t.styles,function(t){t.match(n)&&(i=!0)}),i||t.styles.push(n+e[0].toUpperCase()+e.substring(1))})}),t.title&&o.events["internal:landingscreen:"+t._id]&&(o.events["internal:landingscreen:"+t._id].title=t.title,o.events["internal:landingscreen:"+t._id]=d(o.events["internal:landingscreen:"+t._id])),t=d(t)},o.deriveAsset=function(t){return"Asset::Video"===t._type&&(t=r.resolveVideo(t)),t=d(t)},o.deriveContainer=function(t){if(t.haveNotLoadedChildData=!1,t.children&&t.children.length>0){t.children=t.children.sort(function(t,e){return t.name.en>e.name.en?1:-1}),t.children=t.children.sort(function(t,e){return t.sort_order-e.sort_order});var e=[];angular.forEach(t.children,function(t){o.containers[t._id]?e.push(o.containers[t._id]):(t.haveNotLoadedChildData=!0,o.containers[t._id]=angular.copy(d(t)))}),t.loadedChildData=!0}else t.children=[];return d(t)};var c=function(t){if(void 0!==t)return!("Annotation"!==t._type||!t.templateUrl.match(/transcript/))};o.deriveEvent=function(n){if(n=d(n),"Scene"!==n._type){n.searchableText=(n.display_annotation||n.display_description)+" "+(n.display_title||n.display_annotator),n.cosmetic||(n.cosmetic=!1),n.sxs&&(n.cosmetic=!1),n.templateUrl||(n.templateUrl=""),n.avatar_id&&(o.assets[n.avatar_id]||(o.assets[n.avatar_id]={}),n.avatar=o.assets[n.avatar_id]),o.episodes[n.cur_episode_id]&&"templates/episode/usc.html"===o.episodes[n.cur_episode_id].templateUrl&&(""===n.templateUrl&&(n.templateUrl="templates/item/usc-badges.html"),"Link"===n._type&&("templates/transmedia-link-default.html"===n.templateUrl&&(n.templateUrl="templates/transmedia-link-noembed.html"),n.display_title.match(/ACTIVITY/)&&(n.display_description=n.display_description+'<div class="uscWindowFgOnly">Remember! You need to complete this activity to earn a Friends of USC Scholars badge. (When you’re finished - Come back to this page and click <b>Continue</b>).<br><br>If you’d rather <b>not</b> do the activity, clicking Continue will take you back to the micro-lesson and you can decide where you want to go from there.</div>'),n.display_title.match(/Haven't Registered/)&&(n.styles=n.styles?n.styles:[],n.styles.push("uscHackOnlyGuests"),n.uscReviewModeHack="uscHackOnlyGuests"),n.display_title.match(/Connect with/)&&(n.styles=n.styles?n.styles:[],n.styles.push("uscHackOnlyBadge"),n.uscReviewModeHack="uscHackOnlyBadge"))),n.isContent=!1,n.isTranscript=!1,n.mixedContent=!1,n.noExternalLink=!1,n.targetTop=!1,n.isVideoUrl=!1,n.layouts?(n.layoutCss=n.layouts[0],("inline"===n.layouts[0]||n.layouts[0].match(/sidebar/)||n.layouts[0].match(/burst/))&&(n.isContent=!0)):n.isContent=!0,c(n)&&(n.isTranscript=!0);var i="https"===e.protocol();"Link"===n._type&&n.url&&n.url.match(/^http:\/\//)&&i&&(n.mixedContent=!0,n.showInlineDetail=!1),"Link"===n._type&&r.isVideoUrl(n.url)&&(n.isVideoUrl=!0),"Link"===n._type&&n.url&&/mailto/.test(n.url)&&(n.target="_blank"),n.templateUrl.match(/-embed/)&&(n.noExternalLink=!0),n.templateUrl.match(/frameicide/)&&(n.targetTop=!0)}switch(l[n.templateUrl]?(n.origTemplateUrl=n.templateUrl,n.templateUrl=l[n.templateUrl],n.isContent||"templates/item/image-plain.html"!==n.templateUrl||(n.templateUrl="templates/item/image-fill.html")):n.origTemplateUrl=n.templateUrl,n.producerItemType||("Scene"===n._type?n.producerItemType="scene":"Annotation"===n._type?n.templateUrl.match(/transcript/)?n.producerItemType="transcript":n.producerItemType="annotation":"Upload"===n._type?n.templateUrl.match(/file/)?n.producerItemType="file":n.producerItemType="image":"Link"===n._type?n.templateUrl.match(/video/)?n.producerItemType="video":n.producerItemType="link":"Plugin"===n._type?n.templateUrl.match(/question/)&&(n.producerItemType="question"):"Chapter"===n._type&&(n.producerItemType="chapter"),n.producerItemType),n.producerItemType){case"chapter":n.isContent=!1;break;case"annotation":n.isPq=n.isHeader=n.isLongText=n.isDef=!1,/pullquote/.test(n.templateUrl)&&(n.isPq=!0),/text-h1|text-h2/.test(n.templateUrl)&&(n.isHeader=!0),/text-transmedia/.test(n.templateUrl)&&(n.isLongText=!0),n.isDef=!0}return n.displayStartTime=t("asTime")(n.start_time),n};var d=function(t){var e=a.lang?a.lang:"en";return angular.forEach(["title","annotator","annotation","description","name"],function(n){t[n]&&("string"==typeof t[n]?t["display_"+n]=t[n]:t[n][e]?t["display_"+n]=t[n][e]:t["display_"+n]=t[n].en)}),t};o.setLanguageStrings=function(){angular.forEach(o.events,function(t){t=d(t)}),angular.forEach(o.episodes,function(t){t=d(t)}),angular.forEach(o.containers,function(t){t=d(t)})},o.resolveEpisodeEvents=function(t){var e=[],i=[],a=[],s=o.episodes[t];angular.forEach(o.events,function(n){n.cur_episode_id===t&&("Scene"===n._type?e.push(n):"Chapter"===n._type?(a.push(n),i.push(n)):i.push(n))});var r={};angular.forEach(i,function(t){if("Annotation"===t._type&&!0===t.chapter_marker&&a.push(t),"Annotation"===t._type&&t.annotator){var e=s.defaultLanguage||"en",n=t.annotator[e];void 0===n&&(n=t.annotator[Object.keys(t.annotator).sort()[0]]),r[n]?(r[n].name=angular.extend(r[n].name,t.annotator),r[n].annotation_image_id||(r[n].annotation_image_id=t.annotation_image_id)):r[n]={name:t.annotator,annotation_image_id:t.annotation_image_id};for(var i=Object.keys(r[n].name).sort(),o=r[n].name[e]||"(untranslated)",l=0;l<i.length;l++)i[l]!==e&&(o=o+" / "+r[n].name[i[l]]);r[n].key=o}}),s.annotators=r,s.chapters=a;var l=0;s.masterAsset&&(l=s.masterAsset.duration,angular.forEach(s.scenes,function(t){t.start_time>l&&(t.start_time=l-.2)})),s.scenes=e.sort(function(t,e){return t._id.indexOf("internal:start")>-1||e._id.indexOf("internal:end")>-1?-1:e._id.indexOf("internal:start")>-1||t._id.indexOf("internal:end")>-1?1:t.start_time-e.start_time}),s.chapters=a.sort(function(t,e){return t.start_time-e.start_time}),angular.forEach(i,function(t){l>0&&t.start_time>l-.11&&(t.start_time=l-.2,t.end_time=l-.1),t.start_time<.01&&(t.start_time=.01,t.end_time<.01&&(t.end_time=.01)),t.start_time>t.end_time&&(t.end_time=t.start_time)}),s.items=_sortItems(i);for(var d=1,m=s.scenes.length;d<m;d++)d===m-1?0!==l&&(s.scenes[d].end_time=l):s.scenes[d].end_time=s.scenes[d+1].start_time;for(var u=0,g=e.length;u<g;u++){for(var v=e[u],h=[],f={},y=0,_=i.length;y<_;y++){var b=i[y];b.start_time>=v.start_time&&b.start_time<v.end_time&&(c(b)&&(f.end_time===v.end_time&&(f.end_time=b.start_time),f=b),b.end_time<=v.end_time?(o.events[b._id].scene_id=v._id,h.push(b)):v.end_time-.25<b.start_time&&u!==g-1?b.start_time=v.end_time:(b.end_time=v.end_time,b.scene_id=v._id,h.push(b)))}o.events[v._id].items=_sortItems(h)}s.styleCss=p(s),angular.forEach(o.events,function(e){if(e.cur_episode_id===t){e.styleCss=p(e);var i,a="templates/item/image-plain.html"===e.templateUrl,r="templates/item/image-inline-withtext.html"===e.templateUrl,l="templates/item/image-caption-sliding.html"===e.templateUrl,c="templates/item/image-thumbnail.html"===e.templateUrl,d="templates/item/image-fill.html"===e.templateUrl,m="templates/item/text-transmedia.html"===e.templateUrl,u="templates/item/text-definition.html"===e.templateUrl,g="templates/item/text-h1.html"===e.templateUrl,v="templates/item/text-h2.html"===e.templateUrl,h="templates/item/pullquote-noattrib.html"===e.templateUrl||"templates/item/pullquote.html"===e.templateUrl,f=["highlightSolid","highlightBorder","highlightSide","highlightBloom","highlightTilt","highlightNone"],y=["transitionFade","transitionPop","transitionNone","transitionSlideL","transitionSlideR"];"Scene"!==e._type&&(i=o.scene(e.scene_id),-1!==s.styles.indexOf("timestampNone")||-1!==s.styles.indexOf("timestampInline")||n.existy(i)&&n.existy(i.styles)&&(-1!==i.styles.indexOf("timestampNone")||-1!==i.styles.indexOf("timestampInline"))||(a||m||u)&&(!n.existy(e.styles)||-1===e.styles.indexOf("timestampInline")&&-1===e.styles.indexOf("timestampNone"))&&(e.styleCss+=" timestampNone"),(g||v||h)&&(e.styleCss+=" timestampNone"),n.existy(e.layouts)&&-1!==e.layouts.indexOf("showCurrent")||0!==n.intersection(s.styles,f).length||n.existy(i)&&n.existy(i.styles)&&0!==n.intersection(i.styles,f).length||n.existy(e.styles)&&0!==n.intersection(e.styles,f).length||(e.styleCss+=" highlightSolid"),0!==n.intersection(s.styles,y).length||n.existy(i)&&n.existy(i.styles)&&0!==n.intersection(i.styles,y).length||n.existy(e.styles)&&0!==n.intersection(e.styles,y).length||(a||r||l||c||h||d?n.existy(e.layouts)&&-1===e.layouts.indexOf("videoOverlay")?e.styleCss+=" transitionPop":e.styleCss+=" transitionFade":e.styleCss+=" transitionSlideL")),e.layouts&&(e.styleCss=e.styleCss+" "+e.layouts.join(" ")),e.styleCss=e.styleCss.replace(/timestampInline/,"")}})},o.resolveEpisodeContainers=function(t){var e=o.episodes[t];e.parents=[],delete e.previousEpisodeContainer,delete e.nextEpisodeContainer,e.navigation_depth=0},o.episode=function(t){return o.episodes[t],o.episodes[t]},o.episodeEvents=function(t){var e=[];return angular.forEach(o.events,function(n){n.cur_episode_id===t&&e.push(n)}),e},o.isOnExistingSceneStart=isOnExistingSceneStart,o.getEpisodeScenes=getEpisodeScenes,o.sceneAtEpisodeTime=function(t,e){e=e||s.getMetaProp("time");for(var n=o.episodes[t].scenes,i=0;i<n.length;i++)if(n[i].start_time<=e&&n[i].end_time>e)return n[i]},o.scene=function(t){return o.events[t],o.events[t]};var p=function(t){var e={typography:!1,color:!1,highlight:!1,timestamp:!1,transition:!1},n=[];if(angular.forEach(t.styles,function(t){n.push(t),angular.forEach(e,function(n,i){0===t.indexOf(i)&&(e[i]=t)})}),t.scene_id){var i=o.events[t.scene_id].styles;angular.forEach(i,function(t){angular.forEach(e,function(i,a){e[a]||0!==t.indexOf(a)||(n.push(t),e[a]=t)})})}if(t.cur_episode_id){var a=o.episodes[t.cur_episode_id].styles;angular.forEach(a,function(t){angular.forEach(e,function(i,a){e[a]||0!==t.indexOf(a)||n.push(t)})})}if("Scene"!==t._type&&!t.isContent&&t.layouts&&t.layouts[0].match(/Bg/))for(var s=0;s<n.length;s++)n[s].match(/transition/)&&"transitionNone"!==n[s]&&(n[s]="transitionFade");return n.join(" ")};return o.assocEventWithAsset=assocEventWithAsset,o.resolveEpisodeAssets=function(t){if(angular.forEach(o.events,function(e){if(e.cur_episode_id===t){var n=e.asset_id||e.link_image_id||e.annotation_image_id;n&&o.assets[n]&&(o.events[e._id].asset=o.assets[n])}}),o.episodes[t]){var e=o.episodes[t].master_asset_id;e&&o.assets[e]&&(o.episodes[t].masterAsset=o.assets[e]);var n=o.episodes[t].poster_frame_id;n&&o.assets[n]&&(o.episodes[t].poster=o.assets[n])}},o.addLandingScreen=function(t){o.events["internal:landingscreen:"+t]=createInstance("Scene",{_id:"internal:landingscreen:"+t,_type:"Scene",_internal:!0,templateUrl:"templates/scene/landingscreen.html",cur_episode_id:t,episode_id:t,start_time:-.01,end_time:.01})},o.addEndingScreen=function(t){var e=o.episodes[t];if(e&&e.scenes&&e.masterAsset){e.scenes=e.scenes.sort(function(t,e){return t.start_time-e.start_time});var n=e.scenes[e.scenes.length-1];if(!n._id.match(/internal:endingscreen/)){var i=parseFloat(e.masterAsset.duration);n.end_time=i-.1,angular.forEach(n.items,function(t){t.end_time>i-.1&&(t.end_time=i-.1)}),o.events["internal:endingscreen:"+t]=createInstance("Scene",{_id:"internal:endingscreen:"+t,_type:"Scene",_internal:!0,templateUrl:"templates/scene/endingscreen.html",cur_episode_id:t,start_time:i-.1,end_time:i}),o.events["internal:endingscreen:"+t]=d(o.events["internal:endingscreen:"+t]),o.resolveEpisodeEvents(t)}}},o.isTranscoded=function(t){return t.mediaSrcArr.length>0},i.debugInBrowser,o}function playbackService_playbackService(t,e,n,i,a,s,r,o,l){function handleTimelineEnd(t){t=_setPid(t),h(m[t])&&m[t].handleTimelineEnd(t)}function seedPlayer(t,e,n){if(!0!==n||!h(m[e])){var i=r.parseMediaSrcArr(t),a=_getPlayerManagerFromMediaSrc(i);m[e]=a,p=!1,n&&(c=e,"wistia"!==a.type&&_pollBufferedPercent()),a.seedPlayerManager(e,n,i[0].mediaSrcArr)}}function createInstance(t){m[t].create(t)}function play(t){angular.forEach(g,function(e){e.pauseOtherPlayers(_setPid(t))}),!0===getMetaProp("ready",_setPid(t))&&m[_setPid(t)].play(_setPid(t))}function pause(t){!0===getMetaProp("ready",_setPid(t))&&m[_setPid(t)].pause(_setPid(t))}function seek(t,e){!0===getMetaProp("ready",_setPid(e))&&m[_setPid(e)].seekTo(_setPid(e),parseFloat(t))}function allowPlayback(t){return"paused"===t||"unstarted"===t||"video cued"===t||"ended"===t||"player ready"===t}function togglePlayback(t,e){t=_setPid(t);var n=getPlayerState(t);if(getMetaProp("time",t)>=getMetaProp("duration",t)&&t===c)return e();!0===allowPlayback(n)?play(t):pause(t)}function pauseOtherPlayers(t){angular.forEach(g,function(e){e.pauseOtherPlayers(_setPid(t))}),angular.forEach(m,function(e,n){n!==t&&n!==c&&e.setMetaProp(n,"playerState","2")})}function registerStateChangeListener(t){for(var e=u.length;e--;)if(t.toString()===u[e].toString())return;u.push(t)}function unregisterStateChangeListener(t){u=u.filter(function(e){return e.toString()!==t.toString()})}function getCurrentTime(t){if(h(m[_setPid(t)]))return m[_setPid(t)].getCurrentTime(_setPid(t))}function getPlayerDiv(t){return m[_setPid(t)].getPlayerDiv(_setPid(t))}function getPlayerState(t){return m[_setPid(t)].getPlayerState(_setPid(t))}function setSpeed(t,e){return m[_setPid(e)].setSpeed(_setPid(e),t)}function toggleMute(t){return m[_setPid(t)].toggleMute(_setPid(t))}function setVolume(t,e){m[_setPid(e)].setVolume(_setPid(e),t)}function getMetaProp(t,e){var n=_setPid(e);if(h(m[n]))return m[n].getMetaProp(n,t)}function setMetaProp(t,e,n){var i=_setPid(n);h(m[i])&&m[i].setMetaProp(i,t,e)}function getTimelineState(){return v}function setTimelineState(t){v=t}function freezeMetaProps(t){m[_setPid(t)].freezeMetaProps(_setPid(t))}function unFreezeMetaProps(t){m[_setPid(t)].unFreezeMetaProps(_setPid(t))}function resetPlaybackService(){p=!0,m={},angular.forEach(g,function(t){t.resetPlayerManager()}),c="",v="",t.cancel(d)}function handle$Destroy(t){t!==c?!1===p&&_handleEmbedDestroy(t):_emitStateChange("reset")}function stop(t){m[_setPid(t)].stop(_setPid(t))}function renamePid(t,e){h(m[t])&&m[t].renamePid(t,e),t===c&&(c=e),s.renameKey(t,e,m)}function _getBufferedPercent(t){return t=_setPid(t),m[t].getBufferedPercent(t)}function _handleEmbedDestroy(t){setMetaProp("startAtTime",getCurrentTime(t),t),setMetaProp("hasResumedFromStartAt",!1,t),setMetaProp("ready",!1,t),freezeMetaProps(t)}function _setPid(t){return h(t)?t:c}function _emitStateChange(t){angular.forEach(u,function(e){e(t)})}function _onPlayerReady(t){var e=l[getMetaProp("playerState",t)],n=getMetaProp("startAtTime",t),i=getMetaProp("hasResumedFromStartAt",t),a=getMetaProp("resetInProgress",t);if(setMetaProp("ready",!0,t),t===c&&!1===a&&(setMetaProp("playerState","5",t),_emitStateChange("video cued")),0===n&&!0===getMetaProp("autoplay",t)&&(play(t),setMetaProp("autoplay",!1,t)),n>0&&!1===i){if(seek(n,t),!0===a)return play(t),void setMetaProp("resetInProgress",!1,t);!0===getMetaProp("autoplay",t)&&(play(t),setMetaProp("autoplay",!1,t)),t!==c&&(setMetaProp("hasResumedFromStartAt",!0,t),"playing"===e&&play(t))}}function _stateChangeCB(t){var e=t.state,n=t.emitterId;switch(e){case"unstarted":case"ended":break;case"playing":!1===getMetaProp("hasBeenPlayed",n)&&setMetaProp("hasBeenPlayed",!0,n);break;case"paused":case"buffering":case"video cued":break;case"player ready":_onPlayerReady(n)}"player ready"!==e&&setMetaProp("playerState",o[e],n),n===c&&_emitStateChange(e)}function _pollBufferedPercent(){d=t(function(){setMetaProp("bufferedPercent",_getBufferedPercent(c),c)},200)}function _getPlayerManagerFromMediaSrc(t){for(var e=g.length,n=null;e--;)if(t.length>0&&g[e].type===t[0].type){n=g[e];break}return n}var c,d,p,m={},u=[],g=[n,e,i,a],v="",h=s.existy;return angular.forEach(g,function(t){t.registerStateChangeListener(_stateChangeCB)}),{seedPlayer:seedPlayer,createInstance:createInstance,play:play,pause:pause,seek:seek,getCurrentTime:getCurrentTime,getPlayerState:getPlayerState,toggleMute:toggleMute,setVolume:setVolume,getPlayerDiv:getPlayerDiv,setSpeed:setSpeed,registerStateChangeListener:registerStateChangeListener,unregisterStateChangeListener:unregisterStateChangeListener,getMetaProp:getMetaProp,setMetaProp:setMetaProp,getTimelineState:getTimelineState,setTimelineState:setTimelineState,freezeMetaProps:freezeMetaProps,unFreezeMetaProps:unFreezeMetaProps,pauseOtherPlayers:pauseOtherPlayers,handle$Destroy:handle$Destroy,resetPlaybackService:resetPlaybackService,stop:stop,allowPlayback:allowPlayback,togglePlayback:togglePlayback,renamePid:renamePid,handleTimelineEnd:handleTimelineEnd}}function playerManagerCommons(t){var e=t.existy;return function(n){function getStateChangeListeners(){return a}function getPlayer(t){if(e(i[t]))return i[t]}function setInstance(t,e){getPlayer(t).instance=e}function setPlayer(t,e){i[t]=e}function getMetaProp(t,n){if(e(i[t])&&e(i[t].meta))return i[t].meta[n]}function setMetaProp(t){return function(n,a,r){if(-1===t.indexOf(a))throw new Error(a+" is not a valid prop for"+s+" meta info");if(e(i[n]&&i[n].meta))try{i[n].meta[a]=r}catch(t){}}}function getMetaObj(t){if(e(i[t])&&e(i[t].meta))return i[t].meta}function createMetaObj(t,e){var n=angular.copy(e);return n.meta=angular.extend(n.meta,t),n}function getPlayerDiv(t){return getMetaProp(t,"div")}function pauseOtherPlayers(t,n){return function(a){Object.keys(i).forEach(function(i){if(i!==a){var s=n(i);e(s)&&"playing"===s&&t(i)}})}}function getInstance(t){return function(e){if(!0===t(e))return getPlayer(e).instance}}function registerStateChangeListener(t){for(var e=a.length;e--;)if(t.toString()===a[e].toString())return;a.push(t)}function unregisterStateChangeListener(t){a=a.filter(function(e){return e.toString()!==t.toString()})}function resetPlayerManager(t){return function(){angular.forEach(_getPlayers(),function(e,n){_destroyInstance(n,!0,t)}),i={}}}function renamePid(e,n){t.renameKey(e,n,i)}function handleTimelineEnd(t){return function(e){return t(e)}}function _destroyInstance(t,n,i){e(n)||(n=!1),i(t),!0===n&&setPlayer(t,{})}function _getPlayers(){return i}var i=n.players,a=[],s=n.type;return{commonMetaProps:T,getPlayer:getPlayer,setPlayer:setPlayer,getMetaProp:getMetaProp,setInstance:setInstance,setMetaProp:setMetaProp,createMetaObj:createMetaObj,getMetaObj:getMetaObj,getPlayerDiv:getPlayerDiv,getInstance:getInstance,registerStateChangeListener:registerStateChangeListener,unregisterStateChangeListener:unregisterStateChangeListener,getStateChangeListeners:getStateChangeListeners,pauseOtherPlayers:pauseOtherPlayers,resetPlayerManager:resetPlayerManager,renamePid:renamePid,handleTimelineEnd:handleTimelineEnd}}}function questionAnswersSvc_questionAnswersSvc(t,e,n){var i={};return i.saveAnswer=function(t,n,i){return e.forceCaptureEventActivityWithPromise(t,n,i)},i.getAnswers=function(i){var a=t.defer();return e.readEventActivity(i).then(function(t){var e=t.filter(function(t){return("question-answered"===t.name||"question-answered-updated"===t.name)&&t.episode_id===n.episodeId});a.resolve(e)}),a.promise},i.getUserAnswer=function(e,n){var a=t.defer();return i.getAnswers(e).then(function(t){if(!t)return a.reject();var e=t.filter(function(t){return t.user_id===n});e.length>0?a.resolve(e[0]):a.reject()}),a.promise},i.calculateCounts=function(t){var e;return angular.forEach(t,function(t){e[t.data.index]++}),e},i.incrementAnswerCount=function(t,e){t[e]=(t[e]||0)+1},i}function recursionHelper(t){return{compile:function(e,n){angular.isFunction(n)&&(n={post:n});var i,a=e.contents().remove();return{pre:n&&n.pre?n.pre:null,post:function(e,s){i||(i=t(a)),i(e,function(t){s.append(t)}),n&&n.post&&n.post.apply(null,arguments)}}}}}function selectService_selectService(t,e,n,i){function _setVisibility(t,e){l[t]=e}function _partialVis(t){return function(e){return _setVisibility(t,e)}}function _setAvailableImageOptsForLayout(t,e,n){var i="inline"===e.layouts[0];switch(-1!==e.layouts.indexOf("videoOverlay")&&(b(!1),n.position="fill"),t){case"centeredPro":v(!0),h(!0),o.display=[{value:"windowBg",name:d.windowBg,isDisabled:!1},{value:"videoOverlay",name:d.videoOverlay,isDisabled:!1},{value:"mainBg",name:d.textBg,isDisabled:!0},{value:"mainFg",name:d.textFg,isDisabled:!0},{value:"altBg",name:d.transmediaBg,isDisabled:!0},{value:"altFg",name:d.transmediaFg,isDisabled:!0}],i&&(e.layouts=["windowBg"]),e.layouts=e.layouts||["windowBg"],n.position=n.position||"fill";break;case"1col":case"centered":var s=a("admin");v(!0),o.display=[{value:"windowBg",name:d.windowBg,isDisabled:!1},{value:"videoOverlay",name:d.videoOverlay,isDisabled:!1},{value:"mainBg",name:d.textBg,isDisabled:!s},{value:"mainFg",name:d.textFg,isDisabled:!s},{value:"altBg",name:d.transmediaBg,isDisabled:!0},{value:"altFg",name:d.transmediaFg,isDisabled:!0}],i&&(e.layouts=["windowBg"]),n.position=n.position||"fill",e.layouts=e.layouts||["windowBg"];break;case"2colL":case"2colR":case"mirroredTwoCol":v(!0),o.display=[{value:"windowBg",name:d.windowBg,isDisabled:!1},{value:"videoOverlay",name:d.videoOverlay,isDisabled:!1},{value:"mainBg",name:d.textBg,isDisabled:!1},{value:"mainFg",name:d.textFg,isDisabled:!1},{value:"altBg",name:d.transmediaBg,isDisabled:!1},{value:"altFg",name:d.transmediaFg,isDisabled:!1}],i&&(e.layouts=["mainBg"]),n.position=n.position||"fill",e.layouts=e.layouts||["mainBg"];break;case"cornerV":case"centerVV":case"cornerH":v(!0),o.display=[{value:"windowBg",name:d.windowBg,isDisabled:!1},{value:"videoOverlay",name:d.videoOverlay,isDisabled:!1},{value:"mainBg",name:d.textBg,isDisabled:!1},{value:"mainFg",name:d.textFg,isDisabled:!1},{value:"altBg",name:d.transmediaBg,isDisabled:!1},{value:"altFg",name:d.transmediaFg,isDisabled:!1}],i&&(e.layouts=["altBg"]),n.position=n.position||"fill",e.layouts=e.layouts||["altBg"];break;case"pip":v(!0),o.display=[{value:"windowBg",name:d.windowBg,isDisabled:!0},{value:"videoOverlay",name:d.videoOverlay,isDisabled:!1},{value:"mainBg",name:d.textBg,isDisabled:!0},{value:"mainFg",name:d.textFg,isDisabled:!0},{value:"altBg",name:d.transmediaBg,isDisabled:!1},{value:"altFg",name:d.transmediaFg,isDisabled:!1}],i&&(e.layouts=["altBg"]),n.position=n.position||"fill",e.layouts=e.layouts||["altBg"];break;case"centerVVMondrian":o.display=[{value:"windowBg",name:d.windowBg,isDisabled:!0},{value:"videoOverlay",name:d.videoOverlay,isDisabled:!1},{value:"mainBg",name:d.textBg,isDisabled:!1},{value:"mainFg",name:d.textFg,isDisabled:!1},{value:"altBg",name:d.transmediaBg,isDisabled:!0},{value:"altFg",name:d.transmediaFg,isDisabled:!0}],i&&(e.layouts=["mainBg"]),e.layouts=e.layouts||["mainBg"],n.position=n.position||"fill"}n.position&&(e.styles=[n.position])}function getSceneName(t){return Object.keys(c).filter(function(e){return c[e]===t.templateUrl})[0]}function getSelectOpts(t){return o[t]}function getVisibility(t){return l[t]}function setupItemForm(t,e){var n={transition:"",highlight:"",color:"",typography:"",timestamp:""},i={position:""};if("item"===e&&(n=angular.extend(i,n)),!s(t))return n;for(var a in n)for(var r=0;r<t.length;r++)t[r].substr(0,a.length)===a&&(n[a]=t[r].substr(a.length));if("episode"===e)return n;for(var o=0;o<t.length;o++)"contain"!==t[o]&&"cover"!==t[o]&&"center"!==t[o]&&"fill"!==t[o]&&"tl"!==t[o]&&"tr"!==t[o]&&"bl"!==t[o]&&"br"!==t[o]||(n.position=t[o]);return n}function getTemplates(e){switch(e){case"episode":var r=t.getCustomerIdsFromRoles(),o=function(t,e){if(a("admin"))return"Episode"===e.type&&t.push({url:e.url,name:e.displayName}),t;if("Episode"===e.type&&s(e.customerIds)){(i.intersection(r,e.customerIds).length>0||0===e.customerIds.length)&&t.push({url:e.url,name:e.displayName})}return t},l=function(t,e){return t.name.toLowerCase()<e.name.toLowerCase()?-1:t.name.toLowerCase()>e.name.toLowerCase()?1:0};return f(!0),n.getTemplates().reduce(o,[]).sort(l);case"scene":v(!1),h(!1),_(!0),b(!1);var d=[{url:c.centered,name:"Center 1 (+ V•TS•ANT•TM)"},{url:c.centeredPro,name:"Center 2 (+ V•ANT)"},{url:c["1col"],name:"Center 3 (V•TS•ANT•TM)"},{url:c.cornerV,name:"Split 1 (V•TS•ANT | TM)"},{url:c.mirroredTwoCol,name:"Split 2 (V•TM | TS•ANT)"},{url:c.centerVV,name:"Split 3 (V•ANT | TM)"},{url:c.centerVVMondrian,name:"Split 4 (V•ANT | TM Invert)"},{url:c.cornerH,name:"Split 5 (V•TS•ANT / TM)"},{url:c.pip,name:"Split 6 (TM / V•TS•ANT)"}];return a("admin")&&d.push({url:c["2colL"],name:"OLD Two Columns"},{url:c["2colR"],name:"OLD Two Columns (mirrored)"}),d;case"transcript":return y(!0),_(!0),b(!1),[{url:"templates/item/transcript.html",name:"Transcript"}];case"annotation":return y(!1),f(!1),_(!0),b(!1),[{url:"templates/item/text-h1.html",name:"Header 1"},{url:"templates/item/text-h2.html",name:"Header 2"},{url:"templates/item/pullquote.html",name:"Pullquote"},{url:"templates/item/text-transmedia.html",name:"Long text (as transmedia)"},{url:"templates/item/text-definition.html",name:"Definition (as transmedia)"}];case"link":v(!0),h(!1),g(!0),f(!0),_(!0),b(!1);var p=[{url:"templates/item/link.html",name:"Link"},{url:"templates/item/link-withimage-notitle.html",name:"Link - hide title"},{url:"templates/item/link-modal-thumb.html",name:"Link modal"},{url:"templates/item/link-embed.html",name:"Embedded link"}];return a("admin")&&p.splice(3,0,{url:"templates/item/link-descriptionfirst.html",name:"Link w/ description first"}),p;case"image":g(!0),v(!1),h(!1),f(!0),_(!0),b(!1);return[{url:"templates/item/image-plain.html",name:"Plain Image"},{url:"templates/item/image-inline-withtext.html",name:"Inline Image with text"},{url:"templates/item/image-caption-sliding.html",name:"Image with sliding caption"},{url:"templates/item/image-thumbnail.html",name:"Image thumbnail"},{url:"templates/item/image-fill.html",name:"Background or video overlay"}];case"file":return f(!0),_(!1),b(!1),[{url:"templates/item/file.html",name:"Uploaded File"}];case"question":return v(!0),g(!0),f(!0),_(!0),b(!1),[{url:"templates/item/question-mc.html",name:"Question"}];case"chapter":f(!0)}}function onSelectChange(t,n){switch(v(!1),t.producerItemType){case"scene":var i="inline"===t.layouts[0];switch(t.templateUrl){case"templates/scene/centered.html":case"templates/scene/centeredPro.html":h(!1),v(!1),t.layouts[0]="",t.layouts[1]=p.a.value;break;case"templates/scene/centerVV.html":case"templates/scene/centerVV-Mondrian.html":v(!1),h(!0),o.video=[{value:"videoLeft",name:"Video on Left"},{value:"videoRight",name:"Video on Right"}],t.layouts[1]=p.a.value,(i||""===t.layouts[0])&&(t.layouts[0]="videoLeft");break;case"templates/scene/cornerV.html":case"templates/scene/cornerH.html":case"templates/scene/pip.html":v(!0),h(!0),o.video=[{value:"videoLeft",name:"Video on Left"},{value:"videoRight",name:"Video on Right"}],o.display=[{value:p.a.value,name:p.a.name},{value:p.b.value,name:p.b.name}],(i||""===t.layouts[0])&&(t.layouts[0]="videoLeft",t.layouts[1]=p.a.value);break;case"templates/scene/mirrored-twocol.html":v(!0),h(!0),o.video=[{value:"videoLeft",name:"Video on Left"},{value:"videoRight",name:"Video on Right"}],o.display=[{value:m.a.value,name:m.a.name},{value:m.b.value,name:m.b.name}],(i||""===t.layouts[0])&&(t.layouts[0]="videoLeft",t.layouts[1]=m.b.value);break;case"templates/scene/1col.html":v(!0),h(!1),o.display=[{value:u.a.value,name:u.a.name},{value:u.b.value,name:u.b.name}],t.layouts[0]="",i&&(t.layouts[1]=u.b.value);break;case"templates/scene/2colL.html":case"templates/scene/2colR.html":v(!0),h(!0),o.video=[{value:"",name:"Video Centered"},{value:"videoLeft",name:"Video on Left"},{value:"videoRight",name:"Video on Right"}],o.display=[{value:u.a.value,name:u.a.name},{value:u.b.value,name:u.b.name}],i&&(t.layouts[0]="",t.layouts[1]=u.b.value)}break;case"link":switch(v(!0),g(!0),_(!0),!0===t.stop?(t.layouts[0]="windowFg","templates/item/link-modal-thumb.html"===t.templateUrl&&(t.templateUrl="templates/item/link-embed.html")):t.layouts[0]="inline",t.templateUrl){case"templates/item/link.html":case"templates/item/link-withimage.html":case"templates/item/link-withimage-notitle.html":case"templates/item/link-modal-thumb.html":g(!0);break;case"templates/item/link-descriptionfirst.html":case"templates/item/link-embed.html":g(!1)}break;case"transcript":v(!1),t.layouts[0]="inline";break;case"annotation":switch(t.layouts[0]="inline",t.templateUrl){case"templates/item/text-h1.html":case"templates/item/text-h2.html":y(!1),f(!1);break;case"templates/item/pullquote-noattrib.html":case"templates/item/pullquote.html":y(!0),f(!1);break;case"templates/item/text-transmedia.html":case"templates/item/text-definition.html":y(!1),f(!0)}!0===t.stop&&(t.layouts[0]="windowFg");break;case"question":o.questionType=[{value:"mc-poll",name:"Poll"},{value:"mc-formative",name:"Formative"}],t.layouts[0]="windowFg",t.stop=!0;break;case"image":v(!1);var a=getSceneName(e.scene(t.scene_id));switch(t.templateUrl){case"templates/item/image-plain.html":case"templates/item/image-inline-withtext.html":case"templates/item/image-caption-sliding.html":case"templates/item/image-thumbnail.html":n.pin=n.position="",t.layouts[0]="inline";break;case"templates/item/image-fill.html":t.cosmetic=!0,v(!0),b(!0),o.imagePosition=[{value:"fill",name:"Fill and stretch"},{value:"contain",name:"Contain"},{value:"cover",name:"Cover and crop"},{value:"tl",name:"Top Left"},{value:"tr",name:"Top Right"},{value:"bl",name:"Bottom Left"},{value:"br",name:"Bottom Right"}],_setAvailableImageOptsForLayout(a,t,n)}!0===t.stop&&(t.layouts[0]="windowFg");break;case"file":switch(t.showInlineDetail=!1,t.templateUrl){case"templates/item/link.html":t.showInlineDetail=!0}!0===t.stop&&(t.layouts[0]="windowFg")}}function showTab(t,e){switch(t){case"scene":switch(e){case"Item":return!1;case"Style":return!0;case"Customize":return a("admin")}break;case"transcript":case"annotation":case"link":case"image":case"file":case"question":switch(e){case"Item":return!0;case"Style":return!1;case"Customize":return a("admin")}break;case"chapter":switch(e){case"Item":return!0;case"Style":case"Customize":return!1}}}var a=t.userHasRole,s=i.existy,r=[{value:"en",name:"English",isDisabled:!1},{value:"es",name:"Spanish",isDisabled:!1},{value:"zh",name:"Chinese",isDisabled:!1},{value:"pt",name:"Portuguese",isDisabled:!1},{value:"fr",name:"French",isDisabled:!1},{value:"de",name:"German",isDisabled:!1},{value:"it",name:"Italian",isDisabled:!1}],o={video:[],display:[],imagePosition:[],imagePin:[],questionType:[],language:r},l={templateSelect:!0,imageUpload:!1,display:!1,videoPosition:!1,bgImagePosition:!1,titleField:!0,speakerField:!0},c={centered:"templates/scene/centered.html",centeredPro:"templates/scene/centeredPro.html","1col":"templates/scene/1col.html","2colL":"templates/scene/2colL.html","2colR":"templates/scene/2colR.html",mirroredTwoCol:"templates/scene/mirrored-twocol.html",cornerV:"templates/scene/cornerV.html",centerVV:"templates/scene/centerVV.html",centerVVMondrian:"templates/scene/centerVV-Mondrian.html",cornerH:"templates/scene/cornerH.html",pip:"templates/scene/pip.html"},d={windowBg:"Full window background",videoOverlay:"Video overlay (16:9)",textBg:"Text pane background",textFg:"Text pane foreground",transmediaBg:"Transmedia pane background",transmediaFg:"Transmedia pane foreground"},p={a:{value:"showCurrent",name:"show only current transmedia items"},b:{value:"",name:"Show all transmedia items, highlight current ones"}},m={a:{value:"showCurrent",name:"Show only current text items"},b:{value:"",name:"Show all text items, highlight current ones"}},u={a:{value:"showCurrent",name:"Show only current items"},b:{value:"",name:"Show all items, highlight current ones"}},g=_partialVis("imageUpload"),v=_partialVis("display"),h=_partialVis("videoPosition"),f=_partialVis("titleField"),y=_partialVis("speakerField"),_=_partialVis("templateSelect"),b=_partialVis("bgImagePosition");return{showTab:showTab,onSelectChange:onSelectChange,getTemplates:getTemplates,getVisibility:getVisibility,getSelectOpts:getSelectOpts,setupItemForm:setupItemForm,getSceneName:getSceneName}}function timelineSvc_timelineSvc(t,e,n,i,a,s,r,o,l,c){function _onPlayerStateChange(e){if("ended"!==l.getTimelineState()||"unstarted"!==e&&"video cued"!==e)switch(l.setTimelineState(e),e){case"reset":_resetClocks(),l.resetPlaybackService();break;case"unstarted":break;case"ended":l.setMetaProp("time",l.getMetaProp("duration"));break;case"playing":var n=l.getCurrentTime(),i=l.getMetaProp("time"),a=l.getMetaProp("resetInProgress");Math.abs(i-n)>.75&&!1===a&&(l.setMetaProp("time",n),b(!0)),w(),y(),r.videoControlsActive=!0,r.show.navPanel=!1,t.parent!==t&&t.parent.postMessage("pauseEpisodePlayback","*"),o.captureEpisodeActivity("play");break;case"paused":case"buffering":_resetClocks();break;case"video cued":var s=l.getMetaProp("startAtTime"),c=l.getMetaProp("hasResumedFromStartAt");s>0&&!1===c&&d.startAtSpecificTime(s);break;case"player ready":d.updateEventStates()}}function _resetClocks(){n.cancel(p),r.videoControlsActive=!0,_(),p=void 0,f=void 0}function _doEndingSequence(){_resetClocks(),l.handleTimelineEnd(),o.captureEpisodeActivity("pause")}function restartEpisode(){d.seek(.01),d.play()}function nextScene(){for(var t=!1,e=l.getMetaProp("time"),n=l.getMetaProp("duration"),i=d.markedEvents.length-1,a=0;a<i;a++)if(d.markedEvents[a].start_time>e){handleScene(a,"nextScene"),t=!0;break}t||(d.pause(),d.seek(n-.01,"nextScene"))}function handleScene(t,e){var n=d.markedEvents[t],i=n.start_time;.01===i&&"prevScene"!==e&&(i+=.1),d.seek(i,e),!0===n.stop&&d.pause()}function prevScene(){var t=l.getMetaProp("time");"playing"===l.getTimelineState()&&(t-=3);for(var e=d.markedEvents.length-1,n=e;n>=0;n--)if(d.markedEvents[n].start_time<t){d.seek(d.markedEvents[n].start_time,"prevScene"),n===e&&--n,handleScene(n,"prevScene");break}}function groupByStartTime(t){return t.reduce(function(t,e){return t.hasOwnProperty(e.start_time)?t[e.start_time].push(e):t[e.start_time]=[e],t},{})}function prepGroupedEvents(t){var e=[];return angular.forEach(t,function(t,n){var i={events:t,stop:!1,multiStop:!1,start_time:n,toolTipText:null,layoutChange:!1},a=!1,s=[],r=!1,o=!1;angular.forEach(t,function(t){/internal:endingscreen|internal:landingscreen/.test(t._id)&&(o=!0),t.stop&&(a=!0),"Scene"===t.type&&(r=!0),"Chapter"!==t.type&&!0!==t.chapter_marker||s.push(t)}),0===s.length&&!r&&a&&(i.toolTipText="Stop item"),a&&(i.stop=!0),i.events.length>1&&a&&(i.multiStop=!0),r&&0===s.length&&(i.layoutChange=!0,i.toolTipText="(Layout Change)"),s.length>0&&(angular.forEach(s,function(t,e){0===e?i.toolTipText=t.display_annotation||t.display_title:i.toolTipText+=" / "+(t.display_annotation||t.display_title)}),r&&(i.toolTipText+=" (Layout Change)"),i.multiStop&&(i.toolTipText+=" / (Stop item)")),o||e.push(i)}),e}var d=Object.create(null);d.timelineEvents=[],d.markedEvents=[],d.enforceSingletonPauseListener||t.addEventListener("message",function(t){"pauseEpisodePlayback"===t.data&&d.pause()},!1),d.enforceSingletonPauseListener=!0;var p,m,u,g=c.parseTime;d.setSpeed=function(t){u=t,l.setMetaProp("timeMultiplier",u),l.setSpeed(u),b()},d.restartEpisode=restartEpisode,d.play=function(){var t=l.getMetaProp("duration");!t||t<.1||l.play()},d.pause=function(t){_resetClocks(),l.pause(),t||o.captureEpisodeActivity("pause")},d.startAtSpecificTime=function(t){r.isTouchDevice&&!1===l.getMetaProp("hasBeenPlayed")&&"youtube"===l.getMetaProp("videoType")||(t=g(t),t<0&&(t=0),t>l.getMetaProp("duration")&&l.setMetaProp("duration",t),l.setMetaProp("time",t),l.setMetaProp("hasResumedFromStartAt",!0),d.updateEventStates(),o.captureEpisodeActivity("seek",{method:"URLParameter"}))},d.seek=function(t,n,i){if(!0===l.getMetaProp("ready")){l.pauseOtherPlayers();var a=l.getMetaProp("duration");if("ended"===l.getTimelineState()&&l.setTimelineState("paused"),0===a)return void e(function(){d.seek(t)},300);var s={method:"",seekStart:l.getMetaProp("time")};t=g(t),t<0&&(t=0),t>a&&l.setMetaProp("duration",t),_(),l.setMetaProp("time",t),l.seek(t),d.updateEventStates(),c.existy(n)&&(s.method=n,c.existy(i)&&(s.event_id=i),o.captureEpisodeActivity("seek",s))}},d.nextScene=nextScene,d.handleScene=handleScene,d.prevScene=prevScene,d.toggleMute=function(){l.toggleMute()},d.setVolume=function(t){l.setVolume(t)};var v,h=function(){v={lastTimelineTime:0,lastVideoTime:0,running:!1}};h();var f,y=function(){v.running||(v.running=!0,v.lastTimelineTime=l.getMetaProp("time"),v.lastVideoTime=l.getMetaProp("time"),b())},_=function(){e.cancel(m),h()},b=function(t){e.cancel(m);for(var n=l.getCurrentTime(),i=l.getMetaProp("time"),a=0;a<d.timelineEvents.length;a++){var s=d.timelineEvents[a];if(s.t>=v.lastTimelineTime){if(s.t>i)break;if("pause"!==s.action||!t&&s.t!==v.lastTimelineTime){if(x(s),"pause"===s.action){a++;break}}else;}}var r=d.timelineEvents[a],o=d.timelineEvents[d.timelineEvents.length-1];if(!c.existy(r)&&c.existy(o)&&/internal:endingscreen/.test(o.id)&&_doEndingSequence(),v.lastVideoTime=n,v.lastTimelineTime=i,r&&"playing"===l.getTimelineState()){var p=1e3*(d.timelineEvents[a].t-i)/u;m=e(b,p+10)}},x=function(t){"timeline"===t.id?"pause"===t.action?(l.setMetaProp("time",t.t),d.pause()):d.play():"enter"===t.action?(s.events[t.id].state="isCurrent",s.events[t.id].isCurrent=!0):"exit"===t.action?(s.events[t.id].state="isPast",s.events[t.id].isCurrent=!1):"preload"===t.action&&T(s.events[t.id])},w=function(){f=void 0,n.cancel(p),p=n(S,20)},S=function(){var t=new Date,e=Number.isNaN(t-f)?0:t-f;v.running||y();var n=parseFloat(l.getMetaProp("time"))+e/1e3*u;n<0&&(n=0,d.pause());var i=l.getMetaProp("duration");n>i&&(n=i),l.setMetaProp("time",n),f=t};d.init=function(t){d.timelineEvents=[],d.markedEvents=[],d.displayMarkedEvents=[],u=1;var e=s.episode(t);l.seedPlayer(e.masterAsset.mediaSrcArr,e.masterAsset._id,!0),l.setTimelineState("unstarted"),l.setMetaProp("duration",0),d.injectEvents(s.episodeEvents(t),0),l.registerStateChangeListener(_onPlayerStateChange),n.cancel(p),_()},d.injectEvents=function(t,e){if(0!==t.length){e||(e=0),angular.forEach(t,function(t){if(t.start_time=Number(t.start_time),t.end_time=Number(t.end_time),"Scene"===t._type&&("producer"===r.product&&k(t),/internal:(landing|ending)screen/.test(t._id)&&k(t)),"Chapter"!==t._type&&!0!==t.chapter_marker||k(t),0!==t.start_time||t._id.match("internal")||(t.start_time=.01,s.events[t._id].start_time=.01),t.stop)k(t),d.timelineEvents.push({t:t.start_time+e,id:"timeline",eventId:t._id,action:"pause"}),d.timelineEvents.push({t:t.start_time+e,id:t._id,action:"enter"}),d.timelineEvents.push({t:t.start_time+e+.01,id:t._id,action:"exit"});else if(d.timelineEvents.push({t:t.start_time+e,id:t._id,action:"enter"}),t.end_time||0===t.end_time){if(/internal:endingscreen/.test(t._id))return;d.timelineEvents.push({t:t.end_time+e,id:t._id,action:"exit"})}(t.asset_id||t.annotation_image_id||t.link_image_id)&&d.timelineEvents.push({t:t.start_time<3?0:t.start_time-3,id:t._id,action:"preload"})}),d.sortTimeline();var n=groupByStartTime(d.markedEvents);d.displayMarkedEvents=prepGroupedEvents(n)}};var k=function(t){for(var e=!1,n=0;n<d.markedEvents.length;n++)d.markedEvents[n]._id===t._id&&(d.markedEvents[n]=angular.copy(t),e=!0);e||d.markedEvents.push(t)};d.removeEvent=function(t){d.timelineEvents=i("filter")(d.timelineEvents,function(e){return e.id!==t&&e.eventId!==t}),d.markedEvents=i("filter")(d.markedEvents,{_id:"!"+t});var e=groupByStartTime(d.markedEvents);d.displayMarkedEvents=prepGroupedEvents(e),d.updateEventStates()},d.updateEventTimes=function(t){d.timelineEvents=i("filter")(d.timelineEvents,function(e){return e.id!==t._id&&e.eventId!==t._id}),d.injectEvents([t],0)},d.updateSceneTimes=function(t){angular.forEach(s.episodes[t].scenes,function(t){d.updateEventTimes(t)})},d.sortTimeline=function(){d.timelineEvents=d.timelineEvents.sort(function(t,e){if(t.t===e.t){if(t.action===e.action)return 0;if("enter"===t.action){if("pause"===e.action)return-1;if("exit"===e.action)return 1}return"exit"===t.action?-1:"pause"===t.action?1:0}return t.t-e.t}),d.markedEvents=d.markedEvents.sort(function(t,e){return t.start_time-e.start_time}),d.timelineEvents.length>0&&l.setMetaProp("duration",d.timelineEvents[d.timelineEvents.length-1].t),d.updateEventStates()},d.updateEventStates=function(){var t=l.getMetaProp("time");angular.forEach(d.timelineEvents,function(t){if("timeline"!==t.id){var e=s.events[t.id];e&&(e.state="isFuture",e.isCurrent=!1)}}),angular.forEach(d.timelineEvents,function(e){if(e.t<=t){var n=s.events[e.id];n&&("enter"===e.action?(n.state="isCurrent",n.isCurrent=!0):"exit"===e.action&&(n.state="isPast",n.isCurrent=!1))}})};var C={},T=function(t){t.asset&&"Asset::Image"===t.asset._type&&(C[t.asset.url]||(C[t.asset.url]=new Image,C[t.asset.url].src=t.asset.url))};return a.debugInBrowser,d}function urlService_urlService(t,e,n,i,a){function parseInput(t){var e=checkUrl(t).type;if(e.length>0)return s[e].parseInput(t)}function parseMediaSrcArr(t){return Object.keys(s).reduce(function(e,n){var i=s[n].parseMediaSrc(t);return i.mediaSrcArr.length>0&&e.push(i),e},[])}function isVideoUrl(t){return checkUrl(t).type.length>0}function checkUrl(t){return Object.keys(s).reduce(function(e,n){return s[n].canPlay(t)&&(e.type=n,e.mimeType=s[n].getMimeType(t)),e},{type:"",mimeType:""})}function getOutgoingUrl(t,e){var n=checkUrl(t).type;if(n.length>0)return s[n].getOutgoingUrl(t,e)}function resolveVideo(e){var s={youtube:[],mp4:[],webm:[],m3u8:[],kaltura:[],wistia:[]},r=/\.(\w+)$/;if(e.alternate_urls){for(var o=0;o<e.alternate_urls.length;o++)e.alternate_urls[o].match(/youtube/)?t.embeddableYoutubeUrl(e.alternate_urls[o])&&s.youtube.push(t.embeddableYoutubeUrl(e.alternate_urls[o])):s[e.alternate_urls[o].match(r)[1]].push(e.alternate_urls[o]);e.you_tube_url&&t.embeddableYoutubeUrl(e.you_tube_url)&&s.youtube.push(t.embeddableYoutubeUrl(e.you_tube_url));var l=/(\d+)x(\d+)\.\w+$/;angular.forEach(Object.keys(s),function(t){s[t]=s[t].sort(function(t,e){return(t.match(l)||[0,0])[1]-(e.match(l)||[0,0])[1]})})}if(0===s.youtube.length&&(e.url&&t.embeddableYoutubeUrl(e.url)&&(s.youtube=[t.embeddableYoutubeUrl(e.url)]),e.you_tube_url&&t.embeddableYoutubeUrl(e.you_tube_url)&&(s.youtube=[t.embeddableYoutubeUrl(e.you_tube_url)])),e.alternate_urls||angular.forEach(["mp4","webm","m3u8"],function(t){0!==s[t].length||e.url.match(/youtube/)||s[t].push(e.url.replace("mp4",t))}),a.youtube.disabled&&delete s.youtube,/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)||delete s.m3u8,/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)){var c,d="t="+(new Date).getTime();angular.forEach(["mp4","webm"],function(t){if(s[t].length>0)for(var e=0;e<s[t].length;e++)c=s[t][e].match(/\?/)?"&":"?",s[t][e]=s[t][e]+c+d})}return n.canPlay(e.url)&&s.kaltura.push(e.url),i.canPlay(e.url)&&s.wistia.push(e.url),e.urls=s,e.mediaSrcArr=_resolveMediaSrcArray(s),e}function _resolveMediaSrcArray(t){return Object.keys(t).reduce(function(e,n){return e=e.concat(t[n])},[])}var s={youtube:t,html5:e,kaltura:n,wistia:i};return{parseMediaSrcArr:parseMediaSrcArr,checkUrl:checkUrl,getOutgoingUrl:getOutgoingUrl,parseInput:parseInput,isVideoUrl:isVideoUrl,resolveVideo:resolveVideo}}function html5PlayerManager(t,e,n,i,a){function html5Ending(t){stop(t)}function create(t){Object.isFrozen(v(t).meta)&&unFreezeMetaProps(t);var e=document.getElementById(t);_attachEventListeners(e),e.onStateChange=_onStateChange,e.controls=!0,s===t&&(s=t,e.controls=!1),e.load(),v(t).instance=e}function freezeMetaProps(t){Object.freeze(b(t))}function unFreezeMetaProps(t){var e,n,i;i=b(t),e={};for(n in i)i.hasOwnProperty(n)&&(e[n]=i[n]);/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&(o=!0),v(t).meta=e}function seedPlayerManager(t,e,n){if(!(l(v(t))&&x(t,"startAtTime")>0)){e&&(r={},s=t);var i=_initPlayerDiv(t,n),a={mainPlayer:e,videoObj:i.videoObj,div:i.videoElm};h(t,_(a,m))}}function onSeeked(){var t=getPlayerState(this.id);("playing"===t||"buffering"===t&&!0===i.isIEOrEdge)&&onPlaying.call(this)}function onEnded(){y(this.id);w(this.id,"playerState",0)}function onCanPlay(){var t=y(this.id);!1===x(this.id,"ready")&&(_emitStateChange(t,6),w(this.id,"duration",t.duration))}function onPlaying(){var t=y(this.id);w(this.id,"playerState",1),_emitStateChange(t)}function onPause(){var t=y(this.id);if(!0===o)return void(o=!1);w(this.id,"playerState",2),_emitStateChange(t)}function onBuffering(){var t=y(this.id);w(this.id,"playerState",3),_emitStateChange(t)}function play(e){var n=y(e),i=x(e,"time"),a=x(e,"ready"),r=t(function(){var o;l(n)&&4===n.readyState&&!0===a&&(o=x(e,"time"),e===s&&i<=o&&(n.currentTime=i),n.play(),t.cancel(r))},10)}function pause(t){y(t).pause()}function stop(t){w(t,"time",x(t,"duration")),pause(t)}function getCurrentTime(t){var e=y(t);if(void 0!==e)return e.currentTime}function getPlayerState(t){var n=v(t);if(l(n))return e[n.meta.playerState]}function seek(t,e){y(t).currentTime=e}function setSpeed(t,e){y(t).playbackRate=e}function toggleMute(t){var e=y(t);e.muted=!e.muted,w(t,"muted",e.muted)}function setVolume(t,e){y(t).volume=e/100,w(t,"volume",e)}function getBufferedPercent(t){var e=y(t);if(e&&-1!==x(t,"playerState")&&e.buffered.length>0){var n=e.buffered.length,i=e.buffered.start(n-1),a=e.buffered.end(n-1);return a<0&&(a-=i,i=0),a/x(t,"duration")*100}}function _initPlayerDiv(t,e){var n=_getHtml5VideoObject(e);return{videoObj:n,videoElm:_drawPlayerDiv(t,n,0)}}function _drawPlayerDiv(t,e,n){var i=document.createElement("video");i.id=t,Object.keys(e).forEach(function(t){var a,s,r,o;a=t,"mp4"===a&&(a="mpeg4"),s=e[t][n],l(s)&&(r="m3u8"===t?"application/x-mpegURL":"video/"+t,o=document.createElement("source"),o.setAttribute("type",r),o.setAttribute("src",s),o.setAttribute("class",a),i.appendChild(o))});var a=document.createElement("p");return a.innerText="Oh no! Your browser does not support the HTML5 Video element.",i.appendChild(a),i.outerHTML}function _formatPlayerStateChangeEvent(t,n){return{emitterId:n,state:e[t]}}function _emitStateChange(t,e){var n,i=v(t.id);n=e||i.meta.playerState,t.onStateChange(_formatPlayerStateChangeEvent(n,t.id))}function _onStateChange(t){angular.forEach(P(),function(e){e(t)})}function _getHtml5VideoObject(t){var e=/(mp4|m3u8|webm)/;return t.reduce(function(t,n){return t[n.match(e)[1]].push(n),t},{mp4:[],webm:[],m3u8:[]})}function _attachEventListeners(t){var e={pause:onPause,playing:onPlaying,waiting:onBuffering,seeked:onSeeked,canplay:onCanPlay,ended:onEnded};Object.keys(e).forEach(function(n){!function(n){t.addEventListener(n,e[n])}(n)})}function _removeEventListeners(t){var e,n=y(t);l(n)&&(e=n,e.removeEventListener("pause",onPause),e.removeEventListener("playing",onPlaying),e.removeEventListener("waiting",onBuffering),e.removeEventListener("seeked",onSeeked),e.removeEventListener("canplay",onCanPlay),e.removeEventListener("ended",onEnded))}var s,r={},o=!1,l=n.existy,c=a({players:r,type:"html5"}),d=c.commonMetaProps,p={videoObj:{},videoType:"html5"},m={instance:null,meta:{}};angular.extend(m.meta,p,d);var u=Object.keys(m.meta),g=function(t){return l(v(t))&&l(v(t).instance)},v=c.getPlayer,h=c.setPlayer,f=c.getPlayerDiv,y=c.getInstance(g),_=c.createMetaObj,b=c.getMetaObj,x=c.getMetaProp,w=c.setMetaProp(u),S=c.registerStateChangeListener,k=c.unregisterStateChangeListener,C=c.pauseOtherPlayers(pause,getPlayerState),T=c.resetPlayerManager(_removeEventListeners),E=c.renamePid,I=c.handleTimelineEnd(html5Ending),P=c.getStateChangeListeners;return{type:"html5",getMetaProp:x,setMetaProp:w,getMetaObj:b,getPlayerDiv:f,pauseOtherPlayers:C,registerStateChangeListener:S,unregisterStateChangeListener:k,resetPlayerManager:T,renamePid:E,seedPlayerManager:seedPlayerManager,create:create,getPlayerState:getPlayerState,play:play,pause:pause,seekTo:seek,getCurrentTime:getCurrentTime,getBufferedPercent:getBufferedPercent,toggleMute:toggleMute,setVolume:setVolume,setSpeed:setSpeed,freezeMetaProps:freezeMetaProps,unFreezeMetaProps:unFreezeMetaProps,stop:stop,handleTimelineEnd:I}}function html5UrlService(t){function getMimeType(t){return"video/"+t.match(/(mp4|m3u8|webm)/)[0]}function getOutgoingUrl(t,e){return n(e)&&e>0&&(t+="#t="+e),t}function parseMediaSrc(t){return t.reduce(function(t,e){return isHTML5VideoUrl(e)&&t.mediaSrcArr.push(e),t},{type:e,mediaSrcArr:[]})}function isHTML5VideoUrl(t){return/(.mp4|.m3u8|.webm)/.test(t)}function parseInput(t){if(isHTML5VideoUrl(t))return t}var e="html5",n=t.existy;return{type:e,getMimeType:getMimeType,parseMediaSrc:parseMediaSrc,canPlay:isHTML5VideoUrl,parseInput:parseInput,getOutgoingUrl:getOutgoingUrl}}function kalturaPlayerManager(t,e,n,i,a){function create(t){function handleSuccess(){}function readyCallback(t){var e=document.getElementById(t);v(t).instance=e,_attachEventListeners(e,t)}var e=x(t,"ktObj");_createKWidget(t,e.partnerId,e.entryId,e.uiconfId,readyCallback).then(handleSuccess)}function seedPlayerManager(t,e,n){if(!(o(v(t))&&x(t,"startAtTime")>0)){e&&(r={},s=t);var i=a.getKalturaObject(n[0]),l={mainPlayer:e,div:_getPlayerDiv(t),ktObj:i};h(t,_(l,p))}}function onMediaReady(t){_emitStateChange(t,6),w(t,"duration",_kdpEval(t,"duration"))}function onPlaying(t){w(t,"playerState",1),!0===x(t,"ready")&&_emitStateChange(t)}function onPaused(t){w(t,"playerState",2),_emitStateChange(t)}function onBufferEnd(t){var n=e[x(this.id,"playerState")],i=x(this.id,"bufferTimeout");o(i)&&$(i),"buffering"===n&&play(this.id)}function onBufferStart(){var t=this.id,e=P(function(){_reset(t)},15e3);w(this.id,"bufferTimeout",e),w(this.id,"playerState",3),_emitStateChange(this.id)}function onPlayerPlayEnd(t){w(t,"playerState",0),_emitStateChange(t)}function onMediaError(t){}function onUpdatedPlaybackRate(t){}function onPlayerUpdatePlayhead(t){w(this.id,"time",t)}function play(t){_sendKdpNotice(t,"doPlay")}function pause(t){_sendKdpNotice(t,"doPause")}function seekTo(t,e){e>60&&e%10==0&&(e-=.5),_sendKdpNotice(t,"doSeek",e)}function stop(t){_sendKdpNotice(t,"doStop")}function getPlayerState(t){return e[x(t,"playerState")]}function getCurrentTime(t){return _kdpEval(t,"video.player.currentTime")||0}function getBufferedPercent(t){if(!0===x(t,"ready"))return 100*_kdpEval(t,"video.buffer.percent")}function toggleMute(t){var e=x(t,"muted");!1===e?(w(t,"lastVol",x(t,"volume")),setVolume(t,0)):setVolume(t,x(t,"lastVol")),w(t,"muted",!e)}function setSpeed(t,e){_sendKdpNotice(t,"playbackRateChangeSpeed",e)}function setVolume(t,e){_sendKdpNotice(t,"changeVolume",e/100),w(t,"volume",e)}function _reset(t,e){var n=e||x(t,"time");w(t,"startAtTime",n),w(t,"hasResumedFromStartAt",!1),w(t,"resetInProgress",!0),_sendKdpNotice(t,"changeMedia",{entryId:x(t,"ktObj").entryId}),w(t,"ready",!1)}function _sendKdpNotice(t,e,n){var i=y(t);try{o(n)?i.sendNotification(e,n):i.sendNotification(e)}catch(t){}}function _createKWidget(t,e,n,a,r){var o={targetId:t,wid:"_"+e,uiconf_id:a,readyCallback:r,entry_id:n,flashvars:{"playbackRateSelector.plugin":!0,"controlBarContainer.plugin":!1,"largePlayBtn.plugin":!1,"loadingSpinner.plugin":!0,"closedCaptions.displayCaptions":!1}},l={"EmbedPlayer.NativeControls":!0,"EmbedPlayer.DisableHTML5FlashFallback":!0};return t!==s&&angular.extend(o.flashvars,l),i.load(e,a).then(function(){KWidget.embed(o)})}function _getPlayerDiv(t){return'<div id="'+t+'"></div>'}function _attachEventListeners(t,e){var n={playerPlayed:onPlaying,playerPaused:onPaused,bufferStartEvent:onBufferStart,bufferEndEvent:onBufferEnd,playerPlayEnd:onPlayerPlayEnd,mediaError:onMediaError,mediaReady:onMediaReady,updatedPlaybackRate:onUpdatedPlaybackRate,playerUpdatePlayhead:onPlayerUpdatePlayhead};Object.keys(n).forEach(function(i){!function(i){t.kBind(i+"."+e,n[i])}(i)})}function _removeEventListeners(t){y(t).kUnbind("."+t)}function _emitStateChange(t,e){var n;n=e||x(t,"playerState"),A().forEach(function(e){e(_formatPlayerStateChangeEvent(n,t))})}function _kdpEval(t,e){var n=y(t);if(o(n))return n.evaluate("{"+e+"}")}function _formatPlayerStateChangeEvent(t,n){return{emitterId:n,state:e[t]}}var s,r={},o=t.existy,l=n({players:r,type:"kaltura"}),c=l.commonMetaProps,d={ktObj:{},videoType:"kaltura",bufferTimeout:null,seekTimeout:null,lastVol:100},p={instance:null,meta:{}};angular.extend(p.meta,d,c);var m=Object.keys(p.meta),u=function(t){return o(v(t))&&!0===x(t,"ready")},g=function(t){},v=l.getPlayer,h=l.setPlayer,f=l.getPlayerDiv,y=l.getInstance(u),_=l.createMetaObj,b=l.getMetaObj,x=l.getMetaProp,w=l.setMetaProp(m),S=l.registerStateChangeListener,k=l.unregisterStateChangeListener,C=l.pauseOtherPlayers(pause,getPlayerState),T=l.resetPlayerManager(_removeEventListeners),E=l.renamePid,I=l.handleTimelineEnd(g),P=t.ngTimeout,$=t.cancelNgTimeout,A=l.getStateChangeListeners;return{type:"kaltura",getMetaProp:x,setMetaProp:w,getMetaObj:b,getPlayerDiv:f,pauseOtherPlayers:C,registerStateChangeListener:S,unregisterStateChangeListener:k,resetPlayerManager:T,renamePid:E,seedPlayerManager:seedPlayerManager,create:create,getPlayerState:getPlayerState,play:play,pause:pause,seekTo:seekTo,getCurrentTime:getCurrentTime,getBufferedPercent:getBufferedPercent,toggleMute:toggleMute,setVolume:setVolume,setSpeed:setSpeed,freezeMetaProps:angular.noop,unFreezeMetaProps:angular.noop,stop:stop,handleTimelineEnd:I}}function kalturaScriptLoader(t,e){function load(e,a){return t(function(t){var s=a+e;i(n[s])||(n[s]="ready"),"undefined"==typeof KWidget?_loadScript(e,a,n,t):"ready"===n[s]?_loadScript(e,a,n,t):t()})}function _loadScript(t,e,n,i){var a=_getScriptTagSrc(t,e),s=_appendScript(a,t);s.onload=i,n[e+t]=s}function _getScriptTagSrc(t,e){return"https://cdnapisec.kaltura.com/p/"+t+"/sp/"+t+"00/embedIframeJs/uiconf_id/"+e+"/partner_id/"+t}function _appendScript(t,e){var n=document.createElement("script");n.src=t,n.id=e;var i=document.getElementsByTagName("script")[0];return i.parentNode.insertBefore(n,i),n}var n={},i=e.existy;return{load:load}}function kalturaUrlService(){function getMimeType(){return e}function parseInput(t){return buildAutoEmbedURLFromKalturaObject(getKalturaObject(t),1024,768)}function parseMediaSrc(e){return e.reduce(function(t,e){return isKalturaUrl(e)&&t.mediaSrcArr.push(e),t},{type:t,mediaSrcArr:[]})}function isKalturaUrl(t){var e=["partnerId","uiconfId","entryId","uniqueObjId"],n=getKalturaObject(t);return e.every(function(t){return n.hasOwnProperty(t)&&null!=n[t]})}function getKalturaObject(t){var e,n={},i=[];return"<script"===t.substring(0,7)?(i=/^.*?src\=.https?\:\/\/(?:www|cdnapi|cdnapisec)\.kaltura\.com\/p\/(.*?)\/sp\/(.*?)00.*?\/embedIframeJs\/uiconf_id\/(.*?)\/partner_id\/(.*?)\?(.*?)\".*/g.exec(t),null!=i?(n.partnerId=i[1],n.uiconfId=i[3],e=parseUrlParams(i[5]),n.entryId=e.entry_id,n.uniqueObjId=e.playerId):n=getKalturaObjectFromDynamicEmbedCode(t)):"<div"===t.substring(0,4)?n=getKalturaObjectFromDynamicEmbedCode(t):"<iframe"===t.substring(0,7)?null!=(i=/^.*?src\=.https?\:\/\/(?:www|cdnapi|cdnapisec)\.kaltura\.com\/p\/(.*?)\/sp\/(.*?)00.*?\/embedIframeJs\/uiconf_id\/(.*?)\/partner_id\/(.*?)\?(.*?)\".*/g.exec(t))&&(n.partnerId=i[1],n.uiconfId=i[3],e=parseUrlParams(i[5]),n.uniqueObjId=e.playerId,n.entryId=e.entry_id):"<object"===t.substring(0,7)?null!=(i=/^.*\n*?.*?id\=.(.*?)\"(.*?\n*)*?data\=.*?https?\:\/\/(?:www|cdnapi|cdnapisec)\.kaltura\.com\/kwidget\/wid\/_(.*?)\/uiconf_id\/(.*?)\/entry_id\/(.*?)\".*/g.exec(t))&&(n.uniqueObjId=i[1],n.partnerId=i[3],n.uiconfId=i[4],n.entryId=i[5]):"http"===t.substring(0,4)&&null!=(i=/^https?\:\/\/(?:www|cdnapi|cdnapisec)\.kaltura\.com\/p\/(.*?)\/sp\/(.*?)00.*?\/embedIframeJs\/uiconf_id\/(.*?)\/partner_id\/(.*?)\?(.*)/g.exec(decodeURIComponent(t)))&&(n.partnerId=i[1],n.uiconfId=i[3],e=parseUrlParams(i[5]),n.entryId=e.entry_id,n.uniqueObjId=e.playerId),n}function buildAutoEmbedURLFromKalturaObject(t,e,n){return"https://cdnapisec.kaltura.com/p/"+t.partnerId+"/sp/"+t.partnerId+"00/embedIframeJs/uiconf_id/"+t.uiconfId+"/partner_id/"+t.partnerId+"?entry_id="+t.entryId+"&playerId="+t.uniqueObjId+"&autoembed=true&width="+e+"&height="+n}function parseUrlParams(t){return"&"==t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),JSON.parse('{"'+t.replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}function getKalturaObjectFromDynamicEmbedCode(t){var e={},n=/^(?:.|\n|\r)*?kWidget\..*?mbed\(({(?:.|\n|\r)*})\).*?/g.exec(t);if(null!=n){var i=JSON.parse(n[1]);e.uniqueObjId=i.targetId,e.partnerId=i.wid.substring(1),e.uiconfId=i.uiconf_id,e.entryId=i.entry_id}return e}var t="kaltura",e="video/x-"+t;return{type:t,getMimeType:getMimeType,canPlay:isKalturaUrl,parseMediaSrc:parseMediaSrc,getKalturaObject:getKalturaObject,buildAutoEmbedURLFromKalturaObject:buildAutoEmbedURLFromKalturaObject,parseInput:parseInput,getOutgoingUrl:function(){}}}function youTubePlayerManager(t,e,n,i,a,s,r){function seedPlayerManager(t,e,n){if(!(_existy(f(t))&&w(t,"startAtTime")>0)){e&&(l={},o=t);var i={mainPlayer:e,div:_getPlayerDiv(t),ytId:s.extractYoutubeId(n[0])};y(t,b(i,m))}}function create(t){function handleSuccess(n){f(t).instance=n,S(t,"ytId",e)}function tryAgain(){return _createInstance(t,e,onPlayerStateChange,onPlayerQualityChange,onReady,onError).then(handleSuccess).catch(handleFail)}function handleFail(t){i.error({data:"Network timeout initializing video player. Please try again."},t)}function onPlayerStateChange(t){var e=_getPidFromInstance(t.target);S(e,"playerState",t.data);var n=_formatPlayerStateChangeEvent(t,e),i=w(e,"bufferInterval");t.data===YT.PlayerState.ENDED&&t.target.stopVideo(),t.data===YT.PlayerState.BUFFERING?(i=A(function(){t.target.getPlayerState()===YT.PlayerState.BUFFERING&&_reset(e)},7e3),S(e,"bufferInterval",i)):U(i),_emitStateChange(n)}function onReady(t){var e=_getPidFromInstance(t.target),n=_formatPlayerStateChangeEvent({data:"6"},e);S(e,"duration",t.target.getDuration()),_emitStateChange(n)}function onPlayerQualityChange(t){var e=_getPidFromInstance(t.target);"medium"===t.data&&/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&setPlaybackQuality(e,"large")}function onError(t){var e=_getPidFromInstance(t.target);5===t.data&&_reset(e)}var e=w(t,"ytId");_createInstance(t,e,onPlayerStateChange,onPlayerQualityChange,onReady,onError).then(handleSuccess).catch(tryAgain)}function setSpeed(t,e){var n=_(t);_existy(n)&&n.getAvailablePlaybackRates().length>1&&n.setPlaybackRate(e)}function getCurrentTime(t){var e=_(t);if(_existy(e))return _tryCommand(e,"getCurrentTime")}function playerState(t){var e=_(t);if(_existy(e))return a[_tryCommand(e,"getPlayerState")]}function play(t){var e=_(t);_existy(e)&&_tryCommand(e,"playVideo")}function pause(t){var e=_(t);_existy(e)&&_tryCommand(e,"pauseVideo")}function stop(t){var e=_(t);_existy(e)&&_tryCommand(e,"stopVideo")}function setPlaybackQuality(t,e){var n=_(t);_existy(n)&&n.setPlaybackQuality(e)}function getVideoLoadedFraction(t){var e=_(t);if(_existy(e))return 100*e.getVideoLoadedFraction()}function seekTo(t,e){var n=_(t),i=w(t,"ytId"),s=a[w(t,"playerState")],r=playerState(t);if(_existy(n))if("video cued"===r)switch(s){case"paused":case"playing":n.cueVideoById(i,e);break;case"video cued":t===o?(e>.1&&!1===w(t,"autoplay")&&k(_seekPauseListener),_tryCommand(n,"seekTo",e)):n.cueVideoById(i,e)}else _tryCommand(n,"seekTo",e,!0)}function toggleMute(t){var e=_(t);e.isMuted()?(e.unMute(),S(t,"muted",!1)):(e.mute(),S(t,"muted",!0))}function setVolume(t,e){var n=_(t);_existy(n)&&(n.setVolume(e),S(t,"volume",e))}function _seekPauseListener(t){"playing"===t.state&&(C(_seekPauseListener),pause(t.emitterId))}function _reset(t){var e=_(t),n=w(t,"mainPlayer");if(_existy(e)){var i=e.getVideoData().video_id,a=e.getCurrentTime();!0===n?e.cueVideoById(i,a):e.loadVideoById(i,a)}}function _createInstance(e,i,a,s,r,l){var c=1;e===o&&(c=0);var d=t.host();return n.load().then(function(){return new YT.Player(e,{videoId:i,playerVars:{controls:c,fs:c,enablejsapi:1,modestbranding:1,showinfo:0,rel:0,iv_load_policy:3,origin:d,wmode:"transparent"},events:{onReady:r,onStateChange:a,onPlaybackQualityChange:s,onError:l}})})}function _existy(t){return null!=t}function _getPidFromInstance(t){return t.getIframe().id}function _formatPlayerStateChangeEvent(t,e){return{emitterId:e,state:a[t.data]}}function _emitStateChange(t){M().forEach(function(e){e(t)})}function _getPlayerDiv(t){return'<div id="'+t+'"></div>'}function _tryCommand(t,e,n,i){var a;try{_existy(n)&&_existy(i)?t[e](n,i):_existy(n)?t[e](n):a=t[e]()}catch(t){}if(_existy(a))return a}var o,l={},c=r({players:l,type:"youtube"}),d=c.commonMetaProps,p={ytId:"",videoType:"youtube",bufferInterval:null},m={instance:null,meta:{}};angular.extend(m.meta,p,d);var u=Object.keys(m.meta),g=function(t){return _existy(f(t))&&!0===w(t,"ready")},v=function(t){_tryCommand(_(t),"destroy")},h=function(t){S(t,"time",w(t,"duration")),e.ngTimeout(function(){"ended"!==playerState(t)&&stop(t)},500)},f=c.getPlayer,y=c.setPlayer,_=c.getInstance(g),b=c.createMetaObj,x=c.getMetaObj,w=c.getMetaProp,S=c.setMetaProp(u),k=c.registerStateChangeListener,C=c.unregisterStateChangeListener,T=c.pauseOtherPlayers(pause,playerState),E=c.getPlayerDiv,I=c.resetPlayerManager(v),P=c.renamePid,$=c.handleTimelineEnd(h),A=e.ngTimeout,U=e.cancelNgTimeout,M=c.getStateChangeListeners;return{type:"youtube",getMetaProp:w,setMetaProp:S,getMetaObj:x,getPlayerDiv:E,pauseOtherPlayers:T,registerStateChangeListener:k,unregisterStateChangeListener:C,resetPlayerManager:I,renamePid:P,seedPlayerManager:seedPlayerManager,create:create,play:play,pause:pause,seekTo:seekTo,getCurrentTime:getCurrentTime,getPlayerState:playerState,getBufferedPercent:getVideoLoadedFraction,toggleMute:toggleMute,setVolume:setVolume,setSpeed:setSpeed,setPlaybackQuality:setPlaybackQuality,freezeMetaProps:angular.noop,unFreezeMetaProps:angular.noop,stop:stop,handleTimelineEnd:$}}function YTScriptLoader(t,e){function load(){var i;return t(function(t,a){if(i=e(a,n),"undefined"==typeof YT||void 0===YT.Player){var s=document.createElement("script");s.src="//www.youtube.com/iframe_api",s.id="yt-iframe-api";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(s,r)}else e.cancel(i),t();window.onYouTubeIframeAPIReady=function(){e.cancel(i),t()}})}var n=2e3;return{load:load}}function youtubeUrlService(t){function getMimeType(){return n}function getOutgoingUrl(t,n){return t=embeddableYoutubeUrl(t,!1),e(n)&&n>0&&(t+="&start="+n),t}function extractYoutubeId(t){if(!t)return!1;t=t.replace(/%3F/,"?"),t=t.replace(/%26/,"&");var e=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i,n=t.match(e);return!(!n||!n[1])&&n[1]}function isYoutubeUrl(t){return!!t&&(t=t.replace(/%3F/,"?"),t=t.replace(/%26/,"&"),/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i.test(t))}function parseMediaSrc(t){return t.reduce(function(t,e){return isYoutubeUrl(e)&&t.mediaSrcArr.push(e),t},{type:"youtube",mediaSrcArr:[]})}function embedParams(t){return!1===t?"?controls=1&autoplay=1&modestbranding=1&showinfo=1&rel=0&iv_load_policy=3&wmode=transparent":"?enablejsapi=1&controls=0&modestbranding=1&showinfo=0&rel=0&iv_load_policy=3&wmode=transparent"}function createEmbedLinkFromYoutubeId(t,e){return!!t&&"//www.youtube.com/embed/"+t+(e?"":embedParams(e))}function embeddableYoutubeUrl(t,e){return!!t&&createEmbedLinkFromYoutubeId(extractYoutubeId(t),e)}var e=t.existy,n="video/x-youtube";return{type:"youtube",getMimeType:getMimeType,extractYoutubeId:extractYoutubeId,isYoutubeUrl:isYoutubeUrl,canPlay:isYoutubeUrl,parseMediaSrc:parseMediaSrc,embedParams:embedParams,createEmbedLinkFromYoutubeId:createEmbedLinkFromYoutubeId,embeddableYoutubeUrl:embeddableYoutubeUrl,parseInput:embeddableYoutubeUrl,getOutgoingUrl:getOutgoingUrl}}function autofocus(t){return{link:function(e,n){t(function(){"TEXTAREA"===n[0].tagName||"INPUT"===n[0].tagName?n[0].focus():n.find("input,textarea")[0].focus()})}}}function ittAnnotationField(){return{restrict:"EA",scope:{data:"=",ittItemForm:"="},template:['<div class="field">','\t<div class="label">Annotation Text [{{$ctrl.appState.lang}}]','\t\t<itt-validation-tip ng-if="$ctrl.ittItemForm[$ctrl.textAreaName].$invalid" text="Annotation Text is a required field"></itt-validation-tip>',"\t</div>",'\t<div class="input" sxs-input-i18n="$ctrl.data.annotation" do-validate="true" x-inputtype="\'textarea\'" on-emit-name="$ctrl.onName($taName)" autofocus></div>',"</div>"].join("\n"),controller:["appState",function(t){function onName(t){e.textAreaName=t}var e=this;e.onName=onName,e.appState=t,e.textAreaName=""}],controllerAs:"$ctrl",bindToController:!0}}function ittClipboard(t){return{restrict:"EA",transclude:!0,template:'\n    <itt-tooltip tip-text="{{$ctrl.tipText}}" ng-click="$ctrl.bubbleEvent($event)">\n       <a class="icon__button" ng-class="$ctrl.light ? \'button__clipboard--light\' : \'button__clipboard\'"></a>\n      </itt-tooltip>\n    ',scope:{sourceText:"@",tipText:"@?",onCopy:"&",light:"<?",customNotice:"<?"},controller:[function(){function bubbleEvent(t){copyText(e.sourceText),e.onCopy({$event:t}),null==e.customNotice&&(e.tipText="Copied!",n(function(){e.tipText=i},1500))}function copyText(t){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.focus(),e.setSelectionRange(0,e.value.length),document.execCommand("copy"),document.body.removeChild(e)}var e=this,n=t.ngTimeout,i=e.tipText||"Click to copy URL";angular.extend(e,{tipText:i,bubbleEvent:bubbleEvent})}],controllerAs:"$ctrl",bindToController:!0}}function ittColorSelect(){return{restrict:"EA",template:['<div class="field">','\t<div class="label">Color</div>','\t<div class="input">','\t\t<select size="1" ng-model="itemForm.color">','\t\t\t<option value="">(Default)</option>','\t\t\t<option value="Invert">Invert</option>','\t\t\t<option value="Sepia">Sepia</option>','\t\t\t<option value="Solarized">Solarized</option>','\t\t\t<option value="Vivid">Vivid</option>',"\t\t</select>","\t</div>","</div>"].join(" ")}}function ittContainer(t,e,n,i,a,s,r){return{restrict:"A",replace:!1,scope:{container:"=ittContainer",depth:"=depth",onContainerClick:"&",onContainerAdd:"&",clickRootContext:"=",addRootContext:"="},templateUrl:"templates/container.html",controller:["$scope","$location","modelSvc","authSvc","dataSvc",function(t,e,n,i,a){function toggleNarrativeModal(){t.showNarrativeModal=!t.showNarrativeModal}function postNewNarrative(i){t.resolvingNarrative=!0,a.generateNewNarrative(i.c,i.n).then(function(i){n.cache("narrative",i),e.path("/story/"+i._id),t.resolvingNarrative=!1})}t.toggleNarrativeModal=toggleNarrativeModal,t.postNewNarrative=postNewNarrative,t.showNarrativeModal=!1,t.resolvingNarrative=!1,t.isAdmin=i.userHasRole("admin"),t.canAccess=t.isAdmin||i.userHasRole("customer admin"),t.getLinkStatusReport=a.getCustomerLinkStatusReportSpreadsheet,t.customers=n.getCustomersAsArray()}],compile:function(o){return a.compile(o,function(a){a.appState=n,a.containers=i.containers,a.customer=i.customers[a.container.customer_id],a.isDemoServer=e.host().match(/demo|localhost|api-dev|client.dev/),a.selectText=function(t){t.target.select()},a.containerTypes=["customer","project","module","episode"],a.onToggleChildren=function(t){a.onContainerClick({$container:{container:a.container,bool:t}})},a.renameContainer=function(){var t={};angular.forEach(["_id","customer_id","episodes","keywords","parent_id","sort_order"],function(e){t[e]=angular.copy(a.container[e])}),t.name={en:a.container.newContainerName},s.updateContainer(t).then(function(){a.container.editingContainer=!1})},a.addContainer=function(t){var e={customer_id:a.container.customer_id,parent_id:a.container._id,name:{en:angular.copy(a.container.newContainerTitle)}};s.createContainer(e).then(function(e){if(2===a.depth){var n={container_id:e._id,title:angular.copy(e.name)};s.getCommon().then(function(){s.createEpisode(n).then(function(t){var e={_type:"Scene",title:{},description:{},templateUrl:"templates/scene/1col.html",start_time:0,end_time:0,episode_id:t._id};s.storeItem(e)}).then(function(){a.onContainerAdd({$container:t})})})}else a.onContainerAdd({$container:t})}),a.container.newContainerTitle="",a.container.addingContainer=!1,r.existy(t.showChildren)&&!1!==t.showChildren||a.onToggleChildren(!1)},a.deleteEpisodeAndContainer=function(e){var n=i.containers[e],a=n.parent_id?n.parent_id:n.ancestry.replace(/.*\//,""),r=i.containers[a],o=[];angular.forEach(r.children,function(t){t._id!==e&&o.push(t)}),r.children=o,n.episodes.length?s.deleteEpisode(n.episodes[0]).then(function(){t(function(){s.deleteContainer(n._id)},250)}):s.deleteContainer(n._id)}})}}}function ittContainerEpisodes(t,e,n,i){return{restrict:"A",replace:!1,scope:{container:"=ittContainerEpisodes",forAdmin:"=forAdmin",onNodeClick:"&",rootContext:"="},templateUrl:"templates/containerepisodes.html",controller:["$scope",function(t){t.selectEpisode=function(e){t.onNodeClick({node:e})}}],compile:function(a){return e.compile(a,function(e){e.containers=t.containers,e.crossEpisodePath=n.crossEpisodePath,e.episodeId=n.episodeId,e.loadChildren=function(){t.containers[e.container._id].haveNotLoadedChildData&&i.getContainer(e.container._id)},e.toggle=function(){e.container.wasClicked=!e.container.wasClicked}})}}}function ittDescriptionField(){return{restrict:"EA",scope:{data:"=",modelOpts:"=?"},template:['<div class="field">','\t<div class="label">Description [{{descriptionField.lang}}]</div>','\t<div class="input" ng-model-options="descriptionField.modelOpts" sxs-input-i18n="descriptionField.data.description" x-inputtype="\'textarea\'"></div>',"</div>"].join(" "),controller:["appState","ittUtils",function(t,e){var n=this;n.lang=t.lang,e.existy(n.modelOpts)||(n.modelOpts={updateOn:"default"})}],controllerAs:"descriptionField",bindToController:!0}}function ittDisplaySelect(){return{restrict:"EA",scope:{data:"=",itemForm:"=?"},template:['<div class="field" ng-if="$ctrl.getVisibility(\'display\')">','\t<div class="label">Display</div>','\t<div class="input">','\t\t<select ng-change="$ctrl.onItemFormUpdate($ctrl.data, $ctrl.itemForm)"','\t\t\tng-model="$ctrl.data.layouts[$ctrl.layoutIndex]"',"\t\t\tng-options=\"{{$ctrl.setNgOpts('display')}}\"","\t\t\titt-options-disabled=\"option.isDisabled for option in $ctrl.getSelectOpts('display')\">","\t\t</select>","\t</div>","</div>",'<div class="field" ng-if="$ctrl.getVisibility(\'bgImagePosition\')">','\t<div class="label">Position</div>','\t\t<div class="input">','\t\t<select ng-change="$ctrl.onItemFormUpdate($ctrl.data, $ctrl.itemForm)" ng-model="$ctrl.itemForm.position" ng-options="{{$ctrl.setNgOpts(\'imagePosition\')}}"></select>',"\t</div>","</div>"].join(""),controller:["$scope","selectService","ittUtils",function(t,e,n){function watchTemplate(){return i.data.templateUrl}function handleChange(t){i.isImageFillTemplate=t&&"templates/item/image-fill.html"===t}var i=this;i.getVisibility=e.getVisibility,i.getSelectOpts=e.getSelectOpts,i.onItemFormUpdate=e.onSelectChange,i.setNgOpts=n.setNgOpts,i.layoutIndex="image"===i.data.producerItemType?0:1,t.$watch(watchTemplate,handleChange)}],controllerAs:"$ctrl",bindToController:!0}}function ittDynamicModel(t,e){return{restrict:"A",terminal:!0,priority:1e5,link:function(n,i){var a=e(i.attr("itt-dynamic-model"))(n);i.removeAttr("itt-dynamic-model"),i.attr("ng-model",a),t(i)(n)}}}function ittEditPencil(){return{restrict:"EA",transclude:!0,scope:{canAccess:"=?",force:"=?",onEdit:"&"},template:["<div>",'\t<span class="pencil__content" ng-transclude></span>','\t<span style="text-indent: 0">','\t\t<span class="edit-pencil" ng-click="sendEdit($event)" ng-if="showPencil || force"></span>',"\t</span>","</div>"].join(" "),link:function(t,e){function sendEdit(e){t.showPencil=!1,t.onEdit({$event:e})}function mouseenter(){!0===t.canAccess&&t.$apply(function(){t.showPencil=!0})}function mouseleave(){!0===t.canAccess&&t.$apply(function(){t.showPencil=!1})}t.showPencil=!1,t.sendEdit=sendEdit,e.mouseenter(mouseenter),e.mouseleave(mouseleave)}}}function ittEpisode(t,e,n,i){return{restrict:"A",replace:!0,template:'<span ng-include="episode.templateUrl"></span>',controller:"EpisodeController",link:function(a){a.episode=n.episodes[i.episodeId],e.captureEpisodeActivity("episodeLoad"),t(function(){a.episode=n.episodes[i.episodeId],null!=a.episode&&(i.playerTemplate=a.episode.templateUrl)},457)}}}function ittEpisodeEditor(t,e,n,i,a,s,r,o,l){return{restrict:"A",replace:!0,scope:{episode:"=ittEpisodeEditor"},templateUrl:"templates/producer/episode.html",controller:"EditController",link:function(c){function translationMessage(t){var e="",n=t.filter(function(t){return void 0==t.default||(e="Translate from "+t.code+" to: ",!1)}).map(function(t){return t=t.code}).join(", ");return e+n}function beginBackgroundTranslations(t){function handleSuccess(t){"Request for translations queued"===t.status?c.afterTranslationAttempt=t.status+", check back later!":c.afterTranslationAttempt="Something went wrong...",c.doCheckForTranslations=!0}function handleError(t){}a.beginBackgroundTranslations(t).then(handleSuccess).catch(handleError)}function waitForDuration(t,n,i){return function(a){"player ready"===a&&(o.unregisterStateChangeListener(waitForDuration),e(function(){t({duration:o.getMetaProp("duration","replaceMe"),url:n,type:i}),c.episode.swap={}},0))}}function createAssetFromTmp(t){var e=Object.create(null);e.content_type=t.type,e.duration=t.duration,e.url=t.url,e.name=c.episode.title,e.description=c.episode.description,a.createAsset(c.episodeContainerId,e).then(function(t){i.cache("asset",t),o.renamePid("replaceMe",t._id),c.attachChosenAsset(t._id)}).catch(function(t){})}function attachMediaSrc(t){var e,n=l.checkUrl(t),i=n.type;if(i.length>0){e=n.mimeType,c.episode.replacingMasterAsset=!0,c.showmessage="Getting "+i+" video...";var a=l.parseInput(t);c.episode.swap={_id:"replaceMe",mediaSrcArr:[a]};var s=waitForDuration(createAssetFromTmp,a,e);o.registerStateChangeListener(s)}}c.translationMessage=translationMessage,c.beginBackgroundTranslations=beginBackgroundTranslations,c.episodeContainerId=i.episodes[n.episodeId].container_id;var d=i.containers[c.episodeContainerId];c.customer=i.customers[d.customer_id],c.episode.master_asset_id&&""!==c.episode.master_asset_id&&(c.masterAsset=i.assets[c.episode.master_asset_id]),c.uploadStatus=[],c.uneditedEpisode=angular.copy(c.episode),c.itemForm=r.setupItemForm(c.episode.styles,"episode"),!s.userHasRole("admin")||c.masterAsset&&/video\/x-/.test(c.masterAsset.content_type)?c.masterAssetType="WebUrl":c.masterAssetType="Video",c.langForm={en:!0,es:!1,zh:!1,pt:!1,fr:!1,de:!1,it:!1};for(var p=0;p<c.episode.languages.length;p++)c.langForm[c.episode.languages[p].code]=!0;c.langForm[c.episode.defaultLanguage]=!0,c.languageWatcher=c.$watch(function(){return[c.langForm,c.episode.defaultLanguage]},function(){var t=0,e="",n=[];for(var i in c.langForm)c.langForm[i]?(t++,e=i,n.push({code:i})):c.episode.defaultLanguage===i&&(c.episode.defaultLanguage=!1);c.languageCount=t,!1===c.episode.defaultLanguage&&(c.episode.defaultLanguage=e),angular.forEach(n,function(t){t.code===c.episode.defaultLanguage&&(t.default=!0)}),c.episode.languages=angular.copy(n)},!0),c.watchStyleEdits=c.$watch(function(){return c.itemForm},function(){var t=[];for(var e in c.itemForm)c.itemForm[e]&&t.push(e+c.itemForm[e]);c.episode.styles=t,i.deriveEpisode(c.episode),i.resolveEpisodeEvents(c.episode._id)},!0),c.appState=n,c.watchEdits=c.$watchGroup(["episode.templateUrl","episode.title[appState.lang]","episode.description[appState.lang]"],function(t,e){if(t[0]!==e[0]){var n=[];if(e[0]){var a=e[0].match("templates/episode/(.*).html")[1];angular.forEach(c.episode.styles,function(t){t.toLowerCase()!=="color"+a&&t.toLowerCase()!=="typography"+a&&n.push(t)})}var s=t[0].match("templates/episode/(.*).html")[1];angular.forEach(["eliterate","gw","purdue","usc","columbia","columbiabusiness"],function(t){s===t&&(n.push("color"+t[0].toUpperCase()+t.substring(1)),n.push("typography"+t[0].toUpperCase()+t.substring(1)))}),c.episode.styles=angular.copy(n)}i.deriveEpisode(c.episode),i.resolveEpisodeEvents(c.episode._id)}),c.dismissalWatcher=t.$on("player.dismissAllPanels",c.cancelEdit),c.cancelEdit=function(){c.cancelEpisodeEdit(c.uneditedEpisode)},c.attachChosenAsset=function(t){c.episode.replacingMasterAsset=!1;var e=i.assets[t],n=i.assets[c.episode.master_asset_id];if(c.showmessage="New video attached.",n&&e.duration<n.duration){c.getItemsAfter(c.episode.items.concat(c.episode.scenes),e.duration).length&&(c.showmessage="Warning: this new video is shorter than the current video and we've detected that some existing content items will be impacted. If you save this edit, these events will have their start and end times adjusted to the new episode end. (If this isn't what you want, choose a different video or hit 'cancel'.)")}c.episode._master_asset_was_changed=!0,c.episode.master_asset_id=e._id,c.masterAsset=e,c.episode.masterAsset=e,i.deriveEpisode(c.episode)},c.attachPosterAsset=function(t){var e=i.assets[t];c.episode.poster_frame_id=t,c.episode.poster=e,i.deriveEpisode(c.episode)},c.assetUploaded=function(t){c.showUploadButtons=!1,c.showUploadField=!1,c.attachChosenAsset(t)},c.posterUploaded=function(t){c.showUploadButtonsPoster=!1,c.showUploadFieldPoster=!1,c.attachPosterAsset(t)},c.attachMediaSrc=attachMediaSrc,c.replaceAsset=function(t){t=t||"",c["showUploadButtons"+t]=!0,c["showUploadField"+t]=!1},c.selectText=function(t){t.target.select()},c.$on("$destroy",function(){c.watchEdits(),c.dismissalWatcher(),c.languageWatcher(),c.watchStyleEdits()})}}}function ittEpisodeList(){return{restrict:"A",replace:!0,controller:["$scope","$location","$timeout","appState","authSvc","dataSvc","modelSvc","ittUtils",function(t,e,n,i,a,s,r,o){function walkContainers(e,n,i){return e.sort(function(t,e){return t.name.en.toLowerCase()<e.name.en.toLowerCase()?-1:t.name.en.toLowerCase()>e.name.en.toLowerCase()?1:0}),angular.forEach(e,function(e){var a=r.containers[e._id];a.evenOdd=n,n=!n,a.isActive&&i&&(t.lastClickedContainer={container:a,bool:!1}),a.showChildren&&a.children&&(n=walkContainers(a.children,n,i))}),n}function onContainerAdd(e){walkContainers(t.root.children,!e.evenOdd,!1)}function onContainerClick(e){e.container.children?(!1===e.bool&&(e.container.showChildren=!e.container.showChildren),walkContainers(t.root.children,!0,!1)):s.getContainer(e.container._id).then(function(n){e.container=r.containers[n],!1===e.bool&&(e.container.showChildren=!0),walkContainers(t.root.children,!0,!1)}),!0===e.bool&&(o.existy(t.lastClickedContainer)?t.lastClickedContainer.container!==e.container?(t.lastClickedContainer.container.isActive=!1,t.lastClickedContainer=e,t.lastClickedContainer.container.isActive=!0):t.lastClickedContainer.container.isActive=!t.lastClickedContainer.container.isActive:(t.lastClickedContainer=e,t.lastClickedContainer.container.isActive=!0))}t.logout=function(){a.logout()},t.appState=i,t.loading=!0,t.containers=r.containers,t.userHasRole=a.userHasRole,s.getCustomerList(),s.getContainerRoot().then(function(e){t.root={children:[]},angular.forEach(e,function(e){t.root.children.push(r.containers[e])}),walkContainers(t.root.children,!0,!0),t.loading=!1},function(){t.failedLogin=!0,t.loading=!1}),t.onContainerAdd=onContainerAdd,t.onContainerClick=onContainerClick}]}}function ittFileField(){return{restrict:"EA",scope:!0,template:['<div class="field">','\t<div class="label">File','\t\t<itt-validation-tip ng-if="ittItemForm.itemAsset.$invalid" text="File is required"></itt-validation-tip>',"\t</div>",'\t<div class="input" ng-include="\'templates/producer/upload-producer.html\'"></div>',"</div>"].join(" ")}}function ittFilesHandler(){return{scope:{onSelected:"&"},restrict:"A",link:function(t,e){e.bind("change",function(){t.$apply(function(){t.onSelected({files:e[0].files})})})}}}function ittFlags(){return{restrict:"EA",scope:{flags:"=",data:"=",itemForm:"=?"},template:['<div class="field">','\t<div class="label">Flags</div>','\t<div class="input">','\t\t<span ng-repeat="flag in $ctrl._flags">',"\t\t\t<span ng-if=\"flag !== 'invertColor'\">",'\t\t\t\t<label for="{{$ctrl._ids[flag]}}"></label>','\t\t\t\t<input id="{{$ctrl._ids[flag]}}" type="checkbox" itt-dynamic-model="\'$ctrl.data.\' + flag" ng-change="$ctrl.handleChange()"/>{{$ctrl._displays[flag]}}',"\t\t\t</span>","\t\t\t<span ng-if=\"flag === 'invertColor'\">",'\t\t\t\t<label for="{{$ctrl._ids[flag]}}"></label>','\t\t\t\t<input id="{{$ctrl._ids[flag]}}" type="checkbox" ng-model="$ctrl.itemForm.color" ng-true-value="\'Invert\'" ng-false-value="\'\'" ng-change="$ctrl.handleChange()"/>{{$ctrl._displays[flag]}}',"\t\t\t</span>","\t\t</span>","\t</div>","</div>"].join(" "),controller:["$scope","selectService","ittUtils",function(t,e,n){function handleChange(){i.data.hasOwnProperty("stop")&&e.onSelectChange(i.data,i.itemForm)}function _h1OrH2(t){return"templates/item/text-h1.html"===t||"templates/item/text-h2.html"===t}function watchTemplateUrl(){return i.data.templateUrl}function setFlags(t,e){t!==e&&(i.itemForm.color=""),t&&("templates/item/image-fill.html"===i.data.templateUrl?i._flags=i._flags.filter(function(t){return"stop"!==t}):i._flags=i.flags,_h1OrH2(t)?(i._flags=i.flags,n.existy(i.itemForm)&&"internal:editing"===i.data._id&&(i.itemForm.color="Invert")):(n.existy(i.itemForm)&&"internal:editing"===i.data._id&&(i.itemForm.color=""),i._flags=i._flags.filter(function(t){return"chapter_marker"!==t&&"invertColor"!==t})))}var i=this;i._flags=angular.copy(i.flags),i.handleChange=handleChange,i._displays={required:"Required",stop:"Stop item",cosmetic:"Cosmetic",chapter_marker:"Chapter Event",invertColor:"Invert Color"},i._ids={required:"itemRequired",stop:"itemStop",cosmetic:"itemCosmetic",chapter_marker:"itemChapter",invertColor:"Invert"},t.$watch(watchTemplateUrl,setFlags)}],controllerAs:"$ctrl",bindToController:!0}}function ittFlotr2Chart(){var t=1;return{restrict:"E",scope:{type:"@",height:"@",width:"@",title:"=title",options:"@",data:"@"},template:'<div class="flotContainer"><div class="chartContainer" id="chartContainer" aria-label="{{chartLabel}}"></div><div class="legendContainer" id="legendContainer"></div></div>',link:function(e,n,i){var a=function(t,n,i){e.chartLabel=d(n),$.plot(t,n,i),t.show()},s=$("#chartContainer");s.attr("id","chartContainer"+t);var r=$("#legendContainer");r.attr("id","legendContainer"+t++);var o=function(t,e){return Math.round(e.percent)+"% ("+e.data[0][1]+"): "+t},l=function(t,e){return'<div style="padding: 3px; font-size: 80%">'+Math.round(e.percent)+"%</div>"};e.chartOptions={series:{pie:{show:!0,label:{show:!0,background:{opacity:.7},formatter:l}}},legend:{show:!0,labelFormatter:o,noColumns:1,position:"sw",margin:0,backgroundColor:null,backgroundOpacity:1,sorted:"descending",container:r},grid:{hoverable:!0},tooltip:!0,tooltipOpts:{content:"%y.0, %s",shifts:{x:20,y:0},defaultTheme:!1}},e.$watch(function(){return s.width()},function(t){t>0&&(s.css({height:t}),a(s,JSON.parse(e.data),e.chartOptions),e.observeData=i.$observe("data",function(t){e.data=JSON.parse(t),a(s,e.data,e.chartOptions)}),e.$on("$destroy",e.observeData))});var c=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n].data;for(var i=0;i<t.length;i++)t[i].percent=t[i].data/e*100;return t},d=function(t){var e="";t=c(t);for(var n=0;n<t.length;n++)e+=Math.round(t[n].percent)+"% of users totaling "+t[n].data+" choose '"+t[n].label+"'. ";return e}}}}function ittGuestAccessibleUrl(){return{restrict:"EA",template:['<div ng-if="!$ctrl.clipboardMode">',' <div ng-if="$ctrl.narrative.guest_access_allowed === true">','\t    <label for="{{$ctrl.display.id[$ctrl.type]}}">Guest Accessible URL:','       <itt-validation-tip ng-if="$ctrl[$ctrl.type].error" text="{{$ctrl[$ctrl.type].error}}"></itt-validation-tip>','       <p class="--break-word"><small ng-class="{ \'error-red\': $ctrl[$ctrl.type].error, unselectable: $ctrl[$ctrl.type].error }">{{$ctrl.formatGuestAccessibleUrl()}}</small></p>',"     </label>",'     <input id="{{$ctrl.display.id[$ctrl.type]}}" type="text" name="path" placeholder="{{$ctrl.display.placeholder}}" itt-valid-pathslug narrative-id="{{$ctrl.narrative._id}}" ng-model="$ctrl[$ctrl.type].path_slug.en">'," </div>","</div>",'<a ng-if="$ctrl.clipboardMode" itt-clipboard source-text="{{$ctrl.formatUrlToCopy()}}" on-copy="$event.stopPropagation()"></a>'].join(""),scope:{narrative:"=",timeline:"=?",customer:"=?",clipboardMode:"@?",subDomain:"@?"},controller:["ittUtils",function(t){function formatUrlToCopy(){return i(n.narrative)&&!1===n.narrative.guest_access_allowed?formatLTIUrl():formatGuestAccessibleUrl()}function formatLTIUrl(){if(i(n.narrative))return"timeline"===n.type?e+"auth/lti?narrative="+n.narrative._id+"&timeline="+n.timeline._id:e+"auth/lti?narrative="+n.narrative._id}function formatGuestAccessibleUrl(){var t=i(n.narrative),s=t&&i(n.narrative.path_slug)&&i(n.narrative.path_slug.en),r=i(n.timeline),o=r&&i(n.timeline.path_slug)&&i(n.timeline.path_slug.en);return"timeline"===n.type&&o?e+"#/story/"+n.narrative.path_slug.en+"/"+a(n.timeline.path_slug.en):s?e+"#/story/"+a(n.narrative.path_slug.en):void 0}var e,n=this,i=t.existy,a=t.slugify,s="https://",r=".narrasys.com/";angular.extend(n,{type:i(n.timeline)?"timeline":"narrative",display:null,formatLTIUrl:formatLTIUrl,formatGuestAccessibleUrl:formatGuestAccessibleUrl,formatUrlToCopy:formatUrlToCopy}),function(){n.display={id:{timeline:"tlPath",narrative:"nPath"},placeholder:"human-friendly-link-to "+n.type};var t=i(n.subDomain)&&n.subDomain||i(n.narrative.narrative_subdomain)&&n.narrative.narrative_subdomain;e=s+t+r}()}],controllerAs:"$ctrl",bindToController:!0}}function ittHighlightSelect(){return{restrict:"EA",template:['<div class="field">','\t<div class="label">Highlight<span ng-if="episode"> Style</spann></div>','\t<div class="input">','\t\t<select size="1" ng-model="itemForm.highlight">','\t\t\t<option ng-if="episode" value="">(Default)</option>','\t\t\t<option ng-if="item._type === \'Scene\'" value="">(Inherit from episode)</option>','\t\t\t<option ng-if="item._type !== \'Scene\' && !episode" value="">(Inherit from layout)</option>','\t\t\t<option value="None">No highlight</option>','\t\t\t<option value="Solid">Solid</option>','\t\t\t<option value="Border">Border</option>','\t\t\t<option value="Side">Side</option>','\t\t\t<option value="Bloom">Translucent</option>','\t\t\t<option value="Tilt">Tilt</option>',"\t\t</select>","\t</div>","</div>"].join(" ")}}function ittIframe(t){return{restrict:"E",scope:{src:"@",contenttype:"@",item:"&"},replace:!0,templateUrl:"templates/iframe.html",controller:["$scope","ittUtils","appState",function(t,e,n){function validateFrameUrl(t){return e.isValidURL(t)?(i.isLoading=!1,!0):(i.isLoading=!0,!1)}var i=this,a="allow-forms allow-same-origin allow-scripts";i.isLoading=!0,i.isTouchDevice=n.isTouchDevice,i.isTouchDevice&&/inthetelling.com\/#/.test(i.src)&&(i.iOSScroll="no"),i.watcher=t.$watchGroup([function(){return i.src},function(){return i.contenttype}],function(){i.src&&validateFrameUrl(i.src)&&(i.contenttype?i.sandbox="text/html"===i.contenttype?a:void 0:(i.sandbox=a,i.src.match(/.pdf$/)&&delete i.sandbox,i.src.match(/inthetelling.com\/#/)&&(i.sandbox+=" allow-top-navigation allow-popups"),i.src.match(/inthetelling.com\/#/)&&-1===i.src.indexOf("?")&&(i.src+="?embed=1"),i.src.match(/amazonaws.com\/itt/i)&&delete i.sandbox))}),t.$on("$destroy",function(){i.watcher()})}],controllerAs:"$ctrl",bindToController:!0,link:function(e,n){var i=95,a=angular.noop,s=$(".w-modal"),r=$(".modal"),o=$(window).height()-220;r.length>0&&t.isTouchDevice&&(e.$ctrl.styles={height:o+"px"},n.css("height",o),e.$watch(function(){return n.height()},function(t,i){t!==i&&(e.$ctrl.styles={height:t+"px"},n.css("height",o))})),s.length>0?function(){var t=s.height()-i;n.css("height",t),s.css("overflow-y","hidden"),a=e.$watch(function(){return s.height()},function(t,e){if(t!==e){var a=t-i;n.css("height",a)}})}():function(){"discover"!==t.viewMode||"templates/episode/narrasys-pro.html"!==t.playerTemplate&&"templates/episode/career-playbook.html"!==t.playerTemplate||t.isTouchDevice||n.css("height",o)}(),e.$on("$destroy",function(){a()})}}}function ittImageField(){return{restrict:"EA",template:['<div class="field" ng-show="selectService.getVisibility(\'imageUpload\')">','\t<div class="label">Image','\t\t<itt-validation-tip ng-if="ittItemForm.itemAsset.$invalid" text="Image is required"></itt-validation-tip>',"\t</div>",'\t<div class="input" ng-include="\'templates/producer/upload-producer.html\'"></div>',"</div>"].join(" ")}}function ittItem(t,e,n,i,a,s,r,o,l,c,d,p,m){return{restrict:"A",replace:!1,scope:{item:"=ittItem"},template:function(t,e){return e.forcetemplate?"<div ng-include=\"'templates/item/"+e.forcetemplate+".html'\"></div>":'<div ng-include="item.templateUrl"></div>'},controller:"ItemController",link:function(u,g){function handleOutgoingLinkDisplay(){if(null!=u.item.url&&null!=u.item.url_status&&null!=u.item.target){var t=u.item,e=t.url,n=t.target,i=t.url_status,a=m.mixedContentUrl(e);return!m.urlIsEmbeddable(e,i)||"_blank"===n||a}}u.appState=s,u.userHasRole=a.userHasRole,u.item.avatar_id&&(u.item.avatar=l.assets[u.item.avatar_id]),"internal:editing"===u.item._id?g.addClass("noTransitions"):(a.userHasRole("admin")||a.userHasRole("customer admin")||u.item.user_id===s.user._id)&&(u.item.editableByThisUser=!0),u.handleOutgoingLinkDisplay=handleOutgoingLinkDisplay,u.toggleDetailView=function(){u.item.showInlineDetail?u.item.showInlineDetail=!1:(o.pause(),u.captureInteraction(),g.width()>450?u.item.showInlineDetail=!0:s.itemDetail={item:u.item,animate:!0})};var v={ENTER:13,SPACE:32};if(u.toggleDetailOnKeyPress=function(t){var e=t,n=!0;switch(e.keyCode){case v.ENTER:case v.SPACE:u.toggleDetailView(),n=!1;break;default:n=!0}n||(t.stopPropagation(),t.preventDefault())},u.forceModal=function(t){void 0===t&&(t=!0),o.pause(),s.itemDetail={item:u.item,animate:t}},u.outgoingLinkOnKeyPress=function(t,e){var n=e,i=!0;switch(n.keyCode){case v.ENTER:case v.SPACE:u.outgoingLink(t),i=!1;break;default:i=!0}i||(e.stopPropagation(),e.preventDefault())},u.outgoingLink=function(t){if(o.pause(),u.captureInteraction(),p.isVideoUrl(t)){d.pause(u.item._id);var n=Math.floor(d.getCurrentTime(u.item._id))||0;t=p.getOutgoingUrl(t,n)}u.item.targetTop?e(function(){window.location.href=t}):window.open(t)},u.editItem=function(){s.editEvent=u.item,s.editEvent.templateOpts=c.getTemplates(u.item.producerItemType);var t=c.setupItemForm(s.editEvent.styles,"item");c.onSelectChange(s.editEvent,t),s.videoControlsActive=!0,s.videoControlsLocked=!0},u.captureInteraction=function(){r.captureEventActivity("clicked",u.item._id)},"templates/item/link-embed.html"===u.item.templateUrl)var h=u.$watch(function(){return d.getMetaProp("time")>u.item.start_time},function(t){t&&(u.captureInteraction(),h())});if(u.item.asset_id&&!u.item.asset&&(u.item.asset=l.assets[u.item.asset_id]),u.item.asset&&u.item.styleCss&&u.item.styleCss.match(/fill|contain|cover/)&&(u.item.asset.cssUrl="url('"+u.item.asset.url+"');",u.item.backgroundImageStyle="background-image: url('"+u.item.asset.url+"');"),u.item.data&&(u.plugin=u.item.data._plugin,u.plugin._type=u.item.data._pluginType,"credlyBadge"===u.plugin._type)){r.captureEventActivity("viewed",u.item._id),s.user.roles&&1===s.user.roles.length&&"guest"===s.user.roles[0]?u.plugin.eligibleForBadges=!1:(u.plugin.eligibleForBadges=!0,s.user.emails?u.plugin.userEmail=s.user.emails[0]:u.plugin.userEmail="",u.plugin.totalAchieved=0),u.checkBadgeEligibility=function(){u.plugin.eligibleForBadges&&angular.forEach(u.plugin.requirements,function(t){t.achieved||r.readEventActivity(t.eventId,t.activity).then(function(e){t.achieved=e,u.countAchievements()}),u.countAchievements()})},u.countAchievements=function(){var t=0;angular.forEach(u.plugin.requirements,function(e){e.achieved&&(t+=1)}),u.plugin.totalAchieved=t,u.plugin.totalAchieved===u.plugin.requirements.length&&(l.episodes[s.episodeId].styleCss=l.episodes[s.episodeId].styleCss+" uscHackUserHasBadge")},u.checkBadgeEligibility();var f=0;u.badgePoll=n(function(){f++,(u.item.isCurrent||"review"===s.viewMode)&&u.checkBadgeEligibility(),f>60&&n.cancel(u.badgePoll)},1e4),u.$on("$destroy",function(){n.cancel(u.badgePoll)}),u.badger=function(){u.plugin.gettingBadge=!0,t({method:"GET",url:i.apiDataBaseUrl+"/v1/send_credly_badge?badge_id="+u.plugin.credlyBadgeId+"&email="+u.plugin.userEmail}).success(function(t){u.checkBadgeEligibility(),"Badge previously sent."===t.status&&(u.plugin.alreadyHadBadge=!0),u.plugin.gotBadge=!0}).error(function(){u.plugin.gettingBadge=!1,u.plugin.error=!0})}}}}}function ittItemDetailModal(t){return{restrict:"A",replace:!0,scope:{item:"=ittItemDetailModal"},templateUrl:"templates/item/modal.html",link:function(e){e.item=e.item.item,e.item.animate||(e.modalStyle={transition:"none"});var n={bottom:"0","padding-top":"5%"},i={"overflow-y":"auto",top:"40%",height:"85%","z-index":"11"};e.item.isVideoUrl?e.modalStyle=angular.extend(e.modalStyle,{"padding-top":"5%"}):"image"===e.item.producerItemType?e.modalStyle=angular.extend(e.modalStyle,i):e.modalStyle=angular.extend(e.modalStyle,n),e.dismiss=function(){t.itemDetail=!1}}}}function ittItemEditor(t,e,n,i,a,s){return{restrict:"A",replace:!0,scope:{item:"=ittItemEditor"},templateUrl:"templates/producer/item.html",controller:"EditController",link:function(r){a.pause(),a.seek(r.item.start_time),r.uploadStatus=[],r.uneditedItem=angular.copy(r.item),r.uneditedItem.$$hashKey=r.item.$$hashKey,r.annotators=i.episodes[n.episodeId].annotators,r.episodeContainerId=i.episodes[n.episodeId].container_id,r.languages=i.episodes[n.episodeId].languages,r.itemForm=s.setupItemForm(r.item.styles,"item"),r.item.layouts||(r.item.layouts=["inline"]),r.item.producerItemType||e.error({data:"Don't have a producerItemType for item "+r.item._id}),r.itemEditor="templates/producer/item/"+n.product+"-"+r.item.producerItemType+".html",r.appState=n,r.watchEdits=r.$watch(function(){return r.item},function(t,e){e&&(!1===t.chapter_marker&&a.removeEvent(t._id),t=i.deriveEvent(t),"producer"!==n.product||"_blank"!==t.target||"templates/item/link-embed.html"!==t.templateUrl&&"templates/item/link-modal-thumb.html"!==t.templateUrl||(t.templateUrl="templates/item/link.html"),t.asset?(r.item.asset.cssUrl="url('"+t.asset.url+"');",r.item.backgroundImageStyle="background-image: url('"+t.asset.url+"');"):(delete r.item.asset,delete r.item.backgroundImageStyle),t.start_time===e.start_time&&t.start_time===e.end_time||i.resolveEpisodeEvents(n.episodeId))},!0),r.watchStyleEdits=r.$watch(function(){return r.itemForm},function(){var t=[];for(var e in r.itemForm)r.itemForm[e]&&("position"===e?t.push(r.itemForm[e]):t.push(e+r.itemForm[e]));r.item.styles=t,r.item.asset&&(r.item.asset.cssUrl="url('"+r.item.asset.url+"');",r.item.backgroundImageStyle="background-image: url('"+r.item.asset.url+"');")},!0),r.forcePreview=function(){n.editEvent.fnord=n.editEvent.fnord?"":"fnord"};var o=function(t){return!("Annotation"!==t._type||!t.templateUrl.match(/transcript/))};r.setItemTime=function(){"Scene"===r.item._type?(i.resolveEpisodeEvents(n.episodeId),a.updateSceneTimes(r.item.episode_id)):r.item.stop?(r.item.end_time=r.item.start_time,i.resolveEpisodeEvents(n.episodeId),a.updateEventTimes(r.item)):(i.resolveEpisodeEvents(n.episodeId),(r.item.end_time<=r.item.start_time||r.item.end_time>i.events[r.item.scene_id].end_time)&&(r.item.end_time=i.events[r.item.scene_id].end_time),a.updateEventTimes(r.item))};var l=function(t,e){return t.start_time-e.start_time};r.setItemEndTime=function(){(r.item.end_time<=r.item.start_time||r.item.end_time>i.events[r.item.scene_id].end_time)&&(r.item.end_time=i.events[r.item.scene_id].end_time),a.updateEventTimes(r.item)};var c=function(){var t=i.episodes[n.episodeId];return angular.copy(t.items).filter(o)},d=function(t,e,n){if("Chapter"===e._type)return!1;if(!t)return!1;var i,a=t.end_time;n=n.sort(l);for(var s=0,r=n.length;s<r;s++)if(n[s]._id===e._id){i=n[s+1];break}return i&&i.start_time<t.end_time&&(a=i.start_time),a},p=function(t){return"Scene"===t._type?t:i.events[r.item.scene_id]};r.switchToAutoOrCustom=function(t){if(t){var e=o(r.item)?c():[];r.item.end_time=d(p(r.item),r.item,e),r.customEndTime=!1}else r.customEndTime=!0},r.isAutoEndTime=function(){var t=o(r.item)?c():[],e=d(p(r.item),r.item,t);return r.item.end_time===e},r.customEndTime=!r.isAutoEndTime(),r.dismissalWatcher=t.$on("player.dismissAllPanels",r.cancelEdit),r.cancelEdit=function(){r.cancelEventEdit(r.uneditedItem)},r.assetUploaded=function(t){r.item.asset=i.assets[t],"Link"===r.item._type?r.item.link_image_id=t:"Annotation"===r.item._type?r.item.annotation_image_id=t:r.item.asset_id=t,r.showUploadButtons=!1,r.showUploadField=!1},r.replaceAsset=function(){r.showUploadButtons=!0,r.item.sxs&&(r.item.removedAssets=r.item.removedAssets||[],"Link"===r.item._type?r.item.removedAssets.push(r.item.link_image_id):"Annotation"===r.item._type?r.item.removedAssets.push(r.item.annotation_image_id):r.item.removedAssets.push(r.item.asset_id))},r.detachAsset=function(){if(r.item.asset)switch(r.item.producerItemType){case"link":r.item.asset=null,r.item.link_image_id=null,r.item.asset_id=null,r.item.annotation_image_id=null;break;case"transcript":r.item.asset=null,r.item.annotation_image_id=null;break;case"image":case"question":case"file":r.item.asset=null,r.item.asset_id=null}},r.attachChosenAsset=function(t){var e=i.assets[t];r.item&&(r.item.asset=e,s.onSelectChange(r.item,r.itemForm),"Upload"===r.item._type||"Plugin"===r.item._type?r.item.asset_id=t:"Link"===r.item._type?(r.item.link_image_id=t,r.item.asset_id=t):"Annotation"===r.item._type&&(r.item.asset_id=t,r.item.annotation_image_id=t))},r.$on("$destroy",function(){r.watchEdits(),r.dismissalWatcher(),r.watchStyleEdits()})}}}function ittLanguageFlags(){return{restrict:"EA",template:['<div class="field">','\t<div class="label">Languages</div>','\t<div class="input">',"\t<label>",'\t\t<input type="checkbox" ng-model="langForm.en">English',"\t</label>","\t<label>",'\t\t<input type="checkbox" ng-model="langForm.es">Spanish',"\t</label>","\t<label>",'\t\t<input type="checkbox" ng-model="langForm.zh">Chinese',"\t</label>","\t<label>",'\t\t<input type="checkbox" ng-model="langForm.pt">Portuguese',"\t</label>","\t<label>",'\t\t<input type="checkbox" ng-model="langForm.fr">French',"\t</label>","\t<label>",'\t\t<input type="checkbox" ng-model="langForm.de">German',"\t</label>","\t<label>",'\t\t<input type="checkbox" ng-model="langForm.it">Italian',"\t</label>","\t</div>","</div>"].join("\n")}}function ittLanguageSelect(){return{restrict:"EA",scope:{data:"=",langForm:"=?"},template:['<div class="field">','\t<div class="label">Default Language</div>','\t<div class="input">','\t\t<select ng-model="$ctrl.data.defaultLanguage" ng-options="{{$ctrl.setNgOpts()}}" itt-options-disabled="option.isDisabled for option in $ctrl.langOpts"></select>',"\t</div>","</div>"].join("\n"),controller:["$scope","selectService",function(t,e){function setNgOpts(){return"option.value as option.name for option in $ctrl.langOpts"}function watchLangForm(){return n.langForm}function handleUpdates(t){n.langOpts=n.langOpts.map(function(e){return angular.forEach(t,function(t,n){e.value===n&&(e.isDisabled=!t)}),e})}var n=this;n.getSelectOpts=e.getSelectOpts,n.setNgOpts=setNgOpts,n.langOpts=e.getSelectOpts("language"),t.$watch(watchLangForm,handleUpdates,!0)}],controllerAs:"$ctrl",bindToController:!0}}function ittLoading(){return{scope:!0,templateUrl:"templates/loading.html"}}function ittLogin(t,e,n,i,a,s){return{restrict:"A",replace:!1,link:function(r){r.userHasRole=i.userHasRole,r.appState=a,r.loginForm={auth_key:"",password:""},r.apiDataBaseUrl=n.apiDataBaseUrl,i.authenticate().then(function(){if(s.init(),e.key&&t.search("key",null),e.episode){var n=e.episode;t.search("episode",null),t.search("nonce",null),t.path("/episode/"+n)}else if(e.narrative){var i=e.narrative;if(t.search("narrative",null),t.search("nonce",null),e.timeline){var a=e.timeline;t.search("timeline",null),t.path("/story/"+i+"/"+a)}else t.path("/story/"+i)}else 0===Object.keys(e).length&&t.path("/account")},function(){}),r.adminLogin=function(){i.adminLogin(r.loginForm.auth_key,r.loginForm.password).then(function(){t.path("/projects")}).catch(function(t){r.badlogin=!0})},r.logout=function(){i.logout()}}}}function ittMagnet(t,e,n){return{restrict:"A",replace:!0,scope:!0,link:function(i,a){i.changeMagnet=function(i){t.$emit("magnet.changeMagnet",i),(e.isTouchDevice||0===n.getMetaProp("time"))&&t.$emit("magnet.jumpToMagnet")},i.unwatchVisibility=i.$watch(function(){return a.is(":visible")},function(t){t&&i.changeMagnet(a)}),"watchModeVideoMagnet"===a.attr("id")&&(i.unwatchSize=i.$watch(function(){return{w:angular.element(window).width(),h:angular.element(window).height(),v:a.is(":visible")}},function(){var t=angular.element(window),e=t.height()-46;t.width()/e>16/9?a.width(16/9*e):a.width(t.width()),i.changeMagnet(a)},!0)),i.$on("$destroy",function(){i.unwatchVisibility(),i.unwatchSize&&i.unwatchSize()})}}}function ittMagnetized(t,e){return{restrict:"A",replace:!0,scope:!0,link:function(n,i){var a=function(t){n.unwatch&&n.unwatch(),n.magnet=$(t),n.unwatch=n.$watch(function(){return{top:n.magnet.offset().top-i.offset().top,left:n.magnet.offset().left-i.offset().left,width:n.magnet.width()-i.width(),winWidth:e.windowWidth,winHeight:e.windowHeight}},s,!0)},s=function(){window.requestAnimationFrame(function(){i.css("position","fixed"===n.magnet.css("position")?"fixed":"absolute");var t=n.magnet.offset().top-i.offset().top,e=n.magnet.offset().left-i.offset().left,a=n.magnet.width()-i.width();Math.abs(t)>1||Math.abs(e)>1?i.offset({top:i.offset().top+t/4,left:i.offset().left+e/4}):i.offset(n.magnet.offset()),Math.abs(a)>4?i.width(Math.ceil(i.width()+a/4)):i.width(Math.ceil(n.magnet.width())),i.height(Math.ceil(n.magnet.width()/(16/9)))})};t.$on("magnet.changeMagnet",function(t,e){a(e)});var r=function(){i.css("position","fixed"===n.magnet.css("position")?"fixed":"absolute"),i.offset(n.magnet.offset()),i.width(Math.ceil(n.magnet.width())),i.height(Math.ceil(n.magnet.width()/(16/9)))};t.$on("magnet.jumpToMagnet",r),n.$on("$destroy",function(){n.unwatch&&n.unwatch()})}}}function ittMcQuestion(t,e,n){return{restrict:"E",replace:!1,scope:{plugin:"=data",qid:"=",choices:"=",correct:"=",onChoice:"=",questionType:"@",showChart:"="},templateUrl:"templates/item/question-mc-inner.html",link:function(i){i.scoreQuiz=function(t){i.plugin.distractors[t].selected=!0,i.plugin.hasBeenAnswered=!0,i.plugin.selectedDistractor=i.plugin.distractors[t].index,e.captureEventActivity("question-answered",i.qid,{answer:i.plugin.distractors[t].text,index:i.plugin.distractors[t].index,correct:!!i.plugin.distractors[t].correct})},i.feedback=function(){for(var t=0;t<i.plugin.distractors.length;t++)if(i.plugin.distractors[t].index===i.plugin.selectedDistractor)return i.plugin.distractors[t].correct?i.plugin.correctfeedback:i.plugin.incorrectfeedback},i.questionType=i.plugin.questiontype,i.chartOptions={};var a=function(t){var e=[];for(var a in t)t.hasOwnProperty(a)&&angular.forEach(i.plugin.distractors,function(i){if(i.index+""==a+""){var s=i.text;"object"==typeof s&&(s=s[n.lang]||s.en||""),e.push({data:t[a],label:s})}});return e};if(!0===i.plugin.hasBeenAnswered){void 0===i.plugin.answer_counts&&(i.plugin.answer_counts={});var s=i.plugin.answer_counts,r=a(s);i.chartData=r}i.scorePoll=function(e){t.saveAnswer("question-answered",i.qid,{answer:i.plugin.distractors[e].text,index:i.plugin.distractors[e].index,correct:!!i.plugin.distractors[e].correct}).then(function(){i.plugin.answer_counts=void 0===i.plugin.answer_counts?{}:i.plugin.answer_counts,t.incrementAnswerCount(i.plugin.answer_counts,i.plugin.distractors[e].index);var n=i.plugin.answer_counts,s=a(n);i.chartData=s,i.plugin.distractors[e].selected=!0,i.plugin.hasBeenAnswered=!0,i.plugin.selectedDistractor=i.plugin.distractors[e].index})}}}}function ittModal(){return{restrict:"EA",transclude:!0,scope:{modalClass:"@",wrapperClass:"@?"},template:['<div class="{{wrapperClass ? wrapperClass : \'itt__modal\'}}"><div class="{{modalClass}}"><ng-transclude></ng-transclude></div></div>'].join(" ")}}function ittNarrative(){return{templateUrl:"templates/narrative/default.html",scope:{narrativeData:"=",customerData:"="},controller:["$scope","authSvc","appState","dataSvc","modelSvc","ittUtils",function(t,e,n,i,a,s){function _updateSortOrder(t,e){var n=e.length,i=0;t>0&&(i=t===n-1?e[t-1].sort_order+100:s.bitwiseCeil((e[t-1].sort_order+e[t+1].sort_order)/2));var a=i;for(e[t].sort_order=i,t++,i++;t<n;t++)a>=e[t].sort_order&&(e[t].sort_order=i),a=i,i++}function _persistTimelineSortUpdate(e){i.storeTimeline(t.narrative._id,e).then(function(t){angular.extend(e,t)})}function toggleEditNarrativeModal(){s.existy(t.customers[0])&&s.existy(t.customers[0].narratives)&&t.customers[0].narratives.length>1?t.editingNarrative=!t.editingNarrative:i.getNarrativeList(t.customers[0]).then(function(){t.editingNarrative=!t.editingNarrative})}function toggleEditingTimeline(e){t.timelineUnderEdit=e}function toggleOwnership(){t.isOwner=!t.isOwner}function toggleEpisodeList(){t.showEpisodeList=!t.showEpisodeList}function doneEditingTimeline(){t.timelineUnderEdit=null,t.narrative.timelines=t.narrative.timelines.filter(function(e){return e!==t.tmpTimeline}),t.tmpTimeline=null}function editorAction(t,e){!0===t.isTemp?persistTmpTimeline(t):updateTimeline(t,e)}function _setTotalNarrativeDuration(e){t.totalNarrativeDuration=e.map(function(t){return t.episode_segments.map(function(t){return t.end_time})[0]}).reduce(function(t,e){return t+=e},0)}function deleteTimeline(e){i.deleteTimeline(e._id).then(function(){t.narrative.timelines=t.narrative.timelines.filter(function(t){return e._id!==t._id}),doneEditingTimeline(),_setTotalNarrativeDuration(t.narrative.timelines)})}function addTmpTimeline(e,n){var i,a,r,o,l;s.existy(e)?(o=n.indexOf(e),l=o+1,a=n[o],i=a.sort_order,n.slice(-1)[0]===a?i+=100:(r=n[o+1].sort_order,i=s.bitwiseCeil((r+i)/2))):(i=0,l=0);var c={name:{en:""},description:{en:""},hidden:!1,sort_order:i,isTemp:!0,index:l},d=n.slice(0,l),p=n.slice(l,n.length);d.push(c),n=d.concat(p),t.narrative.timelines=n,t.tmpTimeline=c,toggleEpisodeList()}function onEpisodeSelect(e){i.getEpisodeOverview(e).then(function(e){return t.tmpTimeline.parent_episode=e,s.existy(e.description)&&(t.tmpTimeline.description.en=s.stripHtmlTags(e.description.en)),t.tmpTimeline.name.en=s.stripHtmlTags(e.title.en),e}).then(function(e){i.getSingleAsset(e.master_asset_id).then(function(e){t.tmpTimeline.duration=e?e.duration:0,toggleEpisodeList(),persistTmpTimeline(t.tmpTimeline)})})}function persistTmpTimeline(e){function storeChildEpisode(n){return i.storeTimeline(t.narrative._id,e).then(function(t){return{d:t,e:n}})}function handleEpisodeSegment(n){var a=n.d,s=n.e;i.createEpisodeSegment(a._id,{episode_id:s._id,start_time:0,end_time:e.duration,sort_order:0,timeline_id:a._id}).then(function(e){a.episode_segments=[e],angular.forEach(t.narrative.timelines,function(t){t.sort_order===a.sort_order&&angular.extend(t,a)}),t.tmpTimeline=null,doneEditingTimeline(),_setTotalNarrativeDuration(t.narrative.timelines)})}function logErr(t){}_updateSortOrder(e.index,t.narrative.timelines),i.createChildEpisode({parent_id:e.parent_episode._id}).then(storeChildEpisode).then(handleEpisodeSegment).catch(logErr)}function updateNarrative(e){i.updateNarrative(e).then(function(e){t.editingNarrative=!1,angular.extend(t.narrative,e.data);var n=a.customers[e.data.customer_id];a.assocNarrativesWithCustomer(n,[e.data])})}function updateTimeline(e,n){i.storeTimeline(t.narrative._id,e).then(function(t){angular.extend(n,t),doneEditingTimeline()})}var r={accept:function(){return!0},dropped:function(e){var n=e.dest.index;n!==e.source.index&&(_updateSortOrder(n,t.narrative.timelines),_persistTimelineSortUpdate(t.narrative.timelines[n]))}};angular.extend(t,{toggleEditNarrativeModal:toggleEditNarrativeModal,toggleEditingTimeline:toggleEditingTimeline,doneEditingTimeline:doneEditingTimeline,toggleOwnership:toggleOwnership,toggleEpisodeList:toggleEpisodeList,updateNarrative:updateNarrative,updateTimeline:updateTimeline,addTmpTimeline:addTmpTimeline,onEpisodeSelect:onEpisodeSelect,persistTmpTimeline:persistTmpTimeline,editorAction:editorAction,deleteTimeline:deleteTimeline,exportToSpreadsheet:i.getNarrativeExportAsSpreadsheet,canAccess:!1,treeOpts:r}),function(){t.loading=!0,t.logout=e.logout,t.isOwner=!1,t.narrative=t.narrativeData,t.customers=t.customerData,t.user=n.user,(e.userHasRole("admin")||e.userHasRole("customer admin"))&&(t.canAccess=!0),t.loading=!1,_setTotalNarrativeDuration(t.narrative.timelines)}()}]}}function ittNarrativeEditor(){return{restrict:"EA",template:'\n<div class="narrative__edit">\n  <h2>Narrative Settings</h2>\n  <form name="nEditForm">\n    <div ng-show="$ctrl._containerInfo && $ctrl.canAccess">\n      <label for="nCustomer">Customer\n        <itt-validation-tip ng-if="nEditForm.customer.$invalid" text="A customer must be set"></itt-validation-tip>\n      </label>\n      <select id="nCustomer" name="customer" required ng-model="$ctrl.selectedCustomer"\n              ng-change="$ctrl.selectCustomer($ctrl.selectedCustomer)"\n              ng-options="cust.name for cust in $ctrl._customers track by cust._id"></select></br>\n    </div>\n    <div ng-if="$ctrl.selectedCustomer && $ctrl._containerInfo == null">\n      <h5>{{$ctrl.selectedCustomer.name}}</h5>\n    </div>\n    <label id="nName">Narrative Title\n      <itt-validation-tip ng-if="nEditForm.name.$invalid" text="Title is required"></itt-validation-tip>\n    </label>\n    <input for="nName" type="text" name="name" placeholder="Add Narrative Title"\n           ng-model="$ctrl._narrative.name.en" required>\n    <label for="nDescription">Description</label>\n    <textarea id="nDescription" name="description" placeholder="Add a Description"\n              ng-model="$ctrl._narrative.description.en"></textarea>\n    <div ng-if="!$ctrl.hidePathSlug">\n      <itt-guest-accessible-url narrative="$ctrl._narrative" sub-domain="{{$ctrl._narrative.narrative_subdomain}}"\n                                customer="$ctrl.selectedCustomer"></itt-guest-accessible-url>\n    </div>\n    <label for="nSupportUrl">Support Url\n      <itt-validation-tip ng-if="nEditForm.supportUrl.$invalid" text="Not a valid URL"></itt-validation-tip>\n    </label>\n    <input id="nSupportUrl" type="text" name="supportUrl" itt-valid-url placeholder="link for support"\n           ng-model="$ctrl._narrative.support_url"/>\n\n    <div class="narrative-flags">\n      <div>\n        <input id="nNewWindow" type="checkbox" ng-model="$ctrl._narrative.disable_new_window"/>\n        <label for="nNewWindow">Disable New Window</label>\n      </div>\n\n      <div>\n        <input id="nDisableNav" type="checkbox" ng-model="$ctrl._narrative.disable_navigation"/>\n        <label for="nDisableNav">Disable Navigation</label>\n      </div>\n\n      <div>\n        <input\n          id="nGuestAccess"\n          type="checkbox"\n          ng-change="$ctrl.guestAccessEffects()"\n          ng-model="$ctrl._narrative.guest_access_allowed"/>\n        <label for="nGuestAccess">Enable Guest Access</label>\n      </div>\n\n      <div ng-if="$ctrl.trueAdmin && $ctrl._narrative._id">\n        <input\n          id="socialshare-checkbox"\n          type="checkbox"\n          ng-disabled="$ctrl._narrative.disableSocialshare"\n          ng-model="$ctrl._narrative.enable_social_sharing"/>\n        <label for="socialshare-checkbox">Enable Socialshare</label>\n      </div>\n    </div>\n\n    <itt-enable-socialshare\n      ng-if="$ctrl.trueAdmin && $ctrl._narrative._id"\n      container-id="{{$ctrl.selectedCustomer.root_container_id}}"\n      narrative="$ctrl._narrative">\n    </itt-enable-socialshare>\n    <div class="ancillaryNav">\n      <button class="done" ng-click="$ctrl.handleUpdate($ctrl._narrative)"\n              ng-disabled="nEditForm.$invalid || $ctrl._narrative.error">Save\n      </button>\n      <button class="done" ng-click="$ctrl.onDone({$event: $event})">Cancel</button>\n    </div>\n  </form>\n</div>',scope:{narrative:"=?",customers:"=",containerInfo:"=?",hidePathSlug:"=?",onDone:"&",onUpdate:"&"},controllerAs:"$ctrl",bindToController:!0,controller:["ittUtils","authSvc","uploadsService",function(t,e,n){function guestAccessEffects(){null!=i._narrative&&(!1===i._narrative.guest_access_allowed?(i._narrative.enable_social_sharing=!1,i._narrative.disableSocialshare=!0):i._narrative.disableSocialshare=!1)}function selectCustomer(t){i.selectedCustomer=t}function handleUpdate(e){a(i.selectedCustomer)&&(e.customer_id=i.selectedCustomer._id);var s=["name","description","customer_id","guest_access_allowed","enable_social_sharing","narrative_image_ids","path_slug","support_url","disable_navigation","disable_new_window","_id"],r=t.pick(e,s),o=[];e.social_image_square&&o.push({file:e.social_image_square.file,tag:b}),e.social_image_wide&&o.push({file:e.social_image_wide.file,tag:x}),o.length>0?n.uploadTaggedFiles(o,i.selectedCustomer.root_container_id).then(function(t){t.forEach(function(t){return r.narrative_image_ids.push(t.file._id)}),n.resetUploads(),i.onUpdate({n:r})}):a(i._containerInfo)?i.onUpdate({data:{n:r,c:i._containerInfo.containerId}}):i.onUpdate({n:r})}function _setNameFromContainer(){a(i._containerInfo)&&(a(i._narrative)?i._narrative.name=i._containerInfo.name:i._narrative={name:i._containerInfo.name})}function _setCustomer(){if(1===i._customers.length)i.selectedCustomer=i._customers[0];else if(a(i._narrative)||a(i._containerInfo)){var t=a(i._containerInfo)&&i._containerInfo.customerId||i._narrative.customer_id;i.selectedCustomer=i._customers.filter(function(e){return e._id===t})[0]}else i._customers.unshift({name:"Select a Customer"})}var i=this,a=t.existy;angular.extend(i,{trueAdmin:e.userHasRole("admin"),canAccess:e.userHasRole("admin")||e.userHasRole("customer admin"),_narrative:angular.copy(i.narrative),_customers:angular.copy(i.customers),_containerInfo:angular.copy(i.containerInfo),selectedCustomer:null,handleUpdate:handleUpdate,selectCustomer:selectCustomer,guestAccessEffects:guestAccessEffects}),function(){_setNameFromContainer(),_setCustomer(),guestAccessEffects()}()}]}}function ittNarrativeList(){return{restrict:"A",replace:!0,templateUrl:"templates/narrativelist.html",scope:{customersData:"="},controller:["$location","authSvc","appState","dataSvc","modelSvc","ittUtils",function(t,e,n,i,a,s){function toggleNarrativeRow(t,e){e.stopPropagation(),null===r.narrativeRow?r.narrativeRow=t:t===r.narrativeRow?r.narrativeRow=null:r.narrativeRow=t,r.customersData.forEach(function(t){t.isActive=!1})}function closeAddOrEditModal(e){r.narrativeSelect=!1,r.selectedCustomer=[],r.narrativeToEdit=!1,e&&t.path("/story/"+e._id)}function handleErr(t){t.data.path_slug&&(r.narrativeToEdit.error="path slug is already taken")}function addOrUpdateNarrative(t){var e="";!0===r.narrativeSelect?e="createNarrative":"[object Object]"===Object.prototype.toString.call(t)&&(e="updateNarrative"),_addOrUpdateNarr(t,e).then(closeAddOrEditModal).catch(function(t){handleErr(t)})}function setSelectedNarrative(t){var e=s.existy(t.narratives)&&t.narratives.length>1;r.selectedCustomer=[t],e?r.narrativeSelect=!r.narrativeSelect:i.getNarrativeList(t).then(function(){r.narrativeSelect=!r.narrativeSelect})}function setNarrativeToEdit(t,e,n){t.stopPropagation(),r.narrativeToEdit=e,r.selectedCustomer=[n]}function setRowClasses(t){return{hoverIndicator:!t.showNarratives,"container__row--even":!1===t.evenOdd,"container__row--odd":!0===t.evenOdd,isActive:t.isActive}}function setNarrativeRowClasses(t,e){return{hoverIndicator:t.showNarratives,"container__row--even":!1===e.evenOdd,"container__row--odd":!0===e.evenOdd,isActive:e===r.narrativeRow}}function gotoNarrative(e,n){n.stopPropagation(),t.path("/story/"+e)}function customerRowClick(t,e){e.stopPropagation(),t.isActive=!t.isActive,r.narrativeRow=null,r.customersData.forEach(function(e){t._id!==e._id&&(e.isActive=!1)})}function toggleRow(t,e){e.stopPropagation(),t.showNarratives=!t.showNarratives,t.showNarratives?_toggleNarrativesOpened(t):(t.showNarratives=!1,_toggleNarrativesClosed())}function _addOrUpdateNarr(t,e){return i[e](t).then(function(t){var n=t.data,i=a.customers[n.customer_id];i=a.assocNarrativesWithCustomer(i,[n]);var s=r.customersData.filter(function(t){return t._id===i._id});if(1===s.length&&(_updateNarrativeEvenOdd(i),s[0]=i,"createNarrative"===e))return n})}function _toggleNarrativesClosed(){_updateAllEvenOdd()}function _toggleNarrativesOpened(t){o(t.narratives)&&0!==t.narratives.length||_fetchAndCacheNarratives(t),o(t.narratives)&&t.narratives.length>=1&&_updateAllEvenOdd()}function _fetchAndCacheNarratives(t){i.getNarrativeList(t).then(function(){_updateAllEvenOdd()})}function _updateAllEvenOdd(){for(var t=1,e=r.customersData.length;t<=e;t++){t-1==0&&(r.customersData[0].evenOdd=!1);var n=r.customersData[t],i=r.customersData[t-1],a=null;if(o(i.narratives)&&i.narratives.length>0&&!0===i.showNarratives&&(_updateNarrativeEvenOdd(i),a=i.narratives[i.narratives.length-1]),!o(n))return;o(a)?n.evenOdd=!a.evenOdd:n.evenOdd=!i.evenOdd}}function _updateNarrativeEvenOdd(t){t.narratives=t.narratives.sort(function(t,e){var n=t.name.en.toLowerCase(),i=e.name.en.toLowerCase();return n<i?-1:n>i?1:0}).reduce(function(e,n,i){return 0===i?(n.evenOdd=!t.evenOdd,e.push(n),e):(n.evenOdd=!e[i-1].evenOdd,e.push(n),e)},[])}var r=this,o=s.existy;angular.extend(r,{narrativeSelect:!1,narrativeRow:null,logout:e.logout,user:n.user,setSelectedNarrative:setSelectedNarrative,customerRowClick:customerRowClick,gotoNarrative:gotoNarrative,toggleRow:toggleRow,setRowClasses:setRowClasses,setNarrativeRowClasses:setNarrativeRowClasses,setNarrativeToEdit:setNarrativeToEdit,closeAddOrEditModal:closeAddOrEditModal,addOrUpdateNarrative:addOrUpdateNarrative,toggleNarrativeRow:toggleNarrativeRow}),function(){(e.userHasRole("admin")||e.userHasRole("customer admin"))&&(r.canAccess=!0),_updateAllEvenOdd()}()}],controllerAs:"$ctrl",bindToController:!0}}function ittNarrativeTimeline(t,e,n,i,a,s){return{restrict:"A",replace:!0,templateUrl:"templates/player-timeline.html",link:function(r){i.init(),n.getNarrative(t.narrativePath).then(function(e){i.narrativeId=e._id,r.narrative=e;var n=a.getRoleForNarrative(e._id),o=a.getDefaultProductForRole(n),l=Object.create(null),c="",d="";i.product=o,angular.forEach(e.timelines,function(e){e._id!==t.timelinePath&&e.path_slug.en!==t.timelinePath||(l=e,c=e.name.en,d=e._id,i.timelineId=e._id,e.episode_segments[0]&&(i.episodeId=e.episode_segments[0].episode_id,i.episodeSegmentId=e.episode_segments[0]._id,r.showPlayer=!0))});var p=e.path_slug.en,m=l.path_slug.en,u=e.narrative_subdomain;!0===e.enable_social_sharing&&!0===r.enableSocialSharing&&(r.socialShareInfo={subDomain:u,tlTitle:c,narrative:p,timeline:{url:m,id:d}}),i.episodeId||s.error({data:"Sorry, no episode was found in this timeline."})}),function(){r.enableSocialSharing=!/api-dev|np-dev|demo/.test(e.host())}()}}}function ittNav(){return{restrict:"EA",scope:{onLogout:"&",inPlayer:"=?"},template:'\n      <div>\n      \t<header class="nav__header">\n      \t\t<div class="nav__item">\n      \t\t\t<img ng-if="!$ctrl.inPlayer" ng-src="{{::$ctrl.bannerImg}}"/>\n      \t\t\t<img ng-if="$ctrl.inPlayer" ng-src="{{::$ctrl.logo}}"/>\n      \t\t</div>\n      \t\t<div class="nav__item" ng-if="$ctrl.appState.user._id">\n      \t\t\t<div class="nav__controls">\n      \t\t\t\t<div class="navControls__item item--left">\n      \t\t\t\t\t<div class="nav__user" ng-click="$ctrl.goToAccounts()">\n      \t\t\t\t\t\t<img ng-src="{{$ctrl.appState.user.avatar || $ctrl.noAvatar}}">\n      \t\t\t\t\t\t<a class="nav__button" ng-if="$ctrl.appState.user">{{$ctrl.appState.user.name}}</a>\n      \t\t\t\t\t</div>\n      \t\t\t\t\t<a class="nav__button" ng-if="$ctrl.currentPath !== \'/projects\' && $ctrl.canAccess" href="/#/projects">My Projects</a>\n      \t\t\t\t\t<a class="nav__button" ng-if="$ctrl.currentPath !== \'/stories\' && $ctrl.canAccess" href="/#/stories">My Narratives</a>\n      \t\t\t\t</div>\n      \t\t\t\t<div class="navControls__item item--right">\n      \t\t\t\t\t<a class="nav__button" ng-click="$ctrl.onLogout()">Log out</a>\n      \t\t\t\t\t<a class="nav__button"  ng-if="$ctrl.canAccess" target="_blank" rel="noopener noreferrer" href="https://support.narrasys.com">Help</a>\n      \t\t\t\t<div>\n      \t\t\t</div>\n      \t\t</div>\n      \t</header>\n      </div>\n      ',controller:["$location","appState","authSvc",function(t,e,n){function goToAccounts(){i.canAccess&&t.url("/account")}var i=this;i.currentPath=t.path(),i.appState=e,i.goToAccounts=goToAccounts,i.bannerImg=W,i.noAvatar=e.noAvatarImg,i.logo=K,n.authenticate().then(function(){i.canAccess=n.userHasRole("admin")||n.userHasRole("customer admin")||n.userHasRole("instructor")})}],controllerAs:"$ctrl",bindToController:!0}}function ittOptionsDisabled(t){function _disableOptions(t,e,n,i,a){for(var s,r=n.find("option"),o=0,l=0,c=r.length;o<c;o++){var d=angular.element(r[o]);""!=d.val()&&(s={},s[e]=i[l],d.attr("disabled",a(t,s)),l++)}}function link(e,n,i){var a=i.ittOptionsDisabled.match(/^\s*(.+)\s+for\s+(.+)\s+in\s+(.+)?\s*/),s=a[3],r=t(a[1]);e.$watch(s,function(t){t&&_disableOptions(e,a[2],n,t,r)},!0),e.$watch(i.ngModel,function(i){var o=t(s)(e);i&&_disableOptions(e,a[2],n,o,r)})}return{restrict:"EA",priority:0,require:"ngModel",link:link}}function ittQuestionOptions(){return{restrict:"EA",scope:!0,template:['<div class="field"><div class="label">Answers</div></div>','<div class="field" ng-repeat="distractor in item.data._plugin.distractors track by $index">','\t<div class="label">',"\t\t{{$index | alpha}} &nbsp;",'\t\t<input type="checkbox" ng-model="distractor.correct" ng-change="onFormativeChecked(distractor)" ng-if="item.data._plugin.questiontype == \'mc-formative\'">',"\t</div>",'\t<div class="input" sxs-input-i18n="distractor.text" x-inputtype="\'textarea\'"></div>',"</div>",'<div class="field">','\t<div class="input">','\t\t<button ng-click="addDistractor($event)">Add distractor</button>',"\t</div>","</div>",'<div class="field" ng-if="item.data._plugin.questiontype == \'mc-formative\'">','\t<div class="label">Feedback when correct</div>','\t<div class="input" sxs-input-i18n="item.data._plugin.correctfeedback" x-inputtype="\'textarea\'"></div>',"</div>",'<div class="field" ng-if="item.data._plugin.questiontype == \'mc-formative\'">','\t<div class="label">Feedback when incorrect</div>','\t<div class="input" sxs-input-i18n="item.data._plugin.incorrectfeedback" x-inputtype="\'textarea\'"></div>',"</div>"].join(" ")}}function ittQuestionTextField(){return{restrict:"EA",scope:{data:"=",doValidate:"=?",ittItemForm:"=?"},template:['<div class="field">','\t<div class="label">Question text','\t\t<itt-validation-tip ng-if="$ctrl.ittItemForm[$ctrl.textAreaName].$invalid" text="Question Text is a required field"></itt-validation-tip>',"\t</div>",'\t<div class="input" do-validate="$ctrl.doValidate" on-emit-name="$ctrl.onName($taName)" sxs-input-i18n="$ctrl.data.data._plugin.questiontext" x-inputtype="\'textarea\'"></div>',"</div>"].join(" "),controller:[function(){function onName(e){t.textAreaName=e}var t=this;t.onName=onName}],controllerAs:"$ctrl",bindToController:!0}}function ittQuestionTypeSelect(){return{restrict:"EA",scope:{data:"="},template:['<div class="field">','\t<div class="label">Template</div>','\t<div class="input">','\t<select ng-model="$ctrl.data.data._plugin.questiontype" ng-options="{{$ctrl.setNgOpts(\'questionType\')}}"></select>',"\t</div>","</div>"].join(" "),controller:["selectService","ittUtils",function(t,e){var n=this;n.setNgOpts=e.setNgOpts,n.getSelectOpts=t.getSelectOpts,function(){t.onSelectChange(n.data,{})}()}],controllerAs:"$ctrl",bindToController:!0}}function ittReviewMode(t,e){return{restrict:"A",replace:!1,scope:{allScenes:"=ittReviewMode"},templateUrl:"templates/episode/components/reviewmode-scenes.html",link:function(n){n.appState=e,n.scenes=[];var i=0;n.isLoading=!0;var a=[1,2,3,5,8,13,21,34,55,89,144,233,377,610,987,1/0];n.addOne=function(){if(i++,n.allScenes)n.scenes=n.allScenes.slice(0,a[i]),i<n.allScenes.length?t(n.addOne,100):(n.isLoading=!1,n.scenes=n.allScenes);else var e=n.$watch(function(){return n.allScenes},function(){n.allScenes&&(e(),n.addOne())})},t(n.addOne,100)}}}function ittRouteLoading(){return{restrict:"EA",template:['<div ng-if="routeLoadingCtrl.isLoading" class="loading routeLoading">','\t<div class="spinner">','\t\t<div class="rotating pie"></div>','\t\t<div class="filler pie"></div>','\t\t<div class="mask"></div>','\t</div><span class="loading__text">Loading</span>',"</div>"].join(" "),scope:{isLoading:"=?"},controller:["$rootScope","$scope","$timeout","errorSvc",function(t,e,n,i){var a=this;a.isLoading=a.isLoading||!1;var s;t.$on("$routeChangeStart",function(){s=n(function(){a.isLoading=!0},500)}),t.$on("$routeChangeSuccess",function(){n.cancel(s),a.isLoading=!1}),t.$on("$locationChangeSuccess",function(){n.cancel(s),a.isLoading=!1}),t.$on("$routeChangeError",function(){n.cancel(s),a.isLoading=!1}),e.$watch(function(){return i.errors.length},function(t,e){t!==e&&t>0&&(n.cancel(s),a.isLoading=!1)})}],controllerAs:"routeLoadingCtrl",bindToController:!0}}function ittScene(t,e){return{restrict:"A",replace:!1,scope:{scene:"=ittScene",episode:"=episode"},template:'<span ng-include="scene.templateUrl"></span>',controller:"SceneController",link:function(n,i){"review"!==e.viewMode&&window.scrollTo(0,0),n.precalculateSceneValues(),n.appState=e;var a=function(){if(null===i.find(".videoMagnet img").height())var t=n.$watch(function(){return i.find(".videoMagnet img").height()},function(e){e>0&&(t(),a())});else{i.find(".matchVideoHeight:visible").each(function(){$(this).css("height",i.find(".videoMagnet img").height())});var e=angular.element(window).height()-$("#CONTAINER").scrollTop();i.find(".stretchToViewport:visible").each(function(){$(this).css("min-height",e-$(this).offset().top)}),i.find(".stretchToViewportShort:visible").each(function(){$(this).css("min-height",e-$(this).offset().top-210)})}i.find(".content").each(function(){var t=$(this);t.outerWidth()>550?t.addClass("allowSidebars"):t.removeClass("allowSidebars")})};n.unwatch=n.$watch(function(){return{winWidth:e.windowWidth,winHeight:e.windowHeight,newMode:e.viewMode}},function(t){"discover"===t.newMode&&n.scene.isCurrent&&a()},!0),n.unwatchEdits=n.$watch(function(){return e.editEvent},n.precalculateSceneValues,!0),n.safetyBelt=t(a,1321),n.$on("$destroy",function(){n.unwatch(),n.unwatchEdits(),t.cancel(n.safetyBelt)})}}}function ittSearchPanel(t){return{restrict:"A",replace:!0,scope:!0,templateUrl:"templates/searchpanel.html",controller:"SearchPanelController",link:function(e){e.appState=t,e.indexEvents()}}}function ittShowFocus(t){return function(e,n,i){e.$watch(i.ittShowFocus,function(e){t(function(){e&&n.filter(":visible").first().focus()})},!0)}}function ittShowHideVisualOnly(t){return{restrict:"A",multiElement:!0,link:function(e,n,i){e.$watch(i.ittShowHideVisualOnly,function(e){e?t.removeClass(n,"visual-hide"):t.addClass(n,"visual-hide")})}}}function visualHideAnimation(){return{addClass:function(t){t.fadeTo("slow",0,function(){})},removeClass:function(t){t.fadeTo("slow",1,function(){})}}}function ittSpeakerField(){return{restrict:"EA",template:'\n      <div class="field" ng-if="selectService.getVisibility(\'speakerField\')">\n      \t<div class="label">Speaker [{{appState.lang}}]</div>\n      \t<div class="input">\n      \t\t<div sxs-annotator-autocomplete="annotators" item="item" ng-model="item.annotator"></div>\n      \t</div>\n      </div>'}}function ittSpeakerThumbField(){return{restrict:"EA",template:['<div class="field">','\t<div class="label">Speaker thumbnail</div>','\t<div class="input" ng-include="\'templates/producer/upload-producer.html\'"></div>',"</div>"].join(" ")}}function ittTabs(){return{template:['<div class="">','\t<ul class="nav nav-tabs">','\t\t<li ng-repeat="pane in panes" class="tab-pane"><p class="ittTabLabel" ng-class="{cur:pane.selected}" ng-click="select(pane)">{{pane.title}}</p></li>',"\t</ul>",'\t<div class="tab-content"><ng-transclude></ng-transclude></div>',"</div>"].join(""),transclude:!0,restrict:"EA",scope:{},controller:["$scope",function(t){function select(t){angular.forEach(e,function(t){t.selected=!1}),t.selected=!0}var e=t.panes=[];t.select=select,this.addPane=function(t){0===e.length&&select(t),e.push(t)}}]}}function ittTab(){return{template:'<div ng-show="selected"><ng-transclude></ng-transclude></div>',require:"^^ittTabs",transclude:!0,scope:{title:"@"},link:function(t,e,n,i){i.addPane(t)}}}function ittTemplateSelect(){return{restrict:"EA",scope:{data:"=",itemForm:"=?"},template:['<div class="field" ng-if="$ctrl.isVisible(\'templateSelect\')">','\t<div class="label">{{$ctrl.labelText}}</div>',"\t<div class=\"input\" ng-class=\"{layouts: $ctrl.labelText === 'Template' && $ctrl.data.producerItemType === 'scene'}\">",'\t\t<select ng-model="$ctrl.data.templateUrl" ng-change="$ctrl.onSelectChange($ctrl.data, $ctrl.itemForm)" ng-options="option.url as option.name for option in $ctrl.data.templateOpts" itt-options-disabled="option.isDisabled for option in $ctrl.data.templateOpts"></select>',"\t</div>","</div>"].join(" "),controller:["selectService","modelSvc",function(t,e){var n=this;n.isVisible=t.getVisibility,n.onSelectChange=t.onSelectChange,n.getSelectOpts=t.getSelectOpts,n.labelText="Template";var i,a,s,r="annotation"===n.data.producerItemType;r&&(i=t.getSceneName(e.scene(n.data.scene_id)),a="centerVV"===i,s="centerVVMondrian"===i,(a||s)&&angular.forEach(n.data.templateOpts,function(t){"Header 1"===t.name&&(t.isDisabled=!0)})),n.data.hasOwnProperty("producerItemType")||(n.data.producerItemType="episode",n.labelText="Theme")}],controllerAs:"$ctrl",bindToController:!0}}function ittTimeField(){return{restrict:"EA",scope:!0,template:['<div class="field" ng-if="!(item._type===\'Scene\' && item.start_time <= 0.1)">','\t<div class="label">Start</div>','\t<div class="input">','  <itt-validation-tip ng-if="ittItemForm.time.$invalid" text="{{item.validationMessage}}"></itt-validation-tip>','\t\t<span sxs-input-time="item" x-input-field="start_time"></span>',"\t\t<span ng-if=\"!(item.stop || item._type === 'Scene' || item._type === 'Chapter')\">",'\t\t\t<span class="label"> &nbsp; &nbsp; &nbsp; End</span>','\t\t\t<span sxs-input-time="item" x-input-field="end_time"></span>',"\t\t</span>","\t</div>","</div>"].join(" ")}}function ittTimeline(t,e,n,i,a){return{restrict:"A",replace:!0,scope:!0,templateUrl:"templates/timeline-story.html",controller:"TimelineController",link:function(s,r){function adjustHigh(t){return t>98?100:t}function adjustLow(t){return t<3?0:t}function incrementVolume(t){var e=s.currentVolume()+t;e=adjustHigh(e),"function"==typeof s.setVolume&&s.setVolume(e)}function decrementVolume(t){var e=s.currentVolume()-t;e=adjustLow(e),"function"==typeof s.setVolume&&s.setVolume(e)}s.appState=e,s.timeline=n,s.handlePosition=0,s.zoomLevel=1,s.zoomOffset=0,e.isTouchDevice&&!a.getMetaProp("hasBeenPlayed")&&(s.isSuppressed=!0);var o,l,c=s.$watch(function(){return a.getMetaProp("hasBeenPlayed")},function(t){!0===t&&(s.isSuppressed=!1,c())});t(function(){o=r.find(".progressbarContainer"),l=r.find(".progressbar"),f()}),s.autoZoom=function(t){s.savedZoomLevel=s.zoomLevel;var e=t.end_time-t.start_time,n=a.getMetaProp("duration")-t.end_time;s.zoomLevel=Math.min(Math.max(Math.round(.6*n/e),1),20),m()},s.endAutoZoom=function(){s.savedZoomLevel&&(s.zoomLevel=s.savedZoomLevel,m(),delete s.savedZoomLevel)};var d=s.$watch(function(){return e.editEvent},function(t){"producer"===e.product&&(t?s.autoZoom(t):s.endAutoZoom())});s.appState=e,s.setNewLanguage=function(){i.setLanguageStrings()},s.showSceneMenuTooltip=function(t){t&&!e.isTouchDevice?s.sceneMenuToolTip=!0:s.sceneMenuToolTip=!1},s.prevScene=function(){n.prevScene()},s.nextScene=function(){n.nextScene()},s.userChangingVolume=function(t){a.getMetaProp("muted")&&s.toggleMute();var e=angular.element(t.currentTarget),n=function(t,n){var i=(t.clientX-e.offset().left)/e.width()*100;i>98&&(i=100),i<3&&(i=0),n?s.setVolume(i):s.$apply(s.setVolume(i))};n(t,!0),e.bind("mousemove.volume",n),angular.element(document).bind("mouseup.volume",function(){angular.element(document).unbind("mouseup.volume"),e.unbind("mousemove.volume")})};var p={PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFTARROW:37,UPARROW:38,RIGHTARROW:39,DOWNARROW:40};s.onVolumeKeyDown=function(t){var e=t,n=!0;switch(e.keyCode){case p.LEFTARROW:decrementVolume(1),n=!1;break;case p.RIGHTARROW:case p.UPARROW:incrementVolume(1),n=!1;break;case p.DOWNARROW:decrementVolume(1),n=!1;break;case p.PAGEUP:incrementVolume(10),n=!1;break;case p.PAGEDOWN:decrementVolume(10),n=!1;break;case p.HOME:decrementVolume(100),n=!1;break;case p.END:incrementVolume(100),n=!1;break;default:n=!0}n||(t.stopPropagation(),t.preventDefault())},s.currentVolume=function(){return a.getMetaProp("muted")?0:a.getMetaProp("volume")},s.audioIcon=function(){return a.getMetaProp("muted")?"muted":"vol"+Math.floor(a.getMetaProp("volume")/34)},s.showTooltip=function(t){t.showTooltip=!0},s.hideTooltip=function(t){t.showTooltip=!1},s.zoomIn=function(){s.stopWatching=!0,s.zoomLevel=s.zoomLevel+1,m()},s.zoomOut=function(){s.stopWatching=!0,s.zoomLevel<=2?s.zoomLevel=1:s.zoomLevel<=3?s.zoomLevel=1.5:s.zoomLevel=s.zoomLevel/2,m()};var m=function(){s.zoomOffset=-(s.zoomLevel-1)*(a.getMetaProp("time")/a.getMetaProp("duration")),o.stop().animate({left:100*s.zoomOffset+"%",width:100*s.zoomLevel+"%"},1e3,function(){s.stopWatching=!1})};s.$watch(function(){return{t:a.getMetaProp("time"),d:a.getMetaProp("duration")}},function(){s.stopWatching||(s.zoomOffset=-(s.zoomLevel-1)*(a.getMetaProp("time")/a.getMetaProp("duration")),o&&o.css({left:100*s.zoomOffset+"%"}))},!0);var u=function(n){a.pauseOtherPlayers(),t(function(){s.seekHandleVisible=!0},250),s.isSeeking=!0;var i=e.isTouchDevice?"touchend.timeline":"mouseup.timeline";l.bind(i,function(){v()}),angular.element(document).bind(i,function(){h()}),g(n)};s.$watch(function(){return a.getMetaProp("time")},function(){e.editEvent&&(s.willSeekTo=a.getMetaProp("time"))});var g=function(t){if(s.isSeeking){var e=a.getMetaProp("duration");s.willSeekTo=(t.clientX-o.offset().left)/o.width()*e,s.willSeekTo<0&&(s.willSeekTo=0),s.willSeekTo>e&&(s.willSeekTo=e)}},v=function(){s.stopWatching=!0,s.enableAutoscroll(),n.seek(s.willSeekTo,"scrubTimeline"),m()},h=function(){angular.element(document).off("mouseup.timeline"),angular.element(document).off("touchend.timeline"),l.off("mouseup.timeline"),l.off("touchend.timeline"),t(function(){s.isSeeking=!1,s.seekHandleVisible=!1})},f=function(){var t=$(r.find(".playhead"));e.isTouchDevice?(t.on("touchstart.timeline",function(t){u(t.originalEvent.targetTouches[0]),t.preventDefault()}),t.on("touchmove.timeline",function(t){g(t.originalEvent.targetTouches[0]),t.preventDefault()})):(t.on("mousedown.timeline",function(t){u(t),t.preventDefault()}),t.on("mousemove.timeline",function(t){g(t),t.preventDefault()}))};s.$on("$destroy",function(){h(),d()})}}}function ittTimelineEditor(){return{restrict:"EA",template:'\n<div class="timeline__edit">\n  <form name="tlEditForm">\n    <label for="tlName">Name\n      <itt-validation-tip ng-if="tlEditForm.name.$invalid" text="Name is required"></itt-validation-tip>\n    </label>\n    <input type="text" name="name" ng-model="$ctrl._timeline.name.en" id="tlName" required>\n    <label for="tlDescription">Description</label>\n    <textarea id="tlDescription" name="description" placeholder="Insert Description..."\n              ng-model="$ctrl._timeline.description.en"></textarea>\n    <itt-guest-accessible-url narrative="$ctrl.narrative" timeline="$ctrl._timeline"></itt-guest-accessible-url>\n    <label>Hidden</label>\n    <input type="checkbox" ng-model="$ctrl._timeline.hidden"/>\n    <itt-enable-socialshare\n      ng-if="$ctrl.trueAdmin"\n      narrative="$ctrl.narrative"\n      container-id="{{$ctrl.containerId}}"\n      timeline="$ctrl._timeline">\n    </itt-enable-socialshare>\n    <div class="ancillaryNav">\n      <button class="button" ng-disabled="tlEditForm.$invalid || $ctrl._timeline.error"\n              ng-click="$ctrl.handleUpdate($ctrl._timeline)">Save\n      </button>\n      <button class="button" ng-click="$ctrl.confirmDelete()">Delete</button>\n      <button class="button" ng-click="$ctrl.onDone()">Cancel</button>\n    </div>\n  </form>\n</div>\n<itt-modal modal-class="timeline__delete" ng-if="$ctrl.underDelete">\n  <h2>Are you sure?</h2>\n  <p>delete: </p>\n  <p class="under__delete"><strong>{{$ctrl._timeline.name.en}}?</strong></p>\n  <button ng-click="$ctrl.onDelete($ctrl._timeline)">yes</button>\n  <button ng-click="$ctrl.underDelete = false">no</button>\n</itt-modal>',scope:{timeline:"=",narrative:"=",containerId:"@?",onUpdate:"&",onDelete:"&",onDone:"&"},controller:["$location","ittUtils","config","uploadsService","authSvc",function(t,e,n,i,a){function handleUpdate(t){var e=["_id","name","description","hidden","sort_order","path_slug","episode_segments","timeline_image_ids"],n=pick(t,e),a=[];t.social_image_square&&a.push({file:t.social_image_square.file,tag:b}),t.social_image_wide&&a.push({file:t.social_image_wide.file,tag:x}),a.length>0?i.uploadTaggedFiles(a,s.containerId).then(function(t){t.forEach(function(t){return n.timeline_image_ids.push(t.file._id)}),i.resetUploads(),s.onUpdate({t:n})}):s.onUpdate({t:n})}function confirmDelete(){s.underDelete=!0}var s=this,r=e.existy;s.confirmDelete=confirmDelete,s.handleUpdate=handleUpdate,s.underDelete=!1,s.trueAdmin=a.userHasRole("admin"),function(){s.host=t.protocol()+":"+n.apiDataBaseUrl,r(s.timeline)&&!0===s.timeline.isTemp?s._timeline=s.timeline:s._timeline=angular.copy(s.timeline)}()}],controllerAs:"$ctrl",bindToController:!0}}function ittTimestampSelect(){return{restrict:"EA",scope:!0,template:['<div class="field">','\t<div class="label"><span ng-if="episode">Display </span>Timestamp</div>','\t<div class="input">','\t\t<select size="1" ng-model="itemForm.timestamp">','\t\t\t<option ng-if="episode" value="">(Default)</option>','\t\t\t<option ng-if="item._type === \'Scene\'" value="">(Inherit from episode)</option>','\t\t\t<option ng-if="item._type !== \'Scene\'" value="">(Inherit from layout)</option>','\t\t\t<option value="None">Off</option>','\t\t\t<option value="Inline">On</option>',"\t\t</select>","\t</div>","</div>"].join(" ")}}function ittTitleField(){return{restrict:"EA",scope:{data:"=",modelOpts:"=?",doValidate:"=?",ittItemForm:"=?"},template:['<div class="field" ng-if="$ctrl.isVisible(\'titleField\')">','\t<div class="label">Title [{{$ctrl.appState.lang}}]','\t\t<itt-validation-tip ng-if="$ctrl.ittItemForm[$ctrl.textAreaName].$invalid" text="Title is a required field"></itt-validation-tip>',"\t</div>",'\t<div class="input" ng-model-options="$ctrl.modelOpts" do-validate="$ctrl.doValidate" sxs-input-i18n="$ctrl.data.title" on-emit-name="$ctrl.onName($taName)" x-inputtype="\'input\'" autofocus></div>',"</div>"].join(" "),controller:["appState","ittUtils","selectService",function(t,e,n){function onName(t){i.textAreaName=t}var i=this;i.appState=t,i.isVisible=n.getVisibility,i.onName=onName,e.existy(i.modelOpts)||(i.modelOpts={updateOn:"default"})}],controllerAs:"$ctrl",bindToController:!0}}function ittToolbarStory(){return{scope:!0,templateUrl:"templates/toolbar-story.html"}}function ittTooltip(){return{restrict:"EA",transclude:!0,scope:{tipText:"@",css:"@?"},template:['<span class="ittTooltip">',"\t<ng-transclude></ng-transclude>",'\t<span ng-if="showTip" class="{{css ? css : \'ittTooltip__text\'}}" style="text-indent: 0;">{{tipText}}</span>',"</span>"].join(""),link:function(t,e){function onMouseenter(){t.$apply(function(){t.showTip=!0})}function onMouseleave(){t.$apply(function(){t.showTip=!1})}e.mouseenter(onMouseenter),e.mouseleave(onMouseleave)}}}function ittTranscriptField(){return{restrict:"EA",scope:{data:"=",ittItemForm:"="},template:['<div class="field">','\t<div class="label">Transcript [{{$ctrl.appState.lang}}]','\t\t<itt-validation-tip ng-if="$ctrl.ittItemForm[$ctrl.textAreaName].$invalid" text="Transcript is a required field"></itt-validation-tip>',"\t</div>",'\t<div class="input" sxs-input-i18n="$ctrl.data.annotation" do-validate="true" x-inputtype="\'textarea\'" on-emit-name="$ctrl.onName($taName)" autofocus></div>',"</div>"].join(" "),controller:["appState",function(t){function onName(t){e.textAreaName=t}var e=this;e.onName=onName,e.appState=t,e.textAreaName=""}],controllerAs:"$ctrl",bindToController:!0}}function ittTransitionSelect(){return{restrict:"EA",template:['<div class="field">','\t<div class="label">Transition</div>','\t<div class="input">','\t\t<select size="1" ng-model="itemForm.transition">','\t\t\t<option ng-if="episode" value="">(Default)</option>','\t\t\t<option ng-if="item._type === \'Scene\'" value="">(Inherit from episode)</option>','\t\t\t<option ng-if="item._type !== \'Scene\' && !episode" value="">(Inherit from layout)</option>','\t\t\t<option value="None">No transition</option>','\t\t\t<option value="Fade">Fade</option>','\t\t\t<option value="SlideL">Slide left</option>','\t\t\t<option value="SlideR">Slide right</option>','\t\t\t<option value="Pop">Pop</option>',"\t\t</select>","\t</div>","</div>"].join(" ")}}function ittTypographySelect(){return{restrict:"EA",template:['<div class="field">','\t<div class="label">Typography</div>','\t<div class="input">','\t\t<select size="1" ng-model="itemForm.typography">','\t\t\t<option value="">(Default)</option>','\t\t\t<option value="Sans">Sans</option>','\t\t\t<option value="Serif">Serif</option>','\t\t\t<option value="Book">Book</option>','\t\t\t<option value="Swiss">Swiss</option>',"\t\t</select>","\t</div>","</div>"].join(" ")}}function ittUrlField(){return{restrict:"EA",scope:{data:"=",context:"@?",label:"@",onAttach:"&",ittItemForm:"<?"},template:'\n<div class="field">\n  <div class="label">{{$ctrl.label || "URL"}}\n    <span ng-repeat="(field, val) in $ctrl.validatedFields">\n      <itt-validation-tip ng-if="val.showInfo" text="{{val.message}}" do-info="val.doInfo"></itt-validation-tip>\n     </span>\n  </div>\n  <div class="input" ng-if="$ctrl.context !== \'episode\'">\n    <div ng-if="$ctrl.canEmbed" class="ittUrl__escapeLink">\n\n      <input\n        id="urlEscapeLink"\n        type="checkbox"\n        ng-change="$ctrl.updateTemplateOpts()"\n        ng-true-value="\'_blank\'"\n        ng-false-value="\'_self\'"\n        ng-model="$ctrl.data.target"/>\n      <span class="escapelink"></span>\n      <label for="urlEscapeLink">Force new tab</label>\n\n    </div>\n    <input\n      type="text"\n      name="itemUrl"\n      ng-model="$ctrl.data.url"\n      ng-model-options="{ updateOn: \'blur\' }"/>\n  </div>\n  <div class="input" ng-if="$ctrl.context === \'episode\'">\n    <input\n      type="text"\n      ng-model="$ctrl.data"\n      itt-valid-episode-url\n      on-validation-notice="$ctrl.handleEpisodeValidationMessage($notice)"/>\n    <button ng-if="$ctrl.data" ng-click="$ctrl.onAttach({$url: $ctrl.data})">Attach Video</button>\n  </div>\n</div>',controller:["$scope","$q","ittUtils","validationSvc",function(t,e,n,i){function $onInit(){null==a.context&&(a.context="producer"),"episode"!==a.context&&("string"!=typeof a.data&&"https://"!==a.data.url&&itemUrlValidationPipeline(a.data.url,a.data.url_status,a.context),subscribeWatch())}function $onDestroy(){"episode"!==a.context&&unsubscribeWatch()}function subscribeWatch(){l=t.$watch(watchItemUrl,handleChanges)}function unsubscribeWatch(){l()}function updateTemplateOpts(){a.data.templateOpts=_disableTemplateOpts("_blank"===a.data.target)}function watchItemUrl(){return a.data.url}function handleChanges(t,e){if("https://"===t)return void _setValidity(!1);t!==e&&itemUrlValidationPipeline(t,null,a.context)}function itemUrlValidationPipeline(t,e,n){_resetFields(),_setValidity(i.validateUrl(t,a))&&inspectHeaders(t,e,n)}function inspectHeaders(t,e,n){return z(this,void 0,void 0,function(){var r,o,l,d,p,m;return G(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,i.inspectHeadersAsync(t,a,e,n)];case 1:return r=u.sent(),o=r.canEmbed,l=r.location,d=r.urlStatus,_setValidity(!0),p=i.mixedContent(l||t,a),a.canEmbed=o&&!p,a.data.templateOpts=_disableTemplateOpts(!a.canEmbed),a.data.url_status=Object.assign(new c,d),s(l)&&(unsubscribeWatch(),a.data.url=l,subscribeWatch()),[3,3];case 2:return m=u.sent(),_setValidity(!1),[3,3];case 3:return[2]}})})}function _disableTemplateOpts(t){if(!0===t&&(a.data.showInlineDetail=!1),"editor"!==a.context&&"editor-video"!==a.context)return a.data.templateOpts.map(function(e){return"Embedded link"!==e.name&&"Link modal"!==e.name||(e.isDisabled=t),e})}function handleEpisodeValidationMessage(t){a.validatedFields={kaltura:null,youtube:null,html5:null,error:null},angular.extend(a.validatedFields,t)}function _resetFields(){Object.keys(r).forEach(function(t){return r[t]=o})}function _setValidity(t,e,n){return void 0===e&&(e="itemUrl"),void 0===n&&(n=a),n.ittItemForm.$setValidity(e,t),t}var a=this,s=n.existy,r={url:null,iframeHeaders:null,404:null,301:null,mixedContent:null},o={showInfo:!1,message:"",doInfo:!1};angular.extend(a,{validatedFields:r,$onInit:$onInit,$onDestroy:$onDestroy,handleEpisodeValidationMessage:handleEpisodeValidationMessage,updateTemplateOpts:updateTemplateOpts});var l=angular.noop}],controllerAs:"$ctrl",bindToController:!0}}function ittUser(t,e,n,i,a,s,r){return{restrict:"A",replace:!0,scope:{},templateUrl:"templates/user.html",link:function(o,l,c){function toggleEditing(){o.isEditing=!o.isEditing}o.inPlayer=c.inPlayer,o.appState=e,o.loading=!0,o.logout=n.logout,o.canAccess=n.userHasRole("admin")||n.userHasRole("customer admin"),n.authenticate().then(function(){o.loading=!1,o.user=e.user,o.userHasRole=n.userHasRole}),o.isEditing=!1,o.toggleEditing=toggleEditing,o.uploadStatus=[],o.toggleUploadAvatar=function(){o.showUploadField=!o.showUploadField},o.uploadAvatar=function(n){function _resizeWithService(t){return r.resizeImg(t,60,60,!0).then(function(t){return t})}function _avatarFileFromImg(e){return t(function(t){t(r.createFileFromDataURL(e,n[0].name))})}function _postToAWS(t){a.uploadUserFiles(e.user._id,[t])[0].then(function(t){o.showUploadField=!1,s.cache("asset",t.file),e.user.avatar_id,e.user.avatar_id=t.file._id,o.updateUser(),delete o.uploads})}o.uploadStatus[0]={bytesSent:0,bytesTotal:1},r.readFileToImg(n[0]).then(_resizeWithService).then(_avatarFileFromImg).then(_postToAWS).catch(function(t){})},o.updateUser=function(){n.updateUser(e.user).then(function(){o.user=e.user})},o.getMyNarratives=function(){i.getUserNarratives(o.user._id).then(function(t){o.myPurchases=t,angular.forEach(o.myPurchases,function(t){t.daysUntilExpiration=Math.floor((new Date(t.expiration_date)-new Date)/864e5),i.getNarrativeOverview(t.narrative_id).then(function(t){angular.forEach(o.myPurchases,function(e){e.narrative_id===t._id&&(e.narrativeData=t)})})})})}}}}function ittValidAsset(t){return{restrict:"EA",require:"^ngModel",scope:{item:"="},link:function(e,n,i,a){function watchItem(){return e.item}function handleChanges(e){var n=e.templateUrl,i=e.asset;switch(n){case"templates/item/file.html":case"templates/item/image-plain.html":case"templates/item/image-inline.html":case"templates/item/image-inline-withtext.html":case"templates/item/image-caption-sliding.html":case"templates/item/image.html":case"templates/item/image-fill.html":case"templates/item/link-withimage-notitle.html":t.existy(i)?a.$setValidity("itemAsset",!0):a.$setValidity("itemAsset",!1);break;case"templates/item/link.html":case"templates/item/link-withimage.html":case"templates/item/link-modal-thumb.html":case"templates/item/link-descriptionfirst.html":case"templates/item/link-embed.html":a.$setValidity("itemAsset",!0)}}a&&(a.$validators.itemAsset=function(){return!0},e.$watch(watchItem,handleChanges,!0))}}}function ittValidationTip(){return{restrict:"EA",scope:{text:"@",doInfo:"=?"},template:['<span class="tooltip-static">',"\t<i class=\"fa fa-info-circle\" ng-class=\"{'error-red': !doInfo, 'info-blue': doInfo}\"></i>",'\t<span class="tooltip-text">{{text}}</span>',"</span>"].join("\n")}}function ittValidEpisodeUrl(t,e){return{require:"?ngModel",scope:{onValidationNotice:"&"},link:function(n,i,a,s){function watchFields(){return l}function handleUpdates(t){n.onValidationNotice({$notice:t})}function episodeUrl(e){if(l={},s.$isEmpty(e))return l.error={showInfo:!0,message:"Field cannot be blank."},!1;if(t.isVideoUrl(e)){var n=t.checkUrl(e).type;return"html5"===n?(l[n]={showInfo:!0,message:r(n)+" video currently not supported"},!1):(l[n]={showInfo:!0,message:r(n)+" detected",doInfo:!0},!0)}return l.error={showInfo:!0,message:e+" is not a valid episode URL"},!1}var r=e.capitalize,o={showInfo:!1,message:"",doInfo:!1},l={kaltura:o,youtube:o,html5:o,error:o};s.$validators={episodeUrl:episodeUrl},n.$watch(watchFields,handleUpdates,!0)}}}function ittValidPathslug(t,e){return{require:["^ngModel","^ittGuestAccessibleUrl"],restrict:"EA",link:function(n,i,a,s){function validPathslug(t){if(c[c.type].error=null,l.$isEmpty(t))return c[c.type].error="Slug cannot be empty",!0;var e=r(t);return-1!==_gatherPathSlugs(p,m).indexOf(e)&&(c[c.type].error=e+" is already taken."),!0}function _gatherPathSlugs(t,e){return t.reduce(function(t,n){if(n.path_slug&&n.path_slug.en)if(o(e)){if(e!==n._id)return t.push(n.path_slug.en),t}else t.push(n.path_slug.en);return t},[])}var r=e.slugify,o=e.existy,l=s[0],c=s[1],d=t.customers[c.narrative.customer_id]||c.customer,p="narrative"===c.type?t.cachedNarrativesByCustomer(d):c.narrative.timelines,m=c[c.type]._id;l&&(l.$validators={validPathslug:validPathslug})}}}function ittValidUrl(t){return{require:"?ngModel",link:function(e,n,i,a){a&&(a.$validators.supportUrl=function(e){return a.$isEmpty(e)||t.isValidURL(e)})}}}function ittVideo(){return{replace:!1,templateUrl:"templates/video.html",scope:{poster:"=?",mainPlayer:"=",mediaSrcArr:"=",playerId:"="},controller:["$scope","$timeout","$interval","$sce","$rootScope","$routeParams","playbackService","ittUtils","timelineSvc","modelSvc","dataSvc","appState",function(t,e,n,i,a,s,r,o,l,c,d,p){function onInit(){if(!u(m.mediaSrcArr)||0===m.mediaSrcArr.length)return void(m.transcodedInterval=n(checkTranscoded,1e4));r.seedPlayer(m.mediaSrcArr,m.playerId,m.mainPlayer),m.playerElement=i.trustAsHtml(r.getPlayerDiv(m.playerId)),e(function(){r.createInstance(m.playerId),!0===m.mainPlayer&&(s.t&&r.setMetaProp("startAtTime",o.parseTime(s.t),m.playerId),"true"===s.autoplay&&r.setMetaProp("autoplay",!0,m.playerId))},0)}function videoClick(){r.togglePlayback(m.playerId,l.restartEpisode)}function setCssClass(){var t={},e={"np--embed":!1===m.mainPlayer},n={play:playerIsPaused()},i={firstplay:showUnstartedOverlay()},a={rewind:showReplayOverlay()};return angular.extend(t,e,n,i,a),t}function showMask(){return!(u(p.iOSVersion)&&p.iOSVersion.length&&"youtube"===r.getMetaProp("videoType",m.playerId)&&showUnstartedOverlay())||p.iOSVersion[0]>9}function playerIsPaused(){return"paused"===r.getPlayerState(m.playerId)&&!showReplayOverlay()}function showUnstartedOverlay(){return!1===r.getMetaProp("hasBeenPlayed",m.playerId)}function showReplayOverlay(){var t=r.getMetaProp("time",m.playerId),e=r.getMetaProp("duration",m.playerId);return!0===m.mainPlayer&&t>0&&t>=e-.3}function onDestroy(){r.handle$Destroy(m.playerId)}function checkTranscoded(){var t=c.episodes[p.episodeId];t&&t.masterAsset&&!c.isTranscoded(t.masterAsset)?d.getSingleAsset(t.master_asset_id).then(function(t){c.cache("asset",t);var e=c.assets[t._id];c.isTranscoded(e)&&(m.isTranscoded=!0,n.cancel(m.transcodedInterval),m.mediaSrcArr=e.mediaSrcArr,a.$broadcast("dataSvc.getEpisode.done"),onInit())}):n.clear(m.transcodedInterval)}var m=this;m.isTranscoded=!1,m.transcodedInterval=angular.noop,m.playbackService=r,m.videoClick=videoClick,m.playerIsPaused=playerIsPaused,m.showUnstartedOverlay=showUnstartedOverlay,m.showReplayOverlay=showReplayOverlay,m.setCssClass=setCssClass,m.showMask=showMask,m.appState=p;var u=o.existy;t.$on("$destroy",onDestroy),onInit()}],bindToController:!0,controllerAs:"$ctrl"}}function ittVideoPositionSelect(){return{restrict:"EA",scope:!0,template:['<div class="field" ng-if="selectService.getVisibility(\'videoPosition\')">','\t<div class="label">Video Postion</div>','\t<div class="input">','\t\t<select ng-model="item.layouts[0]" ng-options="option.value as option.name for option in selectService.getSelectOpts(\'video\')"></select>',"\t</div>","</div>"].join(" ")}}function ittVolumeSlider(t){return{restrict:"E",scope:!0,template:'<div ng-focus="showControls()" role="slider" aria-label="volume" aria-valuemin="0" aria-valuemax="100" aria-valuenow="{{currentVolume()}}" aria-valuetext="{{currentVolume()}}" tabindex="0" class="volumebar" ng-mousedown="userChangingVolume($event)" ng-keydown="onVolumeKeyDown($event)" aria-labelledby="volumeControlDescription"> <div class="volume" ng-style="{width: currentVolume()+\'%\'}"></div> <div id="volumeControlDescription" class="screen-reader-offscreen"> Use left and right arrows to increase or decrease the volume by 1. Use page up and page down to increase or decrease the volume by 10. Use home and end to move to the volume to the lowest and highest setting.  </div> ',multiElement:!1,link:function(e){function adjustHigh(t){return t>98?100:t}function adjustLow(t){return t<3?0:t}function incrementVolume(t){var n=e.currentVolume()+t;n=adjustHigh(n),"function"==typeof e.setVolume&&e.setVolume(n)}function decrementVolume(t){var n=e.currentVolume()-t;n=adjustLow(n),"function"==typeof e.setVolume&&e.setVolume(n)}e.userChangingVolume=function(t){var n=angular.element(t.currentTarget),i=function(t,i){var a=(t.clientX-n.offset().left)/n.width()*100;a>98&&(a=100),a<3&&(a=0),i?e.setVolume(a):e.$apply(e.setVolume(a))};i(t,!0),n.bind("mousemove.volume",i),angular.element(document).bind("mouseup.volume",function(){angular.element(document).unbind("mouseup.volume"),n.unbind("mousemove.volume")})};var n={PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFTARROW:37,UPARROW:38,RIGHTARROW:39,DOWNARROW:40};e.onVolumeKeyDown=function(t){var e=t,i=!0;switch(e.keyCode){case n.LEFTARROW:decrementVolume(1),i=!1;break;case n.RIGHTARROW:case n.UPARROW:incrementVolume(1),i=!1;break;case n.DOWNARROW:decrementVolume(1),i=!1;break;case n.PAGEUP:incrementVolume(10),i=!1;break;case n.PAGEDOWN:decrementVolume(10),i=!1;break;case n.HOME:decrementVolume(100),i=!1;break;case n.END:incrementVolume(100),i=!1;break;default:i=!0}i||(t.stopPropagation(),t.preventDefault())},e.currentVolume=function(){return t.getMetaProp("muted")?0:t.getMetaProp("volume")}}}}function ittWidthWatch(){return{restrict:"A",replace:!1,link:function(t,e){var n=t.$watch(function(){return e.width()},function(e){t.isNarrow=e<450});t.$on("$destroy",n)}}}function nysCopyright(){return{template:["Narrative Player &#169;","<span ng-bind-html=\"now | date:'yyyy'\" ></span>",'<a href="//narrasys.com" target="_blank" rel="noopener noreferrer"> Narrasys</a>. All rights reserved.',"<br>",'<a href="/privacy">Privacy</a>','<span ng-if="narrative.support_url"> - ','\t<a ng-href="{{narrative.support_url}}">Support</a>',"</span>"].join("")}}function sxsAddContent(t,e){return{restrict:"A",replace:!0,scope:{},templateUrl:"templates/producer/addcontent.html",controller:"EditController",link:function(n){n.appState=t,n.playbackService=e,n.expand=function(){n.expanded=!0,angular.element(document).one("mouseup.addcontent",function(){n.collapse()})},n.collapse=function(){n.expanded=!1}}}}function sxsAnnotatorAutocomplete(t,e,n){return{require:"ngModel",templateUrl:"templates/producer/annotator-autocomplete.html",scope:{annotators:"=sxsAnnotatorAutocomplete",item:"=item"},link:function(i,a,s,r){i.appState=n,i.hasAnnotator=function(){return Object.keys(i.item.annotator).length>0},angular.forEach(i.annotators,function(t){t.annotation_image_id&&(t.imageUrl=e.assets[t.annotation_image_id].url)}),i.annotator={name:i.item.annotator},i.annotators[i.item.annotator]&&i.annotators[i.item.annotator].annotation_image_id&&(i.annotator.imageUrl=e.assets[i.annotators[i.item.annotator].annotation_image_id].url),i.filteredAnnotators=function(t){var e=Object.keys(t).map(function(e){return t[e]}),n=e.pop(),i=e.sort(function(t,e){return t.key.toLowerCase()<e.key.toLowerCase()?-1:t.key.toLowerCase()>e.key.toLowerCase()?1:0});return i.push(n),i.reduce(function(t,e){return t[e.key]=e,t},{})}(angular.copy(i.annotators)),i.preselectedItem=-1,a.find(".annotatorChooser").bind("keydown",function(t){switch(t.which){case 40:i.preselectedItem=(i.preselectedItem+1)%Object.keys(i.filteredAnnotators).length;break;case 38:i.preselectedItem=(i.preselectedItem-1)%Object.keys(i.filteredAnnotators).length;break;case 13:t.preventDefault(),i.preselectedItem>-1&&i.selectByIndex(i.preselectedItem)}}),i.handleAutocomplete=function(){if(i.annotator.name="",i.searchText){i.preselectedItem=-1;var t={};angular.forEach(i.annotators,function(e){e.key.toLowerCase().indexOf(i.searchText.toLowerCase())>-1&&(t[e.key]=e)}),i.filteredAnnotators=t,1===Object.keys(i.filteredAnnotators).length&&(i.preselectedItem=0)}else i.filteredAnnotators=angular.copy(i.annotators),i.preselectedItem=-1},i.selectByIndex=function(t){if(!(t<0)){var e=Object.keys(i.filteredAnnotators).sort();i.select(i.filteredAnnotators[e[t]])}},i.select=function(t){i.preselectedItem=-1,t.annotation_image_id?(i.item.annotation_image_id=t.annotation_image_id,i.item.asset=e.assets[t.annotation_image_id],i.annotator.imageUrl=i.item.asset.url):(delete i.annotator.imageUrl,delete i.item.asset),r.$setViewValue(t.name),i.searchText=""},i.autoCompleting=!1,i.showAutocomplete=function(){var t=a.find(".annotatorChooser")[0];t.setSelectionRange(0,t.value.length),i.autoCompleting=!0},i.hideAutocomplete=function(){t(function(){i.preselectedItem>-1?i.selectByIndex(i.preselectedItem):""!==i.searchText&&i.addNewAnnotator(),i.autoCompleting=!1},300)},i.addNewAnnotator=function(){var t=i.searchText;i.item.annotator={},i.item.annotator[n.lang]=t,i.searchText="",i.handleAutocomplete()},i.uploadAnnotatorImage=function(){window.alert("TODO")}}}}function sxsInputI18n(t,e,n){return{templateUrl:"templates/producer/inputi18n.html",scope:{field:"=sxsInputI18n",inputtype:"=inputtype",doValidate:"=",onEmitName:"&"},link:function(i,a,s){i.field||(i.field={en:""}),i.appState=e,i.textangularname="ta"+(new Date).getUTCMilliseconds()+"y"+Math.random().toString(16),i.onEmitName({$taName:i.textangularname}),"textarea"===i.inputtype&&(t(function(){if(void 0!==s.autofocus){n.retrieveEditor(i.textangularname).scope.displayElements.text.trigger("focus")}}),i.trim=function(){var t=i.field[e.lang];t&&(t=t.replace(/<br\/>/g,"<br>"),t=t.replace(/<div>/g,"<br>"),t=t.replace(/<\/?(span|div)>/g,""),t=t.replace(/(<br>)*$/,""),i.field[e.lang]=t)},i.sanitizePastedHtml=function(t){var e=document.createElement("div");return e.innerHTML=t,e.textContent})}}}function sxsInputTime(t,e,n,i,a,s,r){return{require:"?^^form",scope:{item:"=sxsInputTime"},templateUrl:"templates/producer/inputtime.html",link:function(o,l,c,d){function watchModel(){return parse(o.model)}function handleUpdates(t){setTime(t),"start_time"===c.inputField&&o.item.stop&&(o.item.end_time=t)}function handelValidation(t){if(o.item.validationMessage=null,d.time.$setValidity("time",!0),"Scene"!==o.item._type)return!0;var e=!1,n=validateStartTime(t),i=validateSceneStartTime(t);return e=n&&i,e||d&&(d.time.$setValidity("time",!1),d.time.$setViewValue(format(t)),d.time.$render(),i||(o.item.validationMessage="Scenes cannot share the same start time."),n||(o.item.validationMessage="For a start time <=0:00.1, please edit the first layout")),e}function validateSceneStartTime(t){var e,n=!0;return o.item.start_time!==t&&(e=i.isOnExistingSceneStart(t),n=!e),n}function validateStartTime(t){return p(t)&&t>.1}function setTime(t){!1!==handelValidation(t)&&(t>u&&(t=u),o.item.stop&&(o.item.end_time=t),o.realValue=t,o.item[c.inputField]=o.realValue,o.model=o.format(t),o.item.invalid_end_time=o.item.start_time>o.item.end_time)}function parse(e){var n;if(void 0===e||""===e)n=s.getMetaProp("time");else if(isNaN(e)){var i=e.split(":");2===i.length?(isNaN(i[0])&&(i[0]=0),isNaN(i[1])&&(i[1]=0),n=60*Number(i[0])+Number(i[1])):n=s.getMetaProp("time")}else n=e;return n<.01&&(n=.01),t.$emit("searchReindexNeeded"),n}function format(t){var e=Math.floor(t/60),n=Math.round(t%60*100)/100;return n<10&&(n="0"+n),e+":"+n}function nudge(t){e.cancel(m),l.find(".inputfield").focus();var n=t/30;setTime(o.item[c.inputField]+n),"start_time"===c.inputField&&a.seek(o.item[c.inputField]+n)}function showTools(t){t?o.tooltip=!0:m=e(function(){o.tooltip=!1},300)}function isTranscript(){return!1}var p=r.existy;angular.extend(o,{fieldname:angular.copy(c.inputField),realValue:angular.copy(o.item[c.inputField]),playbackService:s,model:format(angular.copy(o.item[c.inputField])),appState:n,parse:parse,format:format,nudge:nudge,setTime:setTime,showTools:showTools,isTranscript:isTranscript}),function(){"Scene"===o.item._type?o.scene=function(){return o.item}:o.scene=function(){return i.sceneAtEpisodeTime(o.item.cur_episode_id,s.getMetaProp("time"))}}(),o.$watch(watchModel,handleUpdates);var m,u=i.episodes[o.item.cur_episode_id].masterAsset.duration}}}function routerConfig(t){t.when("/",{title:"Narrative Producer",templateUrl:"templates/root.html"}).when("/auth",{templateUrl:"templates/auth.html",reloadOnSearch:!1}).when("/account",{template:['<div class="standaloneAncillaryPage">','\t<itt-nav on-logout="logout()"></itt-nav>',"\t<h1>My Account</h1>","\t<div itt-user></div>","</div>"].join(""),controller:["$scope","authSvc",function(t,e){t.logout=e.logout}]}).when("/stories",{title:"Available Narratives",template:['<div class="standaloneAncillaryPage">','\t<itt-nav on-logout="logout()"></itt-nav>',"\t<h1>Narratives</h1>",'\t<div itt-narrative-list customers-data="customersResolve"></div>',"</div>"].join("\n"),controller:"NarrativesCtrl",resolve:{narrativesResolve:["$route","$q","ittUtils","authSvc","dataSvc","modelSvc",function(t,e,n,i,a,s){var r=s.getCustomersAsArray();return Object.keys(r).length>0?e(function(t){return t({c:r})}):i.authenticate().then(function(){return a.getCustomerList().then(function(t){return{c:t}})})}]}}).when("/story/:narrativePath",{template:['<div class="standaloneAncillaryPage">','\t<itt-nav on-logout="logout()"></itt-nav>','\t<div itt-narrative narrative-data="narrativeResolve" customer-data="customerResolve">',"</div>"].join(""),controller:"NarrativeCtrl",resolve:{narrativeResolve:["$route","$q","authSvc","dataSvc","modelSvc","ittUtils",function(t,e,n,i,a,s){var r,o=t.current.params.narrativePath,l=a.getNarrativeByPathOrId(o);return s.existy(l)&&s.existy(l.path_slug)&&s.existy(l.timelines)&&(l.path_slug.en===o||l._id===o)?(r=a.customers[l.customer_id],e(function(t){return t({n:l,c:[r]})})):i.getNarrative(o).then(function(t){return i.getCustomer(t.customer_id,!0).then(function(e){return{n:t,c:[e]}})})}]}}).when("/story/:narrativePath/:timelinePath",{template:"<div itt-narrative-timeline></div>",resolve:{product:["appState",function(t){t.product="player",t.productLoadedAs="narrative"}]}}).when("/projects",{title:"Available projects",templateUrl:"templates/producer/episodelist.html"}).when("/episode/:epId",{title:"Narrative Producer",controller:"PlayerController",templateUrl:"templates/player.html",resolve:{product:["appState",function(t){t.product="player",t.productLoadedAs="player"}]}}).when("/episode/:epId/:viewMode",{title:"Narrative Producer",controller:"PlayerController",templateUrl:"templates/player.html",resolve:{product:["appState",function(t){t.product="player",t.productLoadedAs="player"}]}}).when("/sxs/:epId",{title:"Narrative Producer",controller:"PlayerController",templateUrl:"templates/player.html",resolve:{product:["appState",function(t){t.product="sxs",t.productLoadedAs="sxs"}]}}).when("/editor/:epId",{title:"Narrative Producer",controller:"PlayerController",templateUrl:"templates/player.html",resolve:{product:["appState",function(t){t.product="sxs",t.productLoadedAs="sxs"}]}}).when("/producer/:epId",{title:"Narrative Producer",controller:"PlayerController",templateUrl:"templates/player.html",resolve:{product:["appState",function(t){t.product="producer",t.productLoadedAs="producer"}]}}).when("/assets/:containerId",{title:"Container Assets test",controller:"ContainerAssetsTestController",template:['<div class="standaloneAncillaryPage">','\t<itt-nav on-logout="logout()"></itt-nav>',"\t<div>",'\t\t<sxs-container-assets container-id="{{containerId}}" mime-key="assetLib"></sxs-container-assets>',"\t</div>","</div>"].join(""),resolve:{authEffects:["authSvc",function(t){return t.authenticate().then(angular.noop)}]}}).when("/event/:eventId",{title:"Event test",controller:"EventTestController",templateUrl:"templates/testbed-event.html"}).otherwise({title:"Narrative Producer: Error",controller:"ErrorController",templateUrl:"templates/error-404.html"})}function xDomainConfig(t){t.resourceUrlWhitelist(["self",/.*/,/^http(s)?:\/\/platformuniv-p.edgesuite.net/,/^http(s)?:\/\/themes.googleusercontent.com/])}function authInterceptorConfig(t){t.defaults.useXDomain=!0,t.defaults.withCredentials=!0,delete t.defaults.headers.common["X-Requested-With"],t.interceptors.push(["$q","errorSvc",function(t,e){return{responseError:function(n){return n.data&&n.data.path_slug?t(function(t,e){return e(n)}):(e.error(n),t.reject(n))}}}])}function textAngularConfig(t){t.decorator("taOptions",["taRegisterTool","$delegate",function(t,e){return e.defaultFileDropHandler=function(t,e){},e.toolbar=[["h1","h2","h3"],["bold","italics","underline","strikeThrough"],["ul","ol"],["undo","redo","clear"]],e}])}function debugInfoConfig(t){var e=!1,n=window.location.hostname;0!==n.indexOf("localhost")&&0!==n.indexOf("api-dev")&&0!==n.indexOf("np-dev")||(e=!0),!1===e&&t.debugInfoEnabled(!1)}function runFunction(t,e){t.$on("$routeChangeSuccess",function(t,n){document.title=n.title?n.title:"Narrative Producer",e.init()});var n=!1;$(document).on("keydown",function(e){n||"INPUT"===document.activeElement.tagName||"TEXTAREA"===document.activeElement.tagName||document.activeElement.attributes.contenteditable||(n=!0,27===e.keyCode&&(t.$emit("userKeypress.ESC"),e.preventDefault()),32===e.which&&(t.$emit("userKeypress.SPACE"),e.preventDefault()))}),$(document).on("keyup",function(){n=!1})}Object.defineProperty(e,"__esModule",{value:!0}),ContainerAssetsTestController.$inject=["$scope","$routeParams","authSvc"];var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),a=function(){function ITimeline(){}return ITimeline}(),s=function(){function ICustomer(){}return ICustomer}(),r=function(){function INarrative(){}return INarrative}(),o=function(){function IAsset(){}return IAsset}(),l=function(){function IEvent(){}return IEvent}(),c=function(){function ILinkStatus(){}return ILinkStatus}(),d=function(t){function ILink(){return null!==t&&t.apply(this,arguments)||this}return i(ILink,t),ILink}(l),p=function(t){function IAnnotation(){var e=null!==t&&t.apply(this,arguments)||this;return e.chapter_marker=!1,e}return i(IAnnotation,t),IAnnotation}(l),m=function(t){function IBookmark(){return null!==t&&t.apply(this,arguments)||this}return i(IBookmark,t),IBookmark}(l),u=function(t){function IChapter(){return null!==t&&t.apply(this,arguments)||this}return i(IChapter,t),IChapter}(l),g=function(t){function IImage(){return null!==t&&t.apply(this,arguments)||this}return i(IImage,t),IImage}(l),v=(function(){function IPluginData(){}}(),function(t){function IPlugin(){return null!==t&&t.apply(this,arguments)||this}return i(IPlugin,t),IPlugin}(l)),h=function(t){function IScene(){return null!==t&&t.apply(this,arguments)||this}return i(IScene,t),IScene}(l),f=function(t){function IText(){return null!==t&&t.apply(this,arguments)||this}return i(IText,t),IText}(l),y=function(t){function IUpload(){return null!==t&&t.apply(this,arguments)||this}return i(IUpload,t),IUpload}(l);EditController.$inject=["$scope","$rootScope","$timeout","$window","selectService","appState","dataSvc","modelSvc","timelineSvc","authSvc","MIMES","playbackService"],ErrorController.$inject=["$scope","errorSvc","appState","authSvc"],EventTestController.$inject=["$scope","$routeParams","mockSvc","modelSvc","appState"],ItemController.$inject=["$scope","timelineSvc"],NarrativeCtrl.$inject=["$scope","narrativeResolve","authSvc"],NarrativesCtrl.$inject=["$scope","authSvc","narrativesResolve"],PlayerController.$inject=["$scope","$location","$rootScope","$routeParams","$timeout","$interval","config","appState","dataSvc","modelSvc","timelineSvc","analyticsSvc","authSvc","selectService","playbackService"],SceneController.$inject=["$scope","$filter","ittUtils"],SearchPanelController.$inject=["$scope","$rootScope","$timeout","appState"],TimelineController.$inject=["$scope","$rootScope","timelineSvc","playbackService"];var _=n(0),b=(n.n(_),angular.module("itt.controllers",[]).controller("EditController",EditController).controller("EpisodeController",EpisodeController).controller("ErrorController",ErrorController).controller("EventTestController",EventTestController).controller("ItemController",ItemController).controller("NarrativeCtrl",NarrativeCtrl).controller("NarrativesCtrl",NarrativesCtrl).controller("PlayerController",PlayerController).controller("SceneController",SceneController).controller("SearchPanelController",SearchPanelController).controller("TimelineController",TimelineController).controller("ContainerAssetsTestController",ContainerAssetsTestController),"social_image_square"),x="social_image_wide",w=n(0);n.n(w),angular.module("itt.filters",[]).filter("itemLayout",function(){return function(t,e){var n=[];return angular.forEach(t,function(t){t.layouts&&t.layouts[0]===e&&n.push(t)}),n}}).filter("mainCol",function(){return function(t){var e=[];return angular.forEach(t,function(t){!t.layouts||"mainBg"!==t.layouts[0]&&"mainFg"!==t.layouts[0]||e.push(t)}),e}}).filter("altCol",function(){return function(t){var e=[];return angular.forEach(t,function(t){!t.layouts||"altBg"!==t.layouts[0]&&"altFg"!==t.layouts[0]||e.push(t)}),e}}).filter("annotation",function(){return function(t){var e=[];return angular.forEach(t,function(t){"Annotation"!==t._type||t.templateUrl.match(/(transmedia|definition)/)||e.push(t)}),e}}).filter("transmedia",function(){return function(t){var e=[];return angular.forEach(t,function(t){("Annotation"!==t._type||t.templateUrl.match(/(transmedia|definition)/))&&e.push(t)}),e}}).filter("transcript",function(){return function(t){var e=[];return angular.forEach(t,function(t){t.isTranscript&&e.push(t)}),e}}).filter("isCurrent",function(){return function(t){var e=[];return angular.forEach(t,function(t){t.isCurrent&&e.push(t)}),e}}).filter("isContent",function(){return function(t){var e=[];return angular.forEach(t,function(t){t.isContent&&e.push(t)}),e}}).filter("reviewMode",["appState",function(t){return function(e){var n=[],i="producer"===t.product;return angular.forEach(e,function(t){(i||!t.cosmetic&&(t.isContent||t.layouts.indexOf("windowFg")>-1))&&n.push(t)}),n}}]).filter("transcriptandrequired",function(){return function(t){var e=[];return angular.forEach(t,function(t){(t.isTranscript||t.required)&&e.push(t)}),e}}).filter("transcriptandoptional",function(){return function(t){var e=[];return angular.forEach(t,function(t){(t.isTranscript||!t.isTranscript&&!t.required)&&e.push(t)}),e}}).filter("required",function(){return function(t){var e=[];return angular.forEach(t,function(t){!t.isTranscript&&t.required&&e.push(t)}),e}}).filter("optional",function(){return function(t){var e=[];return angular.forEach(t,function(t){t.isTranscript||t.required||e.push(t)}),e}}).filter("highlightSubstring",function(){return function(t,e){if(t)return e||angular.isNumber(e)?t.toString().replace(new RegExp(e.toString(),"gi"),'<span class="ui-match">$&</span>'):t}}).filter("pretty",function(){return function(t){return JSON.stringify(t,void 0,2)}}).filter("i18n",["appState",function(t){return function(e){return e?"object"==typeof e?e[t.lang]||e.en||"":e:""}}]).filter("asBytes",function(){return function(t){if(!t)return"";var e=Math.floor(t/1024);return e<1024?e+"Kb":Math.floor(e/10.24)/100+"Mb"}}).filter("asPercent",function(){return function(t){return isNaN(t)?Math.floor(100*t)+"%":"0%"}}).filter("stripParams",function(){return function(t){return t.substr(0,t.indexOf("?"))}}).filter("asTime",function(){return function(t){return isNaN(t)?"0:00":t<0?"0:00":Math.floor(t/60)+":"+("0"+Math.floor(t)%60).slice(-2)}}).filter("alpha",function(){return function(t){return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("")[t%26]}}).filter("capitalize",function(){return function(t){return t?t.charAt(0).toUpperCase()+t.substr(1).toLocaleLowerCase():""}}).filter("vidsFromCustAdmins",function(){return function(t){var e=[];return angular.forEach(t,function(t){/video/.test(t.content_type)||e.push(t)}),e}}).filter("langDisplay",["ittUtils",function(t){var e=t.existy,n={en:"English",es:"Spanish",zh:"Chinese",pt:"Portuguese",fr:"French",de:"German",it:"Latin"};return function(t){return e(t)?n[t]:""}}]).filter("slugify",["ittUtils",function(t){return function(e){return t.existy(e)?t.slugify(e):""}}]).filter("tagName",[function(){var t=(e={},e[b]="Square",e[x]="Wide",e);return function(e){if(e&&t.hasOwnProperty(e))return t[e]};var e}]);analyticsSvc.$inject=["$q","$http","$routeParams","$interval","config","appState","playbackService"];var S=n("IiAB"),k={user:{},episodeId:!1,episodeSegmentId:!1,narrativeId:!1,timelineId:!1,isFramed:window.parent!=window,isTouchDevice:/iPad|iPod|iPhone/.test(navigator.platform)||/Android/.test(navigator.userAgent),isIEOrEdge:/Trident|Edge/.test(navigator.userAgent)||/Trident|Edge/.test(navigator.platform),isIPhone:navigator.platform.match(/iPod|iPhone/),iOSVersion:"",noAvatarImg:S,windowWidth:0,windowHeight:0,viewMode:$(window).width()>480?"discover":"review",producerEditLayer:0,hideCaptions:!1,show:{searchPanel:!1,navPanel:!1},videoControlsActive:!1,videoControlsLocked:!1,itemDetail:!1,autoscroll:!1,autoscrollBlocked:!1,crossEpisodePath:"",product:"",productLoadedAs:"",editEvent:!1,editEpisode:!1,lang:!1},C=function(){function AppState(t,e){this.$interval=t,this.config=e,this.initService()}return AppState.getIOSVersion=function(t){var e=/iP(hone|od|ad)/,n=/OS (\d+)_(\d+)_?(\d+)?/;if(e.test(t.platform)||e.test(t.userAgent)){var i=t.appVersion.match(n);return[parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3]||0,10)]}},AppState.prototype.init=function(){var t;t="sxs"===this.product||"producer"===this.product?this.product:"episode";var e={iOSVersion:AppState.getIOSVersion(navigator),crossEpisodePath:t,product:this.product,productLoadedAs:this.productLoadedAs,user:this.user||{}};Object.assign(this,k,e)},AppState.prototype.initService=function(){this.init(),this.watchWidth()},AppState.prototype.watchWidth=function(){var t=this;this.$interval(function(){t.windowHeight=angular.element(window).height(),t.windowWidth=angular.element(window).width()},50,0,!1),this.config.debugInBrowser},AppState.$inject=["$interval","config"],AppState}();authSvc_authSvc.$inject=["config","$routeParams","$http","$q","$location","ittUtils","appState","modelSvc","errorSvc"],awsSvc.$inject=["$http","$q","config"],config_config.$inject=[],dataSvc_dataSvc.$inject=["$q","$http","$routeParams","$rootScope","$location","ittUtils","config","authSvc","appState","modelSvc","errorSvc","mockSvc","questionAnswersSvc"],errorSvc_errorSvc.$inject=["$location"],imageResize.$inject=["$q"],ittUtils_ittUtils.$inject=["$timeout"],mockSvc_mockSvc.$inject=["modelSvc"],modelSvc_modelSvc.$inject=["$filter","$location","ittUtils","config","appState","playbackService","urlService"],playbackService_playbackService.$inject=["$interval","youTubePlayerManager","html5PlayerManager","kalturaPlayerManager","wistiaPlayerManager","ittUtils","urlService","PLAYERSTATES_WORD","PLAYERSTATES"];var T={mainPlayer:!1,playerState:"-1",div:"",ready:!1,startAtTime:0,hasResumedFromStartAt:!1,duration:0,time:0,hasBeenPlayed:!1,bufferedPercent:0,timeMultiplier:1,resetInProgress:!1,autoplay:!1,volume:100,muted:!1};playerManagerCommons.$inject=["ittUtils"],questionAnswersSvc_questionAnswersSvc.$inject=["$q","analyticsSvc","appState"],recursionHelper.$inject=["$compile"],selectService_selectService.$inject=["authSvc","modelSvc","dataSvc","ittUtils"],timelineSvc_timelineSvc.$inject=["$window","$timeout","$interval","$filter","config","modelSvc","appState","analyticsSvc","playbackService","ittUtils"],urlService_urlService.$inject=["youtubeUrlService","html5UrlService","kalturaUrlService","wistiaUrlService","config"],html5PlayerManager.$inject=["$interval","PLAYERSTATES","ittUtils","appState","playerManagerCommons"],html5UrlService.$inject=["ittUtils"],kalturaPlayerManager.$inject=["ittUtils","PLAYERSTATES","playerManagerCommons","kalturaScriptLoader","kalturaUrlService"],kalturaScriptLoader.$inject=["$q","ittUtils"],kalturaUrlService.$inject=[],youTubePlayerManager.$inject=["$location","ittUtils","YTScriptLoader","errorSvc","PLAYERSTATES","youtubeUrlService","playerManagerCommons"],YTScriptLoader.$inject=["$q","$timeout"],youtubeUrlService.$inject=["ittUtils"];var E=function(){function WistiaScriptLoader(t){this.$q=t,this.WISTIA_HREF="https://fast.wistia.com/assets/external/E-v1.js"}return WistiaScriptLoader.prototype.load=function(t){var e=this;return this.$q(function(n){"undefined"==typeof Wistia?e._appendScript(t,n):n()})},WistiaScriptLoader.prototype._appendScript=function(t,e){var n=document.createElement("script");n.setAttribute("src",this.WISTIA_HREF),n.setAttribute("type","text/javascript"),n.setAttribute("async",""),n.id=t;var i=document.getElementsByTagName("script")[0];i.parentElement.insertBefore(n,i),n.onload=e},WistiaScriptLoader.$inject=["$q"],WistiaScriptLoader}(),I=function(){function WistiaUrlService(){this.type="wistia",this.mimetype="video/x-"+this.type,this.embedUrl="http://fast.wistia.net/embed/iframe/"}return WistiaUrlService.prototype.getMimeType=function(){return this.mimetype},WistiaUrlService.prototype.parseMediaSrc=function(t){return t.reduce(function(t,e){return WistiaUrlService.isWistia(e)&&t.mediaSrcArr.push(e),t},{type:this.type,mediaSrcArr:[]})},WistiaUrlService.prototype.parseInput=function(t){if(WistiaUrlService.isWistia(t)&&!WistiaUrlService.isEmbed(t))return t},WistiaUrlService.prototype.extractId=function(t){if(WistiaUrlService.isWistia(t))return WistiaUrlService.parseIdfromUrl(t)},WistiaUrlService.prototype.canPlay=function(t){return WistiaUrlService.isWistia(t)},WistiaUrlService.prototype.getOutgoingUrl=function(t,e){var n="?autoplay=true&time="+e,i=WistiaUrlService.parseIdfromUrl(t),a=""+i+n;return this.embedUrl+a},WistiaUrlService.isWistia=function(t){return/https?:\/\/(.+)?(wistia\.com|wi\.st)\/.*/.test(t)},WistiaUrlService.isEmbed=function(t){return/<script/i.test(t)},WistiaUrlService.parseIdfromUrl=function(t){var e=t.split("/");return e[e.length-1]},WistiaUrlService}(),P=function(){function BasePlayerManager(){this.players={},this.statechangeCallbacks=[]}return BasePlayerManager.createMetaObj=function(t){var e={instance:null,meta:T};return Object.assign(T,t),Object.assign(e.meta,T),e},BasePlayerManager.prototype.getPlayer=function(t){if(ittUtils_existy(this.players[t]))return this.players[t]},BasePlayerManager.prototype.setInstance=function(t,e){var n=this.getPlayer(t);ittUtils_existy(n)&&(n.instance=e)},BasePlayerManager.prototype.setPlayer=function(t,e){this.players[t]=e},BasePlayerManager.prototype.getMetaProp=function(t,e){var n=this.getPlayer(t);if(ittUtils_existy(n)&&ittUtils_existy(n.meta))return n.meta[e]},BasePlayerManager.prototype.setMetaProp=function(t,e,n){if(ittUtils_existy(this.players[t])&&this.players[t].meta)try{this.players[t].meta[e]=n}catch(t){}},BasePlayerManager.prototype.getPlayerDiv=function(t){return this.getMetaProp(t,"div")},BasePlayerManager.prototype.getPlayerState=function(t){return""},BasePlayerManager.prototype.pause=function(t){},BasePlayerManager.prototype.stop=function(t){},BasePlayerManager.prototype.freezeMetaProps=function(t){},BasePlayerManager.prototype.unFreezeMetaProps=function(t){},BasePlayerManager.prototype.pauseOtherPlayers=function(t){var e=this;Object.keys(this.players).forEach(function(n){if(n!==t){var i=e.getPlayerState(n);ittUtils_existy(i)&&"playing"===i&&e.pause(n)}})},BasePlayerManager.prototype.registerStateChangeListener=function(t){this.statechangeCallbacks.find(function(e){return t.toString()===e.toString()})||this.statechangeCallbacks.push(t)},BasePlayerManager.prototype.unregisterStateChangeListener=function(t){this.statechangeCallbacks=this.statechangeCallbacks.filter(function(e){return e.toString!==t.toString()})},BasePlayerManager.prototype.renamePid=function(t,e){renameKey(t,e,this.players)},BasePlayerManager.prototype.handleTimelineEnd=function(t){},BasePlayerManager.prototype.resetPlayerManager=function(){var t=this;Object.keys(this.players).forEach(function(e){t.destroyInstance(e,!0)}),this.players={}},BasePlayerManager.prototype.destroyInstance=function(t,e){ittUtils_existy(e)||(e=!1),this.destroySideEffects(t),!0===e&&this.setPlayer(t,{})},BasePlayerManager.prototype.destroySideEffects=function(t){},BasePlayerManager}(),A={"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"video cued",4:"quality changed",6:"player ready"},U=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),M=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},L={playing:"playing",paused:"paused",beforeplay:"unstarted",ended:"ended"},O={videoType:"wistia",lastVol:100,bufferingInterval:null,lastVideoTime:0},D=function(t){function WistiaPlayerManager(e,n,i){var a=t.call(this)||this;return a.$interval=e,a.wistiaScriptLoader=n,a.wistiaUrlService=i,a.type="wistia",a._bufferCheckIntervalLength=100,a}return U(WistiaPlayerManager,t),WistiaPlayerManager.setPlayerDiv=function(t,e){return'<div id="'+t+'" class="wistia_embed wistia_async_'+e+'">&nbsp;</div>'},WistiaPlayerManager.formatStateChangeEvent=function(t,e){return{emitterId:e,state:A[t]}},WistiaPlayerManager.prototype.seedPlayerManager=function(t,e,n){if(!(ittUtils_existy(this.getPlayer(t))&&this.getMetaProp(t,"startAtTime")>0)){e&&(this.players={},this.mainPlayerId=t);var i=this.wistiaUrlService.extractId(n[0]),a=M({mainPlayer:e,div:WistiaPlayerManager.setPlayerDiv(t,i),wistiaId:i},O);this.setPlayer(t,WistiaPlayerManager.createMetaObj(a))}},WistiaPlayerManager.prototype.create=function(t){var e=this;this.createWpInstance(t).then(function(n){var i=e.$interval(function(){var n=e.getMetaProp(t,"lastVideoTime"),i=e.getMetaProp(t,"time"),a=i-n;a>=1&&a<=2&&(e.setMetaProp(t,"playerState",3),e.setMetaProp(t,"time",n),e.emitStateChange(t))},e._bufferCheckIntervalLength);e.setMetaProp(t,"bufferingInterval",i)})},WistiaPlayerManager.prototype.getPlayerState=function(t){var e=this.getInstance(t);if(e)return L[e.state()]},WistiaPlayerManager.prototype.getBufferedPercent=function(t){return 0},WistiaPlayerManager.prototype.getCurrentTime=function(t){return this.invokeMethod(t,"time")},WistiaPlayerManager.prototype.play=function(t){this.invokeMethod(t,"play")},WistiaPlayerManager.prototype.pause=function(t){this.invokeMethod(t,"pause")},WistiaPlayerManager.prototype.seekTo=function(t,e){this.invokeMethod(t,"time",e)},WistiaPlayerManager.prototype.setSpeed=function(t,e){this.invokeMethod(t,"playbackRate",e)},WistiaPlayerManager.prototype.toggleMute=function(t){var e=this.getMetaProp(t,"muted");!1===e?(this.setMetaProp(t,"lastVol",this.getMetaProp(t,"volume")),this.setVolume(t,0)):this.setVolume(t,this.getMetaProp(t,"lastVol")),this.setMetaProp(t,"muted",!e)},WistiaPlayerManager.prototype.setVolume=function(t,e){this.invokeMethod(t,"volume",e/100),this.setMetaProp(t,"volume",e)},WistiaPlayerManager.prototype.destroySideEffects=function(t){this.$interval.cancel(this.getMetaProp(t,"bufferingInterval"))},WistiaPlayerManager.prototype.invokeMethod=function(t,e,n){var i=this.getInstance(t);if(ittUtils_existy(i))try{return ittUtils_existy(n)?i[e](n):i[e]()}catch(t){}},WistiaPlayerManager.prototype.getInstance=function(t){if(ittUtils_existy(this.getPlayer(t))&&!0===this.getMetaProp(t,"ready"))return this.getPlayer(t).instance},WistiaPlayerManager.prototype.createWpInstance=function(t){var e=this,n=this.mainPlayerId!==t,i={playbar:n,videoFoam:!0,fullscreenButton:n,controlsVisibleOnLoad:n,playbackRateControl:n,playButton:n,settingsControl:n,qualityControl:n,smallPlayButton:n,volumeControl:n};return this.wistiaScriptLoader.load(t).then(function(n){window.wistiaInitQueue=window.wistiaInitQueue||[],window.wistiaInitQueue.push({id:t,options:i,onReady:function(n){return e.onReady(t,n)}})})},WistiaPlayerManager.prototype.onReady=function(t,e){this.setInstance(t,e),this.attachEventListeners(e,t),this.emitStateChange(t,6),this.setMetaProp(t,"duration",e.duration())},WistiaPlayerManager.prototype.attachEventListeners=function(t,e){var n=this,i=function(t){return function(e){for(var i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];return e.call.apply(e,[n,t].concat(i))}}(e),a={play:function(t){return i(n.onPlay)},pause:function(t){return i(n.onPause)},seek:function(t,e){return i(n.onSeek,t,e)},timechange:function(t){return i(n.onTimechange,t)}};Object.entries(a).forEach(function(e){var n=e[0],i=e[1];t.bind(n,i)})},WistiaPlayerManager.prototype.onTimechange=function(t,e){var n=this.getMetaProp(t,"time");this.setMetaProp(t,"lastVideoTime",e),n>e&&this.setMetaProp(t,"time",e)},WistiaPlayerManager.prototype.onSeek=function(t,e,n){var i=this.getMetaProp(t,"duration");if(this.setMetaProp(t,"time",e),this.setMetaProp(t,"lastVideoTime",e),Math.floor(i-e)<.3)return this.setMetaProp(t,"playerState",0),void this.emitStateChange(t)},WistiaPlayerManager.prototype.onPlay=function(t){this.setMetaProp(t,"playerState",1),this.emitStateChange(t)},WistiaPlayerManager.prototype.onPause=function(t){this.setMetaProp(t,"playerState",2),this.emitStateChange(t)},WistiaPlayerManager.prototype.emitStateChange=function(t,e){var n;n=ittUtils_existy(e)?e:this.getMetaProp(t,"playerState"),this.statechangeCallbacks.forEach(function(e){e(WistiaPlayerManager.formatStateChangeEvent(n,t))})},WistiaPlayerManager.$inject=["$interval","wistiaScriptLoader","wistiaUrlService"],WistiaPlayerManager}(P),F=function(){function UploadsService(t,e){this.$q=t,this.awsSvc=e,this.uploadsDisplay={social_image_square:null,social_image_wide:null},this.uploadQueue=[]}return UploadsService.prototype.uploadTaggedFiles=function(t,e,n){var i=this;return this.$q(function(n,a){for(var s=0,r=t;s<r.length;s++){var o=r[s],l=o.file,c=o.tag;i.uploadsDisplay[c]={bytesSent:0,bytesTotal:1,percent:0,name:l[0].name},i.uploadQueue.push(i.uploadToAws(e,l,c))}return i.$q.all(i.uploadQueue).then(function(t){return n(t)}).catch(function(t){return a(t)})})},UploadsService.prototype.resetUploads=function(){this.uploadsDisplay={social_image_square:null,social_image_wide:null},this.uploadQueue=[]},UploadsService.prototype.uploadToAws=function(t,e,n){var i=this;return this.awsSvc.uploadContainerFiles(t,e,n)[0].then(function(t){return t}).catch(function(t){}).finally(null,function(t){i.uploadsDisplay[n].bytesSent=t.bytesSent,i.uploadsDisplay[n].bytesTotal=t.bytesTotal,i.uploadsDisplay[n].percent=Math.ceil(t.bytesSent/t.bytesTotal*100)})},UploadsService.$inject=["$q","awsSvc"],UploadsService}(),N=function(){function ValidationService(t,e,n,i,a,s,r){this.$http=t,this.$location=e,this.$q=n,this.authSvc=i,this.config=a,this.ittUtils=s,this.urlService=r}return ValidationService.parseCSP=function(t){if(null!=t)return t.split(";").reduce(function(t,e){var n=e.trim().split(/\s+/g),i=n.shift();return i&&(t[i]=n),t},{})},ValidationService.prototype.checkXFrameOpts=function(t){var e=this,n=encodeURIComponent(t);return this.SANE_GET("/x_frame_options_proxy?url="+n).then(function(t){return e.handleSuccess(t)}).then(function(n){return e.canEmbed(n,t)}).catch(function(t){return ValidationService.handleErrors(t)})},ValidationService.prototype.urlIsEmbeddable=function(t,e){var n=this.xFrameHeaderCanEmbed(t,e.x_frame_options),i=this.cspCanEmbed(t,e.content_security_policy);return n&&i},ValidationService.prototype.mixedContent=function(t,e){return this.mixedContentUrl(t)?(e.validatedFields.mixedContent={message:"Mixed Content Detected",showInfo:!0},!0):(e.validatedFields.mixedContent={message:"",showInfo:!1},!1)},ValidationService.prototype.mixedContentUrl=function(t){return this.ittUtils.existy(t)&&/^http:\/\//.test(t)},ValidationService.prototype.validateUrl=function(t,e){return""!==t||ValidationService.emailOrPlaceholder(t)?this.urlService.isVideoUrl(t)||this.ittUtils.isValidURL(t)||ValidationService.emailOrPlaceholder(t)?(e.validatedFields.url={showInfo:!1},!0):(e.validatedFields.url={showInfo:!0,message:t+" is not a valid URL"},!1):(e.validatedFields.url={showInfo:!0,message:"Url cannot be blank"},!1)},ValidationService.prototype.inspectHeadersAsync=function(t,e,n,i){var a=this;return null!=n?this.$q(function(i){var s={canEmbed:a.urlIsEmbeddable(t,n),location:n.location,urlStatus:{content_security_policy:n.content_security_policy,x_frame_options:n.x_frame_options,response_code:n.response_code,err:n.err}};return i(a.handleXframeOptsObj(t,s,e))}):""===t||this.urlService.isVideoUrl(t)||ValidationService.emailOrPlaceholder(t)?this.$q(function(n){e.validatedFields.iframeHeaders={showInfo:!1};var i={canEmbed:!0,location:null,urlStatus:{content_security_policy:null,x_frame_options:null,response_code:null,err:null}};return"kaltura"===a.urlService.checkUrl(t).type&&(i.location=a.urlService.parseInput(t)),n(i)}):this.checkXFrameOpts(t).then(function(n){return a.handleXframeOptsObj(t,n,e)})},ValidationService.prototype.cspCanEmbed=function(t,e){if(null==e)return!0;var n=ValidationService.parseCSP(e),i=n["frame-ancestors"];if(null==i||0===i.length)return!0;var a=this.$location.host();if(1===i.length){var s=i[0];if("'self'"===s&&t.includes(a)||s.includes(a))return!0;if("'none'"===s)return!1}for(var r=0,o=i;r<o.length;r++){if(o[r].includes(a))return!0}return!1},ValidationService.prototype.xFrameHeaderCanEmbed=function(t,e){var n=!1;if(null==e||"null"===e)return!0;switch(!0){case/SAMEORIGIN/i.test(e):var i=this.$location.host(),a=document.createElement("a");a.href=t,i===a.hostname&&(n=!0);break;case/ALLOW-FROM/i.test(e):var s=e.split(",");i=this.$location.host(),angular.forEach(s,function(t){var e=t.trim().split(" ")[1],a=document.createElement("a");a.href=e,i===a.hostname&&(n=!0)});break;case/DENY/i.test(e):}return n},ValidationService.prototype.handleXframeOptsObj=function(t,e,n){var i="";return this.ittUtils.existy(e.location)&&(i=t+" redirected to "+e.location,n.validatedFields[301]={showInfo:!0,message:i,doInfo:!0}),this.ittUtils.existy(e.urlStatus.response_code)&&422===e.urlStatus.response_code?(i=t+" cannot be found",n.validatedFields[404]={showInfo:!0,message:i},this.$q.reject("404")):(null!=e.urlStatus.err&&999!==e.urlStatus.response_code?n.validatedFields.iframeHeaders={showInfo:!0,message:t+" cannot be embedded: "+e.urlStatus.err}:e.canEmbed||this.mixedContentUrl(t)?n.validatedFields.iframeHeaders={showInfo:!1}:(i="Embedded link template is disabled because "+t+" does not allow iframing",e.location&&(i+=". "+n.validatedFields[301].message,n.validatedFields[301]={}),n.validatedFields.iframeHeaders={showInfo:!0,message:i,doInfo:!0}),e)},ValidationService.emailOrPlaceholder=function(t){return/mailto:/.test(t)||"https://"===t},ValidationService.handleErrors=function(t){return{canEmbed:!1}},ValidationService.prototype.handleSuccess=function(t){return this.ittUtils.existy(t.x_frame_options)&&(t.x_frame_options=t.x_frame_options.toUpperCase()),t},ValidationService.prototype.canEmbed=function(t,e){var n={content_security_policy:t.content_security_policy,x_frame_options:t.x_frame_options,err:t.err,response_code:t.response_code},i=Object.create(null),a=t.location;return 999===t.response_code?i.canEmbed=!1:i.canEmbed=this.urlIsEmbeddable(e,t),Object.assign(i,{location:a},{urlStatus:n}),i},ValidationService.prototype.SANE_GET=function(t){var e=this;return this.authSvc.authenticate().then(function(){return e.$http.get(e.config.apiDataBaseUrl+t).then(function(t){return t.data})})},ValidationService.$inject=["$http","$location","$q","authSvc","config","ittUtils","urlService"],ValidationService}(),R=n(0);n.n(R),angular.module("itt.services",[]).service("appState",C).factory("authSvc",authSvc_authSvc).factory("awsSvc",awsSvc).factory("config",config_config).factory("dataSvc",dataSvc_dataSvc).factory("errorSvc",errorSvc_errorSvc).factory("imageResize",imageResize).factory("ittUtils",ittUtils_ittUtils).factory("mockSvc",mockSvc_mockSvc).factory("modelSvc",modelSvc_modelSvc).factory("playbackService",playbackService_playbackService).factory("questionAnswersSvc",questionAnswersSvc_questionAnswersSvc).factory("recursionHelper",recursionHelper).factory("selectService",selectService_selectService).factory("timelineSvc",timelineSvc_timelineSvc).factory("urlService",urlService_urlService).factory("playerManagerCommons",playerManagerCommons).factory("html5PlayerManager",html5PlayerManager).factory("html5UrlService",html5UrlService).factory("kalturaPlayerManager",kalturaPlayerManager).factory("kalturaScriptLoader",kalturaScriptLoader).factory("kalturaUrlService",kalturaUrlService).factory("youTubePlayerManager",youTubePlayerManager).factory("YTScriptLoader",YTScriptLoader).factory("youtubeUrlService",youtubeUrlService).factory("analyticsSvc",analyticsSvc).service("wistiaUrlService",I).service("wistiaPlayerManager",D).service("wistiaScriptLoader",E).service("validationSvc",N).service("uploadsService",F);autofocus.$inject=["$timeout"];var V='\n<div class="field">\n  <div class="label">Batch Upload Transcripts\n  </div>\n  <div class="input">\n    <div ng-if="!$ctrl.showUploader">\n      <span><button ng-click="$ctrl.showUploader = true">Batch Upload Transcripts</button></span>\n    </div>\n\n\n    <itt-asset-uploader\n      ng-if="$ctrl.showUploader"\n      episode-id="{{$ctrl.episodeId}}"\n      mime-types="{{$ctrl.mimes}}"\n      on-filedrop="$ctrl.handleTranscriptFiles(data)"\n      file-receive="$ctrl.transcripts"\n      callback="$ctrl.onUploadComplete()">\n    </itt-asset-uploader>\n\n    <itt-modal\n      wrapper-class="responsive-modal__wrapper"\n      modal-class="responsive-modal__content"\n      ng-if="$ctrl.showOptions">\n      <div class="smart-sentences__wrapper">\n        <div><p>\n          Thank you for using this new feature currently in Beta! Are you sure you want to proceed? Once saved,\n          transcript entries must be individually edited or deleted. This page will automatically refresh after\n          transcripts have successfully uploaded.</p>\n        </div>\n        <div class="smart-sentences__input">\n          <div>\n            <input class="smart-sentences__input" id="groupParam" type="checkbox" ng-model="$ctrl.selectedParam"\n                   ng-false-value="\'none\'"\n                   ng-true-value="\'group_into_sentences\'"/>\n          </div>\n          <div>\n            <label class="smart-sentences__input"\n                   for="groupParam">Group transcript segments into complete sentences (recommended for closed caption\n              transcripts)</label>\n          </div>\n        </div>\n        <div>\n          <button ng-click="$ctrl.commenseUpload()">upload transcripts</button>\n          <button ng-click="$ctrl.cancelUpload()">cancel</button>\n        </div>\n      </div>\n\n    </itt-modal>\n  </div>\n</div>',B=function(){function UploadTranscriptsController(t,e,n,i){this.MIMES=t,this.modelSvc=e,this.dataSvc=n,this.timelineSvc=i,this.showOptions=!1,this.showUploader=!1,this.selectedParam="none",this.maxDuration=null,this.transcripts={},this._maxDurParam="max_subtitle_duration"}return UploadTranscriptsController.prototype.$onInit=function(){this.mimes=this.MIMES.transcripts},UploadTranscriptsController.prototype.cancelUpload=function(){this.files=null,this.showUploader=!1,this.showOptions=!1},UploadTranscriptsController.prototype.handleTranscriptFiles=function(t){this.showOptions=!0,this.files=t},UploadTranscriptsController.prototype.commenseUpload=function(){var t=this.formatParams(),e=this.files,n=this._handleTranscripts(this.episodeId,e[0],t);this.transcripts={payload:{type:"TRANSCRIPT_UPLOAD",promises:n,files:e}}},UploadTranscriptsController.prototype.onUploadComplete=function(){this.cancelUpload(),window.location.reload()},UploadTranscriptsController.prototype.formatParams=function(){var t={};return"none"!==this.selectedParam&&(t[this.selectedParam]=!0),ittUtils_existy(this.maxDuration)&&(t[this._maxDurParam]=this.maxDuration),t},UploadTranscriptsController.prototype._handleTranscripts=function(t,e,n){var i=new FormData;return i.append("subtitles",e),this.dataSvc.batchUploadTranscripts(t,i,n)},UploadTranscriptsController.$inject=["MIMES","modelSvc","dataSvc","timelineSvc"],UploadTranscriptsController}(),q=function(){function UploadTranscripts(){this.bindings={episodeId:"@"},this.template=V,this.controller=B}return UploadTranscripts.Name="ittUploadTranscripts",UploadTranscripts}(),j=function(){function AssetUploaderController(t,e,n,i,a,s){this.$timeout=t,this.$element=e,this.awsSvc=n,this.appState=i,this.modelSvc=a,this.dataSvc=s,this.multiple=!1,this.uploadsinprogress=0,this.paused=!1,this.uploadStatus=[],this.uploads=[]}return AssetUploaderController.prototype.$onInit=function(){void 0===this.instructions?this.manPage="We support uploads of most common file formats, including .doc, .docx, .jpeg, .jpg, .pdf, .png, .ppt, .pptx, .rtf, .txt, and .zip. ":this.manPage=this.instructions,null==this.mimeTypes?this.mimeTypesArr=["application/*","image/*","video/*","text/*","audio/*","model/*"]:this.mimeTypesArr=this.mimeTypes.split(","),void 0===this.errorText&&(this.errorText="Whoops! You may want to try that again!"),this.mimeTypesArr=this.mimeTypesArr.map(function(t){return t.trim()})},AssetUploaderController.prototype.$postLink=function(){var t=this;this.$timeout(function(){t.droptarget=t.$element.find(".uploadDropTarget"),t.fileinput=t.$element.find(".uploadFileInput"),t.uploadsinprogress=0,t.droptarget[0].addEventListener("drop",function(e){return t.handleDrop(e)}),t.droptarget[0].addEventListener("dragover",function(e){return t.handleDragOver(e)}),t.droptarget[0].addEventListener("dragenter",function(e){return t.handleDragEnter(e)}),t.droptarget[0].addEventListener("dragleave",function(e){return t.handleDragLeave(e)})})},AssetUploaderController.prototype.$onChanges=function(t){if(t.fileReceive){var e=t.fileReceive.currentValue,n=e.payload;if(null!=n)switch(n.type){case"TRANSCRIPT_UPLOAD":var i=n.promises,a=n.files;this.commenseUploads(a,i)}}},AssetUploaderController.prototype.pauseUpload=function(){this.awsSvc.pauseUpload(),this.paused=!0},AssetUploaderController.prototype.resumeUpload=function(){this.awsSvc.resumeUpload(),this.paused=!1},AssetUploaderController.prototype.cancelUpload=function(){this.awsSvc.cancelUpload()},AssetUploaderController.prototype.handleUploads=function(t){return this.multiple&&(t.length>1||this.uploads.length>0)?(this.errormessage="You may only upload one file at a time here.",!1):this.checkMimeType(t)?this.onFiledrop?void this.onFiledrop({data:t}):void this.commenseUploads(t):void(this.errormessage=this.errorText)},AssetUploaderController.prototype.commenseUploads=function(t,e){var n=this.setupUploadDisplay(t,e),i=n.oldstack,a=n.newstack;this.processUploads(i,a,t)},AssetUploaderController.prototype.setupUploadDisplay=function(t,e){var n=this.uploads.length,i=this.uploads.length+t.length;return this.uploadsinprogress=this.uploadsinprogress+t.length,this.uploadStatus.push({bytesSent:0,bytesTotal:1,percent:0,name:t[0].name}),this.containerId?this.uploads=this.uploads.concat(this.awsSvc.uploadContainerFiles(this.containerId,t)):this.episodeId?this.uploads=this.uploads.concat(e):this.uploads=this.uploads.concat(this.awsSvc.uploadUserFiles(this.appState.user._id,t)),{oldstack:n,newstack:i}},AssetUploaderController.prototype.checkMimeType=function(t){var e=this,n=!1;return Array.from(t).forEach(function(t){var i=t.type;if(e.episodeId){var a=t.name.match(/(vtt|srt)/);a&&a.length&&(i="text/"+a[0])}e.mimeTypesArr.forEach(function(t){if(AssetUploaderController.strEndsWith(t,"*")){var a=t.slice(0,-1);AssetUploaderController.strStartsWith(i,a)&&(n=!0)}else i===t&&(n=!0);e.errorText=i+" uploads are not allowed here."})}),n},AssetUploaderController.prototype.processUploads=function(t,e,n){for(var i=this,a=t;a<e;a++)!function(e){i.uploadStatus[e]={bytesSent:0,bytesTotal:1,percent:0,name:n[e-t].name},i.uploads[e].then(function(t){if(i.episodeId&&i.callback)return i.callback({data:t}),i.uploadStatus[e].done=!0,void i.oneDone();i.modelSvc.cache("asset",t.file),i.callback&&i.callback({data:t.file._id}),i.uploadStatus[e].done=!0,i.oneDone()}).catch(function(t){i.uploadStatus[e].error=t}).finally(null,function(t){i.uploadStatus[e].bytesSent=t.bytesSent,i.uploadStatus[e].bytesTotal=t.bytesTotal,i.uploadStatus[e].percent=Math.ceil(t.bytesSent/t.bytesTotal*100)})}(a)},AssetUploaderController.prototype.oneDone=function(){this.uploadsinprogress=this.uploadsinprogress-1,0===this.uploadsinprogress&&(this.fileinput.value="",this.paused=!1)},AssetUploaderController.prototype.handleDrop=function(t){t.preventDefault(),t.stopPropagation(),this.handleDragLeave(t),this.handleUploads(t.dataTransfer.files)},AssetUploaderController.prototype.handleDragOver=function(t){return t.preventDefault(),t.dataTransfer.dropEffect="move",this.handleDragEnter(t),!1},AssetUploaderController.prototype.handleDragEnter=function(t){this.droptarget.addClass("droppable")},AssetUploaderController.prototype.handleDragLeave=function(t){this.droptarget.removeClass("droppable")},AssetUploaderController.strStartsWith=function(t,e){return 0===t.indexOf(e)},AssetUploaderController.strEndsWith=function(t,e){return t.substring(t.length-e.length,t.length)===e},AssetUploaderController.$inject=["$timeout","$element","awsSvc","appState","modelSvc","dataSvc"],AssetUploaderController}(),H=function(){function AssetUploader(){this.bindings={containerId:"@?",episodeId:"@?",callback:"&?",onFiledrop:"&?",fileReceive:"<?",mimeTypes:"@?",instructions:"@?",errorText:"@?",multiple:"<?"},this.templateUrl="templates/producer/asset-uploader.html",this.controller=j}return AssetUploader.Name="ittAssetUploader",AssetUploader}();ittClipboard.$inject=["ittUtils"],ittContainer.$inject=["$timeout","$location","appState","modelSvc","recursionHelper","dataSvc","ittUtils"],ittContainerEpisodes.$inject=["modelSvc","recursionHelper","appState","dataSvc"],ittDynamicModel.$inject=["$compile","$parse"],ittEpisode.$inject=["$interval","analyticsSvc","modelSvc","appState"],ittEpisodeEditor.$inject=["$rootScope","$timeout","appState","modelSvc","dataSvc","authSvc","selectService","playbackService","urlService"],ittIframe.$inject=["appState"],ittItem.$inject=["$http","$timeout","$interval","config","authSvc","appState","analyticsSvc","timelineSvc","modelSvc","selectService","playbackService","urlService","validationSvc"],ittItemDetailModal.$inject=["appState"],ittItemEditor.$inject=["$rootScope","errorSvc","appState","modelSvc","timelineSvc","selectService"],ittLogin.$inject=["$location","$routeParams","config","authSvc","appState","errorSvc"],ittMagnet.$inject=["$rootScope","appState","playbackService"],ittMagnetized.$inject=["$rootScope","appState"],ittMcQuestion.$inject=["questionAnswersSvc","analyticsSvc","appState"],ittNarrativeTimeline.$inject=["$routeParams","$location","dataSvc","appState","authSvc","errorSvc"];var W=n("rFfA"),K=n("5Tuk");ittOptionsDisabled.$inject=["$parse"],ittReviewMode.$inject=["$timeout","appState"],ittScene.$inject=["$interval","appState"],ittSearchPanel.$inject=["appState"],ittShowFocus.$inject=["$timeout"],ittShowHideVisualOnly.$inject=["$animate"],ittTimeline.$inject=["$timeout","appState","timelineSvc","modelSvc","playbackService"];var z=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(a,s){function fulfilled(t){try{step(i.next(t))}catch(t){s(t)}}function rejected(t){try{step(i.throw(t))}catch(t){s(t)}}function step(t){t.done?a(t.value):new n(function(e){e(t.value)}).then(fulfilled,rejected)}step((i=i.apply(t,e||[])).next())})},G=this&&this.__generator||function(t,e){function verb(t){return function(e){return step([t,e])}}function step(s){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=i[2&s[0]?"return":s[0]?"throw":"next"])&&!(a=a.call(i,s[1])).done)return a;switch(i=0,a&&(s=[0,a.value]),s[0]){case 0:case 1:a=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,i=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){r.label=s[1];break}if(6===s[0]&&r.label<a[1]){r.label=a[1],a=s;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(s);break}a[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(t){s=[6,t],i=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}var n,i,a,s,r={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};n("IiAB");ittUser.$inject=["$q","appState","authSvc","dataSvc","awsSvc","modelSvc","imageResize"],ittValidAsset.$inject=["ittUtils"],ittValidEpisodeUrl.$inject=["urlService","ittUtils"],ittValidPathslug.$inject=["modelSvc","ittUtils"],ittValidUrl.$inject=["ittUtils"],ittVolumeSlider.$inject=["playbackService"],sxsAddContent.$inject=["appState","playbackService"],sxsAnnotatorAutocomplete.$inject=["$timeout","modelSvc","appState"];var Y=function(){function SxsContainerAssetsController(t,e,n,i,a,s,r,o){this.$rootScope=t,this.$q=e,this.dataSvc=n,this.modelSvc=i,this.awsSvc=a,this.appState=s,this.MIMES=r,this.authSvc=o}return SxsContainerAssetsController.prototype.$onInit=function(){var t=this;this.$q(function(e,n){t.modelSvc.containers[t.containerId]?(t.container=t.modelSvc.containers[t.containerId],t.container.assetsHaveLoaded?e():t.dataSvc.getContainerAssets(t.containerId).then(e)):t.dataSvc.getContainer(t.containerId).then(function(){t.container=t.modelSvc.containers[t.containerId],t.dataSvc.getContainerAssets(t.containerId).then(e)})}).then(function(e){"narrative"===t.context?t.assets=Object.keys(t.modelSvc.assets).reduce(function(e,n){var i=t.modelSvc.assets[n];return(i.tags&&i.tags[0]===b||i.tags[0]===x)&&(e[n]=i),e},{}):t.assets=t.modelSvc.assets,t.isCustAdmin=t.authSvc.userHasRole("customer admin"),t.isAdmin=t.authSvc.userHasRole("admin"),t.canAccess=t.isCustAdmin||t.isAdmin,t.MIMES[t.mimeKey]?(t.mimes=t.MIMES[t.mimeKey],t.isAdmin&&(t.mimes+=",video/*")):t.mimes=t.MIMES.default})},SxsContainerAssetsController.prototype.up=function(){this.showParent=!0},SxsContainerAssetsController.prototype.toggleImages=function(){this.onlyImages=!this.onlyImages},SxsContainerAssetsController.prototype.toggleGrid=function(){this.gridView=!this.gridView},SxsContainerAssetsController.prototype.assetClick=function(t){if(this.context&&"narrative"===this.context)return void this.onAssetSelect({$assetId:t});this.$rootScope.$emit("UserSelectedAsset",t)},SxsContainerAssetsController.$inject=["$rootScope","$q","dataSvc","modelSvc","awsSvc","appState","MIMES","authSvc"],SxsContainerAssetsController}(),Q=function(){function SxsContainerAssets(){this.bindings={containerId:"@",mimeKey:"@?",context:"@?",onAssetSelect:"&?"},this.templateUrl="templates/producer/container-assets.html",this.controller=Y}return SxsContainerAssets.Name="sxsContainerAssets",SxsContainerAssets}();sxsInputI18n.$inject=["$timeout","appState","textAngularManager"],sxsInputTime.$inject=["$rootScope","$timeout","appState","modelSvc","timelineSvc","playbackService","ittUtils"];var X='\n<div ng-if="$ctrl.narrative.enable_social_sharing" class="socialshare-filedrop">\n\n  <div ng-repeat="(tag, imgObj) in $ctrl.images" ng-class="\'itt-filedrop__\' + tag">\n    <itt-filedrop\n      on-error="$ctrl.display[tag].error"\n      on-drop="$ctrl.handleImage(files, tag)">\n      \n      <itt-filedrop-target>\n        <div class="itt-filedrop__wrapper" ng-if="imgObj.path == null">\n          <span class="itt-filedrop__placeholder"></span>\n        </div>\n      </itt-filedrop-target>\n\n      <itt-filedrop-preview>\n        <div ng-if="imgObj.path">\n          <span class="socialshare__img--cancel" ng-click="$ctrl.resetImg(imgObj, tag)"></span>\n          <div class="socialshare__img">\n            <itt-upload-progress upload="$ctrl.uploadsService.uploadsDisplay[tag]"></itt-upload-progress>\n            <img ng-src="{{imgObj.path}}" ng-class="{\'--drop-error\': $ctrl.display[tag].error}"/>\n          </div>\n        </div>\n      </itt-filedrop-preview> \n\n    </itt-filedrop> \n    <div>{{$ctrl.display[tag].text}}</div>\n  </div>\n\n  \x3c!--begin social controls--\x3e\n  <div class="socialshare__controls">\n    <button ng-click="$ctrl.toggleBrowseUploaded()">Browse Uploaded</button>\n    <label class="button" for="fileBtn">Upload New</label>\n    <input id="fileBtn" type="file" accept="image/*" itt-files-handler on-selected="$ctrl.handleImage(files)"/>\n  </div>\n  \x3c!--end social controls--\x3e\n\n  \x3c!--begin browse uploaded--\x3e\n  <itt-modal wrapper-class="responsive-modal__wrapper" modal-class="narrative__modal" ng-if="$ctrl.browseUploaded">\n    <div class="scrollContainer">\n      <sxs-container-assets\n        container-id="{{$ctrl.containerId}}"\n        on-asset-select="$ctrl.uploadedAssetSelected($assetId)"\n        context="narrative">\n      </sxs-container-assets>\n    </div>\n    <div class="controlsContainer">\n      <button ng-click="$ctrl.toggleBrowseUploaded()">Cancel</button>\n    </div>\n  </itt-modal>\n  \x3c!--end browse uploaded--\x3e\n</div>\n',J={social_image_square:"Recommend 576 x 576",social_image_wide:"Recommend 1200 x 630"},Z=function(){function EnableSocialshareController(t,e,n,i,a,s){this.$q=t,this.$timeout=e,this.uploadsService=n,this.imageResize=i,this.dataSvc=a,this.modelSvc=s,this.browseUploaded=!1,this.images={social_image_square:null,social_image_wide:null},this.display={social_image_square:{text:J.social_image_square,error:!1},social_image_wide:{text:J.social_image_wide,error:!1}},this.files={social_image_square:{file:null},social_image_wide:{file:null}}}return EnableSocialshareController.prototype.$onInit=function(){null==this.timeline?this.type="narrative":this.type="timeline",this.model=this[this.type],this.model[this.type+"_image_ids"]&&this.model[this.type+"_image_ids"].length>0?this.getImageAssets():this.model[this.type+"_image_ids"]=[]},EnableSocialshareController.prototype.resetImg=function(t,e){this.images[e]=null,t.assetId&&this.removeImageId(t.assetId)},EnableSocialshareController.prototype.toggleBrowseUploaded=function(){this.browseUploaded=!this.browseUploaded},EnableSocialshareController.prototype.uploadedAssetSelected=function(t){var e=this.modelSvc.assets[t];this.setImageFromAsset(e),this.browseUploaded=!1},EnableSocialshareController.prototype.getImageAssets=function(){var t=this,e=[];this.model[this.type+"_image_ids"].forEach(function(n){n&&t.modelSvc.assets[n]?t.setImageFromAsset(t.modelSvc.assets[n]):e.push(n)}),e.length>0&&this.dataSvc.fetchAndCacheAssetsByIds(e).then(function(e){e.forEach(function(e){return t.setImageFromAsset(e)})})},EnableSocialshareController.prototype.handleImage=function(t,e){var n=this;this.checkAspectRatio(t[0]).then(function(i){var a=i.images,s=i.tag;if(e!==s)return n.$q.reject({errorType:"TAG_MISMATCH",currTag:e,tag:s});n.files[s].file=t,n.images=Object.assign({},n.images,a),n.model[s]={file:t}}).catch(function(t){return n.handleTagmismatchError(t.errorType,t.currTag,t.tag)})},EnableSocialshareController.prototype.handleTagmismatchError=function(t,e,n){var i=this;this.display[e].error=!0,this.display[e].text="The aspect ratio is not correct.",this.$timeout(function(){i.display[e].error=!1,i.display[e].text=J[e]},3e3)},EnableSocialshareController.prototype.checkAspectRatio=function(t){var e=this;return this.imageResize.readFileToImg(t).then(function(n){var i=e.imageResize.getImageTagType(n.width,n.height);return{images:(a={},a[i]={name:t.name,path:n.src},a),tag:i};var a})},EnableSocialshareController.prototype.setImageFromAsset=function(t){var e=t.tags[0],n=this.images[e];n&&n.assetId&&this.removeImageId(n.assetId),this.images[e]={assetId:t._id,path:t.url},this.addImageId(t._id)},EnableSocialshareController.prototype.removeImageId=function(t){this.model[this.type+"_image_ids"]=this.model[this.type+"_image_ids"].filter(function(e){return t!==e})},EnableSocialshareController.prototype.addImageId=function(t){this.model[this.type+"_image_ids"].includes(t)||this.model[this.type+"_image_ids"].push(t)},EnableSocialshareController.$inject=["$q","$timeout","uploadsService","imageResize","dataSvc","modelSvc"],EnableSocialshareController}(),tt=function(){function EnableSocialshare(){this.bindings={containerId:"@?",narrative:"=",timeline:"=?"},this.template=X,this.controller=Z}return EnableSocialshare.Name="ittEnableSocialshare",EnableSocialshare}(),et=function(){function SocialShareController(t,e){this.Socialshare=t,this.dataSvc=e,this.stubUrl="https://thecareerplaybook.narrasys.com/narratives/jim-citrin",this.expanded=!1,this.emailshareExpanded=!1,this.textCopied=!1,this.email={}}return SocialShareController.prototype.$onInit=function(){this.subdomain&&this.paths&&this.paths.narrative&&this.paths.timeline&&(this.stubUrl=SocialShareController.formatShareUrl(this.subdomain,this.paths.narrative,this.paths.timeline.url))},SocialShareController.prototype.onShare=function(t){var e={provider:t,attrs:{}};switch(t){case"email":return void this.toggleEmailshare();case"linkedin":case"twitter":case"reddit":Object.assign(e.attrs,{socialshareText:this.shareTitle},{socialshareUrl:this.stubUrl});break;default:Object.assign(e.attrs,{socialshareUrl:this.stubUrl})}this.Socialshare.share(e),this.closeAll()},SocialShareController.prototype.toggleExpanded=function(){this.expanded=!this.expanded,this.textCopied=!1,this.emailshareExpanded=!1},SocialShareController.prototype.ontextCopied=function(t){this.textCopied=!0},SocialShareController.prototype.handleEmailShare=function(t,e){var n=this;if(e.$invalid)return void e.$error.required.forEach(function(t){t.$setTouched()});this.dataSvc.sendSocialshareEmail(this.paths.timeline.id,t).then(function(t){return n.closeAll()}).catch(function(t){})},SocialShareController.formatShareUrl=function(t,e,n){return"https://"+t+".narrasys.com/narratives/"+e+"/"+n},SocialShareController.prototype.closeAll=function(){this.expanded=!1,this.textCopied=!1,this.emailshareExpanded=!1},SocialShareController.prototype.toggleEmailshare=function(){this.emailshareExpanded=!this.emailshareExpanded},SocialShareController.$inject=["Socialshare","dataSvc"],SocialShareController}(),nt=function(){function IttSocialShare(){this.bindings={providers:"<",subdomain:"@",shareTitle:"@",paths:"<"},this.templateUrl="scripts/directives/socialshare/social-share.html",this.controller=et}return IttSocialShare.Name="ittSocialShare",IttSocialShare}(),it='\n<div class="itt-filedrop itt-filedrop--border" ng-class="{\'--drop-error\': $ctrl.onError}"> \n  <div ng-transclude="target"></div>\n  \n   <div class="itt-filedrop__wrapper" ng-if="$ctrl.onError">\n    <span class="itt-filedrop__placeholder --drop-error"></span>\n   </div>\n  \n  <div ng-if="!$ctrl.error" ng-transclude="preview"></div>\n</div>\n',at=function(){function FiledropController(t){this.$element=t}return FiledropController.prototype.$postLink=function(){this.attachListeners()},FiledropController.prototype.$onDestroy=function(){this.removeListeners()},FiledropController.prototype.attachListeners=function(){var t=this;this.$element[0].addEventListener("drop",function(e){return t.handleDrop(e)}),this.$element[0].addEventListener("dragover",function(e){return t.handleDragOver(e)}),this.$element[0].addEventListener("dragenter",function(e){return t.handleDragEnter(e)}),this.$element[0].addEventListener("dragleave",function(e){return t.handleDragLeave(e)})},FiledropController.prototype.removeListeners=function(){var t=this;this.$element[0].removeEventListener("drop",function(e){return t.handleDrop(e)}),this.$element[0].removeEventListener("dragover",function(e){return t.handleDragOver(e)}),this.$element[0].removeEventListener("dragenter",function(e){return t.handleDragEnter(e)}),this.$element[0].removeEventListener("dragleave",function(e){return t.handleDragLeave(e)})},FiledropController.prototype.handleDrop=function(t){t.preventDefault(),t.stopPropagation(),this.handleDragLeave(t),this.onDrop({files:t.dataTransfer.files})},FiledropController.prototype.handleDragOver=function(t){return t.preventDefault(),t.dataTransfer.dropEffect="move",this.handleDragEnter(t),!1},FiledropController.prototype.handleDragEnter=function(t){this.$element.children().addClass("itt-filedrop--droppable")},FiledropController.prototype.handleDragLeave=function(t){this.$element.children().removeClass("itt-filedrop--droppable")},FiledropController.$inject=["$element"],FiledropController}(),st=function(){function Filedrop(){this.transclude={target:"ittFiledropTarget",preview:"ittFiledropPreview"},this.bindings={onError:"<",onDrop:"&"},this.template=it,this.controller=at}return Filedrop.Name="ittFiledrop",Filedrop}(),rt='\n\n<div class="upload-progress" ng-if="$ctrl.upload != null">\n  <h5>{{$ctrl.upload.name}} - {{$ctrl.upload.percent}}%</h5>\n  <progress\n    ng-attr-max="{{$ctrl.upload.bytesTotal}}"\n    ng-attr-value="{{$ctrl.upload.bytesSent}}">\n  </progress>\n</div>\n\n\x3c!--<div class="upload-progress">--\x3e\n  \x3c!--<p>File name! - 80%</p>--\x3e\n  \x3c!--<progress max="10" value="8"></progress>--\x3e\n\x3c!--</div>--\x3e\n\n',ot=function(){function UploadProgress(){this.bindings={upload:"<"},this.template=rt}return UploadProgress.Name="ittUploadProgress",UploadProgress}(),lt=(angular.module("itt.directives",[]).directive("ittAnnotationField",ittAnnotationField).component(H.Name,new H).directive("ittClipboard",ittClipboard).directive("ittColorSelect",ittColorSelect).directive("ittContainer",ittContainer).directive("ittContainerEpisodes",ittContainerEpisodes).directive("ittDescriptionField",ittDescriptionField).directive("ittDisplaySelect",ittDisplaySelect).directive("ittDynamicModel",ittDynamicModel).directive("ittEditPencil",ittEditPencil).directive("ittEpisode",ittEpisode).directive("ittEpisodeEditor",ittEpisodeEditor).directive("ittEpisodeList",ittEpisodeList).directive("ittFileField",ittFileField).directive("ittFilesHandler",ittFilesHandler).directive("ittFlags",ittFlags).directive("ittFlotr2Chart",ittFlotr2Chart).directive("ittGuestAccessibleUrl",ittGuestAccessibleUrl).directive("ittHighlightSelect",ittHighlightSelect).directive("ittIframe",ittIframe).directive("ittImageField",ittImageField).directive("ittItem",ittItem).directive("ittItemDetailModal",ittItemDetailModal).directive("ittItemEditor",ittItemEditor).directive("ittLanguageFlags",ittLanguageFlags).directive("ittLanguageSelect",ittLanguageSelect).directive("ittLoading",ittLoading).directive("ittLogin",ittLogin).directive("ittMagnet",ittMagnet).directive("ittMagnetized",ittMagnetized).directive("ittMcQuestion",ittMcQuestion).directive("ittModal",ittModal).directive("ittNarrative",ittNarrative).directive("ittNarrativeEditor",ittNarrativeEditor).directive("ittNarrativeList",ittNarrativeList).directive("ittNarrativeTimeline",ittNarrativeTimeline).directive("ittNav",ittNav).directive("ittOptionsDisabled",ittOptionsDisabled).directive("ittQuestionOptions",ittQuestionOptions).directive("ittQuestionTextField",ittQuestionTextField).directive("ittQuestionTypeSelect",ittQuestionTypeSelect).directive("ittReviewMode",ittReviewMode).directive("ittRouteLoading",ittRouteLoading).directive("ittScene",ittScene).directive("ittSearchPanel",ittSearchPanel).directive("ittShowFocus",ittShowFocus).directive("ittShowHideVisualOnly",ittShowHideVisualOnly).animation(".visual-hide",visualHideAnimation).directive("ittSpeakerField",ittSpeakerField).directive("ittSpeakerThumbField",ittSpeakerThumbField).directive("ittTabs",ittTabs).directive("ittTab",ittTab).directive("ittTemplateSelect",ittTemplateSelect).directive("ittTimeField",ittTimeField).directive("ittTimeline",ittTimeline).directive("ittTimelineEditor",ittTimelineEditor).directive("ittTimestampSelect",ittTimestampSelect).directive("ittTitleField",ittTitleField).directive("ittToolbarStory",ittToolbarStory).directive("ittTooltip",ittTooltip).directive("ittTranscriptField",ittTranscriptField).directive("ittTransitionSelect",ittTransitionSelect).directive("ittTypographySelect",ittTypographySelect).component(q.Name,new q).directive("ittUrlField",ittUrlField).directive("ittUser",ittUser).directive("ittValidAsset",ittValidAsset).directive("ittValidationTip",ittValidationTip).directive("ittValidEpisodeUrl",ittValidEpisodeUrl).directive("ittValidPathslug",ittValidPathslug).directive("ittValidUrl",ittValidUrl).directive("ittVideo",ittVideo).directive("ittVideoPositionSelect",ittVideoPositionSelect).directive("ittVolumeSlider",ittVolumeSlider).directive("ittWidthWatch",ittWidthWatch).directive("nysCopyright",nysCopyright).directive("sxsAddContent",sxsAddContent).directive("sxsAnnotatorAutocomplete",sxsAnnotatorAutocomplete).component(Q.Name,new Q).directive("sxsInputI18n",sxsInputI18n).directive("sxsInputTime",sxsInputTime).directive("autofocus",autofocus).component(nt.Name,new nt).component(tt.Name,new tt).component(st.Name,new st).component(ot.Name,new ot),n("l1Qu")),ct=(n.n(lt),n("DJti")),dt=(n.n(ct),n("NGC4"),n("oTj3")),pt=(n.n(dt),n(0)),mt=(n.n(pt),n("wdTO")),ut=(n.n(mt),n("5Nri")),gt=(n.n(ut),n("VUCL")),vt=(n.n(gt),n("mcSx")),ht=(n.n(vt),n("cs5V")),ft=(n.n(ht),n("ihzJ")),yt=(n.n(ft),n("w2z7"));n.n(yt);[n("ZcPu"),n("Ogf/")].forEach(function(t){t.keys().forEach(function(e){return t(e)})});angular.module("iTT",["ngRoute","ngAnimate","ngSanitize","textAngular","ui.tree","720kb.socialshare","itt.controllers","itt.filters","itt.services","itt.directives"]).constant("MIMES",{assetLib:"image/*,text/plain,application/pdf,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/rtf",file:"text/plain,application/pdf,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/rtf",default:"image/*",transcripts:"text/vtt,text/srt"}).constant("PLAYERSTATES",{"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"video cued",4:"quality changed",6:"player ready"}).constant("PLAYERSTATES_WORD",{unstarted:"-1",ended:"0",playing:"1",paused:"2",buffering:"3","quality changed":"4","video cued":"5","player ready":"6"}).config(["$routeProvider",routerConfig]).config(["$sceDelegateProvider",xDomainConfig]).config(["$httpProvider",authInterceptorConfig]).config(["$provide",textAngularConfig]).config(["$compileProvider",debugInfoConfig]).run(["$rootScope","errorSvc",runFunction])},m47d:function(t,e){var n="templates/loading.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="loading">\n\t<div class="spinner">\n\t\t<div class="rotating pie"></div>\n\t\t<div class="filler pie"></div>\n\t\t<div class="mask"></div>\n\t</div>\n\tLoading\n</div>\n')}]),t.exports=n},mNIM:function(t,e){var n="templates/scene/debug.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,"\n<pre>{{scene | pretty}}</pre>")}]),t.exports=n},mbIM:function(t,e,n){var i="templates/scene/centered.html",a='<div class="scene centered" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="col">\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t\t<div class="pane mainPane">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainBgItems| isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: (contentItems | isCurrent).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: contentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in (contentItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},ms3E:function(t,e,n){var i="templates/episode/components/reviewmode-scenes.html",a='<div class="scene animate transitionFade" ng-class="{navigable: scene.display_title}" ng-repeat="scene in scenes" ng-if="!scene._internal">\n\t<div class="pane mainPane">\n\t\t<div class="content allowHighlights" ng-class="{isNarrow: isNarrow}" itt-width-watch>\n\t\t\t<h1 class="sceneTitle" ng-if="scene.display_title" ng-bind-html="scene.display_title"></h1>\n\t\t\t<div ng-if="appState.windowWidth < 480" class="item animate" ng-repeat="item in scene.items| reviewMode | orderBy:\'start_time\'" ng-class="item.state + \' \' + item.uscReviewModeHack" itt-item="item" forceTemplate="review-all"></div>\n\t\t\t<div ng-if="appState.windowWidth >= 480" class="item animate" ng-repeat="item in scene.items | reviewMode | annotation | orderBy:\'start_time\'" ng-class="item.state" itt-item="item" forceTemplate="review-annotation"></div>\n\t\t</div>\n\t</div>\n\t<div ng-if="appState.windowWidth >= 480" class="pane altPane">\n\t\t<div class="content allowHighlights" ng-class="{isNarrow: isNarrow}" itt-width-watch>\n\t\t\t<img ng-if="$index==1" src="'+n("rXKF")+'" class="videoPadding ">\n\t\t\t\x3c!-- contentAlt --\x3e\n\t\t\t<div class="item animate" ng-repeat="item in scene.items | reviewMode | transmedia" ng-class="item.state + \' \' + item.uscReviewModeHack" itt-item="item" forceTemplate="review-transmedia">\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<itt-loading ng-if="isLoading"></itt-loading>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},nA8d:function(t,e,n){t.exports=n.p+"images/middlebury-shield.7834a4633df9f1aabab04bf7726647aa.svg"},nd4G:function(t,e,n){var i="templates/item/usc-badges-inner.html",a='<span>\n\t<img style="max-width: 5em; float:left; margin-right: 0.5em" ng-src="{{plugin.credlyImageUrl}}">\n\t<b>{{plugin.achievement}}</b>\n\t<span ng-if="plugin.eligibleForBadges">\n\t\t<p>Complete the following requirements to earn a <a ng-href="https://credly.com/recipients/{{plugin.credlyBadgeId}}" target="_blank">USC Scholar\'s Badge</a>:</p>\n\t\t<div style="clear:both; margin: 1em 1.2em; font-size:90%">\n\t\t\t<div ng-repeat="req in plugin.requirements">\n\t\t\t\t<img ng-if="req.achieved" style="width: 1em; height: 1em; margin-left: -1.2em" src="'+n("6/Qv")+'">\n\t\t\t\t<img ng-if="!req.achieved" style="width: 1em; height: 1em; margin-left: -1.2em" src="'+n("FUk5")+'">\n\t\t\t\t<span style="">{{req.name}}</span>\n\t\t\t</div>\n\t\t</div>\n\t\t<p ng-if="plugin.totalAchieved != plugin.requirements.length">\n\t\t\tYou have completed {{plugin.totalAchieved}} of {{plugin.requirements.length}} parts of this achievement.\n\t\t</p>\n\n\t\t<div ng-if="plugin.totalAchieved == plugin.requirements.length && !plugin.gotBadge">\n\t\t\t<p>Congratulations! You are eligible for a USC Scholar’s Badge. Enter your email address to claim it:</p>\n\n\t\t\t<input type="text" ng-model="plugin.userEmail">\n\t\t\t<input type="button" value="Go" ng-click="badger()">\n\n\t\t\t<span ng-if="plugin.gettingBadge">\n\t\t\t\t<small>Getting your badge...</small>\n\t\t\t</span>\n\t\t\t<div ng-if="plugin.error">\n\t\t\t\t<small>We\'re sorry, there was an error retrieving your badge. Please try again later.</small>\n\t\t\t</div>\n\t\t</div>\n\t\t<div ng-if="plugin.gotBadge">\n\t\t\tYour badge is in the mail.\n\t\t\t<span ng-if="plugin.alreadyHadBadge">(It looks like you\'ve already acquired this badge; you might want to check your spam folder for an email from credly.com.)</span>\n\t\t</div>\n\t</span>\n\t<span ng-if="!plugin.eligibleForBadges">\n\t\t<p>We\'re sorry, guest users are not eligibile for USC Scholar\'s Badges.</p>\n\t</span>\n</span>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},p2SB:function(t,e){var n="templates/producer/item.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemEdit authoringForm">\n\t<form name="ittItemForm" class="doValidate">\n\t\t<div ng-if="appState.product == \'sxs\'" class="authoringFormScrollContainer">\n\t\t\t\x3c!-- begin sxs --\x3e\n\t\t\t<itt-time-field></itt-time-field>\n\t\t\t<div ng-include="itemEditor"></div>\n\t\t\t\x3c!-- end sxs --\x3e\n\t\t</div>\n\n\t\t\x3c!--i plan to tidy this up after it\'s fully implemented but the basic layout is as follows:\n        each tab contains an ng-switch set to switch on item.producerItemType.\n        <div itt-tabs>\n            <div itt-tab>\n                <div ng-switch on="item.producerItemType"></div>\n            /div>\n            <div itt-tab>\n                <div ng-switch on="item.producerItemType"></div>\n            </div>\n            <div itt-tab>\n                <div ng-switch on="item.producerItemType"></div>\n            </div>\n        </div>\n        --\x3e\n\t\t<div ng-if="appState.product == \'producer\'">\n\t\t\t<div itt-tabs class="ittTabs">\n\t\t\t\t\x3c!--ITEM/SCENE TAB BEGIN--\x3e\n\t\t\t\t<div itt-tab class="ittTab"\n\t\t\t\t\t ng-if="selectService.showTab(item.producerItemType, \'Item\')"\n\t\t\t\t\t title="{{item.producerItemType | capitalize}}">\n\t\t\t\t\t\x3c!--current lang select--\x3e\n\t\t\t\t\t<label ng-if="languages.length > 1" style="float:right; padding-right: 24px" for="itemLangSelect">Current Language\n                        <select\n                            id="itemLangSelect"\n                            size="1"\n                            ng-model="appState.lang"\n                            ng-change="forcePreview()"\n                            ng-options="language.code as (\'[\'+language.code.toUpperCase()+\']\') for language in languages">\n                        </select>\n\t\t\t\t\t</label>\n\n\t\t\t\t\t<div ng-switch on="item.producerItemType">\n\t\t\t\t\t\t<div ng-switch-when="link">\n\t\t\t\t\t\t\t\x3c!--Time, Title, URL, Description, Template, Image, Flags--\x3e\n\t\t\t\t\t\t\t\x3c!--these are impure component directives that depend inherited scope from item--\x3e\n\t\t\t\t\t\t\t<itt-time-field></itt-time-field>\n\t\t\t\t\t\t\t<itt-title-field do-validate="true" data="item" itt-item-form="ittItemForm"></itt-title-field>\n\t\t\t\t\t\t\t<itt-url-field data="item" itt-item-form="ittItemForm"></itt-url-field>\n\t\t\t\t\t\t\t<itt-description-field data="item"></itt-description-field>\n\t\t\t\t\t\t\t<itt-template-select data="item" item-form="itemForm"></itt-template-select>\n\t\t\t\t\t\t\t<itt-image-field></itt-image-field>\n\t\t\t\t\t\t\t<itt-flags data="item"\n\t\t\t\t\t\t\t\t\t   item-form="itemForm"\n\t\t\t\t\t\t\t\t\t   flags="[\'required\', \'stop\', \'cosmetic\']"></itt-flags>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="transcript">\n\t\t\t\t\t\t\t\x3c!--time, speaker, transcript--\x3e\n\t\t\t\t\t\t\t<itt-time-field></itt-time-field>\n\t\t\t\t\t\t\t<itt-speaker-field></itt-speaker-field>\n\t\t\t\t\t\t\t<itt-transcript-field data="item" itt-item-form="ittItemForm"></itt-transcript-field>\n\t\t\t\t\t\t\t<itt-speaker-thumb-field></itt-speaker-thumb-field>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="annotation">\n\t\t\t\t\t\t\t\x3c!--Time, Annotation Text, Template, Speaker, Title, Flags--\x3e\n\t\t\t\t\t\t\t<itt-time-field></itt-time-field>\n\t\t\t\t\t\t\t<itt-title-field data="item"></itt-title-field>\n\t\t\t\t\t\t\t<itt-annotation-field data="item" itt-item-form="ittItemForm"></itt-annotation-field>\n\t\t\t\t\t\t\t<itt-template-select data="item" item-form="itemForm"></itt-template-select>\n\t\t\t\t\t\t\t<itt-speaker-field></itt-speaker-field>\n\t\t\t\t\t\t\t<itt-flags data="item"\n\t\t\t\t\t\t\t\t\t   item-form="itemForm"\n\t\t\t\t\t\t\t\t\t   flags="[\'stop\', \'cosmetic\', \'chapter_marker\', \'invertColor\']"></itt-flags>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!--scenes are layouts; hidden in this tab--\x3e\n\t\t\t\t\t\t\x3c!--<div ng-switch-when="scene">--\x3e\n\t\t\t\t\t\t\x3c!--</div>--\x3e\n\t\t\t\t\t\t<div ng-switch-when="file">\n\t\t\t\t\t\t\t\x3c!--Time, Title, File, Description, Template, Flags--\x3e\n\t\t\t\t\t\t\t<itt-time-field></itt-time-field>\n\t\t\t\t\t\t\t<itt-title-field do-validate="true" data="item" itt-item-form="ittItemForm"></itt-title-field>\n\t\t\t\t\t\t\t<itt-file-field></itt-file-field>\n\t\t\t\t\t\t\t\x3c!--<itt-template-select data="item"></itt-template-select>--\x3e\n\t\t\t\t\t\t\t<itt-description-field data="item"></itt-description-field>\n\t\t\t\t\t\t\t<itt-flags data="item"\n\t\t\t\t\t\t\t\t\t   item-form="itemForm"\n\t\t\t\t\t\t\t\t\t   flags="[\'required\', \'stop\', \'cosmetic\']"></itt-flags>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="image">\n\t\t\t\t\t\t\t\x3c!--Time, Title, Image, Description, Template, Display, Position, Orientation, Flags--\x3e\n\t\t\t\t\t\t\t<itt-time-field></itt-time-field>\n\t\t\t\t\t\t\t<itt-title-field do-validate="true" data="item" itt-item-form="ittItemForm"></itt-title-field>\n\t\t\t\t\t\t\t<itt-image-field></itt-image-field>\n\t\t\t\t\t\t\t<itt-description-field data="item"></itt-description-field>\n\t\t\t\t\t\t\t<itt-template-select data="item" item-form="itemForm"></itt-template-select>\n\t\t\t\t\t\t\t<itt-display-select data="item" item-form="itemForm"></itt-display-select>\n\t\t\t\t\t\t\t\x3c!--TODO reccommend moving orientation into layout tab--\x3e\n\t\t\t\t\t\t\t<itt-flags data="item"\n\t\t\t\t\t\t\t\t\t   item-form="itemForm"\n\t\t\t\t\t\t\t\t\t   flags="[\'required\', \'stop\', \'cosmetic\']"></itt-flags>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="question">\n\t\t\t\t\t\t\t\x3c!--Time, Question type, Title, Question Text, Image, Answers, Feedback when correct, Feedback when incorrect--\x3e\n\t\t\t\t\t\t\t<span class="eventIcon icon-question"></span>\n\t\t\t\t\t\t\t<itt-time-field></itt-time-field>\n\t\t\t\t\t\t\t\x3c!--investigate log error regarding undefined input for itt-title--\x3e\n\t\t\t\t\t\t\t<itt-title-field do-validate="true" data="item" itt-item-form="ittItemForm"></itt-title-field>\n\t\t\t\t\t\t\t<itt-question-text-field data="item" do-validate="false" itt-item-form="ittItemForm"></itt-question-text-field>\n\t\t\t\t\t\t\t<itt-question-type-select data="item"></itt-question-type-select>\n\t\t\t\t\t\t\t<itt-image-field></itt-image-field>\n\t\t\t\t\t\t\t<itt-question-options></itt-question-options>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="chapter">\n\t\t\t\t\t\t\t\x3c!--Time, Title, Description--\x3e\n\t\t\t\t\t\t\t<itt-time-field></itt-time-field>\n\t\t\t\t\t\t\t<itt-title-field do-validate="true" data="item" itt-item-form="ittItemForm"></itt-title-field>\n\t\t\t\t\t\t\t<itt-description-field data="item"></itt-description-field>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="video">\n\t\t\t\t\t\t\t<h4>{{item.producerItemType}}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-default>\n\t\t\t\t\t\t\t<h4>Default!</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!--ITEM TAB END--\x3e\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!--STYLE TAB BEGIN--\x3e\n\t\t\t\t<div itt-tab class="ittTab"\n\t\t\t\t\t ng-if="selectService.showTab(item.producerItemType, \'Style\')"\n\t\t\t\t\t title="{{item.producerItemType === \'scene\' ? \'Layout\' : \'Style\'}}">\n\t\t\t\t\t<div ng-switch on="item.producerItemType">\n\t\t\t\t\t\t\x3c!--hidden across the board--\x3e\n\t\t\t\t\t\t<div ng-switch-when="link">\n\t\t\t\t\t\t\t<itt-display-select></itt-display-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!--hidden accross the board--\x3e\n\t\t\t\t\t\t<div ng-switch-when="transcript">\n\t\t\t\t\t\t\t\x3c!--Template, Speaker Thumb, timestamp, highlight--\x3e\n\t\t\t\t\t\t\t<itt-template-select data="item" item-form="itemForm"></itt-template-select>\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="annotation">\n\t\t\t\t\t\t\t\x3c!--Display--\x3e\n\t\t\t\t\t\t\t<itt-display-select></itt-display-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="scene">\n\t\t\t\t\t\t\t\x3c!--time, template, position, display--\x3e\n\t\t\t\t\t\t\t<itt-time-field></itt-time-field>\n\t\t\t\t\t\t\t<itt-template-select data="item" item-form="itemForm"></itt-template-select>\n\t\t\t\t\t\t\t<itt-video-position-select></itt-video-position-select>\n\t\t\t\t\t\t\t<itt-display-select data="item"></itt-display-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!--file hidden in style tab--\x3e\n\t\t\t\t\t\t\x3c!--<div ng-switch-when="file">--\x3e\n\t\t\t\t\t\t\x3c!--</div>--\x3e\n\t\t\t\t\t\t\x3c!--image style tab hidden for all roles--\x3e\n\t\t\t\t\t\t\x3c!--<div ng-switch-when="image">--\x3e\n\t\t\t\t\t\t\x3c!--</div>--\x3e\n\t\t\t\t\t\t<div ng-switch-when="question">\n\t\t\t\t\t\t\t\x3c!--Template, Display, Flags--\x3e\n\t\t\t\t\t\t\t<itt-template-select data="item" item-form="itemForm"></itt-template-select>\n\t\t\t\t\t\t\t<itt-display-select data="item" item-form="itemForm"></itt-display-select>\n\t\t\t\t\t\t\t<itt-flags data="item"\n\t\t\t\t\t\t\t\t\t   item-form="itemForm"\n\t\t\t\t\t\t\t\t\t   flags="[\'required\', \'stop\', \'cosmetic\']"></itt-flags>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="chapter">\n\t\t\t\t\t\t\t<h4>{{item.producerItemType}}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="video">\n\t\t\t\t\t\t\t<h4>{{item.producerItemType}}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-default>\n\t\t\t\t\t\t\t<h4>Default!</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!--STYLE TAB END--\x3e\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!--CUSTOMIZE TAB BEGIN--\x3e\n\t\t\t\t<div itt-tab class="ittTab"\n\t\t\t\t\t ng-if="selectService.showTab(item.producerItemType, \'Customize\')"\n\t\t\t\t\t title="Customize">\n\t\t\t\t\t<div ng-switch on="item.producerItemType">\n\t\t\t\t\t\t<div ng-switch-when="link">\n\t\t\t\t\t\t\t\x3c!--Typography\tColor\tTimestamp\tHighlight\tTransition--\x3e\n\t\t\t\t\t\t\t<itt-typography-select></itt-typography-select>\n\t\t\t\t\t\t\t<itt-color-select></itt-color-select>\n\t\t\t\t\t\t\t<itt-timestamp-select></itt-timestamp-select>\n\t\t\t\t\t\t\t<itt-highlight-select></itt-highlight-select>\n\t\t\t\t\t\t\t<itt-transition-select></itt-transition-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="transcript">\n\t\t\t\t\t\t\t\x3c!--Typography,\tColor,\tTimestamp,\tHighlight,\tTransition--\x3e\n\t\t\t\t\t\t\t<itt-typography-select></itt-typography-select>\n\t\t\t\t\t\t\t<itt-color-select></itt-color-select>\n\t\t\t\t\t\t\t<itt-timestamp-select></itt-timestamp-select>\n\t\t\t\t\t\t\t<itt-highlight-select></itt-highlight-select>\n\t\t\t\t\t\t\t<itt-transition-select></itt-transition-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="annotation">\n\t\t\t\t\t\t\t\x3c!--Typography, Color, Timestamp, Highlight, Transition--\x3e\n\t\t\t\t\t\t\t<itt-typography-select></itt-typography-select>\n\t\t\t\t\t\t\t<itt-color-select></itt-color-select>\n\t\t\t\t\t\t\t<itt-timestamp-select></itt-timestamp-select>\n\t\t\t\t\t\t\t<itt-highlight-select></itt-highlight-select>\n\t\t\t\t\t\t\t<itt-transition-select></itt-transition-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="scene">\n\t\t\t\t\t\t\t\x3c!--typography, color, timestamp, highlight, transition--\x3e\n\t\t\t\t\t\t\t<itt-typography-select></itt-typography-select>\n\t\t\t\t\t\t\t<itt-color-select></itt-color-select>\n\t\t\t\t\t\t\t<itt-timestamp-select></itt-timestamp-select>\n\t\t\t\t\t\t\t<itt-highlight-select></itt-highlight-select>\n\t\t\t\t\t\t\t<itt-transition-select></itt-transition-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="file">\n\t\t\t\t\t\t\t\x3c!--Typography, Color, Timestamp, Highlight, Transition--\x3e\n\t\t\t\t\t\t\t<itt-typography-select></itt-typography-select>\n\t\t\t\t\t\t\t<itt-color-select></itt-color-select>\n\t\t\t\t\t\t\t<itt-timestamp-select></itt-timestamp-select>\n\t\t\t\t\t\t\t<itt-highlight-select></itt-highlight-select>\n\t\t\t\t\t\t\t<itt-transition-select></itt-transition-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="image">\n\t\t\t\t\t\t\t\x3c!--Typography, Color, Timestamp, Highlight, Transition--\x3e\n\t\t\t\t\t\t\t<itt-typography-select></itt-typography-select>\n\t\t\t\t\t\t\t<itt-color-select></itt-color-select>\n\t\t\t\t\t\t\t<itt-timestamp-select></itt-timestamp-select>\n\t\t\t\t\t\t\t<itt-highlight-select></itt-highlight-select>\n\t\t\t\t\t\t\t<itt-transition-select></itt-transition-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="question">\n\t\t\t\t\t\t\t\x3c!--Typography\tColor\tTimestamp\tHighlight\tTransition--\x3e\n\t\t\t\t\t\t\t<itt-typography-select></itt-typography-select>\n\t\t\t\t\t\t\t<itt-color-select></itt-color-select>\n\t\t\t\t\t\t\t<itt-timestamp-select></itt-timestamp-select>\n\t\t\t\t\t\t\t<itt-highlight-select></itt-highlight-select>\n\t\t\t\t\t\t\t<itt-transition-select></itt-transition-select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="chapter">\n\t\t\t\t\t\t\t<h4>{{item.producerItemType}}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-when="video">\n\t\t\t\t\t\t\t<h4>{{item.producerItemType}}</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-switch-default>\n\t\t\t\t\t\t\t<h4>Default!</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!--CUSTOMIZE TAB END--\x3e\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="ittTabFoot">\n\t\t\t<a ng-click="cancelEdit()">Cancel</a> &nbsp; &nbsp;\n\t\t\t<button ng-if="\n\t\t\titem._id != \'internal:editing\' &&\n\t\t\t!(item._type == \'Scene\' && item.start_time <= 0.01)\n\t\t" ng-click="deleteEvent(item._id)">Delete\n\t\t\t</button>\n\t\t\t<button ng-click="saveEvent()" ng-disabled="blockDoubleClicks || ittItemForm.$invalid">Save</button>\n\t\t</div>\n\t</form>\n\n</div>\n')}]),t.exports=n},"p3P+":function(t,e,n){var i="templates/player.html",a='<div ng-class="{\n\tisTouchDevice: appState.isTouchDevice,\n\tisFramed: appState.isFramed,\n\tisProducer: (appState.product == \'producer\'),\n\tisSxS: (appState.product == \'sxs\'),\n\n\tcanEditContent: (!appState.editEvent && !appState.editEpisode) && (appState.product == \'producer\' || appState.product == \'sxs\')\n\t}">\n\t<div class="player">\n\t\t\x3c!-- TODO: make sure user has admin role for canEditContent --\x3e\n\n\t\t\x3c!--<div ng-include="\'templates/toolbar-story.html\'"></div>--\x3e\n\n\t\t<itt-toolbar-story></itt-toolbar-story>\n\n\t\t<itt-loading ng-if="loading"></itt-loading>\n\t\t<div ng-show="!loading" itt-episode ng-class="{\n\t\tpadForEditing: appState.editEvent || appState.editEpisode,\n\t\tshowBackgroundOnly: appState.producerEditLayer < 0,\n\t\tshowForegroundOnly: appState.producerEditLayer > 0,\n\t}"></div>\n\n\t\t<div class="toolbar-bottom" itt-show-hide-visual-only="appState.videoControlsActive" ng-mouseenter="showControls();" ng-click="showControls();" ng-mouseleave="allowControlsExit()">\n\t\t\t<div class="toolbar-bottom-fill">\n\t\t\t\t<div ng-show="appState.editEvent || appState.editEpisode" class="navPanel editPanel">\n\t\t\t\t\t<div ng-if="appState.editEvent" itt-item-editor="appState.editEvent"></div>\n\t\t\t\t\t<div ng-if="appState.editEpisode" itt-episode-editor="appState.editEpisode"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div itt-timeline></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="toolbar-bottom-controltrigger" ng-mouseenter="showControls();" ng-click="showControls();" ng-focus="showControls()"></div>\n\t</div>\n\n\t<div class="animate transitionFade" ng-if="appState.videoControlsActive && (appState.product == \'sxs\' || appState.product == \'producer\')" ng-mouseenter="showControls();" ng-click="showControls();" ng-focus="showControls()" sxs-add-content></div>\n\n\t<div class="autoscroll" ng-if="appState.autoscroll && appState.autoscrollBlocked" ng-click="enableAutoscroll()">\n\t\t<img src="'+n("WeeJ")+'" width="32" height="32">\n\t</div>\n\n\t<div ng-show="show.navPanel" class="modal-backdrop" ng-click="hidePanel(\'navPanel\')"></div>\n\t<div ng-show="show.profilePanel" class="modal-backdrop" ng-click="hidePanel(\'profilePanel\')"></div>\n\n\t\x3c!-- ITEM DETAIL --\x3e\n\t<div ng-show="appState.itemDetail" class="modal-backdrop" ng-click="appState.itemDetail=false"></div>\n\t<div ng-if="appState.itemDetail" itt-item-detail-modal="appState.itemDetail"></div>\n\n\n\t\x3c!--show.profilePanel is toggled toobar-story.html--\x3e\n\t<div ng-if="show.profilePanel">\n\t\t\x3c!--<div class="arrow-up"></div>--\x3e\n\t\t\x3c!--$parent because ng-if creates a new scope--\x3e\n\t\t<itt-modal modal-class="account__modal" wrapper-class="account__modal--wrapper">\n\t\t\t<button ng-hide="appState.isFramed ||  !(userHasRole(\'admin\') || userHasRole(\'customer admin\'))"\n\t\t\t\t\tclass="button"\n\t\t\t\t\tng-click="editInfo = !editInfo">{{editInfo ? \'Done Editing\' : \'Edit Profile\'}}</button>\n\t\t\t<a class="button" ng-click="show.profilePanel = false">close</a>\n\t\t\t<itt-nav ng-if="!editInfo && ((userHasRole(\'admin\') || userHasRole(\'customer admin\')) && !appState.isFramed)"\n\t\t\t\t\t on-logout="$parent.logout()" in-player="true"></itt-nav>\n\n\t\t\t<div ng-if="editInfo || appState.isFramed ||  !(userHasRole(\'admin\') || userHasRole(\'customer admin\'))">\n\t\t\t\t<div itt-user></div>\n\t\t\t</div>\n\t\t</itt-modal>\n\t</div>\n\n\n\n\n\t<div ng-cloak ng-if="show.wileyNag &&  (appState.productLoadedAs == \'player\'\n\t \t\t\t|| (appState.productLoadedAs == \'narrative\'\n\t \t\t\t&& !narrative.disable_new_window ) )" class="wileyNag animate transitionFade">\n\t\t\x3c!-- HACK design-by-committee idiocy --\x3e\n\t\t<div>\n\t\t\t<span style="float:right">⤴</span>\n\t\t\t<span style="float:right; display:inline-block; padding: 5px">Go here for best view</span>\n\t\t</div> <a class="goAway" ng-click="noWileyNag()">Don\'t show this again</a>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},pMX5:function(t,e,n){var i="templates/episode/narrasys-pro.html",a='<div class="episode professional narrasys" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent"\n\t\t  ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="professional__branding">\n\t\t<div class="branding--content">\n\t\t\t<nys-copyright class="professional__copyright"></nys-copyright>\n\t\t\t<img class="professional__logo" src="'+n("kDpR")+'"/>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},phYv:function(t,e){var n="templates/item/review-transmedia.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span ng-class="{isCosmetic: item.cosmetic}">\n\t<div ng-if="item.sxs" ng-include="item.templateUrl"></div>\n\t<span ng-if="!item.sxs">\n\t\t<span ng-if="item.layouts[0] == \'windowFg\'" ng-include="\'templates/item/review-windowfg.html\'"></span>\n\t\t<span ng-if="item.layouts[0] != \'windowFg\'">\n\t\t\t<div ng-if="item.data._pluginType" ng-include="item.templateUrl"></div>\n\t\t\t<span ng-if="!item.data._pluginType">\n\t\t\t\t<a class="edit-event" ng-click="editItem()">\n\t\t\t\t\t<span>Edit item</span>\n\t\t\t\t</a>\n\n\t\t\t\t<div class="itemTemplate">\n\t\t\t\t\t<div class="itemHead">\n\t\t\t\t\t\t<a role="button" tabindex="0" class="startTime displayTime" aria-label="Seek video to {{item.displayStartTime}}" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t\t\t\t\t<div class="category item__title">\n\t\t\t\t\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t\t\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span ng-if="item._type == \'Annotation\'">\n\t\t\t\t\t\t\x3c!-- text-transmedia or text-definition --\x3e\n\t\t\t\t\t\t<div class="text">\n\t\t\t\t\t\t\t<div class="title">\n\t\t\t\t\t\t\t\t<div ng-if="item.display_annotator" class="authorName" ng-bind-html="item.display_annotator"></div>\n\t\t\t\t\t\t\t\t<div ng-if="item.display_title" class="authorName" ng-bind-html="item.display_title"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div ng-bind-html="item.display_annotation"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span ng-if="item._type != \'Annotation\'">\n\t\t\t\t\t\t<div class="text">\n\t\t\t\t\t\t\t<div class="title">\n\t\t\t\t\t\t\t\t<a tabindex="0" ng-if="handleOutgoingLinkDisplay()" class="fakeLink escapelink" ng-click="outgoingLink(item.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t\t\t\t\t\t<a tabindex="0" role="button" class="fakeLink" ng-if="!handleOutgoingLinkDisplay()" x-ng-keypress="toggleDetailOnKeyPress($event)" ng-click="toggleDetailView()" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText" aria-label="Toggle detail display of {{item.display_title}}"></a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div ng-bind-html="item.display_description"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="itemDetail" ng-if="item.showInlineDetail && item._type == \'Link\'">\n\t\t\t\t\t\t\t<a tabindex="0" ng-if="!item.noExternalLink" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" class="escapelink">(new window)</a>\n\t\t\t\t\t\t\t\t<itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n\t\t\t\t\t\t\t\t<itt-video\n\t\t\t\t\t\t\t\t\tng-if="item.isVideoUrl"\n\t\t\t\t\t\t\t\t\tmedia-src-arr="[item.url]"\n\t\t\t\t\t\t\t\t\tplayer-id="item._id"\n\t\t\t\t\t\t\t\t\tmain-player="false">\n\t\t\t\t\t\t\t\t</itt-video>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="itemDetail" ng-if="item.showInlineDetail && item._type != \'Link\'">\n\t\t\t\t\t\t\t\x3c!-- this doesn\'t handle non-image Uploads, but this template is goign to be phased out very soon anyway in favor of searchresults-all so I\'m not going to bother --\x3e\n\t\t\t\t\t\t\t<div class="touchable" style="position:relative">\n\t\t\t\t\t\t\t\t<img ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t\t\t\t\t\t\t<div class="touchableIndicator"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t</span>\n\t</span>\n\t<div class="clear"></div>\n</span>\n')}]),t.exports=n},"px/Z":function(t,e,n){var i="templates/episode/kellogg.html",a='<div class="episode episode-kellogg" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<img src="'+n("kRx8")+'">\n\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\t<div class="banner-logo"></div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},q06B:function(t,e){var n="templates/item/sxs-video.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemTemplate sxs-item">\n  <a class="edit-event" ng-click="editItem()" ng-if="item.editableByThisUser">[Edit]</a>\n  <div class="avatar">\n    <img ng-src="{{item.avatar.url || appState.noAvatar }}">\n  </div>\n  <div class="itemHead">\n    <div class="authorName" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n  </div>\n  <div class="text">\n    <div class="title" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n    <div ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n  </div>\n\n  <a class="escapelink" ng-click="outgoingLink(item.url)">New window</a>\n  <div ng-if="!handleOutgoingLinkDisplay()">\n    <itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n    <div class="sxs-video">\n      <itt-video\n        ng-if="item.isVideoUrl"\n        media-src-arr="[item.url]"\n        player-id="item._id"\n        main-player="false">\n      </itt-video>\n    </div>\n  </div>\n  <div class="clear"></div>\n</div>\n')}]),t.exports=n},qUX4:function(t,e,n){t.exports=n.p+"images/itt.d5a7cf98384da7c6a0347326ed4d7cb7.svg"},qZRx:function(t,e,n){var i="templates/scene/centeredPro.html",a='<div class="scene centered-pro" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div itt-item="item" class="item animate banner-pull-quote" ng-class="item.styleCss + \' \' + item.state"\n\t\t ng-repeat="item in (contentItems | isCurrent | filter:{templateUrl: \'templates/item/text-h1.html\'} )">\n\t</div>\n\t<div class="col">\n\t\t<div itt-magnet class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t\t<div class="pane mainPane">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainBgItems| isCurrent"\n\t\t\t\t\t ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: (contentItems | isCurrent).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: contentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in (contentItems | isCurrent | filter:centeredProTransmedia  )"\n\t\t\t\t\t ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t\x3c!--<div class="fill fgLayer overlay">--\x3e\n\t\t\t\t\x3c!--<div class="item animate" ng-repeat="item in mainFgItems | isCurrent"--\x3e\n\t\t\t\t\t \x3c!--ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>--\x3e\n\t\t\t\x3c!--</div>--\x3e\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},qpRi:function(t,e){var n="templates/item/image-linkonly.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text">\n\t\t<div class="title">\n\t\t\t<a tabindex="0" x-ng-keypress="outgoingLinkOnKeyPress(item.asset.url,$event)" ng-click="outgoingLink(item.asset.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t</div>\n\t\t<div class="text" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},rFfA:function(t,e,n){t.exports=n.p+"images/Narrasys_Banner.02a409f34b80c72134169a171c9c8852.svg"},rGHM:function(t,e){var n="templates/producer/item/sxs-link.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span class="eventIcon icon-link"></span>\n<itt-title-field do-validate="false" data="item" itt-item-form="ittItemForm"></itt-title-field>\n<itt-url-field data="item" context="editor" itt-item-form="ittItemForm"></itt-url-field>\n<itt-description-field data="item"></itt-description-field>\n\n')}]),t.exports=n},rLXe:function(t,e){var n="templates/producer/container-assets.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div ng-if="$ctrl.showParent">\n  <sxs-container-assets container-id="{{$ctrl.container.parent_id}}"></sxs-container-assets>\n</div>\n<div class="containerAssets">\n\t<div ng-if="$ctrl.appState.product != \'sxs\' && $ctrl.container.parent_id && !$ctrl.showParent">\n\t\t<a class="goUp" ng-click="$ctrl.up()">Parent container</a>\n\t</div>\n\t<div class="title">{{$ctrl.container.display_name}} - Asset Library\n\t</div>\n\n\t<div class="controls">\n\t\t<a ng-click="$ctrl.toggleImages()">\n\t\t\t<span ng-if="$ctrl.onlyImages">Images</span>\n\t\t\t<span ng-if="!$ctrl.onlyImages">All</span>\n\t\t</a>\n\t\t&nbsp;\n\t\t<a ng-click="$ctrl.toggleGrid()">\n\t\t\t<span ng-if="$ctrl.gridView">▦</span>\n\t\t\t<span ng-if="!$ctrl.gridView">☰</span>\n\t\t</a>\n\t</div>\n\n\t<div class="scrollPane" ng-if="!$ctrl.hideItems">\n\t\t<div ng-if="$ctrl.gridView">\n\t\t\t<div class="grid"\n           ng-repeat="asset in $ctrl.isCustAdmin ? ($ctrl.assets | vidsFromCustAdmins) : $ctrl.assets" ng-if="asset.container_id == $ctrl.containerId && !($ctrl.onlyImages && asset._type != \'Asset::Image\')"\n           ng-click="$ctrl.assetClick(asset._id)">\n\t\t\t\t<div ng-if="asset._type == \'Asset::Image\'">\n\t\t\t\t\t<img class="thumbnail" ng-src="{{asset.url}}">\n\t\t\t\t</div>\n\n\t\t\t\t<div ng-if="asset._type != \'Asset::Image\'">\n\t\t\t\t\t<div class="thumbnail">{{asset._type}}</div>\n\t\t\t\t</div>\n        {{asset.display_name}} <span ng-if="asset.tags[0]"> - {{asset.tags[0] | tagName}}</span>\n\t\t\t</div>\n\t\t</div>\n\t\t<table ng-if="!$ctrl.gridView">\n\t\t\t<tr ng-repeat="asset in $ctrl.isCustAdmin ? ($ctrl.assets | vidsFromCustAdmins) : $ctrl.assets" ng-if="asset.container_id == $ctrl.containerId && !($ctrl.onlyImages && asset._type != \'Asset::Image\')"\n          ng-click="$ctrl.assetClick(asset._id)">\n\t\t\t\t<td>\n\t\t\t\t\t<div ng-if="asset._type == \'Asset::Image\'">\n\t\t\t\t\t\t<img class="thumbnail" ng-src="{{asset.url}}">\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t\t<td>{{asset.size |asBytes}}</td>\n\t\t\t\t<td>{{asset.content_type}}</td>\n\t\t\t\t<td>\n\t\t\t\t\t{{asset.display_name}}\n\t\t\t\t</td>\n        <td ng-if="asset.tags[0]">{{asset.tags[0] | tagName}}</td>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n\t<br>\n\n  <itt-asset-uploader\n    container-id="{{$ctrl.container._id}}"\n    mime-types="{{$ctrl.mimes}}"\n    multiple="true"\n    ng-if="$ctrl.canAccess && $ctrl.context !== \'narrative\'">\n  </itt-asset-uploader>\n</div>\n')}]),t.exports=n},rSRG:function(t,e){var n="templates/producer/item/producer-annotation.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- <span class="eventIcon icon-comment"></span>\n --\x3e\n\x3c!--DEPRECATED WITH PRODUCER V1 --\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Annotation Text [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.annotation" x-inputtype="\'textarea\'" autofocus></div>--\x3e\n\x3c!--</div>--\x3e\n\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Template</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<select ng-model="item.templateUrl"--\x3e\n\t\t\t\t\x3c!--ng-change="selectService.onSelectChange(item)"--\x3e\n\t\t\t\t\x3c!--ng-options="option.url as option.name for option in item.templateOpts">--\x3e\n\t\t\x3c!--</select>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Speaker [{{appState.lang}}]--\x3e\n\t\x3c!--</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<div sxs-annotator-autocomplete="annotators" item="item" ng-model="item.annotator"></div>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\x3c!--&lt;!&ndash;<div class="field">&ndash;&gt;--\x3e\n\t\x3c!--&lt;!&ndash;<div class="label">Speaker thumbnail&ndash;&gt;--\x3e\n\t\x3c!--&lt;!&ndash;</div>&ndash;&gt;--\x3e\n\t\x3c!--&lt;!&ndash;<div class="input" ng-include="\'templates/producer/upload-producer.html\'">&ndash;&gt;--\x3e\n\t\x3c!--&lt;!&ndash;</div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;</div>&ndash;&gt;--\x3e\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Title [{{appState.lang}}]</div>--\x3e\n\t\x3c!--<div class="input" sxs-input-i18n="item.title" x-inputtype="\'input\'" autofocus></div>--\x3e\n\x3c!--</div>--\x3e\n\n\x3c!--<div class="field">--\x3e\n\t\x3c!--<div class="label">Flags</div>--\x3e\n\t\x3c!--<div class="input">--\x3e\n\t\t\x3c!--<label>--\x3e\n\t\t\t\x3c!--<input type="checkbox" ng-model="item.required">Required--\x3e\n\t\t\x3c!--</label>--\x3e\n\t\t\x3c!--<label>--\x3e\n\t\t\t\x3c!--<input type="checkbox" ng-change="selectService.onSelectChange(item)" ng-model="item.stop">Stop item--\x3e\n\t\t\x3c!--</label>--\x3e\n\t\t\x3c!--<label>--\x3e\n\t\t\t\x3c!--<input type="checkbox" ng-model="item.cosmetic">Cosmetic--\x3e\n\t\t\x3c!--</label>--\x3e\n\t\t\x3c!--<label ng-if="item.templateUrl === \'templates/item/text-h1.html\'">--\x3e\n\t\t\t\x3c!--<input type="checkbox" ng-model="item.chapter_marker">Chapter Event--\x3e\n\t\t\x3c!--</label>--\x3e\n\t\x3c!--</div>--\x3e\n\x3c!--</div>--\x3e\n\n')}]),t.exports=n},rXKF:function(t,e,n){t.exports=n.p+"images/aspectratiopreserver-16x9.81dd48a755a6e8f01bfc872a4d2ab76a.gif"},rdiM:function(t,e){var n="templates/item/image-caption.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="captionContainer touchable">\n\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t<div class="touchableIndicator"></div>\n\t\t<div class="caption">\n\t\t\t<div class="title item__title item__title--image-caption" ng-bind-html="item.display_title | highlightSubstring: appState.searchText"></div>\n\t\t\t<div class="text item__text item__text--image-caption" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t\t</div>\n\t</div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},rfeV:function(t,e,n){var i="templates/scene/1col.html",a='<div class="scene onecol" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div itt-magnet class="videoMagnet" ng-class="{hasLeftSidebar: mainContentHasLeftSidebar, hasRightSidebar: mainContentHasRightSidebar}">\n\t\t<img src="'+n("rXKF")+'">\n\t</div>\n\t<div class="col">\n\t\t<div class="pane mainPane ">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainBgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer stretchToViewport" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (mainContentItems | isCurrent).length == 1\n\t\t\t\t\t: (mainContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: mainContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: mainContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: mainContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in showCurrent ? (contentItems | isCurrent) : contentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t\t<div class="clear"></div>\n\t\t\t</div>\n\t\t\t<div class="fill fgLayer overlay">\n\t\t\t\t<div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},sGzq:function(t,e){var n="templates/searchpanel.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div ng-class="episode.styleCss" class="searchPanel__wrapper">\n\t<div aria-label="sort toggle" class="searchfilters" aria-controls="sortableSearch">\n\t\t<div>\n\t\t\tSorted by\n\t\t\t<button tabindex="0" class="fakeLink fake-link--search-results" ng-click="toggleSortBy(sortBy)" aria-label="toggles sort to {{getToggledValue(sortBy)}}">{{getFriendlySortText(sortBy)}}</button>\n\t\t</div>\n\t</div>\n\t<div class="scrollContainer">\n\t\t<div class="searchResults content" id="sortableSearch" itt-width-watch ng-class="{isNarrow: isNarrow}">\n\t\t\t<div ng-if="sortBy == \'startTime\'" class="sortByTime">\n\t\t\t\t<h1 ng-bind-html="episode.display_title"></h1>\n\t\t\t\t<div ng-repeat="scene in episode.scenes">\n\t\t\t\t\t\x3c!--<h2 class="searchCategory" ng-if="scene.start_time > 0 && ([scene.display_title] | filter:appState.searchText).length" ng-bind-html="scene.display_title  | highlightSubstring: appState.searchText"></h2>--\x3e\n\t\t\t\t\t\x3c!-- Need to filter out cosmetic items when not in producer --\x3e\n\t\t\t\t\t<span ng-switch="appState.product">\n\t\t\t\t\t\t<div ng-switch-when="producer"\n                 ng-repeat="item in scene.items"\n                 ng-show="([item.searchableText] | filter:appState.searchText).length"\n                 class="item animate" ng-class="item.state"\n                 itt-item="item"\n                 forceTemplate="searchresults-all">\n            </div>\n\t\t\t\t\t\t<div ng-switch-default\n                 ng-repeat="item in scene.items | filter: {cosmetic: false }"\n                 ng-show="([item.searchableText] | filter:appState.searchText).length"\n                 class="item animate"\n                 ng-class="item.state"\n                 itt-item="item"\n                 forceTemplate="searchresults-all">\n            </div>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- sorted by type --\x3e\n\t\t\t<div ng-if="sortBy == \'type\'" class="sortByType">\n\t\t\t\t<div ng-repeat="category in typeCategories">\n\t\t\t\t\t<h3 ng-if="matchedItems.length > 0" ng-bind-html="showTypes[category].name"></h3>\n\t\t\t\t\t\x3c!-- controller handles stripping cosmetic items from showTypes.items, so no need to do it in template. --\x3e\n\t\t\t\t\t<div class="item animate"\n               ng-repeat="item in matchedItems=(showTypes[category].items | orderBy:\'start_time\')"\n               ng-show="([item.searchableText] | filter:appState.searchText).length"\n               ng-class="item.state"\n               itt-item="item"\n               forceTemplate="searchresults-all">\n          </div>\n\t\t\t\t</div>\n\t\t\t\t<div ng-if="(episode.items | filter:{\'searchableText\': appState.searchText||\'\', \'cosmetic\': false}).length == 0">\n\t\t\t\t\t(Nothing matched your search.)\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n')}]),t.exports=n},tOyj:function(t,e,n){var i="templates/episode/components/watchmode.html",a='\x3c!-- the padding is necessary to work around a Chrome bug, see STORY-99 --\x3e\n<div ng-if="appState.viewMode == \'watch\'" style="padding-bottom: 100%;">\n\t<div class="watchMode">\n\t\t<div itt-magnet id="watchModeVideoMagnet" class="videoMagnet">\n\t\t\t<img src="'+n("rXKF")+'">\n\t\t</div>\n\t</div>\n\t<span class="watchModeCaptions" ng-class="{padForBottomToolbar: appState.videoControlsActive}">\n\t\t<div class="item watchModeCaption" ng-if="item.isCurrent && !appState.hideCaptions" ng-repeat="item in episode.items | transcript" ng-class="item.state" itt-item="item" forceTemplate="caption">\n\t\t</div>\n\t</span>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"teY+":function(t,e,n){t.exports=n.p+"images/Narrasys_Logo.df561103178efc6ff2c87d7f47387f90.png"},uFtN:function(t,e,n){var i="templates/scene/pip.html",a='<div class="scene pip" ng-class="scene.styleCss + \' \'+ scene.state">\n\t<div class="pane altPane stretchToViewport">\n\t\t<div class="fill bgLayer">\n\t\t\t<div class="item animate" ng-repeat="item in (altBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t</div>\n\t\t<div class="content contentLayer" ng-class="{\n\t\t\t\tsingleitem: showCurrent\n\t\t\t\t\t? (altContentItems | isCurrent).length == 1\n\t\t\t\t\t: (altContentItems).length == 1,\n\t\t\t\tallowHighlights: !showCurrent,\n\t\t\t\thasLeftSidebar: altContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: altContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: altContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t<div class="item animate" ng-repeat="item in showCurrent ? (altContentItems | isCurrent) : altContentItems" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t</div>\n\t\t\t<div class="clear "></div>\n\t\t</div>\n\t\t<div class="fill fgLayer overlay">\n\t\t\t<div class="item animate" ng-repeat="item in (altFgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t</div>\n\t</div>\n\t<div ng-class="{padForBottomToolbar: appState.videoControlsActive}">\n\t\t<div class="videoPositioner">\n\t\t\t<div itt-magnet class="videoMagnet">\n\t\t\t\t<img src="'+n("rXKF")+'">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="pane mainPane">\n\t\t\t<div class="fill bgLayer">\n\t\t\t\t<div class="item animate" ng-repeat="item in (mainBgItems | isCurrent)" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t\t\t</div>\n\t\t\t<div class="content contentLayer showCurrent" ng-class="{\n\t\t\t\thasLeftSidebar: mainContentHasLeftSidebar,\n\t\t\t\thasRightSidebar: mainContentHasRightSidebar,\n\t\t\t\tisNarrow: isNarrow,\n\t\t\t\tisEmpty: mainContentItems.length == 0\n\t\t\t}" itt-width-watch>\n\t\t\t\t<div class="item animate" ng-repeat="item in mainContentItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="clear "></div>\n\t\t</div>\n\t</div>\n\t<div class="fill fgLayer overlay">\n\t\t<div class="item animate" ng-repeat="item in mainFgItems | isCurrent" ng-class="item.styleCss + \' \' + item.state" itt-item="item"></div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},uaSq:function(t,e,n){var i="templates/episode/gwlaw.html",a='<div class="episode episode-gw" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("MvqX")+'" alt="GW Law">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},"un+J":function(t,e){var n="templates/item/link-withimage-notitle.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text">\n\t\t<span ng-if="handleOutgoingLinkDisplay()">\n\t\t\t<span ng-if="!item.targetTop">\n\t\t\t\t<a tabindex="0" ng-if="item.asset.url" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)">\n\t\t\t\t\t<img ng-src="{{item.asset.url}}" class="img--link-with-image-no-title">\n\t\t\t\t</a>\n\t\t\t</span>\n\t\t\t<span ng-if="item.targetTop">\n\t\t\t\t<a tabindex="0" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)">\n\t\t\t\t\t<img ng-src="{{item.asset.url}}" class="img--link-with-image-no-title">\n\t\t\t\t</a>\n\t\t\t</span>\n\t\t</span>\n\t\t<span ng-if="!handleOutgoingLinkDisplay()">\n\t\t\t<img ng-click="toggleDetailView()" ng-src="{{item.asset.url}}" class="img--link-with-image-no-title">\n\t\t</span>\n\t\t<div class="item__text item__text--link text--link-with-image" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t</div>\n\n</div>\n\n<div class="itemDetail" ng-if="item.showInlineDetail">\n\t<a tabindex="0" ng-if="!item.noExternalLink" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" class="escapelink item__link--escape-link escape-link--link-with-image">(new window)</a>\n\t<itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n\t<itt-video\n\t\tng-if="item.isVideoUrl"\n\t\tmedia-src-arr="[item.url]"\n\t\tplayer-id="item._id"\n\t\tmain-player="false">\n\t</itt-video>\n</div>\n<div class="clear "></div>\n')}]),t.exports=n},vhlq:function(t,e,n){var i="templates/episode/ewb.html",a='<div class="episode episode-ewb" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("RRIM")+'" alt="Engineers Without Borders">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},vxq4:function(t,e){var n="templates/item/sxs-image.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="itemTemplate sxs-item">\n\t<a class="edit-event" ng-click="editItem()" ng-if="item.editableByThisUser">[Edit]</a>\n\t<div class="avatar">\n\t\t<img ng-src="{{item.avatar.url || \'/images/no-avatar.gif\'}}">\n\t</div>\n\t<div class="itemHead">\n\t\t<div class="authorName" ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></div>\n\t</div>\n\t<div>\n\t\t<b ng-bind-html="item.title.en"></b>\n\n\t\t<p style="text-align:center">\n\t\t\t<div ng-if="item.asset.url" class="touchable">\n\t\t\t\t<img x-ng-click="forceModal()" ng-src="{{item.asset.url}}">\n\t\t\t\t<div class="touchableIndicator"></div>\n\t\t\t</div>\n\t\t</p>\n\n\t</div>\n\t<div class="text" ng-bind-html="item.description.en"></div>\n\t<div class="clear"></div>\n</div>\n')}]),t.exports=n},w2z7:function(t,e){},w5Vi:function(t,e){var n="templates/container.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!-- recursive template for admin episode list --\x3e\n<div class="container" ng-class="{hoverIndicator: depth === 3, isActive: container.isActive && depth === 3}" ng-style="{\'text-indent\': 1 * depth + \'em\' }" ng-if="container._id">\n\n\t<span ng-class="{isOpen: container.showChildren && depth !== 3, isClosed: !container.showChildren && depth !== 3}"\n\t\t  ng-click="onToggleChildren(false)">\n\t</span>\n\n\t<itt-modal modal-class="narrative__modal" ng-if="showNarrativeModal">\n\t\t<itt-narrative-editor\n\t\t\tcustomers="customers"\n      container-info="{containerId: container._id, customerId: container.customer_id, name: container.name}"\n      hide-path-slug="::true"\n\t\t\ton-done="toggleNarrativeModal()"\n\t\t\ton-update="postNewNarrative(data)">\n\t\t</itt-narrative-editor>\n\n\t\t<itt-route-loading is-loading="resolvingNarrative"></itt-route-loading>\n\t</itt-modal>\n\n\t<div ng-class="{hoverIndicator: depth !== 3, isActive: container.isActive && depth !== 3}">\n\n\t\t<div ng-if="depth === 3">\n\t\t\t<itt-tooltip tip-text="{{container.status}}"  class="published__state" style="text-indent: 0;">\n\t\t\t\t<span ng-class="{isPublished: container.status === \'Published\', isUnPublished: container.status !== \'Published\'}"></span>\n\t\t\t</itt-tooltip>\n\t\t</div>\n\n\t\t<span ng-if="!container.editingContainer" ng-style="depth === 3 ? {\'text-indent\': \'4em\'} : \'\'">\n\t\t\t<itt-edit-pencil ng-if="depth !== 0" can-access="true" on-edit="container.editingContainer = true">\n\t\t\t\t<a ng-click="onToggleChildren(true)">{{container.name.en}}</a>\n\t\t\t</itt-edit-pencil>\n\n      <a ng-if="depth === 0" ng-click="onToggleChildren(true)">{{container.name.en}}</a>\n\t\t</span>\n\n\t\t<div ng-if="depth === 0">\n\t\t\t<div ng-if="!container.addingContainer">\n\t\t\t\t<div ng-if="container.isActive" class="button__row">\n          <div>\n            <itt-tooltip tip-text="Add Project">\n              <a class="icon__button button__add-inverted" ng-click="container.addingContainer = true"></a>\n            </itt-tooltip>\n            <itt-tooltip tip-text="Link Status Report">\n              <a ng-if="isAdmin" class="icon__button button__link-status"\n                 ng-click="getLinkStatusReport(container.customer_id)"></a>\n            </itt-tooltip>\n          </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div ng-if="container.addingContainer">\n\t\t\t\t<label>Name:&nbsp;\n\t\t\t\t\t<input ng-model="container.newContainerTitle" type="text" autofocus>&nbsp;\n\t\t\t\t</label>\n\t\t\t\t<button ng-click="container.addingContainer = false">Cancel</button>\n\t\t\t\t<button ng-disabled="!container.newContainerTitle" ng-click="addContainer(container)">Add</button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div ng-if="depth === 1">\n\t\t\t<div ng-if="!container.addingContainer">\n\t\t\t\t<div ng-if="container.isActive" class="button__row">\n          <div>\n            <itt-tooltip tip-text="Add Module">\n              <a class="icon__button button__add-inverted" ng-click="container.addingContainer = true"></a>\n            </itt-tooltip>\n            <itt-tooltip tip-text="Go to assets">\n              <a class="icon__button button__assets" ng-href="#/assets/{{container._id}}"></a>\n            </itt-tooltip>\n            <itt-tooltip tip-text="Generate new narrative">\n              <a ng-if="canAccess" class="icon__button button__generateNarrative" ng-click="toggleNarrativeModal()"></a>\n            </itt-tooltip>\n          </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div ng-if="container.addingContainer">\n\t\t\t\t<label>Name:&nbsp;\n\t\t\t\t\t<input ng-model="container.newContainerTitle" type="text" autofocus>&nbsp;\n\t\t\t\t</label>\n\t\t\t\t<button ng-click="container.addingContainer = false">Cancel</button>\n\t\t\t\t<button ng-disabled="!container.newContainerTitle" ng-click="addContainer(container)">Add</button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div ng-if="depth === 2">\n\t\t\t<div ng-if="!container.addingContainer">\n\t\t\t\t<div ng-if="container.isActive" class="button__row">\n          <itt-tooltip tip-text="Add Episode">\n            <a class="icon__button button__add-inverted" ng-click="container.addingContainer = true"></a>\n          </itt-tooltip>\n\t\t\t\t\t<itt-tooltip tip-text="Go to assets" >\n\t\t\t\t\t\t<a class="icon__button button__assets" ng-href="#/assets/{{container._id}}"></a>\n\t\t\t\t\t</itt-tooltip>\n\t\t\t\t\t<itt-tooltip tip-text="Generate new narrative" >\n\t\t\t\t\t\t<a ng-if="canAccess" class="icon__button button__generateNarrative" ng-click="toggleNarrativeModal()"></a>\n\t\t\t\t\t</itt-tooltip>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ng-if="container.addingContainer">\n\t\t\t\t<label>Name:&nbsp;\n\t\t\t\t\t<input ng-model="container.newContainerTitle" type="text" autofocus>&nbsp;\n\t\t\t\t</label>\n\t\t\t\t<button ng-click="container.addingContainer = false">Cancel</button>\n\t\t\t\t<button ng-disabled="!container.newContainerTitle" ng-click="addContainer(container)">Add</button>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<span ng-if="container.editingContainer">\n\t\t\t<label>Name:&nbsp;\n\t\t\t\t<input ng-model="container.newContainerName" ng-init="container.newContainerName = container.name.en" type="text" autofocus>&nbsp;\n\t\t\t</label>\n\t\t\t<button ng-click="container.editingContainer = false">Cancel</button>\n\t\t\t<button ng-disabled="!container.newContainerName || container.newContainerName == container.name.en" ng-click="renameContainer()">Save</button>\n\t\t</span>\n\t\t<span class="controls">\n\t\t\t<button class="danger" ng-if="appState.dangerousButtons && !container.children.length && !container.haveNotLoadedChildData" ng-click="deleteEpisodeAndContainer(container._id)">\n\t\t\t\tDelete\n\t\t\t</button>\n\t\t</span>\n\t</div>\n\n\t<div ng-if="depth == 3 && container.isActive" class="container" style="text-indent: 4em;">\n\n\t\t\x3c!-- begin episode --\x3e\n\t\t<div class="episode__button-row">\n\t\t\t<div class="episode__button">\n\t\t\t\t<itt-tooltip tip-text="Go to editor">\n\t\t\t\t\t<a class="icon__button button__editor" ng-if="isDemoServer" href="#/editor/{{container.episodes[0]}}"></a>\n\t\t\t\t</itt-tooltip>\n\n\t\t\t\t<itt-tooltip tip-text="Go to producer">\n\t\t\t\t\t<a class="icon__button button__producer" href="#/producer/{{container.episodes[0]}}"></a>\n\t\t\t\t</itt-tooltip>\n\n\t\t\t\t<itt-tooltip tip-text="Go to assets">\n\t\t\t\t\t<a class="icon__button button__assets" ng-href="#/assets/{{container._id}}"></a>\n\t\t\t\t</itt-tooltip>\n\n\t\t\t\t<itt-tooltip tip-text="Generate new narrative">\n\t\t\t\t\t<a ng-if="canAccess" class="icon__button button__generateNarrative" title="Generate new narrative" ng-click="toggleNarrativeModal()"></a>\n\t\t\t\t</itt-tooltip>\n\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!-- end episode --\x3e\n\t</div>\n\n\t<div ng-if="container.showChildren">\n\n\t\t\x3c!--recur--\x3e\n\t\t<div ng-if="depth < 3" ng-repeat="child in container.children"\n\t\t\t itt-container="containers[child._id]"\n\t\t\t depth="depth+1"\n\t\t\t ng-class="{\'container__row--odd\': containers[child._id].evenOdd === false, \'container__row--even\': containers[child._id].evenOdd === true }"\n\t\t\t on-container-click="clickRootContext($container)"\n\t\t\t on-container-add="addRootContext($container)"\n\t\t\t add-root-context="addRootContext"\n\t\t\t click-root-context="clickRootContext">\n\t\t</div>\n\n\n\t</div>\n</div>\n')}]),t.exports=n},wAkt:function(t,e,n){var i="templates/episode/columbiabusiness.html",a='<div class="episode episode-columbiabusiness" ng-class="episode.styleCss">\n\t<div class="fill trident"></div>\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent" ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="itt logo" href="//inthetelling.com" target="_blank">\n\t\t\t<img src="'+n("qUX4")+'" alt="In The Telling logo">\n\t\t</a>\n\t\t<span class="copyright" ng-include="\'templates/copyright.html\'"></span>\n\t</div>\n\n\t<div class="banner-logo">\n\t\t<img src="'+n("XWPa")+'" alt="Columbia Business School">\n\t</div>\n\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},wIHC:function(t,e,n){t.exports=n.p+"images/itt-incolor.ef74b932fe3192976fc97cc9b528ee1b.svg"},wM7k:function(t,e){var n="templates/episode/george-washington.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<div class="episode professional george-washington" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent"\n\t\t  ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="professional__branding">\n\t\t<div class="branding--content">\n\t\t\t<div class="professional__copyright" ng-include="\'templates/copyright.html\'"></div>\n\t\t</div>\n\t</div>\n</div>\n')}]),t.exports=n},wXer:function(t,e){var n="templates/item/pullquote-noattrib.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'\x3c!--DEPRECATED IN PRODUCER V1--\x3e\n\x3c!--DUPLICATE OF PULLQUTE TEMPLATE--\x3e\n<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate headerItem">\n\t<div class="category"></div>\n\t<div class="pullquote item__text item__text--pullquote" ng-bind-html="item.display_annotation | highlightSubstring: appState.searchText"></div>\n\t<div class="pullquoteSpeaker" ng-if="item.display_annotator"> — <span ng-bind-html="item.display_annotator | highlightSubstring: appState.searchText"></span></div>\n</div>\n')}]),t.exports=n},"x+pf":function(t,e){var n="templates/player-timeline.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<span>\n\t<div ng-if="showPlayer" ng-controller="PlayerController" ng-include="\'templates/player.html\'"></div>\n</span>\n')}]),t.exports=n},xs09:function(t,e,n){var i="templates/episode/story.html",a='<div class="episode episode-story" ng-class="episode.styleCss">\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent " ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="branding footer">\n\t\t<a class="narrasys-brand narrasys-logo" href="//Narrasys.com" target="_blank" rel="noopener noreferrer">\n\t\t\t<img src="'+n("rFfA")+'" alt="Narrasys logo">\n\t\t</a>\n\t\t<nys-copyright class="copyright"></nys-copyright>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},yRIp:function(t,e,n){var i="templates/episode/fieldpros.html",a='<div class="episode professional field-pros" ng-class="episode.styleCss">\n\n\t<span ng-include="\'templates/episode/components/reviewmode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/watchmode.html\'"></span>\n\t<span ng-repeat="scene in episode.scenes | isCurrent"\n\t\t  ng-include="\'templates/episode/components/discovermode.html\'"></span>\n\t<span ng-include="\'templates/episode/components/video.html\'"></span>\n\t<span ng-include="\'templates/episode/components/windowfg.html\'"></span>\n\n\t<div ng-if="appState.viewMode != \'watch\'" class="professional__branding">\n\t\t<div class="branding--content">\n\t\t\t<nys-copyright class="professional__copyright"></nys-copyright>\n\t\t\t<img class="professional__logo" src="'+n("RSWg")+'"/>\n\t\t</div>\n\t</div>\n</div>\n';window.angular.module("ng").run(["$templateCache",function(t){t.put(i,a)}]),t.exports=i},yulP:function(t,e){var n="templates/episode/wiley3.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,"<div ng-include=\"'templates/episode/wiley1.html'\"></div>\n")}]),t.exports=n},zuiT:function(t,e){var n="templates/item/link.html";window.angular.module("ng").run(["$templateCache",function(t){t.put(n,'<a class="edit-event" ng-click="editItem()">\n\t<span>Edit item</span>\n</a>\n<div class="itemTemplate">\n\t<div class="itemHead">\n\t\t<a role="button" aria-label="Seek video to {{item.displayStartTime}}" tabindex="0" class="startTime displayTime" x-ng-click="seek(item.start_time)" x-ng-keypress="seekOnKeyPress(item.start_time, $event)">{{item.displayStartTime}}</a>\n\t\t<div class="category item__title">\n\t\t\t\x3c!--{{item.category}}--\x3e\n\t\t\t<span ng-if="item.required">(Required viewing)</span>\n\t\t</div>\n\t</div>\n\t<div class="text item__text">\n    \x3c!--open in new tab--\x3e\n\t\t<span ng-if="handleOutgoingLinkDisplay()">\n\t\t\t<span ng-if="!item.targetTop">\n\t\t\t\t<div class="title item__title item__title--link title--link-with-image">\n\t\t\t\t\t<a tabindex="0" class="escapelink item__link--escape-link escape-link--link-with-image" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t\t</div>\n\t\t\t\t<a tabindex="0" ng-if="item.asset.url" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)">\n\t\t\t\t\t<img ng-if="item.asset.url" ng-src="{{item.asset.url}}">\n\t\t\t\t</a>\n\t\t\t</span>\n\t\t\t<span ng-if="item.targetTop">\n\t\t\t\t<div class="title item__title item__title--link title--link-with-image">\n\t\t\t\t\t<a tabindex="0" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t\t</div>\n\t\t\t\t<a tabindex="0" target="_top" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)">\n\t\t\t\t\t<img ng-if="item.asset.url" ng-src="{{item.asset.url}}">\n\t\t\t\t</a>\n\t\t\t</span>\n\t\t</span>\n    \x3c!--open in detail view--\x3e\n\t\t<span ng-if="!handleOutgoingLinkDisplay()">\n\t\t\t\t<div class="title item__title item__title--link title--link-with-image">\n\t\t\t\t<a role="button" x-ng-keypress="toggleDetailOnKeyPress($event)" class="fakeLink item__link--fake-link" tabindex="0" ng-click="toggleDetailView()" ng-bind-html="item.display_title || \'(Untitled)\' | highlightSubstring: appState.searchText"></a>\n\t\t\t</div>\n\t\t\t<img ng-if="item.asset.url" ng-click="toggleDetailView()" ng-src="{{item.asset.url}}">\n\t\t</span>\n\t\t<div class="item__text item__text--link text--link-with-image" ng-bind-html="item.display_description | highlightSubstring: appState.searchText"></div>\n\t</div>\n\n</div>\n\n<div class="itemDetail" ng-if="item.showInlineDetail">\n\t<a tabindex="0" ng-if="!item.noExternalLink" x-ng-keypress="outgoingLinkOnKeyPress(item.url,$event)" ng-click="outgoingLink(item.url)" class="escapelink item__link--escape-link escape-link--link-with-image">(new window)</a>\n\n\t<itt-iframe ng-if="!item.isVideoUrl" x-src="{{item.url}}" item="item"></itt-iframe>\n\t<itt-video\n\t\tng-if="item.isVideoUrl"\n\t\tmedia-src-arr="[item.url]"\n\t\tplayer-id="item._id"\n\t\tmain-player="false">\n\t</itt-video>\n\n</div>\n<div class="clear"></div>\n')}]),t.exports=n}},["m2IE"]);
//# sourceMappingURL=https://localhost.inthetelling.com/sourcemaps/app.69b4d3245fe8c5c7b97b.min.js.map