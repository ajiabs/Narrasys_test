<div class="episode">

	<!-- begin review mode -->
	<div class="reviewMode" ng-show="appState.viewMode == 'review'">
		<div itt-magnet id="reviewModeVideoMagnet" class="videoMagnet">
			<img src="images/aspectratiopreserver-16x9.gif">
		</div>
		<div class="scene" ng-class="{navigable: scene.title}" ng-repeat="scene in episode.scenes">
			<div class="pane mainPane">
				<div class="content allowHighlights">
					<h2 ng-if="scene.title">{{scene.title}}</h2>
					<div class="item animate" ng-repeat="item in scene.items | isContent | annotation | filter:{cosmetic:false} | orderBy:'start_time'" ng-class="item.styleCss + ' ' + item.state" itt-item="item" forceTemplate="review-annotation">
					</div>
				</div>
			</div>
			<div class="pane altPane">
				<div class="content allowHighlights">
					<img ng-if="$index == 1" src="images/aspectratiopreserver-16x9.gif" class="videoPadding">
					<!-- contentAlt -->
					<div class="item animate" ng-repeat="item in scene.items | 
					                                  isContent | 
					                                  transmedia | 
					                                  filter:{cosmetic:false}" ng-class="item.styleCss + ' ' + item.state" itt-item="item" forceTemplate="review-transmedia">
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end review mode -->

	<!-- just the video magnet for watch mode -->
	<div class="watchMode" ng-show="appState.viewMode == 'watch'">
		<div itt-magnet id="watchModeVideoMagnet" class="videoMagnet">
			<img src="images/aspectratiopreserver-16x9.gif">
		</div>
	</div>

	<!-- everything except review mode needs only the current scene: -->
	<span ng-repeat="scene in episode.scenes | isCurrent">

		<div class="discoverMode" ng-show="appState.viewMode == 'discover'">
			<div class="fill bgLayer">
				<div ng-class="item.styleCss + ' ' + item.state" itt-item="item" class="item animate" ng-repeat="item in scene.items |
				                                                isCurrent | 
				                                                itemLayout:'windowBg'">
				</div>
			</div>
			<div itt-scene="scene" episode="episode"></div>
		</div>

		<span ng-if="appState.viewMode == 'watch' && !appState.hideCaptions">
			<div class="item watchModeCaption animate" ng-repeat="item in scene.items  | 
			                                                     transcript | isCurrent" ng-class="item.styleCss + ' ' + item.state" itt-item="item" forceTemplate="caption">
			</div>
		</span>

		<div class="fill overlay windowFg fgLayer" ng-show="appState.viewMode == 'discover'">
			<div ng-class="item.styleCss + ' ' + item.state" itt-item="item" class="item animate" ng-repeat="item in scene.items | isCurrent | itemLayout:'windowFg'">
			</div>
		</div>
	</span>

	<div itt-magnetized class="pane videoContainer">
		<div class="video contentLayer" itt-video="episode.masterAsset.video"></div>
		<div class="pane fill overlay fgLayer">
			<div ng-class="item.styleCss + ' ' + item.state" itt-item="item" class="item animate" ng-repeat="item in episode.items | 
				                                                itemLayout:'videoOverlay' | 
				                                                isCurrent">
			</div>
		</div>
	</div>


	<div ng-if="loading" class="loading">
		<div class="spinner">
			<div class="rotating pie"></div>
			<div class="filler pie"></div>
			<div class="mask"></div>
		</div>
		Loading
	</div>

	<div class="autoscroll" ng-if="appState.autoscroll && appState.autoscrollBlocked" ng-click="enableAutoscroll()">
		<img src="/images/autoscroll.svg" width="32" height="32">
	</div>
</div>
