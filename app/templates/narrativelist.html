<div class="">

  <itt-modal modal-class="narrative__modal" ng-if="$ctrl.narrativeSelect || $ctrl.narrativeToEdit">
    <h3>{{$ctrl.narrativeSelect ? 'Add' : 'Edit'}} Narrative</h3>

    <itt-narrative-editor
      customers="$ctrl.selectedCustomer"
      narrative="$ctrl.narrativeToEdit"
      on-done="$ctrl.closeAddOrEditModal()"
      on-update="$ctrl.addOrUpdateNarrative(n)">
    </itt-narrative-editor>

  </itt-modal>

  <div ng-repeat="customer in $ctrl.customersData"
       ng-click="$ctrl.customerRowClick(customer, $event)"
       ng-class="$ctrl.setRowClasses(customer)">
    <!--drop down arrow-->
    <span ng-click="$ctrl.toggleRow(customer, $event)" ng-class="customer.showNarratives ? 'isOpen' : 'isClosed'">
    </span>

    <a>{{customer.name}}</a>

    <div ng-if="customer.isActive === true">
      <div ng-if="$ctrl.canAccess" style="padding-left: 1em;">
        <button ng-click="$ctrl.setSelectedNarrative(customer)">Add Narrative</button>
      </div>
    </div>

    <div ng-repeat="narrative in customer.narratives"
         style="padding-left: 2em;"
         ng-if="customer.showNarratives === true"
         ng-click="$ctrl.gotoNarrative(narrative._id, $event)"
         ng-class="$ctrl.setNarrativeRowClasses(customer, narrative)">
      <div>
        <itt-edit-pencil can-access="true" on-edit="$ctrl.setNarrativeToEdit($event, narrative, customer)">
          <a>{{narrative.name.en}}</a>
        </itt-edit-pencil>
        <p ng-if="narrative.description">
          <small>{{narrative.description.en}}</small>
        </p>
      </div>
    </div>

  </div>
</div>
