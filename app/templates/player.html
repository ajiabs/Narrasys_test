<div ng-class="{
	isTouchDevice: appState.isTouchDevice,
	isFramed: appState.isFramed,
	isProducer: (appState.product == 'producer'),
	isSxS: (appState.product == 'sxs'),
	episodeUI: (appState.productLoadedAs == 'player'),
	canEditContent: (!appState.editEvent && !appState.editEpisode) && (appState.product == 'producer' || appState.product == 'sxs')
	}">
	<div class="player">
		<!-- TODO: make sure user has admin role for canEditContent -->
		<div ng-include="
		appState.productLoadedAs=='player'
		? 'templates/toolbar-episode.html'
		: 'templates/toolbar-story.html'"></div>

		<div ng-if="loading" ng-include="'templates/loading.html'"></div>
		<div ng-show="!loading" itt-episode ng-class="{
		padForEditing: appState.editEvent || appState.editEpisode,
		showBackgroundOnly: appState.producerEditLayer < 0,
		showForegroundOnly: appState.producerEditLayer > 0,
	}"></div>

		<div class="toolbar-bottom" itt-show-hide-visual-only="appState.videoControlsActive" ng-mouseenter="showControls();" ng-click="showControls();" ng-mouseleave="allowControlsExit()">
			<div class="toolbar-bottom-fill">
				<div ng-if="appState.productLoadedAs=='player'" ng-show="show.navPanel" class="navPanel" ng-class="episode.styleCss">

					<div class="parent" ng-repeat="parent in episode.parents" ng-bind-html="parent.display_name"></div>
					<!-- <h2 ng-bind-html="episode.display_title"></h2> -->
					<div class="scene" x-ng-if="scene.display_title" x-ng-repeat="scene in episode.scenes" x-ng-class="{currentScene: scene.isCurrent}" x-ng-click="seek(scene.start_time)">
						<span class="displayTime">{{scene.displayStartTime}}</span>
						<p>
							<button class="fakeLink" tabindex="0" ng-bind-html="scene.display_title" x-ng-class="{sceneLink: !scene.isCurrent}" ng-focus="showControls()"></button>
							<br>
							<span ng-bind-html="scene.display_description"></span>
						</p>
					</div>
					<div class="crossEpisode">
						<a class="prevEpisode" ng-if="episode.previousEpisodeContainer" ng-href="/#/{{appState.crossEpisodePath}}/{{episode.previousEpisodeContainer.episodes[0]}}" title="{{episode.previousEpisodeContainer.display_name}}">Previous episode</a>
						<a class="nextEpisode" ng-if="episode.nextEpisodeContainer" ng-href="/#/{{appState.crossEpisodePath}}/{{episode.nextEpisodeContainer.episodes[0]}}" title="{{episode.nextEpisodeContainer.display_name}}">Next Episode</a>
					</div>


				</div>

				<div ng-show="appState.editEvent || appState.editEpisode" class="navPanel editPanel">
					<div ng-if="appState.editEvent" itt-item-editor="appState.editEvent"></div>
					<div ng-if="appState.editEpisode" itt-episode-editor="appState.editEpisode"></div>
				</div>

				<div itt-timeline></div>
			</div>
		</div>
		<div class="toolbar-bottom-controltrigger" ng-mouseenter="showControls();" ng-click="showControls();" ng-focus="showControls()"></div>
	</div>

	<div class="animate transitionFade" ng-if="appState.videoControlsActive && (appState.product == 'sxs' || appState.product == 'producer')" ng-mouseenter="showControls();" ng-click="showControls();" ng-focus="showControls()" sxs-add-content></div>

	<div class="autoscroll" ng-if="appState.autoscroll && appState.autoscrollBlocked" ng-click="enableAutoscroll()">
		<img src="/images/autoscroll.svg" width="32" height="32">
	</div>

	<div ng-show="show.navPanel" class="modal-backdrop" ng-click="hidePanel('navPanel')"></div>
	<div ng-show="show.profilePanel" class="modal-backdrop" ng-click="hidePanel('profilePanel')"></div>

	<!-- ITEM DETAIL -->
	<div ng-show="appState.itemDetail" class="modal-backdrop" ng-click="appState.itemDetail=false"></div>
	<div ng-if="appState.itemDetail" itt-item-detail-modal="appState.itemDetail"></div>


	<div ng-if="show.profilePanel" class="profilePanel" ng-class="{isFramed: appState.isFramed}">
		<div class="arrow-up"></div>
		<div itt-user x-in-player="true"></div>
	</div>

	<div ng-cloak ng-if="show.wileyNag &&  (appState.productLoadedAs == 'player'
	 			|| (appState.productLoadedAs == 'narrative'
	 			&& !narrative.disable_new_window ) )" class="wileyNag animate transitionFade">
		<!-- HACK design-by-committee idiocy -->
		<div>
			<span style="float:right">â¤´</span>
			<span style="float:right; display:inline-block; padding: 5px">Go here for best view</span>
		</div> <a class="goAway" ng-click="noWileyNag()">Don't show this again</a>
	</div>
</div>
