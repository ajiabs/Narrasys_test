<span>
	<div class="toolbar" x-ng-class="{isFramed: isFramed, nobg: !show.playerPanel}">

		<div x-ng-show="show.playerPanel" class="modegroup buttongroup">
			<a class="button button-video" x-ng-class="{cur: currentSceneTemplateIs('video')}" x-ng-click="setSceneTemplate('video');">
				<span>Watch</span>
			</a>
			<a class="button button-directed" x-ng-class="{cur: currentSceneTemplateIs()}" x-ng-click="setSceneTemplate();">
				<span>Discover</span>
			</a>
			<a class="button button-explore" x-ng-class="{cur: currentSceneTemplateIs('explore')}" x-ng-click="setSceneTemplate('explore');">
				<span>Review</span>
			</a>
		</div>

		<div x-ng-if="isFramed" class="escapegroup buttongroup" style="float:right;">
			<a x-ng-click="mainframeescape();" class="button button-mainframeescape">
				<span>New window</span>
			</a>
		</div>

		<div x-ng-show="show.playerPanel" class="searchgroup buttongroup" x-ng-class="{cur: show.searchPanel}" style="float:right; z-index:10">
			<a class="button button-search" href="javascript: void 1;" x-ng-click="toggleSearchPanel()">
				<span>Search</span>
			</a>
			<input id="searchtext" type="text" x-ng-model="searchText" />
		</div>

		<div class="autoscroll" x-ng-show="exploreMode && !autoscrollEnabled" x-ng-click="enableAutoscroll()">
			<img src="/images/autoscroll.svg" width="32" height="32">
		</div>

	</div>
	<div class="threedee">
		<div class="modal-backdrop" x-ng-click="hidePanels()" x-ng-show="show.navigationPanel"></div>
		<div class="modal-backdrop search-backdrop" x-ng-click="hidePanels()" x-ng-show="show.searchPanel"></div>
		<div class="modal-backdrop help-backdrop" x-ng-click="hidePanels()" x-ng-show="show.playerPanel && show.helpPanel"></div>
		<div x-ng-if="show.playerPanel && show.helpPanel" class="helpPanel">
			<div class="arrow-up"></div>
			<p>Welcome to TELLING STORY! You can switch at any time between these views &#8212; don't worry, you won't lose your place:</p>
			<ul>
				<li class="video">
					<h3>Watch</h3>
					<p>Just the video, no frills.</p>
				</li>
				<li class="directed">
					<h3>Discover</h3>
					<p>The guided, synchronized view of the video and related content.</p>
				</li>
				<li class="explore">
					<h3>Review</h3>
					<p>Read the full transcript and all the related transmedia in one convenient list.</p>
				</li>
			</ul>
			<a class="goAway" x-ng-click="noMoreHelp()" href="javascript:void 1;">Don't show this again</a>



		</div>
		<div x-ng-show="show.navigationPanel" class="sidePanel navigationPanel">
			<div x-ng-controller="NavigationPanelController">
				<h2>{{episode.title}}</h2>
				<div class="scene" x-ng-if="scene.title" x-ng-repeat="scene in scenes" x-ng-class="{currentScene: scene.isActive}" x-ng-click="gotoScene(scene.startTime)">
					<span class="displayTime">{{scene.displayTime}}</span>
					<p>
						<a href="javascript:void 1;">{{scene.title}}</a>
						<br>{{scene.description}}
					</p>
				</div>
			</div>
		</div>
		<div x-ng-show="show.searchPanel" class="sidePanel searchPanel">
			<div x-ng-if="show.searchPanelInternals" x-ng-controller="SearchPanelController">

				<div class="searchfilters">
					<label x-ng-show="sortBy!=='startTime'">
						<input type="radio" name="searchsort" id="searchsort" x-ng-model="sortBy" value="startTime">Sorted by
						<span class="fakelink">type</span>
					</label>
					<label x-ng-show="sortBy==='startTime'">
						<input type="radio" name="searchsort" id="searchsort" x-ng-model="sortBy" value="type">Sorted by
						<span class="fakelink">time</span>
					</label>
				</div>
				<div class="scrollContainer">
					<div class="searchResults">
						<!-- TODO:
					- Wire up all types checkbox
					- Check ordering in items by type
					- Hide type header when no child items are visible
				-->
						<!-- sorted by start time -->
						<div x-ng-if="sortBy == 'startTime'">
							<div x-ng-repeat="scene in scenes">
								<h3 x-ng-if="scene.title">{{scene.title}}</h3>
								<div class="item" x-ng-repeat="item in scene.items | orderBy:'startTime' | filter:{'searchableText': searchText, 'cosmetic': false} | type:searchTypes">
									<span class="displayTime"><a href="javascript:void 1" x-ng-click="gotoItem(item)">{{item.displayTime}}</a>
									</span>
									<span x-ng-if="item.type==='annotation'" class="type">{{item.authorName}}</span>
									<span x-ng-if="item.type!=='annotation'" class="type">({{prettyTypeMap[item.type]}})</span>
									<div class="description" ng-bind-html="item.trustedDisplayText | highlight: searchText"></div>
								</div>
							</div>
						</div>

						<!-- sorted by type -->
						<div x-ng-if="sortBy == 'type'">
							<div class="sortedbytype" x-ng-repeat="(type, items) in allItemsByType | orderBy:'type'" x-ng-if="searchTypes[type]">
								<h3>{{prettyTypeMap[type]}}</h3>
								<div class="item" x-ng-repeat="item in items | orderBy:'startTime' | type:searchTypes | filter:{'searchableText': searchText, 'cosmetic': false}">
									<span class="displayTime"><a href="javascript:void 1" x-ng-click="gotoItem(item)">{{item.displayTime}}</a>
									</span>
									<span x-ng-if="item.type==='annotation'" class="type">{{item.authorName}}</span>
									<span x-ng-if="item.type!=='annotation'" class="type">({{prettyTypeMap[item.type]}})</span>
									<div class="description" ng-bind-html="item.trustedDisplayText | highlight: searchText"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- TODO ARIA markup on all clickables -->
	<div class="injectedvideocontrols vjs-story-skin">
		<div x-ng-click="showSceneMenu()" class="video-scenemenu vjs-control">
			<a href="javascript: void 1;">
				<span class="vjs-control-text">Scene list</span>
			</a>
		</div>

		<div x-ng-if="curScene.prevSceneStart || curScene.prevSceneStart === 0" class="video-prevscene vjs-control">
			<a x-ng-click="gotoTime(curScene.prevSceneStart + 0.1)">
				<span class="vjs-control-text">Previous scene</span>
			</a>
		</div>
		<div x-ng-if="curScene.startTime == 0" class="video-prevscene vjs-control">
			<a x-ng-click="gotoTime(0)">
				<span class="vjs-control-text">Previous scene</span>
			</a>
		</div>
		<div x-ng-if="curScene.nextSceneStart" class="video-nextscene vjs-control">
			<a x-ng-click="gotoTime(curScene.nextSceneStart)">
				<span class="vjs-control-text">Next scene</span>
			</a>
		</div>
		<div x-ng-click="toggleCaptions()" x-ng-if="currentSceneTemplateIs('video')" x-ng-class="{active: !hideCaptions}" class="video-captions vjs-control">
			<a>
				<span class="vjs-control-text">Captions</span>
			</a>
		</div>


	</div>


	<div x-ng-show="show.introPanel" class="intropanel">
		<div class="pane introtext">
			<h1>
				{{episode.title}}
			</h1>
			<p>
				{{episode.description}}
			</p>
		</div>
		<div class="pane videoContainer">
			<div class="fillPane video">
				<img class="aspectratiopreserver" src="/images/aspectratiopreserver-16x9.gif" />
			</div>
		</div>
	</div>

	<div x-ng-if="forcedEscape" x-itt-magnetized class="videoOverlay" style="pointer-events: auto;">
		<div x-ng-click="mainframeescape();" class="escapelink forcedEscape"></div>
	</div>
	<div id="footertrigger" x-ng-mouseenter="showVideoControls()"></div>

</span>
